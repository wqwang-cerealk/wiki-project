2022-04-25 23:23:43.298 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-25 23:23:43.305 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_322 on sunarkedeMacBook-Pro.local with PID 90887 (/Users/sunarke/Downloads/wiki 5/target/classes started by sunarke in /Users/sunarke/Downloads/wiki 5)
2022-04-25 23:23:43.305 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-25 23:23:43.363 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-25 23:23:43.363 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-25 23:23:44.023 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-25 23:23:44.026 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-25 23:23:44.051 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2022-04-25 23:23:44.679 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-25 23:23:44.690 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-25 23:23:44.690 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-25 23:23:44.691 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-25 23:23:44.739 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-25 23:23:44.739 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1375 ms
2022-04-25 23:23:45.688 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-25 23:23:46.027 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-25 23:23:46.076 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-25 23:23:46.097 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-25 23:23:46.119 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-25 23:23:46.132 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 3.221 seconds (JVM running for 3.695)
2022-04-25 23:23:46.135 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-25 23:23:46.135 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-25 23:23:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042770313449472[0;39m 生成今日电子书快照开始
2022-04-25 23:23:50.022 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m174042770313449472[0;39m HikariPool-1 - Starting...
2022-04-25 23:23:50.573 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m174042770313449472[0;39m HikariPool-1 - Start completed.
2022-04-25 23:23:50.582 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042770313449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:23:50.602 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042770313449472[0;39m ==> Parameters: 
2022-04-25 23:23:50.635 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042770313449472[0;39m <==    Updates: 0
2022-04-25 23:23:50.638 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042770313449472[0;39m 生成今日电子书快照结束，耗时：636毫秒
2022-04-25 23:23:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042791293358080[0;39m 生成今日电子书快照开始
2022-04-25 23:23:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042791293358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:23:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042791293358080[0;39m ==> Parameters: 
2022-04-25 23:23:55.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042791293358080[0;39m <==    Updates: 0
2022-04-25 23:23:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042791293358080[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-25 23:24:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042812252295168[0;39m 生成今日电子书快照开始
2022-04-25 23:24:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042812252295168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042812252295168[0;39m ==> Parameters: 
2022-04-25 23:24:00.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042812252295168[0;39m <==    Updates: 0
2022-04-25 23:24:00.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042812252295168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-25 23:24:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042833236398080[0;39m 生成今日电子书快照开始
2022-04-25 23:24:05.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042833236398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:05.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042833236398080[0;39m ==> Parameters: 
2022-04-25 23:24:05.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042833236398080[0;39m <==    Updates: 0
2022-04-25 23:24:05.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042833236398080[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-25 23:24:05.082 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m174042833567748096[0;39m start updating Ebook doc
2022-04-25 23:24:05.089 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174042833567748096[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-25 23:24:05.090 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174042833567748096[0;39m ==> Parameters: 
2022-04-25 23:24:05.122 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174042833567748096[0;39m <==    Updates: 1
2022-04-25 23:24:05.124 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m174042833567748096[0;39m update ends, take 42 millisecs
2022-04-25 23:24:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042854199529472[0;39m 生成今日电子书快照开始
2022-04-25 23:24:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042854199529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042854199529472[0;39m ==> Parameters: 
2022-04-25 23:24:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042854199529472[0;39m <==    Updates: 0
2022-04-25 23:24:10.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042854199529472[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-25 23:24:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042875179438080[0;39m 生成今日电子书快照开始
2022-04-25 23:24:15.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042875179438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:15.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042875179438080[0;39m ==> Parameters: 
2022-04-25 23:24:15.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042875179438080[0;39m <==    Updates: 0
2022-04-25 23:24:15.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042875179438080[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-25 23:24:16.736 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-25 23:24:16.736 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-25 23:24:16.738 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-25 23:24:16.794 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m174042882683047936[0;39m ------------- 开始 -------------
2022-04-25 23:24:16.794 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m174042882683047937[0;39m ------------- 开始 -------------
2022-04-25 23:24:16.794 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m174042882683047938[0;39m ------------- 开始 -------------
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m174042882683047937[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m174042882683047938[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m174042882683047936[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m174042882683047937[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m174042882683047938[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m174042882683047936[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m174042882683047937[0;39m 远程地址: 127.0.0.1
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m174042882683047938[0;39m 远程地址: 127.0.0.1
2022-04-25 23:24:16.795 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m174042882683047936[0;39m 远程地址: 127.0.0.1
2022-04-25 23:24:16.854 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：CzJqo4ZL8i，session id：0，当前连接数：1
2022-04-25 23:24:16.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m174042882683047938[0;39m 请求参数: []
2022-04-25 23:24:16.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m174042882683047936[0;39m 请求参数: []
2022-04-25 23:24:16.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m174042882683047937[0;39m 请求参数: []
2022-04-25 23:24:16.883 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m174042882683047937[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-25 23:24:16.884 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m174042882683047937[0;39m ==> Parameters: 
2022-04-25 23:24:16.887 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m174042882683047938[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-25 23:24:16.888 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m174042882683047938[0;39m ==> Parameters: 
2022-04-25 23:24:16.908 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m174042882683047936[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-25 23:24:16.909 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m174042882683047936[0;39m ==> Parameters: 
2022-04-25 23:24:16.919 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m174042882683047938[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-25 23:24:16.919 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-25 23:24:16.921 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m174042882683047938[0;39m <==        Row: 2022-04-24, 1726, 59, 0, 0
2022-04-25 23:24:16.921 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-25 23:24:16.923 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m174042882683047938[0;39m <==        Row: 2022-04-25, 1726, 59, 0, 0
2022-04-25 23:24:16.923 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-25 23:24:16.923 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m174042882683047938[0;39m <==      Total: 2
2022-04-25 23:24:16.924 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-25 23:24:16.924 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-25 23:24:16.925 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-25 23:24:16.925 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-25 23:24:16.926 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==    Columns: id, parent, name, sort
2022-04-25 23:24:16.926 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-25 23:24:16.926 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-25 23:24:16.926 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-25 23:24:16.927 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-25 23:24:16.927 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 101, 100, Vue, 101
2022-04-25 23:24:16.927 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-25 23:24:16.928 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m174042882683047937[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-25 23:24:16.928 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 200, 0, Java, 200
2022-04-25 23:24:16.929 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m174042882683047937[0;39m <==      Total: 10
2022-04-25 23:24:16.929 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 201, 200, Basics, 201
2022-04-25 23:24:16.929 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-25 23:24:16.929 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 300, 0, Python, 300
2022-04-25 23:24:16.930 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-25 23:24:16.930 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-25 23:24:16.931 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 400, 0, Database, 400
2022-04-25 23:24:16.931 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-25 23:24:16.931 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 500, 0, Others, 500
2022-04-25 23:24:16.932 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 501, 500, Servers, 501
2022-04-25 23:24:16.932 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 502, 500, Tools, 502
2022-04-25 23:24:16.932 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m174042882683047936[0;39m <==        Row: 503, 500, Languages, 503
2022-04-25 23:24:16.933 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m174042882683047936[0;39m <==      Total: 15
2022-04-25 23:24:16.951 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m174042882683047936[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-25 23:24:16.951 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m174042882683047936[0;39m ------------- 结束 耗时：159 ms -------------
2022-04-25 23:24:16.951 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m174042882683047938[0;39m 返回结果: {"content":[{"date":1650783600000,"viewCount":1726,"viewIncrease":0,"voteCount":59,"voteIncrease":0},{"date":1650870000000,"viewCount":1726,"viewIncrease":0,"voteCount":59,"voteIncrease":0}],"success":true}
2022-04-25 23:24:16.952 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m174042882683047938[0;39m ------------- 结束 耗时：160 ms -------------
2022-04-25 23:24:16.952 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m174042882683047937[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-25 23:24:16.953 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m174042882683047937[0;39m ------------- 结束 耗时：161 ms -------------
2022-04-25 23:24:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042896142569472[0;39m 生成今日电子书快照开始
2022-04-25 23:24:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042896142569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042896142569472[0;39m ==> Parameters: 
2022-04-25 23:24:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042896142569472[0;39m <==    Updates: 0
2022-04-25 23:24:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042896142569472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-25 23:24:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042917114089472[0;39m 生成今日电子书快照开始
2022-04-25 23:24:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042917114089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042917114089472[0;39m ==> Parameters: 
2022-04-25 23:24:25.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042917114089472[0;39m <==    Updates: 0
2022-04-25 23:24:25.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042917114089472[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-25 23:24:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042938085609472[0;39m 生成今日电子书快照开始
2022-04-25 23:24:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042938085609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:30.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042938085609472[0;39m ==> Parameters: 
2022-04-25 23:24:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042938085609472[0;39m <==    Updates: 0
2022-04-25 23:24:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042938085609472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-25 23:24:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042959057129472[0;39m 生成今日电子书快照开始
2022-04-25 23:24:35.113 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042959057129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:35.114 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042959057129472[0;39m ==> Parameters: 
2022-04-25 23:24:35.182 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042959057129472[0;39m <==    Updates: 0
2022-04-25 23:24:35.182 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042959057129472[0;39m 生成今日电子书快照结束，耗时：180毫秒
2022-04-25 23:24:35.182 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m174042959816298496[0;39m start updating Ebook doc
2022-04-25 23:24:35.183 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174042959816298496[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-25 23:24:35.183 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174042959816298496[0;39m ==> Parameters: 
2022-04-25 23:24:35.289 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174042959816298496[0;39m <==    Updates: 1
2022-04-25 23:24:35.289 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m174042959816298496[0;39m update ends, take 107 millisecs
2022-04-25 23:24:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174042980028649472[0;39m 生成今日电子书快照开始
2022-04-25 23:24:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042980028649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042980028649472[0;39m ==> Parameters: 
2022-04-25 23:24:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174042980028649472[0;39m <==    Updates: 0
2022-04-25 23:24:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174042980028649472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-25 23:24:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043001012752384[0;39m 生成今日电子书快照开始
2022-04-25 23:24:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043001012752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043001012752384[0;39m ==> Parameters: 
2022-04-25 23:24:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043001012752384[0;39m <==    Updates: 0
2022-04-25 23:24:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043001012752384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-25 23:24:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043021967495168[0;39m 生成今日电子书快照开始
2022-04-25 23:24:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043021967495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043021967495168[0;39m ==> Parameters: 
2022-04-25 23:24:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043021967495168[0;39m <==    Updates: 0
2022-04-25 23:24:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043021967495168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-25 23:24:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043042955792384[0;39m 生成今日电子书快照开始
2022-04-25 23:24:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043042955792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:24:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043042955792384[0;39m ==> Parameters: 
2022-04-25 23:24:55.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043042955792384[0;39m <==    Updates: 0
2022-04-25 23:24:55.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043042955792384[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-25 23:25:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043063918923776[0;39m 生成今日电子书快照开始
2022-04-25 23:25:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043063918923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043063918923776[0;39m ==> Parameters: 
2022-04-25 23:25:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043063918923776[0;39m <==    Updates: 0
2022-04-25 23:25:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043063918923776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-25 23:25:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043084898832384[0;39m 生成今日电子书快照开始
2022-04-25 23:25:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043084898832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043084898832384[0;39m ==> Parameters: 
2022-04-25 23:25:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043084898832384[0;39m <==    Updates: 0
2022-04-25 23:25:05.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043084898832384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-25 23:25:05.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m174043085184045056[0;39m start updating Ebook doc
2022-04-25 23:25:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174043085184045056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-25 23:25:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174043085184045056[0;39m ==> Parameters: 
2022-04-25 23:25:05.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174043085184045056[0;39m <==    Updates: 1
2022-04-25 23:25:05.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m174043085184045056[0;39m update ends, take 38 millisecs
2022-04-25 23:25:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043105861963776[0;39m 生成今日电子书快照开始
2022-04-25 23:25:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043105861963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:10.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043105861963776[0;39m ==> Parameters: 
2022-04-25 23:25:10.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043105861963776[0;39m <==    Updates: 0
2022-04-25 23:25:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043105861963776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-25 23:25:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043126841872384[0;39m 生成今日电子书快照开始
2022-04-25 23:25:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043126841872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043126841872384[0;39m ==> Parameters: 
2022-04-25 23:25:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043126841872384[0;39m <==    Updates: 0
2022-04-25 23:25:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043126841872384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-25 23:25:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043147800809472[0;39m 生成今日电子书快照开始
2022-04-25 23:25:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043147800809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043147800809472[0;39m ==> Parameters: 
2022-04-25 23:25:20.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043147800809472[0;39m <==    Updates: 0
2022-04-25 23:25:20.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043147800809472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-25 23:25:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043168772329472[0;39m 生成今日电子书快照开始
2022-04-25 23:25:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043168772329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043168772329472[0;39m ==> Parameters: 
2022-04-25 23:25:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043168772329472[0;39m <==    Updates: 0
2022-04-25 23:25:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043168772329472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-25 23:25:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043189760626688[0;39m 生成今日电子书快照开始
2022-04-25 23:25:30.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043189760626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:30.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043189760626688[0;39m ==> Parameters: 
2022-04-25 23:25:30.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043189760626688[0;39m <==    Updates: 0
2022-04-25 23:25:30.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043189760626688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-25 23:25:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043210727952384[0;39m 生成今日电子书快照开始
2022-04-25 23:25:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043210727952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043210727952384[0;39m ==> Parameters: 
2022-04-25 23:25:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043210727952384[0;39m <==    Updates: 0
2022-04-25 23:25:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043210727952384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-25 23:25:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m174043210992193536[0;39m start updating Ebook doc
2022-04-25 23:25:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174043210992193536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-25 23:25:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174043210992193536[0;39m ==> Parameters: 
2022-04-25 23:25:35.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m174043210992193536[0;39m <==    Updates: 1
2022-04-25 23:25:35.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m174043210992193536[0;39m update ends, take 39 millisecs
2022-04-25 23:25:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043231682695168[0;39m 生成今日电子书快照开始
2022-04-25 23:25:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043231682695168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:40.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043231682695168[0;39m ==> Parameters: 
2022-04-25 23:25:40.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043231682695168[0;39m <==    Updates: 0
2022-04-25 23:25:40.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043231682695168[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-25 23:25:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043252670992384[0;39m 生成今日电子书快照开始
2022-04-25 23:25:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043252670992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043252670992384[0;39m ==> Parameters: 
2022-04-25 23:25:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043252670992384[0;39m <==    Updates: 0
2022-04-25 23:25:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043252670992384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-25 23:25:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043273629929472[0;39m 生成今日电子书快照开始
2022-04-25 23:25:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043273629929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043273629929472[0;39m ==> Parameters: 
2022-04-25 23:25:50.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043273629929472[0;39m <==    Updates: 0
2022-04-25 23:25:50.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043273629929472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-25 23:25:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m174043294614032384[0;39m 生成今日电子书快照开始
2022-04-25 23:25:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043294614032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-25 23:25:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043294614032384[0;39m ==> Parameters: 
2022-04-25 23:25:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m174043294614032384[0;39m <==    Updates: 0
2022-04-25 23:25:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m174043294614032384[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-25 23:25:56.721 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：CzJqo4ZL8i，session id：0！当前连接数：0
2022-04-25 23:25:56.769 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-25 23:25:56.769 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-25 23:25:56.770 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-25 23:25:56.781 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
