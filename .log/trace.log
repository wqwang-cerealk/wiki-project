2022-04-29 12:38:12.995 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-29 12:38:18.012 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5007 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 12:38:23.018 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 20538 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 12:38:23.021 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 12:38:23.086 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-29 12:38:23.087 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-29 12:38:23.880 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 12:38:23.884 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 12:38:23.921 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-04-29 12:38:25.091 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 12:38:25.107 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 12:38:25.108 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 12:38:25.108 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 12:38:25.186 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 12:38:25.187 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2100 ms
2022-04-29 12:38:26.414 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 12:38:26.856 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 12:38:26.903 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 12:38:26.925 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 12:38:26.946 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 12:38:26.959 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 24.519 seconds (JVM running for 25.244)
2022-04-29 12:38:26.962 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 12:38:26.962 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 12:38:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329918341746688[0;39m 生成今日电子书快照开始
2022-04-29 12:38:30.036 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175329918341746688[0;39m HikariPool-1 - Starting...
2022-04-29 12:38:30.565 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175329918341746688[0;39m HikariPool-1 - Start completed.
2022-04-29 12:38:30.574 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329918341746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:30.595 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329918341746688[0;39m ==> Parameters: 
2022-04-29 12:38:30.630 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329918341746688[0;39m <==    Updates: 0
2022-04-29 12:38:30.634 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329918341746688[0;39m 生成今日电子书快照结束，耗时：629毫秒
2022-04-29 12:38:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175329939304878080[0;39m start updating Ebook doc
2022-04-29 12:38:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175329939304878080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:38:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175329939304878080[0;39m ==> Parameters: 
2022-04-29 12:38:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175329939304878080[0;39m <==    Updates: 1
2022-04-29 12:38:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175329939304878080[0;39m update ends, take 66 millisecs
2022-04-29 12:38:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329939585896448[0;39m 生成今日电子书快照开始
2022-04-29 12:38:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329939585896448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329939585896448[0;39m ==> Parameters: 
2022-04-29 12:38:35.117 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329939585896448[0;39m <==    Updates: 0
2022-04-29 12:38:35.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329939585896448[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-29 12:38:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329960280592384[0;39m 生成今日电子书快照开始
2022-04-29 12:38:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329960280592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329960280592384[0;39m ==> Parameters: 
2022-04-29 12:38:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329960280592384[0;39m <==    Updates: 0
2022-04-29 12:38:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329960280592384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:38:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329981243723776[0;39m 生成今日电子书快照开始
2022-04-29 12:38:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329981243723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329981243723776[0;39m ==> Parameters: 
2022-04-29 12:38:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329981243723776[0;39m <==    Updates: 0
2022-04-29 12:38:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329981243723776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:38:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330002206855168[0;39m 生成今日电子书快照开始
2022-04-29 12:38:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330002206855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330002206855168[0;39m ==> Parameters: 
2022-04-29 12:38:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330002206855168[0;39m <==    Updates: 0
2022-04-29 12:38:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330002206855168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:38:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330023195152384[0;39m 生成今日电子书快照开始
2022-04-29 12:38:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330023195152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330023195152384[0;39m ==> Parameters: 
2022-04-29 12:38:55.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330023195152384[0;39m <==    Updates: 0
2022-04-29 12:38:55.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330023195152384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:39:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330044149895168[0;39m 生成今日电子书快照开始
2022-04-29 12:39:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330044149895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330044149895168[0;39m ==> Parameters: 
2022-04-29 12:39:00.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330044149895168[0;39m <==    Updates: 0
2022-04-29 12:39:00.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330044149895168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:39:05.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330065142386688[0;39m 生成今日电子书快照开始
2022-04-29 12:39:05.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330065142386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:05.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330065142386688[0;39m ==> Parameters: 
2022-04-29 12:39:05.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330065142386688[0;39m <==    Updates: 0
2022-04-29 12:39:05.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330065142386688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:39:05.090 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330065498902528[0;39m start updating Ebook doc
2022-04-29 12:39:05.091 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330065498902528[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:39:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330065498902528[0;39m ==> Parameters: 
2022-04-29 12:39:05.132 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330065498902528[0;39m <==    Updates: 1
2022-04-29 12:39:05.133 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330065498902528[0;39m update ends, take 43 millisecs
2022-04-29 12:39:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330086097129472[0;39m 生成今日电子书快照开始
2022-04-29 12:39:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330086097129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330086097129472[0;39m ==> Parameters: 
2022-04-29 12:39:10.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330086097129472[0;39m <==    Updates: 0
2022-04-29 12:39:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330086097129472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:39:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330107085426688[0;39m 生成今日电子书快照开始
2022-04-29 12:39:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330107085426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330107085426688[0;39m ==> Parameters: 
2022-04-29 12:39:15.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330107085426688[0;39m <==    Updates: 0
2022-04-29 12:39:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330107085426688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:39:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330128052752384[0;39m 生成今日电子书快照开始
2022-04-29 12:39:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330128052752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330128052752384[0;39m ==> Parameters: 
2022-04-29 12:39:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330128052752384[0;39m <==    Updates: 0
2022-04-29 12:39:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330128052752384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:39:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330149032660992[0;39m 生成今日电子书快照开始
2022-04-29 12:39:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330149032660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330149032660992[0;39m ==> Parameters: 
2022-04-29 12:39:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330149032660992[0;39m <==    Updates: 0
2022-04-29 12:39:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330149032660992[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:39:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330170012569600[0;39m 生成今日电子书快照开始
2022-04-29 12:39:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330170012569600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330170012569600[0;39m ==> Parameters: 
2022-04-29 12:39:30.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330170012569600[0;39m <==    Updates: 0
2022-04-29 12:39:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330170012569600[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:39:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330190963118080[0;39m start updating Ebook doc
2022-04-29 12:39:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330190963118080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:39:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330190963118080[0;39m ==> Parameters: 
2022-04-29 12:39:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330190963118080[0;39m <==    Updates: 1
2022-04-29 12:39:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330190963118080[0;39m update ends, take 60 millisecs
2022-04-29 12:39:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330191214776320[0;39m 生成今日电子书快照开始
2022-04-29 12:39:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330191214776320[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330191214776320[0;39m ==> Parameters: 
2022-04-29 12:39:35.098 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330191214776320[0;39m <==    Updates: 0
2022-04-29 12:39:35.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330191214776320[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-29 12:39:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330211926249472[0;39m 生成今日电子书快照开始
2022-04-29 12:39:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330211926249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330211926249472[0;39m ==> Parameters: 
2022-04-29 12:39:40.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330211926249472[0;39m <==    Updates: 0
2022-04-29 12:39:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330211926249472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:39:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330232918740992[0;39m 生成今日电子书快照开始
2022-04-29 12:39:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330232918740992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330232918740992[0;39m ==> Parameters: 
2022-04-29 12:39:45.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330232918740992[0;39m <==    Updates: 0
2022-04-29 12:39:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330232918740992[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:39:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330253877678080[0;39m 生成今日电子书快照开始
2022-04-29 12:39:50.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330253877678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:50.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330253877678080[0;39m ==> Parameters: 
2022-04-29 12:39:50.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330253877678080[0;39m <==    Updates: 0
2022-04-29 12:39:50.087 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330253877678080[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 12:39:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330274845003776[0;39m 生成今日电子书快照开始
2022-04-29 12:39:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330274845003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330274845003776[0;39m ==> Parameters: 
2022-04-29 12:39:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330274845003776[0;39m <==    Updates: 0
2022-04-29 12:39:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330274845003776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:40:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330295812329472[0;39m 生成今日电子书快照开始
2022-04-29 12:40:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330295812329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330295812329472[0;39m ==> Parameters: 
2022-04-29 12:40:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330295812329472[0;39m <==    Updates: 0
2022-04-29 12:40:00.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330295812329472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:40:02.442 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 12:40:02.443 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 12:40:02.452 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 9 ms
2022-04-29 12:40:02.525 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：lsDuEMZABU，session id：0，当前连接数：1
2022-04-29 12:40:02.527 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330306398752770[0;39m ------------- 开始 -------------
2022-04-29 12:40:02.527 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330306398752768[0;39m ------------- 开始 -------------
2022-04-29 12:40:02.527 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330306398752769[0;39m ------------- 开始 -------------
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330306398752770[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330306398752769[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330306398752770[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330306398752768[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330306398752769[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330306398752768[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330306398752770[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330306398752769[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:02.530 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330306398752768[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:02.652 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330306398752769[0;39m 请求参数: []
2022-04-29 12:40:02.652 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330306398752770[0;39m 请求参数: []
2022-04-29 12:40:02.652 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330306398752768[0;39m 请求参数: []
2022-04-29 12:40:02.684 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175330306398752769[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:40:02.685 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175330306398752769[0;39m ==> Parameters: 
2022-04-29 12:40:02.688 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175330306398752770[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:40:02.688 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175330306398752770[0;39m ==> Parameters: 
2022-04-29 12:40:02.731 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175330306398752770[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 12:40:02.731 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 12:40:02.732 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 12:40:02.732 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175330306398752770[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 12:40:02.735 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 12:40:02.735 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175330306398752770[0;39m <==        Row: 2022-04-29, 1763, 63, 28, 2
2022-04-29 12:40:02.735 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 12:40:02.735 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175330306398752770[0;39m <==      Total: 2
2022-04-29 12:40:02.736 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 12:40:02.736 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330306398752768[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:40:02.737 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330306398752768[0;39m ==> Parameters: 
2022-04-29 12:40:02.737 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 12:40:02.738 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 12:40:02.738 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 12:40:02.739 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 12:40:02.740 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 12:40:02.740 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 12:40:02.741 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 12:40:02.741 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 12:40:02.742 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 12:40:02.743 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175330306398752769[0;39m <==      Total: 13
2022-04-29 12:40:02.756 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:40:02.757 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:40:02.757 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:40:02.758 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:40:02.759 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:40:02.759 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:40:02.760 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:40:02.760 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:40:02.761 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:40:02.761 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:40:02.762 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:40:02.763 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:40:02.763 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:40:02.764 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:40:02.765 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:40:02.765 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:40:02.766 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:40:02.767 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:40:02.768 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:40:02.768 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330306398752768[0;39m <==      Total: 18
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330306398752770[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1763,"viewIncrease":28,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330306398752769[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330306398752770[0;39m ------------- 结束 耗时：246 ms -------------
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330306398752769[0;39m ------------- 结束 耗时：246 ms -------------
2022-04-29 12:40:02.780 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330306398752768[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:40:02.781 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330306398752768[0;39m ------------- 结束 耗时：256 ms -------------
2022-04-29 12:40:05.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330316779655168[0;39m 生成今日电子书快照开始
2022-04-29 12:40:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330316779655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330316779655168[0;39m ==> Parameters: 
2022-04-29 12:40:05.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330316779655168[0;39m <==    Updates: 0
2022-04-29 12:40:05.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330316779655168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:40:05.056 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330317014536192[0;39m start updating Ebook doc
2022-04-29 12:40:05.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330317014536192[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:40:05.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330317014536192[0;39m ==> Parameters: 
2022-04-29 12:40:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330317014536192[0;39m <==    Updates: 1
2022-04-29 12:40:05.093 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330317014536192[0;39m update ends, take 37 millisecs
2022-04-29 12:40:05.848 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330320336424960[0;39m ------------- 开始 -------------
2022-04-29 12:40:05.849 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330320336424960[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-29 12:40:05.849 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330320336424960[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-29 12:40:05.849 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330320336424960[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:05.851 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330320336424960[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-29 12:40:05.887 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175330320336424960[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-29 12:40:05.892 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175330320336424960[0;39m ==> Parameters: test1(String)
2022-04-29 12:40:05.915 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175330320336424960[0;39m <==    Columns: id, login_name, name, password
2022-04-29 12:40:05.916 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175330320336424960[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 12:40:05.916 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175330320336424960[0;39m <==      Total: 1
2022-04-29 12:40:05.920 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175330320336424960[0;39m generate single sign-on token：175330320638414848，and put it into redis
2022-04-29 12:40:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330337751175168[0;39m 生成今日电子书快照开始
2022-04-29 12:40:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330337751175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330337751175168[0;39m ==> Parameters: 
2022-04-29 12:40:10.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330337751175168[0;39m <==    Updates: 0
2022-04-29 12:40:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330337751175168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:40:12.109 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330320336424960[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"},"success":true}
2022-04-29 12:40:12.109 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330320336424960[0;39m ------------- 结束 耗时：6261 ms -------------
2022-04-29 12:40:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330358726889472[0;39m 生成今日电子书快照开始
2022-04-29 12:40:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330358726889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330358726889472[0;39m ==> Parameters: 
2022-04-29 12:40:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330358726889472[0;39m <==    Updates: 0
2022-04-29 12:40:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330358726889472[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 12:40:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330379702603776[0;39m 生成今日电子书快照开始
2022-04-29 12:40:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330379702603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330379702603776[0;39m ==> Parameters: 
2022-04-29 12:40:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330379702603776[0;39m <==    Updates: 0
2022-04-29 12:40:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330379702603776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:40:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330400682512384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330400682512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330400682512384[0;39m ==> Parameters: 
2022-04-29 12:40:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330400682512384[0;39m <==    Updates: 0
2022-04-29 12:40:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330400682512384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:40:26.646 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330407569559552[0;39m ------------- 开始 -------------
2022-04-29 12:40:26.646 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330407569559552[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:40:26.646 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330407569559552[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:40:26.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330407569559552[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:26.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330407569559552[0;39m 请求参数: []
2022-04-29 12:40:26.676 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330407569559552[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:40:26.677 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330407569559552[0;39m ==> Parameters: 
2022-04-29 12:40:26.701 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:40:26.701 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:40:26.702 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:40:26.702 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:40:26.703 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:40:26.703 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:40:26.703 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:40:26.704 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:40:26.704 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:40:26.704 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:40:26.705 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:40:26.705 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:40:26.705 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:40:26.706 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:40:26.706 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:40:26.706 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:40:26.707 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:40:26.707 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:40:26.708 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:40:26.708 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330407569559552[0;39m <==      Total: 18
2022-04-29 12:40:26.710 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330407569559552[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:40:26.711 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330407569559552[0;39m ------------- 结束 耗时：65 ms -------------
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330408030932992[0;39m ------------- 开始 -------------
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330408030932992[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330408030932992[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330408030932992[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:26.758 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330408030932992[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 12:40:26.805 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175330408030932992[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 12:40:26.805 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175330408030932992[0;39m ==> Parameters: 
2022-04-29 12:40:26.828 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175330408030932992[0;39m <==    Columns: count(0)
2022-04-29 12:40:26.829 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175330408030932992[0;39m <==        Row: 5
2022-04-29 12:40:26.830 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175330408030932992[0;39m <==      Total: 1
2022-04-29 12:40:26.832 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175330408030932992[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 12:40:26.833 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175330408030932992[0;39m ==> Parameters: 10(Integer)
2022-04-29 12:40:26.856 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 12:40:26.856 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 12:40:26.857 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 12:40:26.857 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 12:40:26.857 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 12:40:26.858 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 12:40:26.858 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175330408030932992[0;39m <==      Total: 5
2022-04-29 12:40:26.860 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175330408030932992[0;39m total rows：5
2022-04-29 12:40:26.860 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175330408030932992[0;39m total pages：1
2022-04-29 12:40:26.868 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330408030932992[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 12:40:26.869 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330408030932992[0;39m ------------- 结束 耗时：113 ms -------------
2022-04-29 12:40:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330421637255168[0;39m 生成今日电子书快照开始
2022-04-29 12:40:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330421637255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330421637255168[0;39m ==> Parameters: 
2022-04-29 12:40:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330421637255168[0;39m <==    Updates: 0
2022-04-29 12:40:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330421637255168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:40:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330442621358080[0;39m 生成今日电子书快照开始
2022-04-29 12:40:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330442621358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330442621358080[0;39m ==> Parameters: 
2022-04-29 12:40:35.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330442621358080[0;39m <==    Updates: 0
2022-04-29 12:40:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330442621358080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:40:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330442902376448[0;39m start updating Ebook doc
2022-04-29 12:40:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330442902376448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:40:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330442902376448[0;39m ==> Parameters: 
2022-04-29 12:40:35.114 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330442902376448[0;39m <==    Updates: 1
2022-04-29 12:40:35.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330442902376448[0;39m update ends, take 45 millisecs
2022-04-29 12:40:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330463597072384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330463597072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330463597072384[0;39m ==> Parameters: 
2022-04-29 12:40:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330463597072384[0;39m <==    Updates: 0
2022-04-29 12:40:40.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330463597072384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:40:42.330 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:40:42.331 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-29 12:40:42.334 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175330306398752770[0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:40:42.334 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175330306398752770[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 12:40:42.334 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175330306398752770[0;39m 登录校验开始，token：175330320638414848
2022-04-29 12:40:42.737 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175330306398752770[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"}
2022-04-29 12:40:42.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330475102048256[0;39m ------------- 开始 -------------
2022-04-29 12:40:42.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330475102048256[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 12:40:42.748 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330475102048256[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 12:40:42.748 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330475102048256[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:42.750 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330475102048256[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"Spring"}]
2022-04-29 12:40:42.769 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175330475102048256[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 12:40:42.770 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175330475102048256[0;39m ==> Parameters: 175330475123019776(Long), Spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 12:40:42.886 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175330475102048256[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:33)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 12:40:42.889 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175330475102048256[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 12:40:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330484568592384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330484568592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330484568592384[0;39m ==> Parameters: 
2022-04-29 12:40:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330484568592384[0;39m <==    Updates: 0
2022-04-29 12:40:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330484568592384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:40:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330505540112384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330505540112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330505540112384[0;39m ==> Parameters: 
2022-04-29 12:40:50.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330505540112384[0;39m <==    Updates: 0
2022-04-29 12:40:50.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330505540112384[0;39m 生成今日电子书快照结束，耗时：80毫秒
2022-04-29 12:40:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330526507438080[0;39m 生成今日电子书快照开始
2022-04-29 12:40:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330526507438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330526507438080[0;39m ==> Parameters: 
2022-04-29 12:40:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330526507438080[0;39m <==    Updates: 0
2022-04-29 12:40:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330526507438080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:41:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330547474763776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330547474763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330547474763776[0;39m ==> Parameters: 
2022-04-29 12:41:00.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330547474763776[0;39m <==    Updates: 0
2022-04-29 12:41:00.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330547474763776[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:41:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330568458866688[0;39m 生成今日电子书快照开始
2022-04-29 12:41:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330568458866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330568458866688[0;39m ==> Parameters: 
2022-04-29 12:41:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330568458866688[0;39m <==    Updates: 0
2022-04-29 12:41:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330568458866688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:41:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330568718913536[0;39m start updating Ebook doc
2022-04-29 12:41:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330568718913536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:41:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330568718913536[0;39m ==> Parameters: 
2022-04-29 12:41:05.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330568718913536[0;39m <==    Updates: 1
2022-04-29 12:41:05.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330568718913536[0;39m update ends, take 40 millisecs
2022-04-29 12:41:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330589413609472[0;39m 生成今日电子书快照开始
2022-04-29 12:41:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330589413609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330589413609472[0;39m ==> Parameters: 
2022-04-29 12:41:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330589413609472[0;39m <==    Updates: 0
2022-04-29 12:41:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330589413609472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:41:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330610389323776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330610389323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330610389323776[0;39m ==> Parameters: 
2022-04-29 12:41:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330610389323776[0;39m <==    Updates: 0
2022-04-29 12:41:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330610389323776[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:41:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330631352455168[0;39m 生成今日电子书快照开始
2022-04-29 12:41:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330631352455168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330631352455168[0;39m ==> Parameters: 
2022-04-29 12:41:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330631352455168[0;39m <==    Updates: 0
2022-04-29 12:41:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330631352455168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:41:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330652340752384[0;39m 生成今日电子书快照开始
2022-04-29 12:41:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330652340752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330652340752384[0;39m ==> Parameters: 
2022-04-29 12:41:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330652340752384[0;39m <==    Updates: 0
2022-04-29 12:41:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330652340752384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:41:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330673316466688[0;39m 生成今日电子书快照开始
2022-04-29 12:41:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330673316466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330673316466688[0;39m ==> Parameters: 
2022-04-29 12:41:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330673316466688[0;39m <==    Updates: 0
2022-04-29 12:41:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330673316466688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:41:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330694287986688[0;39m 生成今日电子书快照开始
2022-04-29 12:41:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330694287986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:35.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330694287986688[0;39m ==> Parameters: 
2022-04-29 12:41:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330694287986688[0;39m <==    Updates: 0
2022-04-29 12:41:35.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330694287986688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:41:35.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330694569005056[0;39m start updating Ebook doc
2022-04-29 12:41:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330694569005056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:41:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330694569005056[0;39m ==> Parameters: 
2022-04-29 12:41:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330694569005056[0;39m <==    Updates: 1
2022-04-29 12:41:35.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330694569005056[0;39m update ends, take 37 millisecs
2022-04-29 12:41:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330715246923776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330715246923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330715246923776[0;39m ==> Parameters: 
2022-04-29 12:41:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330715246923776[0;39m <==    Updates: 0
2022-04-29 12:41:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330715246923776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:41:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330736222638080[0;39m 生成今日电子书快照开始
2022-04-29 12:41:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330736222638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330736222638080[0;39m ==> Parameters: 
2022-04-29 12:41:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330736222638080[0;39m <==    Updates: 0
2022-04-29 12:41:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330736222638080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:41:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330757189963776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330757189963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330757189963776[0;39m ==> Parameters: 
2022-04-29 12:41:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330757189963776[0;39m <==    Updates: 0
2022-04-29 12:41:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330757189963776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:41:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330778161483776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330778161483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330778161483776[0;39m ==> Parameters: 
2022-04-29 12:41:55.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330778161483776[0;39m <==    Updates: 0
2022-04-29 12:41:55.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330778161483776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:42:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330799128809472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330799128809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330799128809472[0;39m ==> Parameters: 
2022-04-29 12:42:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330799128809472[0;39m <==    Updates: 0
2022-04-29 12:42:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330799128809472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:42:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330820112912384[0;39m 生成今日电子书快照开始
2022-04-29 12:42:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330820112912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330820112912384[0;39m ==> Parameters: 
2022-04-29 12:42:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330820112912384[0;39m <==    Updates: 0
2022-04-29 12:42:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330820112912384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:42:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330820385542144[0;39m start updating Ebook doc
2022-04-29 12:42:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330820385542144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:42:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330820385542144[0;39m ==> Parameters: 
2022-04-29 12:42:05.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330820385542144[0;39m <==    Updates: 1
2022-04-29 12:42:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330820385542144[0;39m update ends, take 37 millisecs
2022-04-29 12:42:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330841071849472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330841071849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330841071849472[0;39m ==> Parameters: 
2022-04-29 12:42:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330841071849472[0;39m <==    Updates: 0
2022-04-29 12:42:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330841071849472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:42:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330862060146688[0;39m 生成今日电子书快照开始
2022-04-29 12:42:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330862060146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330862060146688[0;39m ==> Parameters: 
2022-04-29 12:42:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330862060146688[0;39m <==    Updates: 0
2022-04-29 12:42:15.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330862060146688[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 12:42:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330883023278080[0;39m 生成今日电子书快照开始
2022-04-29 12:42:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330883023278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330883023278080[0;39m ==> Parameters: 
2022-04-29 12:42:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330883023278080[0;39m <==    Updates: 0
2022-04-29 12:42:20.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330883023278080[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 12:42:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330904003186688[0;39m 生成今日电子书快照开始
2022-04-29 12:42:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330904003186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330904003186688[0;39m ==> Parameters: 
2022-04-29 12:42:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330904003186688[0;39m <==    Updates: 0
2022-04-29 12:42:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330904003186688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:42:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330924970512384[0;39m 生成今日电子书快照开始
2022-04-29 12:42:30.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330924970512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:30.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330924970512384[0;39m ==> Parameters: 
2022-04-29 12:42:30.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330924970512384[0;39m <==    Updates: 0
2022-04-29 12:42:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330924970512384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:42:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330945925255168[0;39m 生成今日电子书快照开始
2022-04-29 12:42:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330945925255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330945925255168[0;39m ==> Parameters: 
2022-04-29 12:42:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330945925255168[0;39m <==    Updates: 0
2022-04-29 12:42:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330945925255168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:42:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330946210467840[0;39m start updating Ebook doc
2022-04-29 12:42:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330946210467840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:42:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330946210467840[0;39m ==> Parameters: 
2022-04-29 12:42:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330946210467840[0;39m <==    Updates: 1
2022-04-29 12:42:35.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330946210467840[0;39m update ends, take 37 millisecs
2022-04-29 12:42:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330966900969472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330966900969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330966900969472[0;39m ==> Parameters: 
2022-04-29 12:42:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330966900969472[0;39m <==    Updates: 0
2022-04-29 12:42:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330966900969472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:42:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330987872489472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330987872489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330987872489472[0;39m ==> Parameters: 
2022-04-29 12:42:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330987872489472[0;39m <==    Updates: 0
2022-04-29 12:42:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330987872489472[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:42:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331008844009472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331008844009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331008844009472[0;39m ==> Parameters: 
2022-04-29 12:42:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331008844009472[0;39m <==    Updates: 0
2022-04-29 12:42:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331008844009472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:42:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331029811335168[0;39m 生成今日电子书快照开始
2022-04-29 12:42:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331029811335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331029811335168[0;39m ==> Parameters: 
2022-04-29 12:42:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331029811335168[0;39m <==    Updates: 0
2022-04-29 12:42:55.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331029811335168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:43:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331050787049472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331050787049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331050787049472[0;39m ==> Parameters: 
2022-04-29 12:43:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331050787049472[0;39m <==    Updates: 0
2022-04-29 12:43:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331050787049472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:43:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331071771152384[0;39m 生成今日电子书快照开始
2022-04-29 12:43:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331071771152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331071771152384[0;39m ==> Parameters: 
2022-04-29 12:43:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331071771152384[0;39m <==    Updates: 0
2022-04-29 12:43:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331071771152384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:43:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331072043782144[0;39m start updating Ebook doc
2022-04-29 12:43:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331072043782144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:43:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331072043782144[0;39m ==> Parameters: 
2022-04-29 12:43:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331072043782144[0;39m <==    Updates: 1
2022-04-29 12:43:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331072043782144[0;39m update ends, take 36 millisecs
2022-04-29 12:43:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331092734283776[0;39m 生成今日电子书快照开始
2022-04-29 12:43:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331092734283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331092734283776[0;39m ==> Parameters: 
2022-04-29 12:43:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331092734283776[0;39m <==    Updates: 0
2022-04-29 12:43:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331092734283776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:43:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331113705803776[0;39m 生成今日电子书快照开始
2022-04-29 12:43:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331113705803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331113705803776[0;39m ==> Parameters: 
2022-04-29 12:43:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331113705803776[0;39m <==    Updates: 0
2022-04-29 12:43:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331113705803776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:43:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331134689906688[0;39m 生成今日电子书快照开始
2022-04-29 12:43:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331134689906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331134689906688[0;39m ==> Parameters: 
2022-04-29 12:43:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331134689906688[0;39m <==    Updates: 0
2022-04-29 12:43:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331134689906688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:43:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331155644649472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331155644649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331155644649472[0;39m ==> Parameters: 
2022-04-29 12:43:25.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331155644649472[0;39m <==    Updates: 0
2022-04-29 12:43:25.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331155644649472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:43:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331176632946688[0;39m 生成今日电子书快照开始
2022-04-29 12:43:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331176632946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331176632946688[0;39m ==> Parameters: 
2022-04-29 12:43:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331176632946688[0;39m <==    Updates: 0
2022-04-29 12:43:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331176632946688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 12:43:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331197583495168[0;39m 生成今日电子书快照开始
2022-04-29 12:43:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331197583495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331197583495168[0;39m ==> Parameters: 
2022-04-29 12:43:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331197583495168[0;39m <==    Updates: 0
2022-04-29 12:43:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331197583495168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:43:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331197847736320[0;39m start updating Ebook doc
2022-04-29 12:43:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331197847736320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:43:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331197847736320[0;39m ==> Parameters: 
2022-04-29 12:43:35.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331197847736320[0;39m <==    Updates: 1
2022-04-29 12:43:35.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331197847736320[0;39m update ends, take 36 millisecs
2022-04-29 12:43:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331218559209472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331218559209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331218559209472[0;39m ==> Parameters: 
2022-04-29 12:43:40.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331218559209472[0;39m <==    Updates: 0
2022-04-29 12:43:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331218559209472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:43:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331239530729472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331239530729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331239530729472[0;39m ==> Parameters: 
2022-04-29 12:43:45.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331239530729472[0;39m <==    Updates: 0
2022-04-29 12:43:45.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331239530729472[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 12:43:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331260510638080[0;39m 生成今日电子书快照开始
2022-04-29 12:43:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331260510638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331260510638080[0;39m ==> Parameters: 
2022-04-29 12:43:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331260510638080[0;39m <==    Updates: 0
2022-04-29 12:43:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331260510638080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:43:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331281486352384[0;39m 生成今日电子书快照开始
2022-04-29 12:43:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331281486352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331281486352384[0;39m ==> Parameters: 
2022-04-29 12:43:55.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331281486352384[0;39m <==    Updates: 0
2022-04-29 12:43:55.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331281486352384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:44:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331302445289472[0;39m 生成今日电子书快照开始
2022-04-29 12:44:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331302445289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331302445289472[0;39m ==> Parameters: 
2022-04-29 12:44:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331302445289472[0;39m <==    Updates: 0
2022-04-29 12:44:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331302445289472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:44:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331323429392384[0;39m 生成今日电子书快照开始
2022-04-29 12:44:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331323429392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331323429392384[0;39m ==> Parameters: 
2022-04-29 12:44:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331323429392384[0;39m <==    Updates: 0
2022-04-29 12:44:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331323429392384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:44:05.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331323706216448[0;39m start updating Ebook doc
2022-04-29 12:44:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331323706216448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:44:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331323706216448[0;39m ==> Parameters: 
2022-04-29 12:44:05.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331323706216448[0;39m <==    Updates: 1
2022-04-29 12:44:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331323706216448[0;39m update ends, take 35 millisecs
2022-04-29 12:44:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331344388329472[0;39m 生成今日电子书快照开始
2022-04-29 12:44:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331344388329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331344388329472[0;39m ==> Parameters: 
2022-04-29 12:44:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331344388329472[0;39m <==    Updates: 0
2022-04-29 12:44:10.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331344388329472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:44:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331365372432384[0;39m 生成今日电子书快照开始
2022-04-29 12:44:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331365372432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331365372432384[0;39m ==> Parameters: 
2022-04-29 12:44:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331365372432384[0;39m <==    Updates: 0
2022-04-29 12:44:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331365372432384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:44:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331386327175168[0;39m 生成今日电子书快照开始
2022-04-29 12:44:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331386327175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331386327175168[0;39m ==> Parameters: 
2022-04-29 12:44:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331386327175168[0;39m <==    Updates: 0
2022-04-29 12:44:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331386327175168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:44:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331407311278080[0;39m 生成今日电子书快照开始
2022-04-29 12:44:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331407311278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331407311278080[0;39m ==> Parameters: 
2022-04-29 12:44:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331407311278080[0;39m <==    Updates: 0
2022-04-29 12:44:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331407311278080[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:44:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331428291186688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331428291186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331428291186688[0;39m ==> Parameters: 
2022-04-29 12:44:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331428291186688[0;39m <==    Updates: 0
2022-04-29 12:44:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331428291186688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:44:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331449262706688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331449262706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331449262706688[0;39m ==> Parameters: 
2022-04-29 12:44:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331449262706688[0;39m <==    Updates: 0
2022-04-29 12:44:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331449262706688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:44:35.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331449501782016[0;39m start updating Ebook doc
2022-04-29 12:44:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331449501782016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:44:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331449501782016[0;39m ==> Parameters: 
2022-04-29 12:44:35.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331449501782016[0;39m <==    Updates: 1
2022-04-29 12:44:35.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331449501782016[0;39m update ends, take 42 millisecs
2022-04-29 12:44:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331470234226688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331470234226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331470234226688[0;39m ==> Parameters: 
2022-04-29 12:44:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331470234226688[0;39m <==    Updates: 0
2022-04-29 12:44:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331470234226688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:44:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331491205746688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:45.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331491205746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331491205746688[0;39m ==> Parameters: 
2022-04-29 12:44:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331491205746688[0;39m <==    Updates: 0
2022-04-29 12:44:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331491205746688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:44:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331512160489472[0;39m 生成今日电子书快照开始
2022-04-29 12:44:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331512160489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331512160489472[0;39m ==> Parameters: 
2022-04-29 12:44:50.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331512160489472[0;39m <==    Updates: 0
2022-04-29 12:44:50.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331512160489472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:44:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331533152980992[0;39m 生成今日电子书快照开始
2022-04-29 12:44:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331533152980992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331533152980992[0;39m ==> Parameters: 
2022-04-29 12:44:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331533152980992[0;39m <==    Updates: 0
2022-04-29 12:44:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331533152980992[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:45:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331554111918080[0;39m 生成今日电子书快照开始
2022-04-29 12:45:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331554111918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331554111918080[0;39m ==> Parameters: 
2022-04-29 12:45:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331554111918080[0;39m <==    Updates: 0
2022-04-29 12:45:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331554111918080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:45:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331575091826688[0;39m 生成今日电子书快照开始
2022-04-29 12:45:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331575091826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331575091826688[0;39m ==> Parameters: 
2022-04-29 12:45:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331575091826688[0;39m <==    Updates: 0
2022-04-29 12:45:05.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331575091826688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:45:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331575339290624[0;39m start updating Ebook doc
2022-04-29 12:45:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331575339290624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:45:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331575339290624[0;39m ==> Parameters: 
2022-04-29 12:45:05.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331575339290624[0;39m <==    Updates: 1
2022-04-29 12:45:05.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331575339290624[0;39m update ends, take 36 millisecs
2022-04-29 12:45:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331596046569472[0;39m 生成今日电子书快照开始
2022-04-29 12:45:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331596046569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331596046569472[0;39m ==> Parameters: 
2022-04-29 12:45:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331596046569472[0;39m <==    Updates: 0
2022-04-29 12:45:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331596046569472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:45:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331617022283776[0;39m 生成今日电子书快照开始
2022-04-29 12:45:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331617022283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331617022283776[0;39m ==> Parameters: 
2022-04-29 12:45:15.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331617022283776[0;39m <==    Updates: 0
2022-04-29 12:45:15.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331617022283776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:45:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331637989609472[0;39m 生成今日电子书快照开始
2022-04-29 12:45:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331637989609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331637989609472[0;39m ==> Parameters: 
2022-04-29 12:45:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331637989609472[0;39m <==    Updates: 0
2022-04-29 12:45:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331637989609472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:45:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331658977906688[0;39m 生成今日电子书快照开始
2022-04-29 12:45:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331658977906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331658977906688[0;39m ==> Parameters: 
2022-04-29 12:45:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331658977906688[0;39m <==    Updates: 0
2022-04-29 12:45:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331658977906688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:45:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331679953620992[0;39m 生成今日电子书快照开始
2022-04-29 12:45:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331679953620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331679953620992[0;39m ==> Parameters: 
2022-04-29 12:45:30.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331679953620992[0;39m <==    Updates: 0
2022-04-29 12:45:30.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331679953620992[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:45:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331700908363776[0;39m 生成今日电子书快照开始
2022-04-29 12:45:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331700908363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331700908363776[0;39m ==> Parameters: 
2022-04-29 12:45:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331700908363776[0;39m <==    Updates: 0
2022-04-29 12:45:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331700908363776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:45:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331701180993536[0;39m start updating Ebook doc
2022-04-29 12:45:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331701180993536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:45:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331701180993536[0;39m ==> Parameters: 
2022-04-29 12:45:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331701180993536[0;39m <==    Updates: 1
2022-04-29 12:45:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331701180993536[0;39m update ends, take 41 millisecs
2022-04-29 12:45:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331721884078080[0;39m 生成今日电子书快照开始
2022-04-29 12:45:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331721884078080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331721884078080[0;39m ==> Parameters: 
2022-04-29 12:45:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331721884078080[0;39m <==    Updates: 0
2022-04-29 12:45:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331721884078080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:45:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331742859792384[0;39m 生成今日电子书快照开始
2022-04-29 12:45:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331742859792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331742859792384[0;39m ==> Parameters: 
2022-04-29 12:45:45.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331742859792384[0;39m <==    Updates: 0
2022-04-29 12:45:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331742859792384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:45:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331763827118080[0;39m 生成今日电子书快照开始
2022-04-29 12:45:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331763827118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331763827118080[0;39m ==> Parameters: 
2022-04-29 12:45:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331763827118080[0;39m <==    Updates: 0
2022-04-29 12:45:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331763827118080[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:45:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331784794443776[0;39m 生成今日电子书快照开始
2022-04-29 12:45:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331784794443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331784794443776[0;39m ==> Parameters: 
2022-04-29 12:45:55.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331784794443776[0;39m <==    Updates: 0
2022-04-29 12:45:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331784794443776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:46:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331805770158080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331805770158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331805770158080[0;39m ==> Parameters: 
2022-04-29 12:46:00.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331805770158080[0;39m <==    Updates: 0
2022-04-29 12:46:00.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331805770158080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 12:46:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331826741678080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331826741678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331826741678080[0;39m ==> Parameters: 
2022-04-29 12:46:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331826741678080[0;39m <==    Updates: 0
2022-04-29 12:46:05.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331826741678080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:46:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331827001724928[0;39m start updating Ebook doc
2022-04-29 12:46:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331827001724928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:46:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331827001724928[0;39m ==> Parameters: 
2022-04-29 12:46:05.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331827001724928[0;39m <==    Updates: 1
2022-04-29 12:46:05.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331827001724928[0;39m update ends, take 37 millisecs
2022-04-29 12:46:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331847709003776[0;39m 生成今日电子书快照开始
2022-04-29 12:46:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331847709003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331847709003776[0;39m ==> Parameters: 
2022-04-29 12:46:10.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331847709003776[0;39m <==    Updates: 0
2022-04-29 12:46:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331847709003776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:46:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331868693106688[0;39m 生成今日电子书快照开始
2022-04-29 12:46:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331868693106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331868693106688[0;39m ==> Parameters: 
2022-04-29 12:46:15.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331868693106688[0;39m <==    Updates: 0
2022-04-29 12:46:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331868693106688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:46:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331889656238080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331889656238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331889656238080[0;39m ==> Parameters: 
2022-04-29 12:46:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331889656238080[0;39m <==    Updates: 0
2022-04-29 12:46:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331889656238080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:46:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331910640340992[0;39m 生成今日电子书快照开始
2022-04-29 12:46:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331910640340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331910640340992[0;39m ==> Parameters: 
2022-04-29 12:46:25.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331910640340992[0;39m <==    Updates: 0
2022-04-29 12:46:25.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331910640340992[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 12:46:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331931599278080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331931599278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331931599278080[0;39m ==> Parameters: 
2022-04-29 12:46:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331931599278080[0;39m <==    Updates: 0
2022-04-29 12:46:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331931599278080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:46:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331952558215168[0;39m 生成今日电子书快照开始
2022-04-29 12:46:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331952558215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331952558215168[0;39m ==> Parameters: 
2022-04-29 12:46:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331952558215168[0;39m <==    Updates: 0
2022-04-29 12:46:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331952558215168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:46:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331952826650624[0;39m start updating Ebook doc
2022-04-29 12:46:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331952826650624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:46:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331952826650624[0;39m ==> Parameters: 
2022-04-29 12:46:35.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331952826650624[0;39m <==    Updates: 1
2022-04-29 12:46:35.103 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331952826650624[0;39m update ends, take 39 millisecs
2022-04-29 12:46:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331973550706688[0;39m 生成今日电子书快照开始
2022-04-29 12:46:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331973550706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331973550706688[0;39m ==> Parameters: 
2022-04-29 12:46:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331973550706688[0;39m <==    Updates: 0
2022-04-29 12:46:40.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331973550706688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:46:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331994518032384[0;39m 生成今日电子书快照开始
2022-04-29 12:46:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331994518032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331994518032384[0;39m ==> Parameters: 
2022-04-29 12:46:45.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331994518032384[0;39m <==    Updates: 0
2022-04-29 12:46:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331994518032384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:46:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332015476969472[0;39m 生成今日电子书快照开始
2022-04-29 12:46:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332015476969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332015476969472[0;39m ==> Parameters: 
2022-04-29 12:46:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332015476969472[0;39m <==    Updates: 0
2022-04-29 12:46:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332015476969472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:46:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332036469460992[0;39m 生成今日电子书快照开始
2022-04-29 12:46:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332036469460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332036469460992[0;39m ==> Parameters: 
2022-04-29 12:46:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332036469460992[0;39m <==    Updates: 0
2022-04-29 12:46:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332036469460992[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:47:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332057432592384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332057432592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332057432592384[0;39m ==> Parameters: 
2022-04-29 12:47:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332057432592384[0;39m <==    Updates: 0
2022-04-29 12:47:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332057432592384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:47:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332078408306688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332078408306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332078408306688[0;39m ==> Parameters: 
2022-04-29 12:47:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332078408306688[0;39m <==    Updates: 0
2022-04-29 12:47:05.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332078408306688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:47:05.073 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332078693519360[0;39m start updating Ebook doc
2022-04-29 12:47:05.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332078693519360[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:47:05.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332078693519360[0;39m ==> Parameters: 
2022-04-29 12:47:05.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332078693519360[0;39m <==    Updates: 1
2022-04-29 12:47:05.119 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332078693519360[0;39m update ends, take 46 millisecs
2022-04-29 12:47:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332099379826688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332099379826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332099379826688[0;39m ==> Parameters: 
2022-04-29 12:47:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332099379826688[0;39m <==    Updates: 0
2022-04-29 12:47:10.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332099379826688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:47:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332120338763776[0;39m 生成今日电子书快照开始
2022-04-29 12:47:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332120338763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332120338763776[0;39m ==> Parameters: 
2022-04-29 12:47:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332120338763776[0;39m <==    Updates: 0
2022-04-29 12:47:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332120338763776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:47:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332141322866688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332141322866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332141322866688[0;39m ==> Parameters: 
2022-04-29 12:47:20.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332141322866688[0;39m <==    Updates: 0
2022-04-29 12:47:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332141322866688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:47:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332162277609472[0;39m 生成今日电子书快照开始
2022-04-29 12:47:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332162277609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332162277609472[0;39m ==> Parameters: 
2022-04-29 12:47:25.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332162277609472[0;39m <==    Updates: 0
2022-04-29 12:47:25.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332162277609472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:47:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332183261712384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332183261712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332183261712384[0;39m ==> Parameters: 
2022-04-29 12:47:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332183261712384[0;39m <==    Updates: 0
2022-04-29 12:47:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332183261712384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:47:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332204229038080[0;39m 生成今日电子书快照开始
2022-04-29 12:47:35.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332204229038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:35.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332204229038080[0;39m ==> Parameters: 
2022-04-29 12:47:35.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332204229038080[0;39m <==    Updates: 0
2022-04-29 12:47:35.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332204229038080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:47:35.075 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332204531027968[0;39m start updating Ebook doc
2022-04-29 12:47:35.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332204531027968[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:47:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332204531027968[0;39m ==> Parameters: 
2022-04-29 12:47:35.112 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332204531027968[0;39m <==    Updates: 1
2022-04-29 12:47:35.113 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332204531027968[0;39m update ends, take 38 millisecs
2022-04-29 12:47:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332225204752384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332225204752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332225204752384[0;39m ==> Parameters: 
2022-04-29 12:47:40.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332225204752384[0;39m <==    Updates: 0
2022-04-29 12:47:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332225204752384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:47:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332246176272384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332246176272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332246176272384[0;39m ==> Parameters: 
2022-04-29 12:47:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332246176272384[0;39m <==    Updates: 0
2022-04-29 12:47:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332246176272384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:47:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332267151986688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332267151986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332267151986688[0;39m ==> Parameters: 
2022-04-29 12:47:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332267151986688[0;39m <==    Updates: 0
2022-04-29 12:47:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332267151986688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:47:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332288119312384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332288119312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332288119312384[0;39m ==> Parameters: 
2022-04-29 12:47:55.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332288119312384[0;39m <==    Updates: 0
2022-04-29 12:47:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332288119312384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:48:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332309074055168[0;39m 生成今日电子书快照开始
2022-04-29 12:48:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332309074055168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332309074055168[0;39m ==> Parameters: 
2022-04-29 12:48:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332309074055168[0;39m <==    Updates: 0
2022-04-29 12:48:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332309074055168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:48:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332330066546688[0;39m 生成今日电子书快照开始
2022-04-29 12:48:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332330066546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332330066546688[0;39m ==> Parameters: 
2022-04-29 12:48:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332330066546688[0;39m <==    Updates: 0
2022-04-29 12:48:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332330066546688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:48:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332330326593536[0;39m start updating Ebook doc
2022-04-29 12:48:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332330326593536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:48:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332330326593536[0;39m ==> Parameters: 
2022-04-29 12:48:05.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332330326593536[0;39m <==    Updates: 1
2022-04-29 12:48:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332330326593536[0;39m update ends, take 38 millisecs
2022-04-29 12:48:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332351033872384[0;39m 生成今日电子书快照开始
2022-04-29 12:48:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332351033872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332351033872384[0;39m ==> Parameters: 
2022-04-29 12:48:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332351033872384[0;39m <==    Updates: 0
2022-04-29 12:48:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332351033872384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:48:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332372005392384[0;39m 生成今日电子书快照开始
2022-04-29 12:48:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332372005392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332372005392384[0;39m ==> Parameters: 
2022-04-29 12:48:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332372005392384[0;39m <==    Updates: 0
2022-04-29 12:48:15.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332372005392384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:48:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332392976912384[0;39m 生成今日电子书快照开始
2022-04-29 12:48:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332392976912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332392976912384[0;39m ==> Parameters: 
2022-04-29 12:48:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332392976912384[0;39m <==    Updates: 0
2022-04-29 12:48:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332392976912384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:48:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332413944238080[0;39m 生成今日电子书快照开始
2022-04-29 12:48:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332413944238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332413944238080[0;39m ==> Parameters: 
2022-04-29 12:48:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332413944238080[0;39m <==    Updates: 0
2022-04-29 12:48:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332413944238080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:48:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332434915758080[0;39m 生成今日电子书快照开始
2022-04-29 12:48:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332434915758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332434915758080[0;39m ==> Parameters: 
2022-04-29 12:48:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332434915758080[0;39m <==    Updates: 0
2022-04-29 12:48:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332434915758080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:48:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332455887278080[0;39m 生成今日电子书快照开始
2022-04-29 12:48:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332455887278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332455887278080[0;39m ==> Parameters: 
2022-04-29 12:48:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332455887278080[0;39m <==    Updates: 0
2022-04-29 12:48:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332455887278080[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:48:35.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332456122159104[0;39m start updating Ebook doc
2022-04-29 12:48:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332456122159104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:48:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332456122159104[0;39m ==> Parameters: 
2022-04-29 12:48:35.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332456122159104[0;39m <==    Updates: 1
2022-04-29 12:48:35.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332456122159104[0;39m update ends, take 39 millisecs
2022-04-29 12:48:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332476867186688[0;39m 生成今日电子书快照开始
2022-04-29 12:48:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332476867186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332476867186688[0;39m ==> Parameters: 
2022-04-29 12:48:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332476867186688[0;39m <==    Updates: 0
2022-04-29 12:48:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332476867186688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:48:43.525 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m175330320336424960[0;39m 连接关闭，token：lsDuEMZABU，session id：0！当前连接数：0
2022-04-29 12:48:44.351 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 12:48:44.355 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 12:48:44.377 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-29 12:48:44.392 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-29 12:48:59.888 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5003 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 12:49:04.893 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 20538 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 12:49:04.894 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 12:49:05.173 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 12:49:05.173 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 12:49:05.175 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2022-04-29 12:49:05.326 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 12:49:05.327 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 12:49:05.327 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 12:49:05.327 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 12:49:05.337 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 12:49:05.337 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 432 ms
2022-04-29 12:49:05.688 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 12:49:05.977 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 12:49:06.006 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 12:49:06.016 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 12:49:06.018 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 12:49:06.022 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 21.198 seconds (JVM running for 664.299)
2022-04-29 12:49:06.024 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-29 12:49:06.024 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 12:49:06.024 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 12:49:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332602675335168[0;39m 生成今日电子书快照开始
2022-04-29 12:49:10.001 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175332602675335168[0;39m HikariPool-2 - Starting...
2022-04-29 12:49:10.231 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175332602675335168[0;39m HikariPool-2 - Start completed.
2022-04-29 12:49:10.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332602675335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:10.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332602675335168[0;39m ==> Parameters: 
2022-04-29 12:49:10.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332602675335168[0;39m <==    Updates: 0
2022-04-29 12:49:10.269 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332602675335168[0;39m 生成今日电子书快照结束，耗时：267毫秒
2022-04-29 12:49:13.585 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 12:49:13.585 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 12:49:13.586 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-29 12:49:13.606 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332617799995392[0;39m ------------- 开始 -------------
2022-04-29 12:49:13.607 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332617799995392[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:49:13.607 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332617799995392[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:49:13.607 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332617799995392[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:13.626 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332617799995392[0;39m 请求参数: []
2022-04-29 12:49:13.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332617971961856[0;39m ------------- 开始 -------------
2022-04-29 12:49:13.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332617971961857[0;39m ------------- 开始 -------------
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332617971961856[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332617971961857[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332617971961856[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332617971961856[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332617971961857[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332617971961856[0;39m 请求参数: []
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332617971961857[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332617971961857[0;39m 请求参数: []
2022-04-29 12:49:13.670 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332617799995392[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:49:13.670 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332617799995392[0;39m ==> Parameters: 
2022-04-29 12:49:13.674 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175332617971961856[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:49:13.674 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175332617971961856[0;39m ==> Parameters: 
2022-04-29 12:49:13.677 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175332617971961857[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:49:13.677 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175332617971961857[0;39m ==> Parameters: 
2022-04-29 12:49:13.688 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:49:13.688 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:49:13.688 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:49:13.691 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:49:13.691 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:49:13.691 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175332617971961856[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 12:49:13.692 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:49:13.692 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:49:13.693 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:49:13.693 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:49:13.694 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175332617971961856[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 12:49:13.695 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:49:13.695 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175332617971961856[0;39m <==        Row: 2022-04-29, 1763, 63, 28, 2
2022-04-29 12:49:13.696 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:49:13.696 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175332617971961856[0;39m <==      Total: 2
2022-04-29 12:49:13.696 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332617799995392[0;39m <==      Total: 18
2022-04-29 12:49:13.699 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 12:49:13.700 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 12:49:13.700 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 12:49:13.701 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 12:49:13.702 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 12:49:13.702 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 12:49:13.702 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 12:49:13.703 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 12:49:13.703 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 12:49:13.704 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 12:49:13.704 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 12:49:13.704 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 12:49:13.705 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 12:49:13.705 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332617971961856[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1763,"viewIncrease":28,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 12:49:13.705 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332617971961856[0;39m ------------- 结束 耗时：58 ms -------------
2022-04-29 12:49:13.705 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 12:49:13.705 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175332617971961857[0;39m <==      Total: 13
2022-04-29 12:49:13.707 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332617971961857[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 12:49:13.707 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332617971961857[0;39m ------------- 结束 耗时：60 ms -------------
2022-04-29 12:49:13.711 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332617799995392[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:49:13.712 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332617799995392[0;39m ------------- 结束 耗时：106 ms -------------
2022-04-29 12:49:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332623663632384[0;39m 生成今日电子书快照开始
2022-04-29 12:49:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332623663632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332623663632384[0;39m ==> Parameters: 
2022-04-29 12:49:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332623663632384[0;39m <==    Updates: 0
2022-04-29 12:49:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332623663632384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:49:15.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332626939383808[0;39m ------------- 开始 -------------
2022-04-29 12:49:15.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332626939383808[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:49:15.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332626939383808[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:49:15.786 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332626939383808[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:15.786 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332626939383808[0;39m 请求参数: []
2022-04-29 12:49:15.802 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332626939383808[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:49:15.803 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332626939383808[0;39m ==> Parameters: 
2022-04-29 12:49:15.820 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:49:15.821 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:49:15.821 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:49:15.822 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:49:15.823 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:49:15.823 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:49:15.823 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:49:15.824 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:49:15.824 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:49:15.824 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:49:15.825 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:49:15.825 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:49:15.825 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:49:15.827 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:49:15.827 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:49:15.827 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332626939383808[0;39m <==      Total: 18
2022-04-29 12:49:15.828 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332626939383808[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:49:15.829 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332626939383808[0;39m ------------- 结束 耗时：44 ms -------------
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332627249762304[0;39m ------------- 开始 -------------
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332627249762304[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332627249762304[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332627249762304[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:15.860 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332627249762304[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 12:49:15.872 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175332627249762304[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 12:49:15.873 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175332627249762304[0;39m ==> Parameters: 
2022-04-29 12:49:15.889 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175332627249762304[0;39m <==    Columns: count(0)
2022-04-29 12:49:15.890 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175332627249762304[0;39m <==        Row: 5
2022-04-29 12:49:15.891 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175332627249762304[0;39m <==      Total: 1
2022-04-29 12:49:15.891 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175332627249762304[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 12:49:15.892 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175332627249762304[0;39m ==> Parameters: 10(Integer)
2022-04-29 12:49:15.908 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 12:49:15.908 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 12:49:15.909 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 12:49:15.910 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 12:49:15.910 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 12:49:15.911 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 12:49:15.912 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175332627249762304[0;39m <==      Total: 5
2022-04-29 12:49:15.914 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175332627249762304[0;39m total rows：5
2022-04-29 12:49:15.914 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175332627249762304[0;39m total pages：1
2022-04-29 12:49:15.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332627249762304[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 12:49:15.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332627249762304[0;39m ------------- 结束 耗时：62 ms -------------
2022-04-29 12:49:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332644639346688[0;39m 生成今日电子书快照开始
2022-04-29 12:49:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332644639346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:20.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332644639346688[0;39m ==> Parameters: 
2022-04-29 12:49:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332644639346688[0;39m <==    Updates: 0
2022-04-29 12:49:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332644639346688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:49:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332665602478080[0;39m 生成今日电子书快照开始
2022-04-29 12:49:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332665602478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332665602478080[0;39m ==> Parameters: 
2022-04-29 12:49:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332665602478080[0;39m <==    Updates: 0
2022-04-29 12:49:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332665602478080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:49:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332686573998080[0;39m 生成今日电子书快照开始
2022-04-29 12:49:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332686573998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332686573998080[0;39m ==> Parameters: 
2022-04-29 12:49:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332686573998080[0;39m <==    Updates: 0
2022-04-29 12:49:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332686573998080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:49:31.029 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:49:31.030 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 12:49:31.030 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175330320638414848
2022-04-29 12:49:31.798 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"}
2022-04-29 12:49:31.809 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332694148911104[0;39m ------------- 开始 -------------
2022-04-29 12:49:31.810 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332694148911104[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 12:49:31.810 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332694148911104[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 12:49:31.810 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332694148911104[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:31.811 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332694148911104[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"Spring"}]
2022-04-29 12:49:31.830 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175332694148911104[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 12:49:31.831 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175332694148911104[0;39m ==> Parameters: 175332694169882624(Long), Spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 12:49:31.870 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175332694148911104[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy150.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 12:49:31.874 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175332694148911104[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 12:49:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332707553906688[0;39m 生成今日电子书快照开始
2022-04-29 12:49:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332707553906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332707553906688[0;39m ==> Parameters: 
2022-04-29 12:49:35.091 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332707553906688[0;39m <==    Updates: 0
2022-04-29 12:49:35.092 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332707553906688[0;39m 生成今日电子书快照结束，耗时：86毫秒
2022-04-29 12:49:35.092 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332707918811136[0;39m start updating Ebook doc
2022-04-29 12:49:35.095 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332707918811136[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:49:35.096 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332707918811136[0;39m ==> Parameters: 
2022-04-29 12:49:35.125 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332707918811136[0;39m <==    Updates: 1
2022-04-29 12:49:35.126 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332707918811136[0;39m update ends, take 34 millisecs
2022-04-29 12:49:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332728517038080[0;39m 生成今日电子书快照开始
2022-04-29 12:49:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332728517038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332728517038080[0;39m ==> Parameters: 
2022-04-29 12:49:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332728517038080[0;39m <==    Updates: 0
2022-04-29 12:49:40.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332728517038080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:49:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332749492752384[0;39m 生成今日电子书快照开始
2022-04-29 12:49:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332749492752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332749492752384[0;39m ==> Parameters: 
2022-04-29 12:49:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332749492752384[0;39m <==    Updates: 0
2022-04-29 12:49:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332749492752384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:49:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332770451689472[0;39m 生成今日电子书快照开始
2022-04-29 12:49:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332770451689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332770451689472[0;39m ==> Parameters: 
2022-04-29 12:49:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332770451689472[0;39m <==    Updates: 0
2022-04-29 12:49:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332770451689472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:49:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332791427403776[0;39m 生成今日电子书快照开始
2022-04-29 12:49:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332791427403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332791427403776[0;39m ==> Parameters: 
2022-04-29 12:49:55.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332791427403776[0;39m <==    Updates: 0
2022-04-29 12:49:55.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332791427403776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:50:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332812407312384[0;39m 生成今日电子书快照开始
2022-04-29 12:50:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332812407312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332812407312384[0;39m ==> Parameters: 
2022-04-29 12:50:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332812407312384[0;39m <==    Updates: 0
2022-04-29 12:50:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332812407312384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:50:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332833383026688[0;39m start updating Ebook doc
2022-04-29 12:50:05.038 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332833383026688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:50:05.039 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332833383026688[0;39m ==> Parameters: 
2022-04-29 12:50:05.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332833383026688[0;39m <==    Updates: 1
2022-04-29 12:50:05.077 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332833383026688[0;39m update ends, take 71 millisecs
2022-04-29 12:50:05.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332833685016576[0;39m 生成今日电子书快照开始
2022-04-29 12:50:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332833685016576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332833685016576[0;39m ==> Parameters: 
2022-04-29 12:50:05.117 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332833685016576[0;39m <==    Updates: 0
2022-04-29 12:50:05.119 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332833685016576[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-29 12:50:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332854333575168[0;39m 生成今日电子书快照开始
2022-04-29 12:50:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332854333575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332854333575168[0;39m ==> Parameters: 
2022-04-29 12:50:10.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332854333575168[0;39m <==    Updates: 0
2022-04-29 12:50:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332854333575168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:50:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332875317678080[0;39m 生成今日电子书快照开始
2022-04-29 12:50:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332875317678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332875317678080[0;39m ==> Parameters: 
2022-04-29 12:50:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332875317678080[0;39m <==    Updates: 0
2022-04-29 12:50:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332875317678080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:50:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332896297586688[0;39m 生成今日电子书快照开始
2022-04-29 12:50:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332896297586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332896297586688[0;39m ==> Parameters: 
2022-04-29 12:50:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332896297586688[0;39m <==    Updates: 0
2022-04-29 12:50:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332896297586688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:50:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332917273300992[0;39m 生成今日电子书快照开始
2022-04-29 12:50:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332917273300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332917273300992[0;39m ==> Parameters: 
2022-04-29 12:50:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332917273300992[0;39m <==    Updates: 0
2022-04-29 12:50:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332917273300992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:50:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332938240626688[0;39m 生成今日电子书快照开始
2022-04-29 12:50:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332938240626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332938240626688[0;39m ==> Parameters: 
2022-04-29 12:50:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332938240626688[0;39m <==    Updates: 0
2022-04-29 12:50:30.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332938240626688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:50:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332959207952384[0;39m 生成今日电子书快照开始
2022-04-29 12:50:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332959207952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332959207952384[0;39m ==> Parameters: 
2022-04-29 12:50:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332959207952384[0;39m <==    Updates: 0
2022-04-29 12:50:35.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332959207952384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:50:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332959476387840[0;39m start updating Ebook doc
2022-04-29 12:50:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332959476387840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:50:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332959476387840[0;39m ==> Parameters: 
2022-04-29 12:50:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332959476387840[0;39m <==    Updates: 1
2022-04-29 12:50:35.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332959476387840[0;39m update ends, take 38 millisecs
2022-04-29 12:50:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332980171083776[0;39m 生成今日电子书快照开始
2022-04-29 12:50:40.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332980171083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:40.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332980171083776[0;39m ==> Parameters: 
2022-04-29 12:50:40.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332980171083776[0;39m <==    Updates: 0
2022-04-29 12:50:40.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332980171083776[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 12:50:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333001159380992[0;39m 生成今日电子书快照开始
2022-04-29 12:50:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333001159380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333001159380992[0;39m ==> Parameters: 
2022-04-29 12:50:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333001159380992[0;39m <==    Updates: 0
2022-04-29 12:50:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333001159380992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:50:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333022114123776[0;39m 生成今日电子书快照开始
2022-04-29 12:50:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333022114123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333022114123776[0;39m ==> Parameters: 
2022-04-29 12:50:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333022114123776[0;39m <==    Updates: 0
2022-04-29 12:50:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333022114123776[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:50:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333043098226688[0;39m 生成今日电子书快照开始
2022-04-29 12:50:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333043098226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333043098226688[0;39m ==> Parameters: 
2022-04-29 12:50:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333043098226688[0;39m <==    Updates: 0
2022-04-29 12:50:55.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333043098226688[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 12:51:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333064052969472[0;39m 生成今日电子书快照开始
2022-04-29 12:51:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333064052969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333064052969472[0;39m ==> Parameters: 
2022-04-29 12:51:00.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333064052969472[0;39m <==    Updates: 0
2022-04-29 12:51:00.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333064052969472[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:51:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333085028683776[0;39m 生成今日电子书快照开始
2022-04-29 12:51:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333085028683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333085028683776[0;39m ==> Parameters: 
2022-04-29 12:51:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333085028683776[0;39m <==    Updates: 0
2022-04-29 12:51:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333085028683776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:51:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333085271953408[0;39m start updating Ebook doc
2022-04-29 12:51:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333085271953408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:51:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333085271953408[0;39m ==> Parameters: 
2022-04-29 12:51:05.099 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333085271953408[0;39m <==    Updates: 1
2022-04-29 12:51:05.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333085271953408[0;39m update ends, take 39 millisecs
2022-04-29 12:51:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333105991815168[0;39m 生成今日电子书快照开始
2022-04-29 12:51:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333105991815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333105991815168[0;39m ==> Parameters: 
2022-04-29 12:51:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333105991815168[0;39m <==    Updates: 0
2022-04-29 12:51:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333105991815168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:51:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333126963335168[0;39m 生成今日电子书快照开始
2022-04-29 12:51:15.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333126963335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:15.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333126963335168[0;39m ==> Parameters: 
2022-04-29 12:51:15.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333126963335168[0;39m <==    Updates: 0
2022-04-29 12:51:15.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333126963335168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:51:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333147943243776[0;39m 生成今日电子书快照开始
2022-04-29 12:51:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333147943243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333147943243776[0;39m ==> Parameters: 
2022-04-29 12:51:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333147943243776[0;39m <==    Updates: 0
2022-04-29 12:51:20.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333147943243776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:51:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333168906375168[0;39m 生成今日电子书快照开始
2022-04-29 12:51:25.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333168906375168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:25.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333168906375168[0;39m ==> Parameters: 
2022-04-29 12:51:25.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333168906375168[0;39m <==    Updates: 0
2022-04-29 12:51:25.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333168906375168[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 12:51:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333189886283776[0;39m 生成今日电子书快照开始
2022-04-29 12:51:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333189886283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333189886283776[0;39m ==> Parameters: 
2022-04-29 12:51:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333189886283776[0;39m <==    Updates: 0
2022-04-29 12:51:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333189886283776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:51:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333210861998080[0;39m 生成今日电子书快照开始
2022-04-29 12:51:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333210861998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333210861998080[0;39m ==> Parameters: 
2022-04-29 12:51:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333210861998080[0;39m <==    Updates: 0
2022-04-29 12:51:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333210861998080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:51:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333211126239232[0;39m start updating Ebook doc
2022-04-29 12:51:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333211126239232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:51:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333211126239232[0;39m ==> Parameters: 
2022-04-29 12:51:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333211126239232[0;39m <==    Updates: 1
2022-04-29 12:51:35.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333211126239232[0;39m update ends, take 43 millisecs
2022-04-29 12:51:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333231841906688[0;39m 生成今日电子书快照开始
2022-04-29 12:51:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333231841906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333231841906688[0;39m ==> Parameters: 
2022-04-29 12:51:40.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333231841906688[0;39m <==    Updates: 0
2022-04-29 12:51:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333231841906688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:51:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333252813426688[0;39m 生成今日电子书快照开始
2022-04-29 12:51:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333252813426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333252813426688[0;39m ==> Parameters: 
2022-04-29 12:51:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333252813426688[0;39m <==    Updates: 0
2022-04-29 12:51:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333252813426688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:51:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333273776558080[0;39m 生成今日电子书快照开始
2022-04-29 12:51:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333273776558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333273776558080[0;39m ==> Parameters: 
2022-04-29 12:51:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333273776558080[0;39m <==    Updates: 0
2022-04-29 12:51:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333273776558080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:51:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333294739689472[0;39m 生成今日电子书快照开始
2022-04-29 12:51:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333294739689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333294739689472[0;39m ==> Parameters: 
2022-04-29 12:51:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333294739689472[0;39m <==    Updates: 0
2022-04-29 12:51:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333294739689472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:52:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333315727986688[0;39m 生成今日电子书快照开始
2022-04-29 12:52:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333315727986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333315727986688[0;39m ==> Parameters: 
2022-04-29 12:52:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333315727986688[0;39m <==    Updates: 0
2022-04-29 12:52:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333315727986688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:52:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333336695312384[0;39m 生成今日电子书快照开始
2022-04-29 12:52:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333336695312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:05.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333336695312384[0;39m ==> Parameters: 
2022-04-29 12:52:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333336695312384[0;39m <==    Updates: 0
2022-04-29 12:52:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333336695312384[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 12:52:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333336925999104[0;39m start updating Ebook doc
2022-04-29 12:52:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333336925999104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:52:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333336925999104[0;39m ==> Parameters: 
2022-04-29 12:52:05.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333336925999104[0;39m <==    Updates: 1
2022-04-29 12:52:05.103 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333336925999104[0;39m update ends, take 44 millisecs
2022-04-29 12:52:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333357675220992[0;39m 生成今日电子书快照开始
2022-04-29 12:52:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333357675220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333357675220992[0;39m ==> Parameters: 
2022-04-29 12:52:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333357675220992[0;39m <==    Updates: 0
2022-04-29 12:52:10.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333357675220992[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:52:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333378638352384[0;39m 生成今日电子书快照开始
2022-04-29 12:52:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333378638352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333378638352384[0;39m ==> Parameters: 
2022-04-29 12:52:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333378638352384[0;39m <==    Updates: 0
2022-04-29 12:52:15.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333378638352384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:52:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333399597289472[0;39m 生成今日电子书快照开始
2022-04-29 12:52:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333399597289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333399597289472[0;39m ==> Parameters: 
2022-04-29 12:52:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333399597289472[0;39m <==    Updates: 0
2022-04-29 12:52:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333399597289472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:52:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333420568809472[0;39m 生成今日电子书快照开始
2022-04-29 12:52:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333420568809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333420568809472[0;39m ==> Parameters: 
2022-04-29 12:52:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333420568809472[0;39m <==    Updates: 0
2022-04-29 12:52:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333420568809472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:52:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333441544523776[0;39m 生成今日电子书快照开始
2022-04-29 12:52:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333441544523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333441544523776[0;39m ==> Parameters: 
2022-04-29 12:52:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333441544523776[0;39m <==    Updates: 0
2022-04-29 12:52:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333441544523776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:52:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333462516043776[0;39m 生成今日电子书快照开始
2022-04-29 12:52:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333462516043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333462516043776[0;39m ==> Parameters: 
2022-04-29 12:52:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333462516043776[0;39m <==    Updates: 0
2022-04-29 12:52:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333462516043776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:52:35.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333462759313408[0;39m start updating Ebook doc
2022-04-29 12:52:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333462759313408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:52:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333462759313408[0;39m ==> Parameters: 
2022-04-29 12:52:35.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333462759313408[0;39m <==    Updates: 1
2022-04-29 12:52:35.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333462759313408[0;39m update ends, take 39 millisecs
2022-04-29 12:52:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333483495952384[0;39m 生成今日电子书快照开始
2022-04-29 12:52:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333483495952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333483495952384[0;39m ==> Parameters: 
2022-04-29 12:52:40.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333483495952384[0;39m <==    Updates: 0
2022-04-29 12:52:40.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333483495952384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:52:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333504459083776[0;39m 生成今日电子书快照开始
2022-04-29 12:52:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333504459083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333504459083776[0;39m ==> Parameters: 
2022-04-29 12:52:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333504459083776[0;39m <==    Updates: 0
2022-04-29 12:52:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333504459083776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:52:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333525426409472[0;39m 生成今日电子书快照开始
2022-04-29 12:52:50.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333525426409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:50.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333525426409472[0;39m ==> Parameters: 
2022-04-29 12:52:50.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333525426409472[0;39m <==    Updates: 0
2022-04-29 12:52:50.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333525426409472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:52:50.744 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：h7OAOeaOgR，session id：1，当前连接数：1
2022-04-29 12:52:50.813 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175333528832184320[0;39m ------------- 开始 -------------
2022-04-29 12:52:50.837 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175333528832184320[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:52:50.837 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175333528832184320[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:52:50.839 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175333528832184320[0;39m 远程地址: 127.0.0.1
2022-04-29 12:52:50.842 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175333528832184320[0;39m 请求参数: []
2022-04-29 12:52:50.865 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175333528832184320[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:52:50.869 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175333528832184320[0;39m ==> Parameters: 
2022-04-29 12:52:50.894 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:52:50.897 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:52:50.904 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:52:50.907 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:52:50.907 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:52:50.908 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:52:50.908 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:52:50.909 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:52:50.909 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:52:50.910 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:52:50.910 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:52:50.911 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:52:50.911 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:52:50.912 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:52:50.913 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:52:50.914 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:52:50.917 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:52:50.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:52:50.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:52:50.921 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175333528832184320[0;39m <==      Total: 18
2022-04-29 12:52:50.934 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175333528832184320[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:52:50.935 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175333528832184320[0;39m ------------- 结束 耗时：122 ms -------------
2022-04-29 12:52:50.989 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175333529570381824[0;39m ------------- 开始 -------------
2022-04-29 12:52:50.990 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175333529570381824[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 12:52:50.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175333529570381824[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 12:52:50.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175333529570381824[0;39m 远程地址: 127.0.0.1
2022-04-29 12:52:50.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175333529570381824[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 12:52:51.017 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175333529570381824[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 12:52:51.018 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175333529570381824[0;39m ==> Parameters: 
2022-04-29 12:52:51.034 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175333529570381824[0;39m <==    Columns: count(0)
2022-04-29 12:52:51.034 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175333529570381824[0;39m <==        Row: 5
2022-04-29 12:52:51.034 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175333529570381824[0;39m <==      Total: 1
2022-04-29 12:52:51.035 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175333529570381824[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 12:52:51.036 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175333529570381824[0;39m ==> Parameters: 10(Integer)
2022-04-29 12:52:51.053 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 12:52:51.054 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 12:52:51.054 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 12:52:51.055 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 12:52:51.055 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 12:52:51.056 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 12:52:51.059 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175333529570381824[0;39m <==      Total: 5
2022-04-29 12:52:51.062 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175333529570381824[0;39m total rows：5
2022-04-29 12:52:51.063 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175333529570381824[0;39m total pages：1
2022-04-29 12:52:51.064 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175333529570381824[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 12:52:51.065 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175333529570381824[0;39m ------------- 结束 耗时：76 ms -------------
2022-04-29 12:52:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333546406318080[0;39m 生成今日电子书快照开始
2022-04-29 12:52:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333546406318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333546406318080[0;39m ==> Parameters: 
2022-04-29 12:52:55.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333546406318080[0;39m <==    Updates: 0
2022-04-29 12:52:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333546406318080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:53:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333567369449472[0;39m 生成今日电子书快照开始
2022-04-29 12:53:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333567369449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333567369449472[0;39m ==> Parameters: 
2022-04-29 12:53:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333567369449472[0;39m <==    Updates: 0
2022-04-29 12:53:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333567369449472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:53:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333588357746688[0;39m 生成今日电子书快照开始
2022-04-29 12:53:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333588357746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333588357746688[0;39m ==> Parameters: 
2022-04-29 12:53:05.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333588357746688[0;39m <==    Updates: 0
2022-04-29 12:53:05.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333588357746688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:53:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333588605210624[0;39m start updating Ebook doc
2022-04-29 12:53:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333588605210624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:53:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333588605210624[0;39m ==> Parameters: 
2022-04-29 12:53:05.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333588605210624[0;39m <==    Updates: 1
2022-04-29 12:53:05.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333588605210624[0;39m update ends, take 35 millisecs
2022-04-29 12:53:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333609325072384[0;39m 生成今日电子书快照开始
2022-04-29 12:53:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333609325072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333609325072384[0;39m ==> Parameters: 
2022-04-29 12:53:10.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333609325072384[0;39m <==    Updates: 0
2022-04-29 12:53:10.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333609325072384[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 12:53:13.169 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175332617971961857[0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:53:13.170 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175332617971961857[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 12:53:13.170 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175332617971961857[0;39m 登录校验开始，token：175330320638414848
2022-04-29 12:53:13.354 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175332617971961857[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"}
2022-04-29 12:53:13.358 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175333623392768000[0;39m ------------- 开始 -------------
2022-04-29 12:53:13.358 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175333623392768000[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 12:53:13.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175333623392768000[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 12:53:13.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175333623392768000[0;39m 远程地址: 127.0.0.1
2022-04-29 12:53:13.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175333623392768000[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"Spring"}]
2022-04-29 12:53:13.379 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175333623392768000[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 12:53:13.381 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175333623392768000[0;39m ==> Parameters: 175333623401156608(Long), Spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 12:53:13.427 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175333623392768000[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy150.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 12:53:13.431 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175333623392768000[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 12:53:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333630288203776[0;39m 生成今日电子书快照开始
2022-04-29 12:53:15.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333630288203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:15.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333630288203776[0;39m ==> Parameters: 
2022-04-29 12:53:15.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333630288203776[0;39m <==    Updates: 0
2022-04-29 12:53:15.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333630288203776[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 12:53:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333651251335168[0;39m 生成今日电子书快照开始
2022-04-29 12:53:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333651251335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333651251335168[0;39m ==> Parameters: 
2022-04-29 12:53:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333651251335168[0;39m <==    Updates: 0
2022-04-29 12:53:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333651251335168[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:53:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333672222855168[0;39m 生成今日电子书快照开始
2022-04-29 12:53:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333672222855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333672222855168[0;39m ==> Parameters: 
2022-04-29 12:53:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333672222855168[0;39m <==    Updates: 0
2022-04-29 12:53:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333672222855168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:53:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333693211152384[0;39m 生成今日电子书快照开始
2022-04-29 12:53:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333693211152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333693211152384[0;39m ==> Parameters: 
2022-04-29 12:53:30.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333693211152384[0;39m <==    Updates: 0
2022-04-29 12:53:30.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333693211152384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:53:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333714170089472[0;39m 生成今日电子书快照开始
2022-04-29 12:53:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333714170089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333714170089472[0;39m ==> Parameters: 
2022-04-29 12:53:35.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333714170089472[0;39m <==    Updates: 0
2022-04-29 12:53:35.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333714170089472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:53:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333714421747712[0;39m start updating Ebook doc
2022-04-29 12:53:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333714421747712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:53:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333714421747712[0;39m ==> Parameters: 
2022-04-29 12:53:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333714421747712[0;39m <==    Updates: 1
2022-04-29 12:53:35.101 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333714421747712[0;39m update ends, take 40 millisecs
2022-04-29 12:53:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333735149998080[0;39m 生成今日电子书快照开始
2022-04-29 12:53:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333735149998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333735149998080[0;39m ==> Parameters: 
2022-04-29 12:53:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333735149998080[0;39m <==    Updates: 0
2022-04-29 12:53:40.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333735149998080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:53:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333756125712384[0;39m 生成今日电子书快照开始
2022-04-29 12:53:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333756125712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333756125712384[0;39m ==> Parameters: 
2022-04-29 12:53:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333756125712384[0;39m <==    Updates: 0
2022-04-29 12:53:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333756125712384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:53:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333777093038080[0;39m 生成今日电子书快照开始
2022-04-29 12:53:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333777093038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333777093038080[0;39m ==> Parameters: 
2022-04-29 12:53:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333777093038080[0;39m <==    Updates: 0
2022-04-29 12:53:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333777093038080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:53:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333798056169472[0;39m 生成今日电子书快照开始
2022-04-29 12:53:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333798056169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333798056169472[0;39m ==> Parameters: 
2022-04-29 12:53:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333798056169472[0;39m <==    Updates: 0
2022-04-29 12:53:55.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333798056169472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:54:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333819027689472[0;39m 生成今日电子书快照开始
2022-04-29 12:54:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333819027689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333819027689472[0;39m ==> Parameters: 
2022-04-29 12:54:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333819027689472[0;39m <==    Updates: 0
2022-04-29 12:54:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333819027689472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:54:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333840015986688[0;39m 生成今日电子书快照开始
2022-04-29 12:54:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333840015986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333840015986688[0;39m ==> Parameters: 
2022-04-29 12:54:05.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333840015986688[0;39m <==    Updates: 0
2022-04-29 12:54:05.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333840015986688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 12:54:05.057 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333840234090496[0;39m start updating Ebook doc
2022-04-29 12:54:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333840234090496[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:54:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333840234090496[0;39m ==> Parameters: 
2022-04-29 12:54:05.093 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333840234090496[0;39m <==    Updates: 1
2022-04-29 12:54:05.093 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333840234090496[0;39m update ends, take 35 millisecs
2022-04-29 12:54:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333860987506688[0;39m 生成今日电子书快照开始
2022-04-29 12:54:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333860987506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333860987506688[0;39m ==> Parameters: 
2022-04-29 12:54:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333860987506688[0;39m <==    Updates: 0
2022-04-29 12:54:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333860987506688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:54:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333881946443776[0;39m 生成今日电子书快照开始
2022-04-29 12:54:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333881946443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333881946443776[0;39m ==> Parameters: 
2022-04-29 12:54:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333881946443776[0;39m <==    Updates: 0
2022-04-29 12:54:15.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333881946443776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:54:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333902926352384[0;39m 生成今日电子书快照开始
2022-04-29 12:54:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333902926352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333902926352384[0;39m ==> Parameters: 
2022-04-29 12:54:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333902926352384[0;39m <==    Updates: 0
2022-04-29 12:54:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333902926352384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:54:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333923881095168[0;39m 生成今日电子书快照开始
2022-04-29 12:54:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333923881095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333923881095168[0;39m ==> Parameters: 
2022-04-29 12:54:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333923881095168[0;39m <==    Updates: 0
2022-04-29 12:54:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333923881095168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:54:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333944869392384[0;39m 生成今日电子书快照开始
2022-04-29 12:54:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333944869392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333944869392384[0;39m ==> Parameters: 
2022-04-29 12:54:30.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333944869392384[0;39m <==    Updates: 0
2022-04-29 12:54:30.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333944869392384[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-29 12:54:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333965824135168[0;39m 生成今日电子书快照开始
2022-04-29 12:54:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333965824135168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333965824135168[0;39m ==> Parameters: 
2022-04-29 12:54:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333965824135168[0;39m <==    Updates: 0
2022-04-29 12:54:35.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333965824135168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:54:35.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333966071599104[0;39m start updating Ebook doc
2022-04-29 12:54:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333966071599104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:54:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333966071599104[0;39m ==> Parameters: 
2022-04-29 12:54:35.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333966071599104[0;39m <==    Updates: 1
2022-04-29 12:54:35.098 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333966071599104[0;39m update ends, take 39 millisecs
2022-04-29 12:54:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333986816626688[0;39m 生成今日电子书快照开始
2022-04-29 12:54:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333986816626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:40.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333986816626688[0;39m ==> Parameters: 
2022-04-29 12:54:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333986816626688[0;39m <==    Updates: 0
2022-04-29 12:54:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333986816626688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:54:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334007783952384[0;39m 生成今日电子书快照开始
2022-04-29 12:54:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334007783952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334007783952384[0;39m ==> Parameters: 
2022-04-29 12:54:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334007783952384[0;39m <==    Updates: 0
2022-04-29 12:54:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334007783952384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:54:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334028747083776[0;39m 生成今日电子书快照开始
2022-04-29 12:54:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334028747083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334028747083776[0;39m ==> Parameters: 
2022-04-29 12:54:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334028747083776[0;39m <==    Updates: 0
2022-04-29 12:54:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334028747083776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:54:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334049710215168[0;39m 生成今日电子书快照开始
2022-04-29 12:54:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334049710215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334049710215168[0;39m ==> Parameters: 
2022-04-29 12:54:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334049710215168[0;39m <==    Updates: 0
2022-04-29 12:54:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334049710215168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:55:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334070685929472[0;39m 生成今日电子书快照开始
2022-04-29 12:55:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334070685929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334070685929472[0;39m ==> Parameters: 
2022-04-29 12:55:00.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334070685929472[0;39m <==    Updates: 0
2022-04-29 12:55:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334070685929472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:55:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334091674226688[0;39m 生成今日电子书快照开始
2022-04-29 12:55:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334091674226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334091674226688[0;39m ==> Parameters: 
2022-04-29 12:55:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334091674226688[0;39m <==    Updates: 0
2022-04-29 12:55:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334091674226688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:05.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334091913302016[0;39m start updating Ebook doc
2022-04-29 12:55:05.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334091913302016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:55:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334091913302016[0;39m ==> Parameters: 
2022-04-29 12:55:05.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334091913302016[0;39m <==    Updates: 1
2022-04-29 12:55:05.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334091913302016[0;39m update ends, take 36 millisecs
2022-04-29 12:55:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334112637358080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334112637358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334112637358080[0;39m ==> Parameters: 
2022-04-29 12:55:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334112637358080[0;39m <==    Updates: 0
2022-04-29 12:55:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334112637358080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:55:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334133600489472[0;39m 生成今日电子书快照开始
2022-04-29 12:55:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334133600489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334133600489472[0;39m ==> Parameters: 
2022-04-29 12:55:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334133600489472[0;39m <==    Updates: 0
2022-04-29 12:55:15.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334133600489472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:55:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334154580398080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334154580398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334154580398080[0;39m ==> Parameters: 
2022-04-29 12:55:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334154580398080[0;39m <==    Updates: 0
2022-04-29 12:55:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334154580398080[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:55:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334175551918080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334175551918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334175551918080[0;39m ==> Parameters: 
2022-04-29 12:55:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334175551918080[0;39m <==    Updates: 0
2022-04-29 12:55:25.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334175551918080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334196519243776[0;39m 生成今日电子书快照开始
2022-04-29 12:55:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334196519243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334196519243776[0;39m ==> Parameters: 
2022-04-29 12:55:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334196519243776[0;39m <==    Updates: 0
2022-04-29 12:55:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334196519243776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:55:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334217494958080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334217494958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334217494958080[0;39m ==> Parameters: 
2022-04-29 12:55:35.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334217494958080[0;39m <==    Updates: 0
2022-04-29 12:55:35.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334217494958080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334217738227712[0;39m start updating Ebook doc
2022-04-29 12:55:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334217738227712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:55:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334217738227712[0;39m ==> Parameters: 
2022-04-29 12:55:35.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334217738227712[0;39m <==    Updates: 1
2022-04-29 12:55:35.098 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334217738227712[0;39m update ends, take 37 millisecs
2022-04-29 12:55:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334238462283776[0;39m 生成今日电子书快照开始
2022-04-29 12:55:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334238462283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334238462283776[0;39m ==> Parameters: 
2022-04-29 12:55:40.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334238462283776[0;39m <==    Updates: 0
2022-04-29 12:55:40.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334238462283776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334259446386688[0;39m 生成今日电子书快照开始
2022-04-29 12:55:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334259446386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334259446386688[0;39m ==> Parameters: 
2022-04-29 12:55:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334259446386688[0;39m <==    Updates: 0
2022-04-29 12:55:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334259446386688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:55:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334280413712384[0;39m 生成今日电子书快照开始
2022-04-29 12:55:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334280413712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334280413712384[0;39m ==> Parameters: 
2022-04-29 12:55:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334280413712384[0;39m <==    Updates: 0
2022-04-29 12:55:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334280413712384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:55:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334301376843776[0;39m 生成今日电子书快照开始
2022-04-29 12:55:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334301376843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334301376843776[0;39m ==> Parameters: 
2022-04-29 12:55:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334301376843776[0;39m <==    Updates: 0
2022-04-29 12:55:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334301376843776[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:56:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334322348363776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334322348363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334322348363776[0;39m ==> Parameters: 
2022-04-29 12:56:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334322348363776[0;39m <==    Updates: 0
2022-04-29 12:56:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334322348363776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:56:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334343332466688[0;39m start updating Ebook doc
2022-04-29 12:56:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334343332466688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:56:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334343332466688[0;39m ==> Parameters: 
2022-04-29 12:56:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334343332466688[0;39m <==    Updates: 1
2022-04-29 12:56:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334343332466688[0;39m update ends, take 59 millisecs
2022-04-29 12:56:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334343588319232[0;39m 生成今日电子书快照开始
2022-04-29 12:56:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334343588319232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334343588319232[0;39m ==> Parameters: 
2022-04-29 12:56:05.105 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334343588319232[0;39m <==    Updates: 0
2022-04-29 12:56:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334343588319232[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 12:56:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334364303986688[0;39m 生成今日电子书快照开始
2022-04-29 12:56:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334364303986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334364303986688[0;39m ==> Parameters: 
2022-04-29 12:56:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334364303986688[0;39m <==    Updates: 0
2022-04-29 12:56:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334364303986688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:56:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334385258729472[0;39m 生成今日电子书快照开始
2022-04-29 12:56:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334385258729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334385258729472[0;39m ==> Parameters: 
2022-04-29 12:56:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334385258729472[0;39m <==    Updates: 0
2022-04-29 12:56:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334385258729472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:56:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334406234443776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334406234443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334406234443776[0;39m ==> Parameters: 
2022-04-29 12:56:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334406234443776[0;39m <==    Updates: 0
2022-04-29 12:56:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334406234443776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:56:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334427218546688[0;39m 生成今日电子书快照开始
2022-04-29 12:56:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334427218546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334427218546688[0;39m ==> Parameters: 
2022-04-29 12:56:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334427218546688[0;39m <==    Updates: 0
2022-04-29 12:56:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334427218546688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:56:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334448169095168[0;39m 生成今日电子书快照开始
2022-04-29 12:56:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334448169095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334448169095168[0;39m ==> Parameters: 
2022-04-29 12:56:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334448169095168[0;39m <==    Updates: 0
2022-04-29 12:56:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334448169095168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:56:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334469149003776[0;39m start updating Ebook doc
2022-04-29 12:56:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334469149003776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:56:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334469149003776[0;39m ==> Parameters: 
2022-04-29 12:56:35.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334469149003776[0;39m <==    Updates: 1
2022-04-29 12:56:35.056 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334469149003776[0;39m update ends, take 54 millisecs
2022-04-29 12:56:35.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334469375496192[0;39m 生成今日电子书快照开始
2022-04-29 12:56:35.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334469375496192[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:35.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334469375496192[0;39m ==> Parameters: 
2022-04-29 12:56:35.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334469375496192[0;39m <==    Updates: 0
2022-04-29 12:56:35.091 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334469375496192[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-29 12:56:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334490120523776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334490120523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334490120523776[0;39m ==> Parameters: 
2022-04-29 12:56:40.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334490120523776[0;39m <==    Updates: 0
2022-04-29 12:56:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334490120523776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:56:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334511092043776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:45.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334511092043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:45.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334511092043776[0;39m ==> Parameters: 
2022-04-29 12:56:45.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334511092043776[0;39m <==    Updates: 0
2022-04-29 12:56:45.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334511092043776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:56:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334532055175168[0;39m 生成今日电子书快照开始
2022-04-29 12:56:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334532055175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334532055175168[0;39m ==> Parameters: 
2022-04-29 12:56:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334532055175168[0;39m <==    Updates: 0
2022-04-29 12:56:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334532055175168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:56:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334553030889472[0;39m 生成今日电子书快照开始
2022-04-29 12:56:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334553030889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334553030889472[0;39m ==> Parameters: 
2022-04-29 12:56:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334553030889472[0;39m <==    Updates: 0
2022-04-29 12:56:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334553030889472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:57:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334574019186688[0;39m 生成今日电子书快照开始
2022-04-29 12:57:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334574019186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334574019186688[0;39m ==> Parameters: 
2022-04-29 12:57:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334574019186688[0;39m <==    Updates: 0
2022-04-29 12:57:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334574019186688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:57:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334594982318080[0;39m 生成今日电子书快照开始
2022-04-29 12:57:05.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334594982318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334594982318080[0;39m ==> Parameters: 
2022-04-29 12:57:05.114 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334594982318080[0;39m <==    Updates: 0
2022-04-29 12:57:05.115 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334594982318080[0;39m 生成今日电子书快照结束，耗时：111毫秒
2022-04-29 12:57:05.120 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334595473051648[0;39m start updating Ebook doc
2022-04-29 12:57:05.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334595473051648[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:57:05.121 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334595473051648[0;39m ==> Parameters: 
2022-04-29 12:57:05.162 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334595473051648[0;39m <==    Updates: 1
2022-04-29 12:57:05.162 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334595473051648[0;39m update ends, take 42 millisecs
2022-04-29 12:57:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334615958032384[0;39m 生成今日电子书快照开始
2022-04-29 12:57:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334615958032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334615958032384[0;39m ==> Parameters: 
2022-04-29 12:57:10.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334615958032384[0;39m <==    Updates: 0
2022-04-29 12:57:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334615958032384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:57:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334636912775168[0;39m 生成今日电子书快照开始
2022-04-29 12:57:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334636912775168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334636912775168[0;39m ==> Parameters: 
2022-04-29 12:57:15.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334636912775168[0;39m <==    Updates: 0
2022-04-29 12:57:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334636912775168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:57:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334657888489472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334657888489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334657888489472[0;39m ==> Parameters: 
2022-04-29 12:57:20.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334657888489472[0;39m <==    Updates: 0
2022-04-29 12:57:20.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334657888489472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:57:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334678860009472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334678860009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334678860009472[0;39m ==> Parameters: 
2022-04-29 12:57:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334678860009472[0;39m <==    Updates: 0
2022-04-29 12:57:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334678860009472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:57:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334699831529472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334699831529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334699831529472[0;39m ==> Parameters: 
2022-04-29 12:57:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334699831529472[0;39m <==    Updates: 0
2022-04-29 12:57:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334699831529472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:57:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334720819826688[0;39m start updating Ebook doc
2022-04-29 12:57:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334720819826688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:57:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334720819826688[0;39m ==> Parameters: 
2022-04-29 12:57:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334720819826688[0;39m <==    Updates: 1
2022-04-29 12:57:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334720819826688[0;39m update ends, take 60 millisecs
2022-04-29 12:57:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334721075679232[0;39m 生成今日电子书快照开始
2022-04-29 12:57:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334721075679232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:35.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334721075679232[0;39m ==> Parameters: 
2022-04-29 12:57:35.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334721075679232[0;39m <==    Updates: 0
2022-04-29 12:57:35.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334721075679232[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-29 12:57:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334741774569472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334741774569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334741774569472[0;39m ==> Parameters: 
2022-04-29 12:57:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334741774569472[0;39m <==    Updates: 0
2022-04-29 12:57:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334741774569472[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:57:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334762758672384[0;39m 生成今日电子书快照开始
2022-04-29 12:57:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334762758672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334762758672384[0;39m ==> Parameters: 
2022-04-29 12:57:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334762758672384[0;39m <==    Updates: 0
2022-04-29 12:57:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334762758672384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:57:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334783734386688[0;39m 生成今日电子书快照开始
2022-04-29 12:57:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334783734386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334783734386688[0;39m ==> Parameters: 
2022-04-29 12:57:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334783734386688[0;39m <==    Updates: 0
2022-04-29 12:57:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334783734386688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:57:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334804705906688[0;39m 生成今日电子书快照开始
2022-04-29 12:57:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334804705906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334804705906688[0;39m ==> Parameters: 
2022-04-29 12:57:55.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334804705906688[0;39m <==    Updates: 0
2022-04-29 12:57:55.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334804705906688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:58:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334825673232384[0;39m 生成今日电子书快照开始
2022-04-29 12:58:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334825673232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334825673232384[0;39m ==> Parameters: 
2022-04-29 12:58:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334825673232384[0;39m <==    Updates: 0
2022-04-29 12:58:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334825673232384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:58:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334846648946688[0;39m 生成今日电子书快照开始
2022-04-29 12:58:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334846648946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:05.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334846648946688[0;39m ==> Parameters: 
2022-04-29 12:58:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334846648946688[0;39m <==    Updates: 0
2022-04-29 12:58:05.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334846648946688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:58:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334846900604928[0;39m start updating Ebook doc
2022-04-29 12:58:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334846900604928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:58:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334846900604928[0;39m ==> Parameters: 
2022-04-29 12:58:05.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334846900604928[0;39m <==    Updates: 1
2022-04-29 12:58:05.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334846900604928[0;39m update ends, take 37 millisecs
2022-04-29 12:58:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334867599495168[0;39m 生成今日电子书快照开始
2022-04-29 12:58:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334867599495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334867599495168[0;39m ==> Parameters: 
2022-04-29 12:58:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334867599495168[0;39m <==    Updates: 0
2022-04-29 12:58:10.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334867599495168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:58:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334888587792384[0;39m 生成今日电子书快照开始
2022-04-29 12:58:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334888587792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334888587792384[0;39m ==> Parameters: 
2022-04-29 12:58:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334888587792384[0;39m <==    Updates: 0
2022-04-29 12:58:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334888587792384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:58:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334909555118080[0;39m 生成今日电子书快照开始
2022-04-29 12:58:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334909555118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334909555118080[0;39m ==> Parameters: 
2022-04-29 12:58:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334909555118080[0;39m <==    Updates: 0
2022-04-29 12:58:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334909555118080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:58:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334930526638080[0;39m 生成今日电子书快照开始
2022-04-29 12:58:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334930526638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334930526638080[0;39m ==> Parameters: 
2022-04-29 12:58:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334930526638080[0;39m <==    Updates: 0
2022-04-29 12:58:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334930526638080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:58:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334951506546688[0;39m 生成今日电子书快照开始
2022-04-29 12:58:30.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334951506546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334951506546688[0;39m ==> Parameters: 
2022-04-29 12:58:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334951506546688[0;39m <==    Updates: 0
2022-04-29 12:58:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334951506546688[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:58:35.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334972473872384[0;39m start updating Ebook doc
2022-04-29 12:58:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334972473872384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:58:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334972473872384[0;39m ==> Parameters: 
2022-04-29 12:58:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334972473872384[0;39m <==    Updates: 1
2022-04-29 12:58:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334972473872384[0;39m update ends, take 59 millisecs
2022-04-29 12:58:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334972725530624[0;39m 生成今日电子书快照开始
2022-04-29 12:58:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334972725530624[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334972725530624[0;39m ==> Parameters: 
2022-04-29 12:58:35.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334972725530624[0;39m <==    Updates: 0
2022-04-29 12:58:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334972725530624[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-29 12:58:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334993428615168[0;39m 生成今日电子书快照开始
2022-04-29 12:58:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334993428615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334993428615168[0;39m ==> Parameters: 
2022-04-29 12:58:40.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334993428615168[0;39m <==    Updates: 0
2022-04-29 12:58:40.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334993428615168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:58:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335014412718080[0;39m 生成今日电子书快照开始
2022-04-29 12:58:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335014412718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335014412718080[0;39m ==> Parameters: 
2022-04-29 12:58:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335014412718080[0;39m <==    Updates: 0
2022-04-29 12:58:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335014412718080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:58:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335035380043776[0;39m 生成今日电子书快照开始
2022-04-29 12:58:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335035380043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335035380043776[0;39m ==> Parameters: 
2022-04-29 12:58:50.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335035380043776[0;39m <==    Updates: 0
2022-04-29 12:58:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335035380043776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:58:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335056347369472[0;39m 生成今日电子书快照开始
2022-04-29 12:58:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335056347369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335056347369472[0;39m ==> Parameters: 
2022-04-29 12:58:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335056347369472[0;39m <==    Updates: 0
2022-04-29 12:58:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335056347369472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:59:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335077314695168[0;39m 生成今日电子书快照开始
2022-04-29 12:59:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335077314695168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335077314695168[0;39m ==> Parameters: 
2022-04-29 12:59:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335077314695168[0;39m <==    Updates: 0
2022-04-29 12:59:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335077314695168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:59:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335098302992384[0;39m 生成今日电子书快照开始
2022-04-29 12:59:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335098302992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335098302992384[0;39m ==> Parameters: 
2022-04-29 12:59:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335098302992384[0;39m <==    Updates: 0
2022-04-29 12:59:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335098302992384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:59:05.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335098542067712[0;39m start updating Ebook doc
2022-04-29 12:59:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335098542067712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:59:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335098542067712[0;39m ==> Parameters: 
2022-04-29 12:59:05.096 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335098542067712[0;39m <==    Updates: 1
2022-04-29 12:59:05.096 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335098542067712[0;39m update ends, take 35 millisecs
2022-04-29 12:59:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335119261929472[0;39m 生成今日电子书快照开始
2022-04-29 12:59:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335119261929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335119261929472[0;39m ==> Parameters: 
2022-04-29 12:59:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335119261929472[0;39m <==    Updates: 0
2022-04-29 12:59:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335119261929472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:59:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335140237643776[0;39m 生成今日电子书快照开始
2022-04-29 12:59:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335140237643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335140237643776[0;39m ==> Parameters: 
2022-04-29 12:59:15.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335140237643776[0;39m <==    Updates: 0
2022-04-29 12:59:15.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335140237643776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:59:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335161213358080[0;39m 生成今日电子书快照开始
2022-04-29 12:59:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335161213358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335161213358080[0;39m ==> Parameters: 
2022-04-29 12:59:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335161213358080[0;39m <==    Updates: 0
2022-04-29 12:59:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335161213358080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:59:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335182184878080[0;39m 生成今日电子书快照开始
2022-04-29 12:59:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335182184878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335182184878080[0;39m ==> Parameters: 
2022-04-29 12:59:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335182184878080[0;39m <==    Updates: 0
2022-04-29 12:59:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335182184878080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:59:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335203156398080[0;39m 生成今日电子书快照开始
2022-04-29 12:59:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335203156398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335203156398080[0;39m ==> Parameters: 
2022-04-29 12:59:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335203156398080[0;39m <==    Updates: 0
2022-04-29 12:59:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335203156398080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:59:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335224115335168[0;39m 生成今日电子书快照开始
2022-04-29 12:59:35.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335224115335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:35.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335224115335168[0;39m ==> Parameters: 
2022-04-29 12:59:35.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335224115335168[0;39m <==    Updates: 0
2022-04-29 12:59:35.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335224115335168[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:59:35.054 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335224341827584[0;39m start updating Ebook doc
2022-04-29 12:59:35.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335224341827584[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:59:35.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335224341827584[0;39m ==> Parameters: 
2022-04-29 12:59:35.089 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335224341827584[0;39m <==    Updates: 1
2022-04-29 12:59:35.090 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335224341827584[0;39m update ends, take 36 millisecs
2022-04-29 12:59:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335245103632384[0;39m 生成今日电子书快照开始
2022-04-29 12:59:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335245103632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335245103632384[0;39m ==> Parameters: 
2022-04-29 12:59:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335245103632384[0;39m <==    Updates: 0
2022-04-29 12:59:40.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335245103632384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:59:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335266075152384[0;39m 生成今日电子书快照开始
2022-04-29 12:59:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335266075152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335266075152384[0;39m ==> Parameters: 
2022-04-29 12:59:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335266075152384[0;39m <==    Updates: 0
2022-04-29 12:59:45.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335266075152384[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:59:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335287050866688[0;39m 生成今日电子书快照开始
2022-04-29 12:59:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335287050866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335287050866688[0;39m ==> Parameters: 
2022-04-29 12:59:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335287050866688[0;39m <==    Updates: 0
2022-04-29 12:59:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335287050866688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:59:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335308005609472[0;39m 生成今日电子书快照开始
2022-04-29 12:59:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335308005609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335308005609472[0;39m ==> Parameters: 
2022-04-29 12:59:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335308005609472[0;39m <==    Updates: 0
2022-04-29 12:59:55.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335308005609472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:00:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335328977129472[0;39m 生成今日电子书快照开始
2022-04-29 13:00:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335328977129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335328977129472[0;39m ==> Parameters: 
2022-04-29 13:00:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335328977129472[0;39m <==    Updates: 0
2022-04-29 13:00:00.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335328977129472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 13:00:01.916 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：h7OAOeaOgR，session id：1！当前连接数：0
2022-04-29 13:00:01.963 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 13:00:01.964 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 13:00:01.968 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-2 - Shutdown initiated...
2022-04-29 13:00:01.975 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-2 - Shutdown completed.
2022-04-29 13:00:17.726 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5006 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 13:00:22.732 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 20538 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 13:00:22.732 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 13:00:23.082 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 13:00:23.083 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 13:00:23.084 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2022-04-29 13:00:23.239 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 13:00:23.240 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 13:00:23.240 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 13:00:23.240 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 13:00:23.250 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 13:00:23.251 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 509 ms
2022-04-29 13:00:23.628 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 13:00:23.836 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 13:00:23.863 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 13:00:23.872 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 13:00:23.874 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 13:00:23.878 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 21.236 seconds (JVM running for 1342.147)
2022-04-29 13:00:23.880 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-29 13:00:23.880 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 13:00:23.880 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 13:00:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335433851506688[0;39m 生成今日电子书快照开始
2022-04-29 13:00:25.008 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175335433851506688[0;39m HikariPool-3 - Starting...
2022-04-29 13:00:25.254 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175335433851506688[0;39m HikariPool-3 - Start completed.
2022-04-29 13:00:25.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335433851506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:25.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335433851506688[0;39m ==> Parameters: 
2022-04-29 13:00:25.294 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335433851506688[0;39m <==    Updates: 0
2022-04-29 13:00:25.295 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335433851506688[0;39m 生成今日电子书快照结束，耗时：288毫秒
2022-04-29 13:00:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335454818832384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:30.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335454818832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:30.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335454818832384[0;39m ==> Parameters: 
2022-04-29 13:00:30.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335454818832384[0;39m <==    Updates: 0
2022-04-29 13:00:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335454818832384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 13:00:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335475794546688[0;39m 生成今日电子书快照开始
2022-04-29 13:00:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335475794546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335475794546688[0;39m ==> Parameters: 
2022-04-29 13:00:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335475794546688[0;39m <==    Updates: 0
2022-04-29 13:00:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335475794546688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 13:00:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335476054593536[0;39m start updating Ebook doc
2022-04-29 13:00:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335476054593536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:00:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335476054593536[0;39m ==> Parameters: 
2022-04-29 13:00:35.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335476054593536[0;39m <==    Updates: 1
2022-04-29 13:00:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335476054593536[0;39m update ends, take 41 millisecs
2022-04-29 13:00:39.490 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 13:00:39.490 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 13:00:39.491 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-29 13:00:39.493 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：zdSkxDWUUv，session id：2，当前连接数：1
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335495021236225[0;39m ------------- 开始 -------------
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335495021236226[0;39m ------------- 开始 -------------
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335495021236224[0;39m ------------- 开始 -------------
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335495021236224[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335495021236225[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335495021236226[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335495021236224[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335495021236225[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335495021236226[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335495021236224[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335495021236226[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335495021236225[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:39.591 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335495021236226[0;39m 请求参数: []
2022-04-29 13:00:39.591 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335495021236225[0;39m 请求参数: []
2022-04-29 13:00:39.591 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335495021236224[0;39m 请求参数: []
2022-04-29 13:00:39.609 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175335495021236226[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 13:00:39.609 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175335495021236226[0;39m ==> Parameters: 
2022-04-29 13:00:39.615 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335495021236224[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 13:00:39.615 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175335495021236225[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 13:00:39.616 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335495021236224[0;39m ==> Parameters: 
2022-04-29 13:00:39.616 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175335495021236225[0;39m ==> Parameters: 
2022-04-29 13:00:39.631 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 13:00:39.631 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 13:00:39.632 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 13:00:39.633 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 13:00:39.634 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 13:00:39.634 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 13:00:39.635 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 13:00:39.636 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 13:00:39.636 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==    Columns: id, parent, name, sort
2022-04-29 13:00:39.637 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 13:00:39.637 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 13:00:39.637 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175335495021236225[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 13:00:39.637 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 13:00:39.637 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175335495021236225[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 13:00:39.637 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 13:00:39.638 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 13:00:39.638 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 13:00:39.638 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175335495021236225[0;39m <==        Row: 2022-04-29, 1763, 63, 28, 2
2022-04-29 13:00:39.638 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 13:00:39.638 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175335495021236225[0;39m <==      Total: 2
2022-04-29 13:00:39.639 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 13:00:39.638 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 13:00:39.639 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 13:00:39.639 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 13:00:39.640 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 13:00:39.639 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 13:00:39.640 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 13:00:39.640 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175335495021236226[0;39m <==      Total: 13
2022-04-29 13:00:39.640 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335495021236225[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1763,"viewIncrease":28,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 13:00:39.641 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335495021236225[0;39m ------------- 结束 耗时：52 ms -------------
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335495021236226[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 13:00:39.641 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335495021236226[0;39m ------------- 结束 耗时：52 ms -------------
2022-04-29 13:00:39.642 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 13:00:39.642 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 13:00:39.643 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 13:00:39.644 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 13:00:39.644 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 13:00:39.646 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 13:00:39.646 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 13:00:39.647 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335495021236224[0;39m <==      Total: 18
2022-04-29 13:00:39.656 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335495021236224[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 13:00:39.656 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335495021236224[0;39m ------------- 结束 耗时：67 ms -------------
2022-04-29 13:00:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335496761872384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:40.004 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335496761872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:40.005 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335496761872384[0;39m ==> Parameters: 
2022-04-29 13:00:40.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335496761872384[0;39m <==    Updates: 0
2022-04-29 13:00:40.044 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335496761872384[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 13:00:44.128 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335514059182080[0;39m ------------- 开始 -------------
2022-04-29 13:00:44.128 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335514059182080[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-29 13:00:44.129 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335514059182080[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-29 13:00:44.129 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335514059182080[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:44.130 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335514059182080[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-29 13:00:44.162 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335514059182080[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-29 13:00:44.163 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335514059182080[0;39m ==> Parameters: test1(String)
2022-04-29 13:00:44.180 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335514059182080[0;39m <==    Columns: id, login_name, name, password
2022-04-29 13:00:44.181 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335514059182080[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 13:00:44.182 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335514059182080[0;39m <==      Total: 1
2022-04-29 13:00:44.189 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175335514059182080[0;39m generate single sign-on token：175335514315034624，and put it into redis
2022-04-29 13:00:44.959 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335514059182080[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175335514315034624"},"success":true}
2022-04-29 13:00:44.960 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335514059182080[0;39m ------------- 结束 耗时：832 ms -------------
2022-04-29 13:00:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335517733392384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:45.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335517733392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:45.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335517733392384[0;39m ==> Parameters: 
2022-04-29 13:00:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335517733392384[0;39m <==    Updates: 0
2022-04-29 13:00:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335517733392384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 13:00:47.109 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335526562402304[0;39m ------------- 开始 -------------
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335526562402304[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335526562402304[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335526562402304[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335526562402304[0;39m 请求参数: []
2022-04-29 13:00:47.142 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335526562402304[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 13:00:47.142 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335526562402304[0;39m ==> Parameters: 
2022-04-29 13:00:47.162 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==    Columns: id, parent, name, sort
2022-04-29 13:00:47.162 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 13:00:47.163 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 13:00:47.163 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 13:00:47.164 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 13:00:47.164 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 13:00:47.165 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 13:00:47.165 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 13:00:47.166 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 13:00:47.166 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 13:00:47.167 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 13:00:47.168 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 13:00:47.168 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 13:00:47.169 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 13:00:47.169 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 13:00:47.169 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 13:00:47.170 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 13:00:47.170 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 13:00:47.170 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 13:00:47.171 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335526562402304[0;39m <==      Total: 18
2022-04-29 13:00:47.172 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335526562402304[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 13:00:47.173 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335526562402304[0;39m ------------- 结束 耗时：64 ms -------------
2022-04-29 13:00:47.196 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335526927306752[0;39m ------------- 开始 -------------
2022-04-29 13:00:47.197 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335526927306752[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 13:00:47.197 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335526927306752[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 13:00:47.197 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335526927306752[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:47.198 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335526927306752[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 13:00:47.203 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175335526927306752[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 13:00:47.203 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175335526927306752[0;39m ==> Parameters: 
2022-04-29 13:00:47.218 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175335526927306752[0;39m <==    Columns: count(0)
2022-04-29 13:00:47.219 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175335526927306752[0;39m <==        Row: 5
2022-04-29 13:00:47.219 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175335526927306752[0;39m <==      Total: 1
2022-04-29 13:00:47.220 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175335526927306752[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 13:00:47.220 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175335526927306752[0;39m ==> Parameters: 10(Integer)
2022-04-29 13:00:47.242 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 13:00:47.242 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 13:00:47.243 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 13:00:47.243 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 13:00:47.243 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 13:00:47.244 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 13:00:47.244 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175335526927306752[0;39m <==      Total: 5
2022-04-29 13:00:47.245 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175335526927306752[0;39m total rows：5
2022-04-29 13:00:47.246 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175335526927306752[0;39m total pages：1
2022-04-29 13:00:47.250 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335526927306752[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 13:00:47.251 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335526927306752[0;39m ------------- 结束 耗时：55 ms -------------
2022-04-29 13:00:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335538704912384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335538704912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335538704912384[0;39m ==> Parameters: 
2022-04-29 13:00:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335538704912384[0;39m <==    Updates: 0
2022-04-29 13:00:50.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335538704912384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 13:00:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335559663849472[0;39m 生成今日电子书快照开始
2022-04-29 13:00:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335559663849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335559663849472[0;39m ==> Parameters: 
2022-04-29 13:00:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335559663849472[0;39m <==    Updates: 0
2022-04-29 13:00:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335559663849472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 13:00:59.161 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 13:00:59.162 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 13:00:59.162 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175335514315034624
2022-04-29 13:00:59.327 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175335514315034624"}
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335577829380096[0;39m ------------- 开始 -------------
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335577829380096[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335577829380096[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335577829380096[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:59.333 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335577829380096[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"spring"}]
2022-04-29 13:00:59.362 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175335577829380096[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 13:00:59.363 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175335577829380096[0;39m ==> Parameters: 175335577841963008(Long), spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 13:00:59.404 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175335577829380096[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy161.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 13:00:59.408 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175335577829380096[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 13:01:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335580652146688[0;39m 生成今日电子书快照开始
2022-04-29 13:01:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335580652146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335580652146688[0;39m ==> Parameters: 
2022-04-29 13:01:00.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335580652146688[0;39m <==    Updates: 0
2022-04-29 13:01:00.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335580652146688[0;39m 生成今日电子书快照结束，耗时：80毫秒
2022-04-29 13:01:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335601623666688[0;39m start updating Ebook doc
2022-04-29 13:01:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335601623666688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:01:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335601623666688[0;39m ==> Parameters: 
2022-04-29 13:01:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335601623666688[0;39m <==    Updates: 1
2022-04-29 13:01:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335601623666688[0;39m update ends, take 60 millisecs
2022-04-29 13:01:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335601879519232[0;39m 生成今日电子书快照开始
2022-04-29 13:01:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335601879519232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335601879519232[0;39m ==> Parameters: 
2022-04-29 13:01:05.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335601879519232[0;39m <==    Updates: 0
2022-04-29 13:01:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335601879519232[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 13:01:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335622595186688[0;39m 生成今日电子书快照开始
2022-04-29 13:01:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335622595186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335622595186688[0;39m ==> Parameters: 
2022-04-29 13:01:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335622595186688[0;39m <==    Updates: 0
2022-04-29 13:01:10.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335622595186688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:01:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335643562512384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335643562512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335643562512384[0;39m ==> Parameters: 
2022-04-29 13:01:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335643562512384[0;39m <==    Updates: 0
2022-04-29 13:01:15.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335643562512384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 13:01:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335664517255168[0;39m 生成今日电子书快照开始
2022-04-29 13:01:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335664517255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335664517255168[0;39m ==> Parameters: 
2022-04-29 13:01:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335664517255168[0;39m <==    Updates: 0
2022-04-29 13:01:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335664517255168[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 13:01:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335685501358080[0;39m 生成今日电子书快照开始
2022-04-29 13:01:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335685501358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335685501358080[0;39m ==> Parameters: 
2022-04-29 13:01:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335685501358080[0;39m <==    Updates: 0
2022-04-29 13:01:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335685501358080[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 13:01:25.491 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 13:01:25.492 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-29 13:01:25.494 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 13:01:25.494 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/user/list
2022-04-29 13:01:25.494 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175335514315034624
2022-04-29 13:01:25.660 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175335514315034624"}
2022-04-29 13:01:25.673 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335688311541760[0;39m ------------- 开始 -------------
2022-04-29 13:01:25.673 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335688311541760[0;39m 请求地址: http://127.0.0.1:8080/user/list GET
2022-04-29 13:01:25.674 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335688311541760[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.list
2022-04-29 13:01:25.674 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335688311541760[0;39m 远程地址: 127.0.0.1
2022-04-29 13:01:25.675 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335688311541760[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 13:01:25.690 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175335688311541760[0;39m ==>  Preparing: SELECT count(0) FROM user
2022-04-29 13:01:25.691 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175335688311541760[0;39m ==> Parameters: 
2022-04-29 13:01:25.709 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175335688311541760[0;39m <==    Columns: count(0)
2022-04-29 13:01:25.709 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175335688311541760[0;39m <==        Row: 2
2022-04-29 13:01:25.710 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175335688311541760[0;39m <==      Total: 1
2022-04-29 13:01:25.712 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335688311541760[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2022-04-29 13:01:25.713 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335688311541760[0;39m ==> Parameters: 10(Integer)
2022-04-29 13:01:25.729 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335688311541760[0;39m <==    Columns: id, login_name, name, password
2022-04-29 13:01:25.730 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335688311541760[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 13:01:25.732 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335688311541760[0;39m <==        Row: 175296442951405568, nongzexi, nongzexi, 4db71c791e6a5f87027698565abc76c8
2022-04-29 13:01:25.734 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335688311541760[0;39m <==      Total: 2
2022-04-29 13:01:25.735 INFO  com.ameliawiki.wiki.service.UserService           :49   [32m175335688311541760[0;39m 总行数：2
2022-04-29 13:01:25.735 INFO  com.ameliawiki.wiki.service.UserService           :50   [32m175335688311541760[0;39m 总页数：1
2022-04-29 13:01:25.740 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335688311541760[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test1","name":"test1"},{"id":175296442951405568,"loginName":"nongzexi","name":"nongzexi"}],"total":2},"success":true}
2022-04-29 13:01:25.741 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335688311541760[0;39m ------------- 结束 耗时：68 ms -------------
2022-04-29 13:01:25.743 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175335688311541760[0;39m ------------- LoginInterceptor 结束 耗时：249 ms -------------
2022-04-29 13:01:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335706477072384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335706477072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335706477072384[0;39m ==> Parameters: 
2022-04-29 13:01:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335706477072384[0;39m <==    Updates: 0
2022-04-29 13:01:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335706477072384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 13:01:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335727431815168[0;39m 生成今日电子书快照开始
2022-04-29 13:01:35.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335727431815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:35.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335727431815168[0;39m ==> Parameters: 
2022-04-29 13:01:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335727431815168[0;39m <==    Updates: 0
2022-04-29 13:01:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335727431815168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 13:01:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335727700250624[0;39m start updating Ebook doc
2022-04-29 13:01:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335727700250624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:01:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335727700250624[0;39m ==> Parameters: 
2022-04-29 13:01:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335727700250624[0;39m <==    Updates: 1
2022-04-29 13:01:35.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335727700250624[0;39m update ends, take 38 millisecs
2022-04-29 13:01:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335748407529472[0;39m 生成今日电子书快照开始
2022-04-29 13:01:40.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335748407529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335748407529472[0;39m ==> Parameters: 
2022-04-29 13:01:40.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335748407529472[0;39m <==    Updates: 0
2022-04-29 13:01:40.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335748407529472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 13:01:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335769374855168[0;39m 生成今日电子书快照开始
2022-04-29 13:01:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335769374855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335769374855168[0;39m ==> Parameters: 
2022-04-29 13:01:45.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335769374855168[0;39m <==    Updates: 0
2022-04-29 13:01:45.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335769374855168[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 13:01:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335790363152384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335790363152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335790363152384[0;39m ==> Parameters: 
2022-04-29 13:01:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335790363152384[0;39m <==    Updates: 0
2022-04-29 13:01:50.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335790363152384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 13:01:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335811334672384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335811334672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335811334672384[0;39m ==> Parameters: 
2022-04-29 13:01:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335811334672384[0;39m <==    Updates: 0
2022-04-29 13:01:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335811334672384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 13:02:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335832293609472[0;39m 生成今日电子书快照开始
2022-04-29 13:02:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335832293609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335832293609472[0;39m ==> Parameters: 
2022-04-29 13:02:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335832293609472[0;39m <==    Updates: 0
2022-04-29 13:02:00.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335832293609472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:02:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335853277712384[0;39m 生成今日电子书快照开始
2022-04-29 13:02:05.275 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335853277712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:05.276 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335853277712384[0;39m ==> Parameters: 
2022-04-29 13:02:05.312 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335853277712384[0;39m <==    Updates: 0
2022-04-29 13:02:05.312 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335853277712384[0;39m 生成今日电子书快照结束，耗时：308毫秒
2022-04-29 13:02:05.313 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335854573752320[0;39m start updating Ebook doc
2022-04-29 13:02:05.313 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335854573752320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:02:05.314 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335854573752320[0;39m ==> Parameters: 
2022-04-29 13:02:05.472 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335854573752320[0;39m <==    Updates: 1
2022-04-29 13:02:05.473 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335854573752320[0;39m update ends, take 160 millisecs
2022-04-29 13:02:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335874253426688[0;39m 生成今日电子书快照开始
2022-04-29 13:02:10.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335874253426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:10.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335874253426688[0;39m ==> Parameters: 
2022-04-29 13:02:10.147 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335874253426688[0;39m <==    Updates: 0
2022-04-29 13:02:10.147 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335874253426688[0;39m 生成今日电子书快照结束，耗时：142毫秒
2022-04-29 13:02:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335895220752384[0;39m 生成今日电子书快照开始
2022-04-29 13:02:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335895220752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335895220752384[0;39m ==> Parameters: 
2022-04-29 13:02:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335895220752384[0;39m <==    Updates: 0
2022-04-29 13:02:15.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335895220752384[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:02:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335916175495168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335916175495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335916175495168[0;39m ==> Parameters: 
2022-04-29 13:02:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335916175495168[0;39m <==    Updates: 0
2022-04-29 13:02:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335916175495168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:02:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335937151209472[0;39m 生成今日电子书快照开始
2022-04-29 13:02:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335937151209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335937151209472[0;39m ==> Parameters: 
2022-04-29 13:02:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335937151209472[0;39m <==    Updates: 0
2022-04-29 13:02:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335937151209472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 13:02:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335958131118080[0;39m 生成今日电子书快照开始
2022-04-29 13:02:30.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335958131118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:30.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335958131118080[0;39m ==> Parameters: 
2022-04-29 13:02:30.109 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335958131118080[0;39m <==    Updates: 0
2022-04-29 13:02:30.110 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335958131118080[0;39m 生成今日电子书快照结束，耗时：106毫秒
2022-04-29 13:02:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335979111026688[0;39m 生成今日电子书快照开始
2022-04-29 13:02:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335979111026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335979111026688[0;39m ==> Parameters: 
2022-04-29 13:02:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335979111026688[0;39m <==    Updates: 0
2022-04-29 13:02:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335979111026688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:02:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335979366879232[0;39m start updating Ebook doc
2022-04-29 13:02:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335979366879232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:02:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335979366879232[0;39m ==> Parameters: 
2022-04-29 13:02:35.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335979366879232[0;39m <==    Updates: 1
2022-04-29 13:02:35.111 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335979366879232[0;39m update ends, take 45 millisecs
2022-04-29 13:02:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336000065769472[0;39m 生成今日电子书快照开始
2022-04-29 13:02:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336000065769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336000065769472[0;39m ==> Parameters: 
2022-04-29 13:02:40.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336000065769472[0;39m <==    Updates: 0
2022-04-29 13:02:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336000065769472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 13:02:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336021033095168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336021033095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336021033095168[0;39m ==> Parameters: 
2022-04-29 13:02:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336021033095168[0;39m <==    Updates: 0
2022-04-29 13:02:45.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336021033095168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:02:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336042004615168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336042004615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336042004615168[0;39m ==> Parameters: 
2022-04-29 13:02:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336042004615168[0;39m <==    Updates: 0
2022-04-29 13:02:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336042004615168[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 13:02:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336062976135168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336062976135168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336062976135168[0;39m ==> Parameters: 
2022-04-29 13:02:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336062976135168[0;39m <==    Updates: 0
2022-04-29 13:02:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336062976135168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 13:03:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336083964432384[0;39m 生成今日电子书快照开始
2022-04-29 13:03:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336083964432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336083964432384[0;39m ==> Parameters: 
2022-04-29 13:03:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336083964432384[0;39m <==    Updates: 0
2022-04-29 13:03:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336083964432384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:03:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175336104923369472[0;39m start updating Ebook doc
2022-04-29 13:03:05.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336104923369472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:03:05.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336104923369472[0;39m ==> Parameters: 
2022-04-29 13:03:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336104923369472[0;39m <==    Updates: 1
2022-04-29 13:03:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175336104923369472[0;39m update ends, take 63 millisecs
2022-04-29 13:03:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336105191804928[0;39m 生成今日电子书快照开始
2022-04-29 13:03:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336105191804928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336105191804928[0;39m ==> Parameters: 
2022-04-29 13:03:05.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336105191804928[0;39m <==    Updates: 0
2022-04-29 13:03:05.107 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336105191804928[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-29 13:03:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336125903278080[0;39m 生成今日电子书快照开始
2022-04-29 13:03:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336125903278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336125903278080[0;39m ==> Parameters: 
2022-04-29 13:03:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336125903278080[0;39m <==    Updates: 0
2022-04-29 13:03:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336125903278080[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 13:03:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336146870603776[0;39m 生成今日电子书快照开始
2022-04-29 13:03:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336146870603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336146870603776[0;39m ==> Parameters: 
2022-04-29 13:03:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336146870603776[0;39m <==    Updates: 0
2022-04-29 13:03:15.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336146870603776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 13:03:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336167842123776[0;39m 生成今日电子书快照开始
2022-04-29 13:03:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336167842123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336167842123776[0;39m ==> Parameters: 
2022-04-29 13:03:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336167842123776[0;39m <==    Updates: 0
2022-04-29 13:03:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336167842123776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 13:03:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336188805255168[0;39m 生成今日电子书快照开始
2022-04-29 13:03:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336188805255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336188805255168[0;39m ==> Parameters: 
2022-04-29 13:03:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336188805255168[0;39m <==    Updates: 0
2022-04-29 13:03:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336188805255168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 13:03:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336209789358080[0;39m 生成今日电子书快照开始
2022-04-29 13:03:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336209789358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336209789358080[0;39m ==> Parameters: 
2022-04-29 13:03:30.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336209789358080[0;39m <==    Updates: 0
2022-04-29 13:03:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336209789358080[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 13:03:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336230765072384[0;39m 生成今日电子书快照开始
2022-04-29 13:03:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336230765072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336230765072384[0;39m ==> Parameters: 
2022-04-29 13:03:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336230765072384[0;39m <==    Updates: 0
2022-04-29 13:03:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336230765072384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:03:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175336231029313536[0;39m start updating Ebook doc
2022-04-29 13:03:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336231029313536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:03:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336231029313536[0;39m ==> Parameters: 
2022-04-29 13:03:35.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336231029313536[0;39m <==    Updates: 1
2022-04-29 13:03:35.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175336231029313536[0;39m update ends, take 38 millisecs
2022-04-29 13:03:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336251724009472[0;39m 生成今日电子书快照开始
2022-04-29 13:03:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336251724009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336251724009472[0;39m ==> Parameters: 
2022-04-29 13:03:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336251724009472[0;39m <==    Updates: 0
2022-04-29 13:03:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336251724009472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 13:03:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336272703918080[0;39m 生成今日电子书快照开始
2022-04-29 13:03:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336272703918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336272703918080[0;39m ==> Parameters: 
2022-04-29 13:03:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336272703918080[0;39m <==    Updates: 0
2022-04-29 13:03:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336272703918080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 13:03:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336293671243776[0;39m 生成今日电子书快照开始
2022-04-29 13:03:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336293671243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336293671243776[0;39m ==> Parameters: 
2022-04-29 13:03:50.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336293671243776[0;39m <==    Updates: 0
2022-04-29 13:03:50.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336293671243776[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 13:03:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336314638569472[0;39m 生成今日电子书快照开始
2022-04-29 13:03:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336314638569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336314638569472[0;39m ==> Parameters: 
2022-04-29 13:03:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336314638569472[0;39m <==    Updates: 0
2022-04-29 13:03:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336314638569472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 13:04:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336335618478080[0;39m 生成今日电子书快照开始
2022-04-29 13:04:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336335618478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:04:00.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336335618478080[0;39m ==> Parameters: 
2022-04-29 13:04:00.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336335618478080[0;39m <==    Updates: 0
2022-04-29 13:04:00.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336335618478080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 13:04:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336356585803776[0;39m 生成今日电子书快照开始
2022-04-29 13:04:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336356585803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:04:05.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336356585803776[0;39m ==> Parameters: 
2022-04-29 13:04:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336356585803776[0;39m <==    Updates: 0
2022-04-29 13:04:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336356585803776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 13:04:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175336356829073408[0;39m start updating Ebook doc
2022-04-29 13:04:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336356829073408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:04:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336356829073408[0;39m ==> Parameters: 
2022-04-29 13:04:05.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336356829073408[0;39m <==    Updates: 1
2022-04-29 13:04:05.098 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175336356829073408[0;39m update ends, take 38 millisecs
2022-04-29 13:04:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336377569906688[0;39m 生成今日电子书快照开始
2022-04-29 13:04:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336377569906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:04:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336377569906688[0;39m ==> Parameters: 
2022-04-29 13:04:10.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336377569906688[0;39m <==    Updates: 0
2022-04-29 13:04:10.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336377569906688[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 13:04:11.408 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：zdSkxDWUUv，session id：2！当前连接数：0
2022-04-29 13:04:11.458 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 13:04:11.459 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 13:04:11.462 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-3 - Shutdown initiated...
2022-04-29 13:04:11.466 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-3 - Shutdown completed.
2022-04-29 18:33:57.627 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-29 18:34:02.638 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5004 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 18:34:07.647 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 27548 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 18:34:07.649 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 18:34:07.724 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-29 18:34:07.725 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-29 18:34:08.406 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 18:34:08.409 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 18:34:08.435 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2022-04-29 18:34:09.123 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 18:34:09.138 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 18:34:09.140 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 18:34:09.140 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 18:34:09.231 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 18:34:09.231 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1506 ms
2022-04-29 18:34:10.373 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 18:34:10.870 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 18:34:10.938 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 18:34:10.975 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 18:34:11.004 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 18:34:11.019 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 23.925 seconds (JVM running for 24.528)
2022-04-29 18:34:11.022 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 18:34:11.022 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 18:34:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419445760626688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:15.036 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175419445760626688[0;39m HikariPool-1 - Starting...
2022-04-29 18:34:15.565 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175419445760626688[0;39m HikariPool-1 - Start completed.
2022-04-29 18:34:15.577 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419445760626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:15.600 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419445760626688[0;39m ==> Parameters: 
2022-04-29 18:34:15.640 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419445760626688[0;39m <==    Updates: 0
2022-04-29 18:34:15.642 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419445760626688[0;39m 生成今日电子书快照结束，耗时：635毫秒
2022-04-29 18:34:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419466723758080[0;39m 生成今日电子书快照开始
2022-04-29 18:34:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419466723758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419466723758080[0;39m ==> Parameters: 
2022-04-29 18:34:20.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419466723758080[0;39m <==    Updates: 0
2022-04-29 18:34:20.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419466723758080[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 18:34:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419487699472384[0;39m 生成今日电子书快照开始
2022-04-29 18:34:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419487699472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419487699472384[0;39m ==> Parameters: 
2022-04-29 18:34:25.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419487699472384[0;39m <==    Updates: 0
2022-04-29 18:34:25.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419487699472384[0;39m 生成今日电子书快照结束，耗时：94毫秒
2022-04-29 18:34:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419508675186688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419508675186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419508675186688[0;39m ==> Parameters: 
2022-04-29 18:34:30.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419508675186688[0;39m <==    Updates: 0
2022-04-29 18:34:30.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419508675186688[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 18:34:33.826 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 18:34:33.827 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 18:34:33.829 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 2 ms
2022-04-29 18:34:33.894 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：T9nhVIXu7P，session id：0，当前连接数：1
2022-04-29 18:34:33.895 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419524982640642[0;39m ------------- 开始 -------------
2022-04-29 18:34:33.895 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419524982640640[0;39m ------------- 开始 -------------
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419524982640641[0;39m ------------- 开始 -------------
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419524982640640[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419524982640641[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419524982640642[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419524982640641[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419524982640642[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419524982640641[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419524982640642[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419524982640640[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 18:34:33.898 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419524982640640[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:33.964 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419524982640642[0;39m 请求参数: []
2022-04-29 18:34:33.964 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419524982640640[0;39m 请求参数: []
2022-04-29 18:34:33.964 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419524982640641[0;39m 请求参数: []
2022-04-29 18:34:34.001 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175419524982640640[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 18:34:34.002 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175419524982640640[0;39m ==> Parameters: 
2022-04-29 18:34:34.007 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419524982640641[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:34:34.007 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175419524982640642[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 18:34:34.008 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419524982640641[0;39m ==> Parameters: 
2022-04-29 18:34:34.008 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175419524982640642[0;39m ==> Parameters: 
2022-04-29 18:34:34.044 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:34:34.044 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 18:34:34.044 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175419524982640640[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 18:34:34.044 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:34:34.045 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 18:34:34.045 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175419524982640640[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 18:34:34.046 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:34:34.046 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:34:34.047 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 18:34:34.047 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175419524982640640[0;39m <==        Row: 2022-04-29, 1764, 63, 29, 2
2022-04-29 18:34:34.047 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:34:34.047 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 18:34:34.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175419524982640640[0;39m <==      Total: 2
2022-04-29 18:34:34.048 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:34:34.048 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 18:34:34.048 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:34:34.048 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 18:34:34.049 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:34:34.049 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 18:34:34.049 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:34:34.049 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 18:34:34.050 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:34:34.050 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 18:34:34.050 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:34:34.050 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 18:34:34.050 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:34:34.051 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 18:34:34.051 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:34:34.051 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 18:34:34.051 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:34:34.052 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 18:34:34.052 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:34:34.052 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:34:34.052 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 18:34:34.053 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175419524982640642[0;39m <==      Total: 13
2022-04-29 18:34:34.053 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:34:34.054 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:34:34.054 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:34:34.055 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419524982640641[0;39m <==      Total: 18
2022-04-29 18:34:34.072 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419524982640641[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:34:34.072 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419524982640641[0;39m ------------- 结束 耗时：179 ms -------------
2022-04-29 18:34:34.073 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419524982640640[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1764,"viewIncrease":29,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 18:34:34.073 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419524982640640[0;39m ------------- 结束 耗时：180 ms -------------
2022-04-29 18:34:34.073 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419524982640642[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 18:34:34.074 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419524982640642[0;39m ------------- 结束 耗时：181 ms -------------
2022-04-29 18:34:35.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419529650900992[0;39m 生成今日电子书快照开始
2022-04-29 18:34:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419529650900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419529650900992[0;39m ==> Parameters: 
2022-04-29 18:34:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419529650900992[0;39m <==    Updates: 0
2022-04-29 18:34:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419529650900992[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:34:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419529902559232[0;39m start updating Ebook doc
2022-04-29 18:34:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419529902559232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:34:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419529902559232[0;39m ==> Parameters: 
2022-04-29 18:34:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419529902559232[0;39m <==    Updates: 1
2022-04-29 18:34:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419529902559232[0;39m update ends, take 42 millisecs
2022-04-29 18:34:37.528 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419540228935680[0;39m ------------- 开始 -------------
2022-04-29 18:34:37.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419540228935680[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-29 18:34:37.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419540228935680[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-29 18:34:37.530 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419540228935680[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:37.532 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419540228935680[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-29 18:34:37.576 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175419540228935680[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-29 18:34:37.578 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175419540228935680[0;39m ==> Parameters: test1(String)
2022-04-29 18:34:37.598 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175419540228935680[0;39m <==    Columns: id, login_name, name, password
2022-04-29 18:34:37.598 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175419540228935680[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 18:34:37.599 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175419540228935680[0;39m <==      Total: 1
2022-04-29 18:34:37.602 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175419540228935680[0;39m generate single sign-on token：175419540539314176，and put it into redis
2022-04-29 18:34:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419550618226688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419550618226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419550618226688[0;39m ==> Parameters: 
2022-04-29 18:34:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419550618226688[0;39m <==    Updates: 0
2022-04-29 18:34:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419550618226688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:34:43.853 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419540228935680[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"},"success":true}
2022-04-29 18:34:43.854 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419540228935680[0;39m ------------- 结束 耗时：6326 ms -------------
2022-04-29 18:34:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419571589746688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419571589746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419571589746688[0;39m ==> Parameters: 
2022-04-29 18:34:45.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419571589746688[0;39m <==    Updates: 0
2022-04-29 18:34:45.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419571589746688[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 18:34:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419592552878080[0;39m 生成今日电子书快照开始
2022-04-29 18:34:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419592552878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419592552878080[0;39m ==> Parameters: 
2022-04-29 18:34:50.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419592552878080[0;39m <==    Updates: 0
2022-04-29 18:34:50.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419592552878080[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:34:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419613516009472[0;39m 生成今日电子书快照开始
2022-04-29 18:34:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419613516009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419613516009472[0;39m ==> Parameters: 
2022-04-29 18:34:55.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419613516009472[0;39m <==    Updates: 0
2022-04-29 18:34:55.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419613516009472[0;39m 生成今日电子书快照结束，耗时：107毫秒
2022-04-29 18:34:55.996 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419617689341952[0;39m ------------- 开始 -------------
2022-04-29 18:34:55.996 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419617689341952[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:34:55.997 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419617689341952[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:34:55.997 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419617689341952[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:55.997 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419617689341952[0;39m 请求参数: []
2022-04-29 18:34:56.013 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419617689341952[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:34:56.013 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419617689341952[0;39m ==> Parameters: 
2022-04-29 18:34:56.034 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:34:56.034 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:34:56.035 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:34:56.036 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:34:56.036 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:34:56.036 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:34:56.037 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:34:56.037 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:34:56.038 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:34:56.038 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:34:56.038 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:34:56.039 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:34:56.039 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:34:56.039 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:34:56.041 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:34:56.041 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419617689341952[0;39m <==      Total: 18
2022-04-29 18:34:56.042 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419617689341952[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:34:56.043 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419617689341952[0;39m ------------- 结束 耗时：47 ms -------------
2022-04-29 18:34:56.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419618020691968[0;39m ------------- 开始 -------------
2022-04-29 18:34:56.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419618020691968[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:34:56.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419618020691968[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:34:56.076 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419618020691968[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:56.078 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419618020691968[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:34:56.109 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175419618020691968[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:34:56.110 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175419618020691968[0;39m ==> Parameters: 
2022-04-29 18:34:56.124 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175419618020691968[0;39m <==    Columns: count(0)
2022-04-29 18:34:56.125 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175419618020691968[0;39m <==        Row: 5
2022-04-29 18:34:56.126 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175419618020691968[0;39m <==      Total: 1
2022-04-29 18:34:56.129 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175419618020691968[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:34:56.130 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175419618020691968[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:34:56.146 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:34:56.147 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:34:56.148 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:34:56.148 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:34:56.149 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:34:56.149 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:34:56.150 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175419618020691968[0;39m <==      Total: 5
2022-04-29 18:34:56.152 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175419618020691968[0;39m total rows：5
2022-04-29 18:34:56.153 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175419618020691968[0;39m total pages：1
2022-04-29 18:34:56.165 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419618020691968[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 18:34:56.165 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419618020691968[0;39m ------------- 结束 耗时：90 ms -------------
2022-04-29 18:35:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419634491723776[0;39m 生成今日电子书快照开始
2022-04-29 18:35:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419634491723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419634491723776[0;39m ==> Parameters: 
2022-04-29 18:35:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419634491723776[0;39m <==    Updates: 0
2022-04-29 18:35:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419634491723776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:35:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419655463243776[0;39m 生成今日电子书快照开始
2022-04-29 18:35:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419655463243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419655463243776[0;39m ==> Parameters: 
2022-04-29 18:35:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419655463243776[0;39m <==    Updates: 0
2022-04-29 18:35:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419655463243776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:35:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419655752650752[0;39m start updating Ebook doc
2022-04-29 18:35:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419655752650752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:35:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419655752650752[0;39m ==> Parameters: 
2022-04-29 18:35:05.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419655752650752[0;39m <==    Updates: 1
2022-04-29 18:35:05.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419655752650752[0;39m update ends, take 38 millisecs
2022-04-29 18:35:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419676443152384[0;39m 生成今日电子书快照开始
2022-04-29 18:35:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419676443152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419676443152384[0;39m ==> Parameters: 
2022-04-29 18:35:10.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419676443152384[0;39m <==    Updates: 0
2022-04-29 18:35:10.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419676443152384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:35:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419697410478080[0;39m 生成今日电子书快照开始
2022-04-29 18:35:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419697410478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419697410478080[0;39m ==> Parameters: 
2022-04-29 18:35:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419697410478080[0;39m <==    Updates: 0
2022-04-29 18:35:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419697410478080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:35:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419718390386688[0;39m 生成今日电子书快照开始
2022-04-29 18:35:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419718390386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419718390386688[0;39m ==> Parameters: 
2022-04-29 18:35:20.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419718390386688[0;39m <==    Updates: 0
2022-04-29 18:35:20.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419718390386688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419739340935168[0;39m 生成今日电子书快照开始
2022-04-29 18:35:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419739340935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:25.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419739340935168[0;39m ==> Parameters: 
2022-04-29 18:35:25.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419739340935168[0;39m <==    Updates: 0
2022-04-29 18:35:25.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419739340935168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:35:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419760329232384[0;39m 生成今日电子书快照开始
2022-04-29 18:35:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419760329232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419760329232384[0;39m ==> Parameters: 
2022-04-29 18:35:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419760329232384[0;39m <==    Updates: 0
2022-04-29 18:35:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419760329232384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419781292363776[0;39m 生成今日电子书快照开始
2022-04-29 18:35:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419781292363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419781292363776[0;39m ==> Parameters: 
2022-04-29 18:35:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419781292363776[0;39m <==    Updates: 0
2022-04-29 18:35:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419781292363776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:35:35.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419781544022016[0;39m start updating Ebook doc
2022-04-29 18:35:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419781544022016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:35:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419781544022016[0;39m ==> Parameters: 
2022-04-29 18:35:35.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419781544022016[0;39m <==    Updates: 1
2022-04-29 18:35:35.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419781544022016[0;39m update ends, take 36 millisecs
2022-04-29 18:35:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419802276466688[0;39m 生成今日电子书快照开始
2022-04-29 18:35:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419802276466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419802276466688[0;39m ==> Parameters: 
2022-04-29 18:35:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419802276466688[0;39m <==    Updates: 0
2022-04-29 18:35:40.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419802276466688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:35:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419823243792384[0;39m 生成今日电子书快照开始
2022-04-29 18:35:45.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419823243792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419823243792384[0;39m ==> Parameters: 
2022-04-29 18:35:45.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419823243792384[0;39m <==    Updates: 0
2022-04-29 18:35:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419823243792384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419844219506688[0;39m 生成今日电子书快照开始
2022-04-29 18:35:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419844219506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419844219506688[0;39m ==> Parameters: 
2022-04-29 18:35:50.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419844219506688[0;39m <==    Updates: 0
2022-04-29 18:35:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419844219506688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:35:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419865182638080[0;39m 生成今日电子书快照开始
2022-04-29 18:35:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419865182638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419865182638080[0;39m ==> Parameters: 
2022-04-29 18:35:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419865182638080[0;39m <==    Updates: 0
2022-04-29 18:35:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419865182638080[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:59.478 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175419524982640640[0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:35:59.479 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175419524982640640[0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-29 18:35:59.483 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:35:59.483 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:35:59.483 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:35:59.654 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:35:59.664 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419884732289024[0;39m ------------- 开始 -------------
2022-04-29 18:35:59.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419884732289024[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:35:59.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419884732289024[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:35:59.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419884732289024[0;39m 远程地址: 127.0.0.1
2022-04-29 18:35:59.667 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419884732289024[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"cover":"1","description":"1","name":"1"}]
2022-04-29 18:35:59.692 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175419884732289024[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:35:59.693 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175419884732289024[0;39m ==> Parameters: 175419884757454848(Long), 1(String), 200(Long), 202(Long), 1(String), 1(String), null, null, null
2022-04-29 18:35:59.942 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175419884732289024[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$2fe88302.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor89.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 18:35:59.946 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175419884732289024[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 18:36:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419886158352384[0;39m 生成今日电子书快照开始
2022-04-29 18:36:00.005 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419886158352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:00.005 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419886158352384[0;39m ==> Parameters: 
2022-04-29 18:36:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419886158352384[0;39m <==    Updates: 0
2022-04-29 18:36:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419886158352384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:36:05.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419907113095168[0;39m 生成今日电子书快照开始
2022-04-29 18:36:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419907113095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419907113095168[0;39m ==> Parameters: 
2022-04-29 18:36:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419907113095168[0;39m <==    Updates: 0
2022-04-29 18:36:05.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419907113095168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:36:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419907410890752[0;39m start updating Ebook doc
2022-04-29 18:36:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419907410890752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:36:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419907410890752[0;39m ==> Parameters: 
2022-04-29 18:36:05.115 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419907410890752[0;39m <==    Updates: 1
2022-04-29 18:36:05.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419907410890752[0;39m update ends, take 43 millisecs
2022-04-29 18:36:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419928105586688[0;39m 生成今日电子书快照开始
2022-04-29 18:36:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419928105586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419928105586688[0;39m ==> Parameters: 
2022-04-29 18:36:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419928105586688[0;39m <==    Updates: 0
2022-04-29 18:36:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419928105586688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:36:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419949068718080[0;39m 生成今日电子书快照开始
2022-04-29 18:36:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419949068718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419949068718080[0;39m ==> Parameters: 
2022-04-29 18:36:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419949068718080[0;39m <==    Updates: 0
2022-04-29 18:36:15.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419949068718080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:36:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419970027655168[0;39m 生成今日电子书快照开始
2022-04-29 18:36:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419970027655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419970027655168[0;39m ==> Parameters: 
2022-04-29 18:36:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419970027655168[0;39m <==    Updates: 0
2022-04-29 18:36:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419970027655168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:36:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419991011758080[0;39m 生成今日电子书快照开始
2022-04-29 18:36:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419991011758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419991011758080[0;39m ==> Parameters: 
2022-04-29 18:36:25.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419991011758080[0;39m <==    Updates: 0
2022-04-29 18:36:25.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419991011758080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 18:36:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420011987472384[0;39m 生成今日电子书快照开始
2022-04-29 18:36:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420011987472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420011987472384[0;39m ==> Parameters: 
2022-04-29 18:36:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420011987472384[0;39m <==    Updates: 0
2022-04-29 18:36:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420011987472384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:36:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420032950603776[0;39m 生成今日电子书快照开始
2022-04-29 18:36:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420032950603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420032950603776[0;39m ==> Parameters: 
2022-04-29 18:36:35.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420032950603776[0;39m <==    Updates: 0
2022-04-29 18:36:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420032950603776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:36:35.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420033231622144[0;39m start updating Ebook doc
2022-04-29 18:36:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420033231622144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:36:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420033231622144[0;39m ==> Parameters: 
2022-04-29 18:36:35.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420033231622144[0;39m <==    Updates: 1
2022-04-29 18:36:35.121 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420033231622144[0;39m update ends, take 51 millisecs
2022-04-29 18:36:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420053938900992[0;39m 生成今日电子书快照开始
2022-04-29 18:36:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420053938900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420053938900992[0;39m ==> Parameters: 
2022-04-29 18:36:40.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420053938900992[0;39m <==    Updates: 0
2022-04-29 18:36:40.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420053938900992[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 18:36:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420074889449472[0;39m 生成今日电子书快照开始
2022-04-29 18:36:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420074889449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420074889449472[0;39m ==> Parameters: 
2022-04-29 18:36:45.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420074889449472[0;39m <==    Updates: 0
2022-04-29 18:36:45.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420074889449472[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 18:36:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420095869358080[0;39m 生成今日电子书快照开始
2022-04-29 18:36:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420095869358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420095869358080[0;39m ==> Parameters: 
2022-04-29 18:36:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420095869358080[0;39m <==    Updates: 0
2022-04-29 18:36:50.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420095869358080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:36:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420116845072384[0;39m 生成今日电子书快照开始
2022-04-29 18:36:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420116845072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420116845072384[0;39m ==> Parameters: 
2022-04-29 18:36:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420116845072384[0;39m <==    Updates: 0
2022-04-29 18:36:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420116845072384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:37:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420137808203776[0;39m 生成今日电子书快照开始
2022-04-29 18:37:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420137808203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420137808203776[0;39m ==> Parameters: 
2022-04-29 18:37:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420137808203776[0;39m <==    Updates: 0
2022-04-29 18:37:00.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420137808203776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:37:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420158788112384[0;39m start updating Ebook doc
2022-04-29 18:37:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420158788112384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:37:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420158788112384[0;39m ==> Parameters: 
2022-04-29 18:37:05.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420158788112384[0;39m <==    Updates: 1
2022-04-29 18:37:05.074 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420158788112384[0;39m update ends, take 59 millisecs
2022-04-29 18:37:05.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420159085907968[0;39m 生成今日电子书快照开始
2022-04-29 18:37:05.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420159085907968[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:05.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420159085907968[0;39m ==> Parameters: 
2022-04-29 18:37:05.114 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420159085907968[0;39m <==    Updates: 0
2022-04-29 18:37:05.115 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420159085907968[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 18:37:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420179751243776[0;39m 生成今日电子书快照开始
2022-04-29 18:37:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420179751243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420179751243776[0;39m ==> Parameters: 
2022-04-29 18:37:10.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420179751243776[0;39m <==    Updates: 0
2022-04-29 18:37:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420179751243776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:37:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420200735346688[0;39m 生成今日电子书快照开始
2022-04-29 18:37:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420200735346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420200735346688[0;39m ==> Parameters: 
2022-04-29 18:37:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420200735346688[0;39m <==    Updates: 0
2022-04-29 18:37:15.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420200735346688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:37:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420221706866688[0;39m 生成今日电子书快照开始
2022-04-29 18:37:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420221706866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420221706866688[0;39m ==> Parameters: 
2022-04-29 18:37:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420221706866688[0;39m <==    Updates: 0
2022-04-29 18:37:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420221706866688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:37:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420242661609472[0;39m 生成今日电子书快照开始
2022-04-29 18:37:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420242661609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420242661609472[0;39m ==> Parameters: 
2022-04-29 18:37:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420242661609472[0;39m <==    Updates: 0
2022-04-29 18:37:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420242661609472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:37:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420263633129472[0;39m 生成今日电子书快照开始
2022-04-29 18:37:30.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420263633129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420263633129472[0;39m ==> Parameters: 
2022-04-29 18:37:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420263633129472[0;39m <==    Updates: 0
2022-04-29 18:37:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420263633129472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:37:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420284604649472[0;39m start updating Ebook doc
2022-04-29 18:37:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420284604649472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:37:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420284604649472[0;39m ==> Parameters: 
2022-04-29 18:37:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420284604649472[0;39m <==    Updates: 1
2022-04-29 18:37:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420284604649472[0;39m update ends, take 61 millisecs
2022-04-29 18:37:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420284873084928[0;39m 生成今日电子书快照开始
2022-04-29 18:37:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420284873084928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420284873084928[0;39m ==> Parameters: 
2022-04-29 18:37:35.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420284873084928[0;39m <==    Updates: 0
2022-04-29 18:37:35.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420284873084928[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-29 18:37:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420305571975168[0;39m 生成今日电子书快照开始
2022-04-29 18:37:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420305571975168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420305571975168[0;39m ==> Parameters: 
2022-04-29 18:37:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420305571975168[0;39m <==    Updates: 0
2022-04-29 18:37:40.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420305571975168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:37:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420326560272384[0;39m 生成今日电子书快照开始
2022-04-29 18:37:45.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420326560272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420326560272384[0;39m ==> Parameters: 
2022-04-29 18:37:45.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420326560272384[0;39m <==    Updates: 0
2022-04-29 18:37:45.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420326560272384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:37:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420347519209472[0;39m 生成今日电子书快照开始
2022-04-29 18:37:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420347519209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420347519209472[0;39m ==> Parameters: 
2022-04-29 18:37:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420347519209472[0;39m <==    Updates: 0
2022-04-29 18:37:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420347519209472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:37:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420368494923776[0;39m 生成今日电子书快照开始
2022-04-29 18:37:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420368494923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420368494923776[0;39m ==> Parameters: 
2022-04-29 18:37:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420368494923776[0;39m <==    Updates: 0
2022-04-29 18:37:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420368494923776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:38:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420389466443776[0;39m 生成今日电子书快照开始
2022-04-29 18:38:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420389466443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420389466443776[0;39m ==> Parameters: 
2022-04-29 18:38:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420389466443776[0;39m <==    Updates: 0
2022-04-29 18:38:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420389466443776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:38:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420410450546688[0;39m start updating Ebook doc
2022-04-29 18:38:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420410450546688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:38:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420410450546688[0;39m ==> Parameters: 
2022-04-29 18:38:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420410450546688[0;39m <==    Updates: 1
2022-04-29 18:38:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420410450546688[0;39m update ends, take 51 millisecs
2022-04-29 18:38:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420410677039104[0;39m 生成今日电子书快照开始
2022-04-29 18:38:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420410677039104[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420410677039104[0;39m ==> Parameters: 
2022-04-29 18:38:05.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420410677039104[0;39m <==    Updates: 0
2022-04-29 18:38:05.096 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420410677039104[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-29 18:38:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420431413678080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420431413678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420431413678080[0;39m ==> Parameters: 
2022-04-29 18:38:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420431413678080[0;39m <==    Updates: 0
2022-04-29 18:38:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420431413678080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:38:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420452385198080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420452385198080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420452385198080[0;39m ==> Parameters: 
2022-04-29 18:38:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420452385198080[0;39m <==    Updates: 0
2022-04-29 18:38:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420452385198080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:38:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420473356718080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420473356718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420473356718080[0;39m ==> Parameters: 
2022-04-29 18:38:20.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420473356718080[0;39m <==    Updates: 0
2022-04-29 18:38:20.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420473356718080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:38:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420494328238080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420494328238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420494328238080[0;39m ==> Parameters: 
2022-04-29 18:38:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420494328238080[0;39m <==    Updates: 0
2022-04-29 18:38:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420494328238080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:38:28.019 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：T9nhVIXu7P，session id：0！当前连接数：0
2022-04-29 18:38:28.063 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 18:38:28.065 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 18:38:28.069 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-29 18:38:28.089 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-29 18:38:47.241 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-29 18:38:52.254 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5004 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 18:38:57.258 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 27737 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 18:38:57.259 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 18:38:57.301 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-29 18:38:57.302 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-29 18:38:57.909 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 18:38:57.911 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 18:38:57.929 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2022-04-29 18:38:58.606 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 18:38:58.614 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 18:38:58.615 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 18:38:58.615 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 18:38:58.686 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 18:38:58.687 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1385 ms
2022-04-29 18:38:59.749 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 18:39:00.124 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 18:39:00.185 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 18:39:00.206 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 18:39:00.231 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 18:39:00.248 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 23.531 seconds (JVM running for 25.487)
2022-04-29 18:39:00.252 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 18:39:00.253 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 18:39:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420662104592384[0;39m start updating Ebook doc
2022-04-29 18:39:05.027 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175420662104592384[0;39m HikariPool-1 - Starting...
2022-04-29 18:39:05.444 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175420662104592384[0;39m HikariPool-1 - Start completed.
2022-04-29 18:39:05.452 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420662104592384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:39:05.474 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420662104592384[0;39m ==> Parameters: 
2022-04-29 18:39:05.511 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420662104592384[0;39m <==    Updates: 1
2022-04-29 18:39:05.513 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420662104592384[0;39m update ends, take 508 millisecs
2022-04-29 18:39:05.514 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420664239493120[0;39m 生成今日电子书快照开始
2022-04-29 18:39:05.514 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420664239493120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:05.515 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420664239493120[0;39m ==> Parameters: 
2022-04-29 18:39:05.560 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420664239493120[0;39m <==    Updates: 0
2022-04-29 18:39:05.561 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420664239493120[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-29 18:39:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420683076112384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420683076112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420683076112384[0;39m ==> Parameters: 
2022-04-29 18:39:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420683076112384[0;39m <==    Updates: 0
2022-04-29 18:39:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420683076112384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:39:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420704047632384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420704047632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420704047632384[0;39m ==> Parameters: 
2022-04-29 18:39:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420704047632384[0;39m <==    Updates: 0
2022-04-29 18:39:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420704047632384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:39:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420725019152384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420725019152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420725019152384[0;39m ==> Parameters: 
2022-04-29 18:39:20.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420725019152384[0;39m <==    Updates: 0
2022-04-29 18:39:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420725019152384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:39:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420745990672384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420745990672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420745990672384[0;39m ==> Parameters: 
2022-04-29 18:39:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420745990672384[0;39m <==    Updates: 0
2022-04-29 18:39:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420745990672384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:39:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420766962192384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420766962192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420766962192384[0;39m ==> Parameters: 
2022-04-29 18:39:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420766962192384[0;39m <==    Updates: 0
2022-04-29 18:39:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420766962192384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:39:31.244 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 18:39:31.245 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 18:39:31.249 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 4 ms
2022-04-29 18:39:31.282 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:39:31.283 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:39:31.283 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:39:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420787933712384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420787933712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420787933712384[0;39m ==> Parameters: 
2022-04-29 18:39:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420787933712384[0;39m <==    Updates: 0
2022-04-29 18:39:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420787933712384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:39:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420788197953536[0;39m start updating Ebook doc
2022-04-29 18:39:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420788197953536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:39:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420788197953536[0;39m ==> Parameters: 
2022-04-29 18:39:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420788197953536[0;39m <==    Updates: 1
2022-04-29 18:39:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420788197953536[0;39m update ends, take 41 millisecs
2022-04-29 18:39:37.613 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175420799459659776[0;39m ------------- 开始 -------------
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175420799459659776[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175420799459659776[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175420799459659776[0;39m 远程地址: 127.0.0.1
2022-04-29 18:39:37.817 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175420799459659776[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"cover":"1","description":"1","name":"1"}]
2022-04-29 18:41:11.968 WARN  com.zaxxer.hikari.pool.HikariPool                 :787  [32m                  [0;39m HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m36s420ms).
2022-04-29 18:41:11.967 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421194621816832[0;39m 生成今日电子书快照开始
2022-04-29 18:42:13.507 WARN  com.zaxxer.hikari.pool.HikariPool                 :787  [32m                  [0;39m HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m1s540ms).
2022-04-29 18:43:03.311 WARN  com.zaxxer.hikari.pool.HikariPool                 :787  [32m                  [0;39m HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=49s805ms).
2022-04-29 18:43:03.312 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421194621816832[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:16.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421194621816832[0;39m ==> Parameters: 
2022-04-29 18:43:16.136 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421194621816832[0;39m <==    Updates: 0
2022-04-29 18:43:16.137 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421194621816832[0;39m 生成今日电子书快照结束，耗时：124164毫秒
2022-04-29 18:43:16.138 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175421715436933120[0;39m start updating Ebook doc
2022-04-29 18:43:16.137 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175420799459659776[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:43:16.138 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421715436933120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:43:16.139 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421715436933120[0;39m ==> Parameters: 
2022-04-29 18:43:16.151 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175420799459659776[0;39m ==> Parameters: 175421452743479296(Long), 1(String), 200(Long), 202(Long), 1(String), 1(String), null, null, null
2022-04-29 18:43:16.174 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421715436933120[0;39m <==    Updates: 1
2022-04-29 18:43:16.175 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175421715436933120[0;39m update ends, take 37 millisecs
2022-04-29 18:43:20.773 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421734877532160[0;39m 生成今日电子书快照开始
2022-04-29 18:43:47.667 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421734877532160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:47.671 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421734877532160[0;39m ==> Parameters: 
2022-04-29 18:43:47.680 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175420799459659776[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$98bbfea7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 18:43:47.710 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421734877532160[0;39m <==    Updates: 0
2022-04-29 18:43:47.710 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421734877532160[0;39m 生成今日电子书快照结束，耗时：21422毫秒
2022-04-29 18:43:47.711 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175421847863693312[0;39m start updating Ebook doc
2022-04-29 18:43:47.712 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421847863693312[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:43:47.712 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421847863693312[0;39m ==> Parameters: 
2022-04-29 18:43:47.730 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175420799459659776[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 18:43:47.751 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421847863693312[0;39m <==    Updates: 1
2022-04-29 18:43:47.752 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175421847863693312[0;39m update ends, take 41 millisecs
2022-04-29 18:43:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421857485426688[0;39m 生成今日电子书快照开始
2022-04-29 18:43:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421857485426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:50.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421857485426688[0;39m ==> Parameters: 
2022-04-29 18:43:50.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421857485426688[0;39m <==    Updates: 0
2022-04-29 18:43:50.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421857485426688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:43:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421878477918208[0;39m 生成今日电子书快照开始
2022-04-29 18:43:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421878477918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:55.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421878477918208[0;39m ==> Parameters: 
2022-04-29 18:43:55.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421878477918208[0;39m <==    Updates: 0
2022-04-29 18:43:55.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421878477918208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:44:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421899407495168[0;39m 生成今日电子书快照开始
2022-04-29 18:44:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421899407495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421899407495168[0;39m ==> Parameters: 
2022-04-29 18:44:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421899407495168[0;39m <==    Updates: 0
2022-04-29 18:44:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421899407495168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:44:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175421920404180992[0;39m start updating Ebook doc
2022-04-29 18:44:05.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421920404180992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:44:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421920404180992[0;39m ==> Parameters: 
2022-04-29 18:44:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421920404180992[0;39m <==    Updates: 1
2022-04-29 18:44:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175421920404180992[0;39m update ends, take 52 millisecs
2022-04-29 18:44:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421920626479104[0;39m 生成今日电子书快照开始
2022-04-29 18:44:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421920626479104[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421920626479104[0;39m ==> Parameters: 
2022-04-29 18:44:05.097 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421920626479104[0;39m <==    Updates: 0
2022-04-29 18:44:05.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421920626479104[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-29 18:44:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421941375700992[0;39m 生成今日电子书快照开始
2022-04-29 18:44:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421941375700992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421941375700992[0;39m ==> Parameters: 
2022-04-29 18:44:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421941375700992[0;39m <==    Updates: 0
2022-04-29 18:44:10.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421941375700992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:44:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421962334638080[0;39m 生成今日电子书快照开始
2022-04-29 18:44:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421962334638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421962334638080[0;39m ==> Parameters: 
2022-04-29 18:44:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421962334638080[0;39m <==    Updates: 0
2022-04-29 18:44:15.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421962334638080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:44:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421983335518208[0;39m 生成今日电子书快照开始
2022-04-29 18:44:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421983335518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421983335518208[0;39m ==> Parameters: 
2022-04-29 18:44:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421983335518208[0;39m <==    Updates: 0
2022-04-29 18:44:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421983335518208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:44:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422004269289472[0;39m 生成今日电子书快照开始
2022-04-29 18:44:25.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422004269289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:25.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422004269289472[0;39m ==> Parameters: 
2022-04-29 18:44:25.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422004269289472[0;39m <==    Updates: 0
2022-04-29 18:44:25.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422004269289472[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 18:44:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422025270169600[0;39m 生成今日电子书快照开始
2022-04-29 18:44:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422025270169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422025270169600[0;39m ==> Parameters: 
2022-04-29 18:44:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422025270169600[0;39m <==    Updates: 0
2022-04-29 18:44:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422025270169600[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:44:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422046245883904[0;39m 生成今日电子书快照开始
2022-04-29 18:44:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422046245883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422046245883904[0;39m ==> Parameters: 
2022-04-29 18:44:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422046245883904[0;39m <==    Updates: 0
2022-04-29 18:44:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422046245883904[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:44:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422046484959232[0;39m start updating Ebook doc
2022-04-29 18:44:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422046484959232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:44:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422046484959232[0;39m ==> Parameters: 
2022-04-29 18:44:35.117 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422046484959232[0;39m <==    Updates: 1
2022-04-29 18:44:35.118 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422046484959232[0;39m update ends, take 51 millisecs
2022-04-29 18:44:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422067213209600[0;39m 生成今日电子书快照开始
2022-04-29 18:44:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422067213209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422067213209600[0;39m ==> Parameters: 
2022-04-29 18:44:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422067213209600[0;39m <==    Updates: 0
2022-04-29 18:44:40.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422067213209600[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:44:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422088180535296[0;39m 生成今日电子书快照开始
2022-04-29 18:44:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422088180535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:45.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422088180535296[0;39m ==> Parameters: 
2022-04-29 18:44:45.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422088180535296[0;39m <==    Updates: 0
2022-04-29 18:44:45.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422088180535296[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:44:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422109147860992[0;39m 生成今日电子书快照开始
2022-04-29 18:44:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422109147860992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422109147860992[0;39m ==> Parameters: 
2022-04-29 18:44:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422109147860992[0;39m <==    Updates: 0
2022-04-29 18:44:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422109147860992[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:44:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422130127769600[0;39m 生成今日电子书快照开始
2022-04-29 18:44:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422130127769600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422130127769600[0;39m ==> Parameters: 
2022-04-29 18:44:55.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422130127769600[0;39m <==    Updates: 0
2022-04-29 18:44:55.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422130127769600[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:45:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422151074123776[0;39m 生成今日电子书快照开始
2022-04-29 18:45:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422151074123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422151074123776[0;39m ==> Parameters: 
2022-04-29 18:45:00.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422151074123776[0;39m <==    Updates: 0
2022-04-29 18:45:00.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422151074123776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:45:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422172062420992[0;39m start updating Ebook doc
2022-04-29 18:45:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422172062420992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:45:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422172062420992[0;39m ==> Parameters: 
2022-04-29 18:45:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422172062420992[0;39m <==    Updates: 1
2022-04-29 18:45:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422172062420992[0;39m update ends, take 59 millisecs
2022-04-29 18:45:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422172318273536[0;39m 生成今日电子书快照开始
2022-04-29 18:45:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422172318273536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422172318273536[0;39m ==> Parameters: 
2022-04-29 18:45:05.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422172318273536[0;39m <==    Updates: 0
2022-04-29 18:45:05.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422172318273536[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:45:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422193033940992[0;39m 生成今日电子书快照开始
2022-04-29 18:45:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422193033940992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422193033940992[0;39m ==> Parameters: 
2022-04-29 18:45:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422193033940992[0;39m <==    Updates: 0
2022-04-29 18:45:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422193033940992[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:45:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422214001266688[0;39m 生成今日电子书快照开始
2022-04-29 18:45:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422214001266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422214001266688[0;39m ==> Parameters: 
2022-04-29 18:45:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422214001266688[0;39m <==    Updates: 0
2022-04-29 18:45:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422214001266688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:45:20.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422234989563904[0;39m 生成今日电子书快照开始
2022-04-29 18:45:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422234989563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422234989563904[0;39m ==> Parameters: 
2022-04-29 18:45:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422234989563904[0;39m <==    Updates: 0
2022-04-29 18:45:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422234989563904[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:45:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422255948500992[0;39m 生成今日电子书快照开始
2022-04-29 18:45:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422255948500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422255948500992[0;39m ==> Parameters: 
2022-04-29 18:45:25.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422255948500992[0;39m <==    Updates: 0
2022-04-29 18:45:25.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422255948500992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:45:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422276932603904[0;39m 生成今日电子书快照开始
2022-04-29 18:45:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422276932603904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422276932603904[0;39m ==> Parameters: 
2022-04-29 18:45:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422276932603904[0;39m <==    Updates: 0
2022-04-29 18:45:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422276932603904[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:45:35.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422297904123904[0;39m 生成今日电子书快照开始
2022-04-29 18:45:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422297904123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422297904123904[0;39m ==> Parameters: 
2022-04-29 18:45:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422297904123904[0;39m <==    Updates: 0
2022-04-29 18:45:35.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422297904123904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:45:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422298151587840[0;39m start updating Ebook doc
2022-04-29 18:45:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422298151587840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:45:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422298151587840[0;39m ==> Parameters: 
2022-04-29 18:45:35.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422298151587840[0;39m <==    Updates: 1
2022-04-29 18:45:35.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422298151587840[0;39m update ends, take 43 millisecs
2022-04-29 18:45:40.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422318867255296[0;39m 生成今日电子书快照开始
2022-04-29 18:45:40.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422318867255296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:40.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422318867255296[0;39m ==> Parameters: 
2022-04-29 18:45:40.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422318867255296[0;39m <==    Updates: 0
2022-04-29 18:45:40.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422318867255296[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 18:45:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422339842969600[0;39m 生成今日电子书快照开始
2022-04-29 18:45:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422339842969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422339842969600[0;39m ==> Parameters: 
2022-04-29 18:45:45.092 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422339842969600[0;39m <==    Updates: 0
2022-04-29 18:45:45.093 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422339842969600[0;39m 生成今日电子书快照结束，耗时：84毫秒
2022-04-29 18:45:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422360797712384[0;39m 生成今日电子书快照开始
2022-04-29 18:45:50.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422360797712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:50.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422360797712384[0;39m ==> Parameters: 
2022-04-29 18:45:50.086 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422360797712384[0;39m <==    Updates: 0
2022-04-29 18:45:50.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422360797712384[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 18:45:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422381773426688[0;39m 生成今日电子书快照开始
2022-04-29 18:45:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422381773426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422381773426688[0;39m ==> Parameters: 
2022-04-29 18:45:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422381773426688[0;39m <==    Updates: 0
2022-04-29 18:45:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422381773426688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:46:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422402740752384[0;39m 生成今日电子书快照开始
2022-04-29 18:46:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422402740752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422402740752384[0;39m ==> Parameters: 
2022-04-29 18:46:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422402740752384[0;39m <==    Updates: 0
2022-04-29 18:46:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422402740752384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:46:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422423716466688[0;39m 生成今日电子书快照开始
2022-04-29 18:46:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422423716466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422423716466688[0;39m ==> Parameters: 
2022-04-29 18:46:05.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422423716466688[0;39m <==    Updates: 0
2022-04-29 18:46:05.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422423716466688[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 18:46:05.085 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422424052011008[0;39m start updating Ebook doc
2022-04-29 18:46:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422424052011008[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:46:05.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422424052011008[0;39m ==> Parameters: 
2022-04-29 18:46:05.144 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422424052011008[0;39m <==    Updates: 1
2022-04-29 18:46:05.145 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422424052011008[0;39m update ends, take 59 millisecs
2022-04-29 18:46:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422444696375296[0;39m 生成今日电子书快照开始
2022-04-29 18:46:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422444696375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422444696375296[0;39m ==> Parameters: 
2022-04-29 18:46:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422444696375296[0;39m <==    Updates: 0
2022-04-29 18:46:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422444696375296[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:46:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422465667895296[0;39m 生成今日电子书快照开始
2022-04-29 18:46:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422465667895296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422465667895296[0;39m ==> Parameters: 
2022-04-29 18:46:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422465667895296[0;39m <==    Updates: 0
2022-04-29 18:46:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422465667895296[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-29 18:46:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422486626832384[0;39m 生成今日电子书快照开始
2022-04-29 18:46:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422486626832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422486626832384[0;39m ==> Parameters: 
2022-04-29 18:46:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422486626832384[0;39m <==    Updates: 0
2022-04-29 18:46:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422486626832384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:46:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422507610935296[0;39m 生成今日电子书快照开始
2022-04-29 18:46:25.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422507610935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:25.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422507610935296[0;39m ==> Parameters: 
2022-04-29 18:46:25.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422507610935296[0;39m <==    Updates: 0
2022-04-29 18:46:25.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422507610935296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:46:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422528595038208[0;39m 生成今日电子书快照开始
2022-04-29 18:46:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422528595038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422528595038208[0;39m ==> Parameters: 
2022-04-29 18:46:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422528595038208[0;39m <==    Updates: 0
2022-04-29 18:46:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422528595038208[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 18:46:35.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422549558169600[0;39m 生成今日电子书快照开始
2022-04-29 18:46:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422549558169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422549558169600[0;39m ==> Parameters: 
2022-04-29 18:46:35.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422549558169600[0;39m <==    Updates: 0
2022-04-29 18:46:35.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422549558169600[0;39m 生成今日电子书快照结束，耗时：100毫秒
2022-04-29 18:46:35.109 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422549981794304[0;39m start updating Ebook doc
2022-04-29 18:46:35.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422549981794304[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:46:35.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422549981794304[0;39m ==> Parameters: 
2022-04-29 18:46:35.166 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422549981794304[0;39m <==    Updates: 1
2022-04-29 18:46:35.167 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422549981794304[0;39m update ends, take 58 millisecs
2022-04-29 18:46:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422570504523776[0;39m 生成今日电子书快照开始
2022-04-29 18:46:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422570504523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422570504523776[0;39m ==> Parameters: 
2022-04-29 18:46:40.097 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422570504523776[0;39m <==    Updates: 0
2022-04-29 18:46:40.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422570504523776[0;39m 生成今日电子书快照结束，耗时：96毫秒
2022-04-29 18:46:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422591492820992[0;39m 生成今日电子书快照开始
2022-04-29 18:46:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422591492820992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422591492820992[0;39m ==> Parameters: 
2022-04-29 18:46:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422591492820992[0;39m <==    Updates: 0
2022-04-29 18:46:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422591492820992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:46:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422612464340992[0;39m 生成今日电子书快照开始
2022-04-29 18:46:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422612464340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422612464340992[0;39m ==> Parameters: 
2022-04-29 18:46:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422612464340992[0;39m <==    Updates: 0
2022-04-29 18:46:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422612464340992[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:46:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422633414889472[0;39m 生成今日电子书快照开始
2022-04-29 18:46:55.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422633414889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422633414889472[0;39m ==> Parameters: 
2022-04-29 18:46:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422633414889472[0;39m <==    Updates: 0
2022-04-29 18:46:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422633414889472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:47:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422654407380992[0;39m 生成今日电子书快照开始
2022-04-29 18:47:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422654407380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422654407380992[0;39m ==> Parameters: 
2022-04-29 18:47:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422654407380992[0;39m <==    Updates: 0
2022-04-29 18:47:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422654407380992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:47:05.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422675395678208[0;39m 生成今日电子书快照开始
2022-04-29 18:47:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422675395678208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422675395678208[0;39m ==> Parameters: 
2022-04-29 18:47:05.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422675395678208[0;39m <==    Updates: 0
2022-04-29 18:47:05.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422675395678208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:47:05.074 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422675664113664[0;39m start updating Ebook doc
2022-04-29 18:47:05.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422675664113664[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:47:05.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422675664113664[0;39m ==> Parameters: 
2022-04-29 18:47:05.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422675664113664[0;39m <==    Updates: 1
2022-04-29 18:47:05.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422675664113664[0;39m update ends, take 38 millisecs
2022-04-29 18:47:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422696346226688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422696346226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422696346226688[0;39m ==> Parameters: 
2022-04-29 18:47:10.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422696346226688[0;39m <==    Updates: 0
2022-04-29 18:47:10.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422696346226688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:47:15.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422717330329600[0;39m 生成今日电子书快照开始
2022-04-29 18:47:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422717330329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422717330329600[0;39m ==> Parameters: 
2022-04-29 18:47:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422717330329600[0;39m <==    Updates: 0
2022-04-29 18:47:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422717330329600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:47:20.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422738297655296[0;39m 生成今日电子书快照开始
2022-04-29 18:47:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422738297655296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422738297655296[0;39m ==> Parameters: 
2022-04-29 18:47:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422738297655296[0;39m <==    Updates: 0
2022-04-29 18:47:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422738297655296[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:47:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422759277563904[0;39m 生成今日电子书快照开始
2022-04-29 18:47:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422759277563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422759277563904[0;39m ==> Parameters: 
2022-04-29 18:47:25.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422759277563904[0;39m <==    Updates: 0
2022-04-29 18:47:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422759277563904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:47:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422780232306688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422780232306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422780232306688[0;39m ==> Parameters: 
2022-04-29 18:47:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422780232306688[0;39m <==    Updates: 0
2022-04-29 18:47:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422780232306688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:47:35.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422801208020992[0;39m start updating Ebook doc
2022-04-29 18:47:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422801208020992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:47:35.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422801208020992[0;39m ==> Parameters: 
2022-04-29 18:47:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422801208020992[0;39m <==    Updates: 1
2022-04-29 18:47:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422801208020992[0;39m update ends, take 58 millisecs
2022-04-29 18:47:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422801455484928[0;39m 生成今日电子书快照开始
2022-04-29 18:47:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422801455484928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422801455484928[0;39m ==> Parameters: 
2022-04-29 18:47:35.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422801455484928[0;39m <==    Updates: 0
2022-04-29 18:47:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422801455484928[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-29 18:47:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422822166958080[0;39m 生成今日电子书快照开始
2022-04-29 18:47:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422822166958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:40.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422822166958080[0;39m ==> Parameters: 
2022-04-29 18:47:40.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422822166958080[0;39m <==    Updates: 0
2022-04-29 18:47:40.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422822166958080[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:47:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422843146866688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:45.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422843146866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:45.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422843146866688[0;39m ==> Parameters: 
2022-04-29 18:47:45.093 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422843146866688[0;39m <==    Updates: 0
2022-04-29 18:47:45.093 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422843146866688[0;39m 生成今日电子书快照结束，耗时：88毫秒
2022-04-29 18:47:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422864109998080[0;39m 生成今日电子书快照开始
2022-04-29 18:47:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422864109998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422864109998080[0;39m ==> Parameters: 
2022-04-29 18:47:50.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422864109998080[0;39m <==    Updates: 0
2022-04-29 18:47:50.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422864109998080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 18:47:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422885089906688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422885089906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422885089906688[0;39m ==> Parameters: 
2022-04-29 18:47:55.188 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422885089906688[0;39m <==    Updates: 0
2022-04-29 18:47:55.189 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422885089906688[0;39m 生成今日电子书快照结束，耗时：183毫秒
2022-04-29 18:48:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422906044649472[0;39m 生成今日电子书快照开始
2022-04-29 18:48:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422906044649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422906044649472[0;39m ==> Parameters: 
2022-04-29 18:48:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422906044649472[0;39m <==    Updates: 0
2022-04-29 18:48:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422906044649472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:48:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422927032946688[0;39m start updating Ebook doc
2022-04-29 18:48:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422927032946688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:48:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422927032946688[0;39m ==> Parameters: 
2022-04-29 18:48:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422927032946688[0;39m <==    Updates: 1
2022-04-29 18:48:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422927032946688[0;39m update ends, take 58 millisecs
2022-04-29 18:48:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422927284604928[0;39m 生成今日电子书快照开始
2022-04-29 18:48:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422927284604928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422927284604928[0;39m ==> Parameters: 
2022-04-29 18:48:05.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422927284604928[0;39m <==    Updates: 0
2022-04-29 18:48:05.116 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422927284604928[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-29 18:48:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422948000272384[0;39m 生成今日电子书快照开始
2022-04-29 18:48:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422948000272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422948000272384[0;39m ==> Parameters: 
2022-04-29 18:48:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422948000272384[0;39m <==    Updates: 0
2022-04-29 18:48:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422948000272384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:48:13.872 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:48:13.873 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:48:13.873 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:48:14.075 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:48:14.089 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175422965134004224[0;39m ------------- 开始 -------------
2022-04-29 18:48:14.090 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175422965134004224[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:48:14.090 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175422965134004224[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:48:14.090 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175422965134004224[0;39m 远程地址: 127.0.0.1
2022-04-29 18:48:14.093 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175422965134004224[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"cover":"1","description":"1","name":"1"}]
2022-04-29 18:48:21.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422994330554368[0;39m 生成今日电子书快照开始
2022-04-29 18:48:21.079 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175422965134004224[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:48:21.080 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175422965134004224[0;39m ==> Parameters: 175422994330554369(Long), 1(String), 200(Long), 202(Long), 1(String), 1(String), null, null, null
2022-04-29 18:48:21.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422994330554368[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:21.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422994330554368[0;39m ==> Parameters: 
2022-04-29 18:48:21.125 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175422965134004224[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$98bbfea7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 18:48:21.131 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175422965134004224[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 18:48:21.140 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422994330554368[0;39m <==    Updates: 0
2022-04-29 18:48:21.141 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422994330554368[0;39m 生成今日电子书快照结束，耗时：91毫秒
2022-04-29 18:48:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423010902249472[0;39m 生成今日电子书快照开始
2022-04-29 18:48:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423010902249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423010902249472[0;39m ==> Parameters: 
2022-04-29 18:48:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423010902249472[0;39m <==    Updates: 0
2022-04-29 18:48:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423010902249472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:48:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423031890546688[0;39m 生成今日电子书快照开始
2022-04-29 18:48:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423031890546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423031890546688[0;39m ==> Parameters: 
2022-04-29 18:48:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423031890546688[0;39m <==    Updates: 0
2022-04-29 18:48:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423031890546688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:48:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423052849483776[0;39m 生成今日电子书快照开始
2022-04-29 18:48:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423052849483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423052849483776[0;39m ==> Parameters: 
2022-04-29 18:48:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423052849483776[0;39m <==    Updates: 0
2022-04-29 18:48:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423052849483776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:48:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423053105336320[0;39m start updating Ebook doc
2022-04-29 18:48:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423053105336320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:48:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423053105336320[0;39m ==> Parameters: 
2022-04-29 18:48:35.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423053105336320[0;39m <==    Updates: 1
2022-04-29 18:48:35.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423053105336320[0;39m update ends, take 41 millisecs
2022-04-29 18:48:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423073837780992[0;39m 生成今日电子书快照开始
2022-04-29 18:48:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423073837780992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423073837780992[0;39m ==> Parameters: 
2022-04-29 18:48:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423073837780992[0;39m <==    Updates: 0
2022-04-29 18:48:40.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423073837780992[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:48:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423094813495296[0;39m 生成今日电子书快照开始
2022-04-29 18:48:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423094813495296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423094813495296[0;39m ==> Parameters: 
2022-04-29 18:48:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423094813495296[0;39m <==    Updates: 0
2022-04-29 18:48:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423094813495296[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:48:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423115789209600[0;39m 生成今日电子书快照开始
2022-04-29 18:48:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423115789209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423115789209600[0;39m ==> Parameters: 
2022-04-29 18:48:50.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423115789209600[0;39m <==    Updates: 0
2022-04-29 18:48:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423115789209600[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:48:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423136752340992[0;39m 生成今日电子书快照开始
2022-04-29 18:48:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423136752340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423136752340992[0;39m ==> Parameters: 
2022-04-29 18:48:55.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423136752340992[0;39m <==    Updates: 0
2022-04-29 18:48:55.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423136752340992[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:49:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423157711278080[0;39m 生成今日电子书快照开始
2022-04-29 18:49:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423157711278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423157711278080[0;39m ==> Parameters: 
2022-04-29 18:49:00.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423157711278080[0;39m <==    Updates: 0
2022-04-29 18:49:00.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423157711278080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:49:05.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423178695380992[0;39m 生成今日电子书快照开始
2022-04-29 18:49:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423178695380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423178695380992[0;39m ==> Parameters: 
2022-04-29 18:49:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423178695380992[0;39m <==    Updates: 0
2022-04-29 18:49:05.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423178695380992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:49:05.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423178972205056[0;39m start updating Ebook doc
2022-04-29 18:49:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423178972205056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:49:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423178972205056[0;39m ==> Parameters: 
2022-04-29 18:49:05.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423178972205056[0;39m <==    Updates: 1
2022-04-29 18:49:05.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423178972205056[0;39m update ends, take 40 millisecs
2022-04-29 18:49:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423199679483904[0;39m 生成今日电子书快照开始
2022-04-29 18:49:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423199679483904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423199679483904[0;39m ==> Parameters: 
2022-04-29 18:49:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423199679483904[0;39m <==    Updates: 0
2022-04-29 18:49:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423199679483904[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:49:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423220638420992[0;39m 生成今日电子书快照开始
2022-04-29 18:49:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423220638420992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423220638420992[0;39m ==> Parameters: 
2022-04-29 18:49:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423220638420992[0;39m <==    Updates: 0
2022-04-29 18:49:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423220638420992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:49:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423241609940992[0;39m 生成今日电子书快照开始
2022-04-29 18:49:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423241609940992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423241609940992[0;39m ==> Parameters: 
2022-04-29 18:49:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423241609940992[0;39m <==    Updates: 0
2022-04-29 18:49:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423241609940992[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:49:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423262564683776[0;39m 生成今日电子书快照开始
2022-04-29 18:49:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423262564683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423262564683776[0;39m ==> Parameters: 
2022-04-29 18:49:25.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423262564683776[0;39m <==    Updates: 0
2022-04-29 18:49:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423262564683776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:49:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423283557175296[0;39m 生成今日电子书快照开始
2022-04-29 18:49:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423283557175296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423283557175296[0;39m ==> Parameters: 
2022-04-29 18:49:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423283557175296[0;39m <==    Updates: 0
2022-04-29 18:49:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423283557175296[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:49:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423304516112384[0;39m 生成今日电子书快照开始
2022-04-29 18:49:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423304516112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423304516112384[0;39m ==> Parameters: 
2022-04-29 18:49:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423304516112384[0;39m <==    Updates: 0
2022-04-29 18:49:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423304516112384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:49:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423304780353536[0;39m start updating Ebook doc
2022-04-29 18:49:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423304780353536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:49:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423304780353536[0;39m ==> Parameters: 
2022-04-29 18:49:35.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423304780353536[0;39m <==    Updates: 1
2022-04-29 18:49:35.111 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423304780353536[0;39m update ends, take 43 millisecs
2022-04-29 18:49:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423325504409600[0;39m 生成今日电子书快照开始
2022-04-29 18:49:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423325504409600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423325504409600[0;39m ==> Parameters: 
2022-04-29 18:49:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423325504409600[0;39m <==    Updates: 0
2022-04-29 18:49:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423325504409600[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:49:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423346480123904[0;39m 生成今日电子书快照开始
2022-04-29 18:49:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423346480123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423346480123904[0;39m ==> Parameters: 
2022-04-29 18:49:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423346480123904[0;39m <==    Updates: 0
2022-04-29 18:49:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423346480123904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:49:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423367447449600[0;39m 生成今日电子书快照开始
2022-04-29 18:49:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423367447449600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423367447449600[0;39m ==> Parameters: 
2022-04-29 18:49:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423367447449600[0;39m <==    Updates: 0
2022-04-29 18:49:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423367447449600[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:49:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423388427358208[0;39m 生成今日电子书快照开始
2022-04-29 18:49:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423388427358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423388427358208[0;39m ==> Parameters: 
2022-04-29 18:49:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423388427358208[0;39m <==    Updates: 0
2022-04-29 18:49:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423388427358208[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:50:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423409394683904[0;39m 生成今日电子书快照开始
2022-04-29 18:50:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423409394683904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423409394683904[0;39m ==> Parameters: 
2022-04-29 18:50:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423409394683904[0;39m <==    Updates: 0
2022-04-29 18:50:00.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423409394683904[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:50:05.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423430362009600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423430362009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423430362009600[0;39m ==> Parameters: 
2022-04-29 18:50:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423430362009600[0;39m <==    Updates: 0
2022-04-29 18:50:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423430362009600[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:50:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423430601084928[0;39m start updating Ebook doc
2022-04-29 18:50:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423430601084928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:50:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423430601084928[0;39m ==> Parameters: 
2022-04-29 18:50:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423430601084928[0;39m <==    Updates: 1
2022-04-29 18:50:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423430601084928[0;39m update ends, take 40 millisecs
2022-04-29 18:50:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423451329335296[0;39m 生成今日电子书快照开始
2022-04-29 18:50:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423451329335296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423451329335296[0;39m ==> Parameters: 
2022-04-29 18:50:10.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423451329335296[0;39m <==    Updates: 0
2022-04-29 18:50:10.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423451329335296[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:50:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423472271495168[0;39m 生成今日电子书快照开始
2022-04-29 18:50:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423472271495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423472271495168[0;39m ==> Parameters: 
2022-04-29 18:50:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423472271495168[0;39m <==    Updates: 0
2022-04-29 18:50:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423472271495168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:50:20.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423493276569600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423493276569600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423493276569600[0;39m ==> Parameters: 
2022-04-29 18:50:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423493276569600[0;39m <==    Updates: 0
2022-04-29 18:50:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423493276569600[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:50:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423514248089600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423514248089600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423514248089600[0;39m ==> Parameters: 
2022-04-29 18:50:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423514248089600[0;39m <==    Updates: 0
2022-04-29 18:50:25.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423514248089600[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:50:30.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423535232192512[0;39m 生成今日电子书快照开始
2022-04-29 18:50:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423535232192512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423535232192512[0;39m ==> Parameters: 
2022-04-29 18:50:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423535232192512[0;39m <==    Updates: 0
2022-04-29 18:50:30.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423535232192512[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:50:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423556161769472[0;39m 生成今日电子书快照开始
2022-04-29 18:50:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423556161769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423556161769472[0;39m ==> Parameters: 
2022-04-29 18:50:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423556161769472[0;39m <==    Updates: 0
2022-04-29 18:50:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423556161769472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:50:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423556434399232[0;39m start updating Ebook doc
2022-04-29 18:50:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423556434399232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:50:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423556434399232[0;39m ==> Parameters: 
2022-04-29 18:50:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423556434399232[0;39m <==    Updates: 1
2022-04-29 18:50:35.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423556434399232[0;39m update ends, take 40 millisecs
2022-04-29 18:50:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423577171038208[0;39m 生成今日电子书快照开始
2022-04-29 18:50:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423577171038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423577171038208[0;39m ==> Parameters: 
2022-04-29 18:50:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423577171038208[0;39m <==    Updates: 0
2022-04-29 18:50:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423577171038208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:50:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423598134169600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423598134169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423598134169600[0;39m ==> Parameters: 
2022-04-29 18:50:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423598134169600[0;39m <==    Updates: 0
2022-04-29 18:50:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423598134169600[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:50:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423619114078208[0;39m 生成今日电子书快照开始
2022-04-29 18:50:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423619114078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423619114078208[0;39m ==> Parameters: 
2022-04-29 18:50:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423619114078208[0;39m <==    Updates: 0
2022-04-29 18:50:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423619114078208[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:50:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423640047849472[0;39m 生成今日电子书快照开始
2022-04-29 18:50:55.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423640047849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:55.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423640047849472[0;39m ==> Parameters: 
2022-04-29 18:50:55.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423640047849472[0;39m <==    Updates: 0
2022-04-29 18:50:55.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423640047849472[0;39m 生成今日电子书快照结束，耗时：84毫秒
2022-04-29 18:51:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423661044535296[0;39m 生成今日电子书快照开始
2022-04-29 18:51:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423661044535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:00.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423661044535296[0;39m ==> Parameters: 
2022-04-29 18:51:00.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423661044535296[0;39m <==    Updates: 0
2022-04-29 18:51:00.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423661044535296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:51:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423681990889472[0;39m start updating Ebook doc
2022-04-29 18:51:05.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423681990889472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:51:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423681990889472[0;39m ==> Parameters: 
2022-04-29 18:51:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423681990889472[0;39m <==    Updates: 1
2022-04-29 18:51:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423681990889472[0;39m update ends, take 58 millisecs
2022-04-29 18:51:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423682238353408[0;39m 生成今日电子书快照开始
2022-04-29 18:51:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423682238353408[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423682238353408[0;39m ==> Parameters: 
2022-04-29 18:51:05.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423682238353408[0;39m <==    Updates: 0
2022-04-29 18:51:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423682238353408[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-29 18:51:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423702995963904[0;39m 生成今日电子书快照开始
2022-04-29 18:51:10.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423702995963904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:10.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423702995963904[0;39m ==> Parameters: 
2022-04-29 18:51:10.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423702995963904[0;39m <==    Updates: 0
2022-04-29 18:51:10.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423702995963904[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 18:51:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423723933929472[0;39m 生成今日电子书快照开始
2022-04-29 18:51:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423723933929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423723933929472[0;39m ==> Parameters: 
2022-04-29 18:51:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423723933929472[0;39m <==    Updates: 0
2022-04-29 18:51:15.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423723933929472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:51:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423744905449472[0;39m 生成今日电子书快照开始
2022-04-29 18:51:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423744905449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423744905449472[0;39m ==> Parameters: 
2022-04-29 18:51:20.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423744905449472[0;39m <==    Updates: 0
2022-04-29 18:51:20.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423744905449472[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:51:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423765906329600[0;39m 生成今日电子书快照开始
2022-04-29 18:51:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423765906329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423765906329600[0;39m ==> Parameters: 
2022-04-29 18:51:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423765906329600[0;39m <==    Updates: 0
2022-04-29 18:51:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423765906329600[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:51:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423786882043904[0;39m 生成今日电子书快照开始
2022-04-29 18:51:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423786882043904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423786882043904[0;39m ==> Parameters: 
2022-04-29 18:51:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423786882043904[0;39m <==    Updates: 0
2022-04-29 18:51:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423786882043904[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:51:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423807820009472[0;39m 生成今日电子书快照开始
2022-04-29 18:51:35.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423807820009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423807820009472[0;39m ==> Parameters: 
2022-04-29 18:51:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423807820009472[0;39m <==    Updates: 0
2022-04-29 18:51:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423807820009472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:51:35.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423808067473408[0;39m start updating Ebook doc
2022-04-29 18:51:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423808067473408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:51:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423808067473408[0;39m ==> Parameters: 
2022-04-29 18:51:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423808067473408[0;39m <==    Updates: 1
2022-04-29 18:51:35.101 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423808067473408[0;39m update ends, take 41 millisecs
2022-04-29 18:51:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423828820889600[0;39m 生成今日电子书快照开始
2022-04-29 18:51:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423828820889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423828820889600[0;39m ==> Parameters: 
2022-04-29 18:51:40.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423828820889600[0;39m <==    Updates: 0
2022-04-29 18:51:40.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423828820889600[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:51:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423849788215296[0;39m 生成今日电子书快照开始
2022-04-29 18:51:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423849788215296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423849788215296[0;39m ==> Parameters: 
2022-04-29 18:51:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423849788215296[0;39m <==    Updates: 0
2022-04-29 18:51:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423849788215296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:51:50.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423870759735296[0;39m 生成今日电子书快照开始
2022-04-29 18:51:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423870759735296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423870759735296[0;39m ==> Parameters: 
2022-04-29 18:51:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423870759735296[0;39m <==    Updates: 0
2022-04-29 18:51:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423870759735296[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:51:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423891722866688[0;39m 生成今日电子书快照开始
2022-04-29 18:51:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423891722866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423891722866688[0;39m ==> Parameters: 
2022-04-29 18:51:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423891722866688[0;39m <==    Updates: 0
2022-04-29 18:51:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423891722866688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:52:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423912698580992[0;39m 生成今日电子书快照开始
2022-04-29 18:52:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423912698580992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423912698580992[0;39m ==> Parameters: 
2022-04-29 18:52:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423912698580992[0;39m <==    Updates: 0
2022-04-29 18:52:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423912698580992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:52:05.008 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423933678489600[0;39m start updating Ebook doc
2022-04-29 18:52:05.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423933678489600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:52:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423933678489600[0;39m ==> Parameters: 
2022-04-29 18:52:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423933678489600[0;39m <==    Updates: 1
2022-04-29 18:52:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423933678489600[0;39m update ends, take 57 millisecs
2022-04-29 18:52:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423933925953536[0;39m 生成今日电子书快照开始
2022-04-29 18:52:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423933925953536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423933925953536[0;39m ==> Parameters: 
2022-04-29 18:52:05.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423933925953536[0;39m <==    Updates: 0
2022-04-29 18:52:05.107 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423933925953536[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 18:52:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423954650009600[0;39m 生成今日电子书快照开始
2022-04-29 18:52:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423954650009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423954650009600[0;39m ==> Parameters: 
2022-04-29 18:52:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423954650009600[0;39m <==    Updates: 0
2022-04-29 18:52:10.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423954650009600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:52:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423975596363776[0;39m 生成今日电子书快照开始
2022-04-29 18:52:15.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423975596363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:15.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423975596363776[0;39m ==> Parameters: 
2022-04-29 18:52:15.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423975596363776[0;39m <==    Updates: 0
2022-04-29 18:52:15.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423975596363776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:52:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423996584660992[0;39m 生成今日电子书快照开始
2022-04-29 18:52:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423996584660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423996584660992[0;39m ==> Parameters: 
2022-04-29 18:52:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423996584660992[0;39m <==    Updates: 0
2022-04-29 18:52:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423996584660992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:52:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424017560375296[0;39m 生成今日电子书快照开始
2022-04-29 18:52:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424017560375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424017560375296[0;39m ==> Parameters: 
2022-04-29 18:52:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424017560375296[0;39m <==    Updates: 0
2022-04-29 18:52:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424017560375296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:52:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424038519312384[0;39m 生成今日电子书快照开始
2022-04-29 18:52:30.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424038519312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424038519312384[0;39m ==> Parameters: 
2022-04-29 18:52:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424038519312384[0;39m <==    Updates: 0
2022-04-29 18:52:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424038519312384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:52:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424059503415296[0;39m 生成今日电子书快照开始
2022-04-29 18:52:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424059503415296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424059503415296[0;39m ==> Parameters: 
2022-04-29 18:52:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424059503415296[0;39m <==    Updates: 0
2022-04-29 18:52:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424059503415296[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:52:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424059742490624[0;39m start updating Ebook doc
2022-04-29 18:52:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424059742490624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:52:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424059742490624[0;39m ==> Parameters: 
2022-04-29 18:52:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424059742490624[0;39m <==    Updates: 1
2022-04-29 18:52:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424059742490624[0;39m update ends, take 44 millisecs
2022-04-29 18:52:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424080453963776[0;39m 生成今日电子书快照开始
2022-04-29 18:52:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424080453963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424080453963776[0;39m ==> Parameters: 
2022-04-29 18:52:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424080453963776[0;39m <==    Updates: 0
2022-04-29 18:52:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424080453963776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:52:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424101454843904[0;39m 生成今日电子书快照开始
2022-04-29 18:52:45.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424101454843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:45.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424101454843904[0;39m ==> Parameters: 
2022-04-29 18:52:45.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424101454843904[0;39m <==    Updates: 0
2022-04-29 18:52:45.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424101454843904[0;39m 生成今日电子书快照结束，耗时：79毫秒
2022-04-29 18:52:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424122409586688[0;39m 生成今日电子书快照开始
2022-04-29 18:52:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424122409586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424122409586688[0;39m ==> Parameters: 
2022-04-29 18:52:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424122409586688[0;39m <==    Updates: 0
2022-04-29 18:52:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424122409586688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:52:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424143397883904[0;39m 生成今日电子书快照开始
2022-04-29 18:52:55.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424143397883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:55.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424143397883904[0;39m ==> Parameters: 
2022-04-29 18:52:55.393 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424143397883904[0;39m <==    Updates: 0
2022-04-29 18:52:55.393 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424143397883904[0;39m 生成今日电子书快照结束，耗时：384毫秒
2022-04-29 18:53:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424164365209600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424164365209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424164365209600[0;39m ==> Parameters: 
2022-04-29 18:53:00.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424164365209600[0;39m <==    Updates: 0
2022-04-29 18:53:00.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424164365209600[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:53:05.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424185345118208[0;39m start updating Ebook doc
2022-04-29 18:53:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424185345118208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:53:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424185345118208[0;39m ==> Parameters: 
2022-04-29 18:53:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424185345118208[0;39m <==    Updates: 1
2022-04-29 18:53:05.073 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424185345118208[0;39m update ends, take 63 millisecs
2022-04-29 18:53:05.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424185609359360[0;39m 生成今日电子书快照开始
2022-04-29 18:53:05.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424185609359360[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:05.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424185609359360[0;39m ==> Parameters: 
2022-04-29 18:53:05.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424185609359360[0;39m <==    Updates: 0
2022-04-29 18:53:05.112 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424185609359360[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-29 18:53:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424206308249600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424206308249600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424206308249600[0;39m ==> Parameters: 
2022-04-29 18:53:10.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424206308249600[0;39m <==    Updates: 0
2022-04-29 18:53:10.090 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424206308249600[0;39m 生成今日电子书快照结束，耗时：81毫秒
2022-04-29 18:53:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424227262992384[0;39m 生成今日电子书快照开始
2022-04-29 18:53:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424227262992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424227262992384[0;39m ==> Parameters: 
2022-04-29 18:53:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424227262992384[0;39m <==    Updates: 0
2022-04-29 18:53:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424227262992384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:53:20.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424248247095296[0;39m 生成今日电子书快照开始
2022-04-29 18:53:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424248247095296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424248247095296[0;39m ==> Parameters: 
2022-04-29 18:53:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424248247095296[0;39m <==    Updates: 0
2022-04-29 18:53:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424248247095296[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:53:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424269206032384[0;39m 生成今日电子书快照开始
2022-04-29 18:53:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424269206032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424269206032384[0;39m ==> Parameters: 
2022-04-29 18:53:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424269206032384[0;39m <==    Updates: 0
2022-04-29 18:53:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424269206032384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:53:25.290 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424270401409024[0;39m ------------- 开始 -------------
2022-04-29 18:53:25.294 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424270401409024[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:53:25.295 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424270401409024[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:53:25.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424270401409024[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:25.299 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424270401409024[0;39m 请求参数: []
2022-04-29 18:53:25.549 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424270401409024[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:53:25.555 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424270401409024[0;39m ==> Parameters: 
2022-04-29 18:53:25.654 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:53:25.655 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:53:25.657 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:53:25.658 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:53:25.658 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:53:25.658 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:53:25.659 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:53:25.659 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:53:25.660 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:53:25.662 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:53:25.662 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:53:25.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:53:25.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:53:25.664 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:53:25.664 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:53:25.665 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:53:25.666 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:53:25.668 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:53:25.669 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:53:25.671 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424270401409024[0;39m <==      Total: 18
2022-04-29 18:53:25.697 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424270401409024[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:53:25.697 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424270401409024[0;39m ------------- 结束 耗时：408 ms -------------
2022-04-29 18:53:25.835 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424272691499008[0;39m ------------- 开始 -------------
2022-04-29 18:53:25.836 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424272691499008[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:53:25.836 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424272691499008[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:53:25.836 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424272691499008[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:25.839 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424272691499008[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:53:26.262 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424272691499008[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:53:26.263 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424272691499008[0;39m ==> Parameters: 
2022-04-29 18:53:26.287 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424272691499008[0;39m <==    Columns: count(0)
2022-04-29 18:53:26.288 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424272691499008[0;39m <==        Row: 5
2022-04-29 18:53:26.289 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424272691499008[0;39m <==      Total: 1
2022-04-29 18:53:26.292 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424272691499008[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:53:26.293 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424272691499008[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:53:26.306 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:53:26.307 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:53:26.307 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:53:26.308 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:53:26.308 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:53:26.309 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:53:26.309 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424272691499008[0;39m <==      Total: 5
2022-04-29 18:53:26.311 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175424272691499008[0;39m total rows：5
2022-04-29 18:53:26.311 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175424272691499008[0;39m total pages：1
2022-04-29 18:53:26.323 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424272691499008[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 18:53:26.323 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424272691499008[0;39m ------------- 结束 耗时：488 ms -------------
2022-04-29 18:53:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424290173358080[0;39m 生成今日电子书快照开始
2022-04-29 18:53:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424290173358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424290173358080[0;39m ==> Parameters: 
2022-04-29 18:53:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424290173358080[0;39m <==    Updates: 0
2022-04-29 18:53:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424290173358080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:53:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424311140683776[0;39m 生成今日电子书快照开始
2022-04-29 18:53:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424311140683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424311140683776[0;39m ==> Parameters: 
2022-04-29 18:53:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424311140683776[0;39m <==    Updates: 0
2022-04-29 18:53:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424311140683776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:53:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424311417507840[0;39m start updating Ebook doc
2022-04-29 18:53:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424311417507840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:53:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424311417507840[0;39m ==> Parameters: 
2022-04-29 18:53:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424311417507840[0;39m <==    Updates: 1
2022-04-29 18:53:35.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424311417507840[0;39m update ends, take 41 millisecs
2022-04-29 18:53:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424332141563904[0;39m 生成今日电子书快照开始
2022-04-29 18:53:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424332141563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424332141563904[0;39m ==> Parameters: 
2022-04-29 18:53:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424332141563904[0;39m <==    Updates: 0
2022-04-29 18:53:40.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424332141563904[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:53:40.296 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424333345329152[0;39m ------------- 开始 -------------
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424333345329152[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424333345329152[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424333345329152[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424333345329152[0;39m 请求参数: []
2022-04-29 18:53:40.315 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424333345329152[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:53:40.316 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424333345329152[0;39m ==> Parameters: 
2022-04-29 18:53:40.350 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:53:40.351 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:53:40.352 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:53:40.354 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:53:40.371 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:53:40.373 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:53:40.375 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:53:40.376 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:53:40.377 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:53:40.377 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:53:40.378 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:53:40.379 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:53:40.380 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:53:40.381 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:53:40.382 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:53:40.383 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:53:40.396 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:53:40.396 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:53:40.397 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:53:40.397 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424333345329152[0;39m <==      Total: 18
2022-04-29 18:53:40.415 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424333345329152[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:53:40.415 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424333345329152[0;39m ------------- 结束 耗时：119 ms -------------
2022-04-29 18:53:40.657 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：lZnmgIKmxC，session id：0，当前连接数：1
2022-04-29 18:53:40.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424335316652032[0;39m ------------- 开始 -------------
2022-04-29 18:53:40.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424335316652032[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:53:40.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424335316652032[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:53:40.767 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424335316652032[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:40.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424335316652032[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:53:40.824 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424335316652032[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:53:40.825 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424335316652032[0;39m ==> Parameters: 
2022-04-29 18:53:40.838 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424335316652032[0;39m <==    Columns: count(0)
2022-04-29 18:53:40.839 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424335316652032[0;39m <==        Row: 5
2022-04-29 18:53:40.839 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424335316652032[0;39m <==      Total: 1
2022-04-29 18:53:40.840 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424335316652032[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:53:40.840 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424335316652032[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:53:40.860 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:53:40.860 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:53:40.861 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:53:40.861 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:53:40.862 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:53:40.864 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:53:40.865 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424335316652032[0;39m <==      Total: 5
2022-04-29 18:53:40.866 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175424335316652032[0;39m total rows：5
2022-04-29 18:53:40.866 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175424335316652032[0;39m total pages：1
2022-04-29 18:53:40.884 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424335316652032[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 18:53:40.885 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424335316652032[0;39m ------------- 结束 耗时：120 ms -------------
2022-04-29 18:53:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424353108889600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424353108889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424353108889600[0;39m ==> Parameters: 
2022-04-29 18:53:45.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424353108889600[0;39m <==    Updates: 0
2022-04-29 18:53:45.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424353108889600[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:53:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424374080409600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424374080409600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424374080409600[0;39m ==> Parameters: 
2022-04-29 18:53:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424374080409600[0;39m <==    Updates: 0
2022-04-29 18:53:50.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424374080409600[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:53:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424395026763776[0;39m 生成今日电子书快照开始
2022-04-29 18:53:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424395026763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424395026763776[0;39m ==> Parameters: 
2022-04-29 18:53:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424395026763776[0;39m <==    Updates: 0
2022-04-29 18:53:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424395026763776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:53:57.458 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:53:57.459 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:53:57.459 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:53:57.658 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:53:57.660 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424406175223808[0;39m ------------- 开始 -------------
2022-04-29 18:53:57.661 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424406175223808[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:53:57.661 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424406175223808[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:53:57.661 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424406175223808[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:57.662 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424406175223808[0;39m 请求参数: [{"category1Id":175294069419937792,"cover":"1","description":"1","docCount":0,"name":"1","viewCount":0,"voteCount":0}]
2022-04-29 18:54:04.665 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424435518574592[0;39m 生成今日电子书快照开始
2022-04-29 18:54:04.706 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424435518574592[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:04.713 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424435518574592[0;39m ==> Parameters: 
2022-04-29 18:54:04.719 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424406175223808[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:54:04.736 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424406175223808[0;39m ==> Parameters: 175424435505991680(Long), 1(String), 175294069419937792(Long), null, 1(String), 1(String), 0(Integer), 0(Integer), 0(Integer)
2022-04-29 18:54:04.757 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424435518574592[0;39m <==    Updates: 0
2022-04-29 18:54:04.760 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424435518574592[0;39m 生成今日电子书快照结束，耗时：86毫秒
2022-04-29 18:54:04.776 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424406175223808[0;39m <==    Updates: 1
2022-04-29 18:54:04.779 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424406175223808[0;39m 返回结果: {"success":true}
2022-04-29 18:54:04.780 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424406175223808[0;39m ------------- 结束 耗时：7120 ms -------------
2022-04-29 18:54:04.814 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175424406175223808[0;39m ------------- LoginInterceptor 结束 耗时：7355 ms -------------
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424436525207552[0;39m ------------- 开始 -------------
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424436525207552[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424436525207552[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424436525207552[0;39m 远程地址: 127.0.0.1
2022-04-29 18:54:04.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424436525207552[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:54:04.899 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424436525207552[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:54:04.899 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424436525207552[0;39m ==> Parameters: 
2022-04-29 18:54:04.921 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424436525207552[0;39m <==    Columns: count(0)
2022-04-29 18:54:04.923 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424436525207552[0;39m <==        Row: 6
2022-04-29 18:54:04.924 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424436525207552[0;39m <==      Total: 1
2022-04-29 18:54:04.926 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424436525207552[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:54:04.926 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424436525207552[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:54:04.945 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:54:04.946 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:54:04.946 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:54:04.947 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:54:04.952 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:54:04.953 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:54:04.954 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 175424435505991680, 1, 175294069419937792, null, 1, 1, 0, 0, 0
2022-04-29 18:54:04.960 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424436525207552[0;39m <==      Total: 6
2022-04-29 18:54:04.960 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175424436525207552[0;39m total rows：6
2022-04-29 18:54:04.961 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175424436525207552[0;39m total pages：1
2022-04-29 18:54:04.968 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424436525207552[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2},{"category1Id":175294069419937792,"cover":"1","description":"1","docCount":0,"id":175424435505991680,"name":"1","viewCount":0,"voteCount":0}],"total":6},"success":true}
2022-04-29 18:54:04.968 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424436525207552[0;39m ------------- 结束 耗时：72 ms -------------
2022-04-29 18:54:05.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424436990775296[0;39m 生成今日电子书快照开始
2022-04-29 18:54:05.008 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424436990775296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:05.008 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424436990775296[0;39m ==> Parameters: 
2022-04-29 18:54:05.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424436990775296[0;39m <==    Updates: 1
2022-04-29 18:54:05.048 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424436990775296[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-29 18:54:05.049 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424437166936064[0;39m start updating Ebook doc
2022-04-29 18:54:05.050 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424437166936064[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:54:05.051 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424437166936064[0;39m ==> Parameters: 
2022-04-29 18:54:05.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424437166936064[0;39m <==    Updates: 1
2022-04-29 18:54:05.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424437166936064[0;39m update ends, take 51 millisecs
2022-04-29 18:54:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424457974878208[0;39m 生成今日电子书快照开始
2022-04-29 18:54:10.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424457974878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:10.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424457974878208[0;39m ==> Parameters: 
2022-04-29 18:54:10.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424457974878208[0;39m <==    Updates: 0
2022-04-29 18:54:10.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424457974878208[0;39m 生成今日电子书快照结束，耗时：79毫秒
2022-04-29 18:54:15.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424478942203904[0;39m 生成今日电子书快照开始
2022-04-29 18:54:15.049 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424478942203904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:15.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424478942203904[0;39m ==> Parameters: 
2022-04-29 18:54:15.092 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424478942203904[0;39m <==    Updates: 0
2022-04-29 18:54:15.092 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424478942203904[0;39m 生成今日电子书快照结束，耗时：83毫秒
2022-04-29 18:54:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424499884363776[0;39m 生成今日电子书快照开始
2022-04-29 18:54:20.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424499884363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:20.041 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424499884363776[0;39m ==> Parameters: 
2022-04-29 18:54:20.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424499884363776[0;39m <==    Updates: 0
2022-04-29 18:54:20.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424499884363776[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 18:54:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424520855883776[0;39m 生成今日电子书快照开始
2022-04-29 18:54:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424520855883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424520855883776[0;39m ==> Parameters: 
2022-04-29 18:54:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424520855883776[0;39m <==    Updates: 0
2022-04-29 18:54:25.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424520855883776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:54:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424541860958208[0;39m 生成今日电子书快照开始
2022-04-29 18:54:30.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424541860958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:30.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424541860958208[0;39m ==> Parameters: 
2022-04-29 18:54:30.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424541860958208[0;39m <==    Updates: 0
2022-04-29 18:54:30.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424541860958208[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:54:35.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424562824089600[0;39m 生成今日电子书快照开始
2022-04-29 18:54:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424562824089600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424562824089600[0;39m ==> Parameters: 
2022-04-29 18:54:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424562824089600[0;39m <==    Updates: 0
2022-04-29 18:54:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424562824089600[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:54:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424563084136448[0;39m start updating Ebook doc
2022-04-29 18:54:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424563084136448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:54:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424563084136448[0;39m ==> Parameters: 
2022-04-29 18:54:35.114 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424563084136448[0;39m <==    Updates: 1
2022-04-29 18:54:35.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424563084136448[0;39m update ends, take 44 millisecs
2022-04-29 18:54:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424583787220992[0;39m 生成今日电子书快照开始
2022-04-29 18:54:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424583787220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:40.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424583787220992[0;39m ==> Parameters: 
2022-04-29 18:54:40.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424583787220992[0;39m <==    Updates: 0
2022-04-29 18:54:40.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424583787220992[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 18:54:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424604775518208[0;39m 生成今日电子书快照开始
2022-04-29 18:54:45.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424604775518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:45.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424604775518208[0;39m ==> Parameters: 
2022-04-29 18:54:45.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424604775518208[0;39m <==    Updates: 0
2022-04-29 18:54:45.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424604775518208[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:54:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424625709289472[0;39m 生成今日电子书快照开始
2022-04-29 18:54:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424625709289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424625709289472[0;39m ==> Parameters: 
2022-04-29 18:54:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424625709289472[0;39m <==    Updates: 0
2022-04-29 18:54:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424625709289472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:54:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424646693392384[0;39m 生成今日电子书快照开始
2022-04-29 18:54:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424646693392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424646693392384[0;39m ==> Parameters: 
2022-04-29 18:54:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424646693392384[0;39m <==    Updates: 0
2022-04-29 18:54:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424646693392384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:55:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424667685883904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424667685883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:00.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424667685883904[0;39m ==> Parameters: 
2022-04-29 18:55:00.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424667685883904[0;39m <==    Updates: 0
2022-04-29 18:55:00.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424667685883904[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 18:55:05.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424688657403904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:05.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424688657403904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:05.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424688657403904[0;39m ==> Parameters: 
2022-04-29 18:55:05.127 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424688657403904[0;39m <==    Updates: 0
2022-04-29 18:55:05.128 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424688657403904[0;39m 生成今日电子书快照结束，耗时：117毫秒
2022-04-29 18:55:05.128 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424689156526080[0;39m start updating Ebook doc
2022-04-29 18:55:05.129 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424689156526080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:55:05.129 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424689156526080[0;39m ==> Parameters: 
2022-04-29 18:55:05.181 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424689156526080[0;39m <==    Updates: 1
2022-04-29 18:55:05.182 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424689156526080[0;39m update ends, take 54 millisecs
2022-04-29 18:55:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424709628923904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424709628923904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424709628923904[0;39m ==> Parameters: 
2022-04-29 18:55:10.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424709628923904[0;39m <==    Updates: 0
2022-04-29 18:55:10.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424709628923904[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:55:15.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424730600443904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424730600443904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424730600443904[0;39m ==> Parameters: 
2022-04-29 18:55:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424730600443904[0;39m <==    Updates: 0
2022-04-29 18:55:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424730600443904[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:55:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424751546798080[0;39m 生成今日电子书快照开始
2022-04-29 18:55:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424751546798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424751546798080[0;39m ==> Parameters: 
2022-04-29 18:55:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424751546798080[0;39m <==    Updates: 0
2022-04-29 18:55:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424751546798080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:55:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424772530900992[0;39m 生成今日电子书快照开始
2022-04-29 18:55:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424772530900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424772530900992[0;39m ==> Parameters: 
2022-04-29 18:55:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424772530900992[0;39m <==    Updates: 0
2022-04-29 18:55:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424772530900992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:55:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424793477255168[0;39m 生成今日电子书快照开始
2022-04-29 18:55:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424793477255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424793477255168[0;39m ==> Parameters: 
2022-04-29 18:55:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424793477255168[0;39m <==    Updates: 0
2022-04-29 18:55:30.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424793477255168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:55:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424814478135296[0;39m 生成今日电子书快照开始
2022-04-29 18:55:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424814478135296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424814478135296[0;39m ==> Parameters: 
2022-04-29 18:55:35.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424814478135296[0;39m <==    Updates: 0
2022-04-29 18:55:35.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424814478135296[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:55:35.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424814750765056[0;39m start updating Ebook doc
2022-04-29 18:55:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424814750765056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:55:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424814750765056[0;39m ==> Parameters: 
2022-04-29 18:55:35.115 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424814750765056[0;39m <==    Updates: 1
2022-04-29 18:55:35.116 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424814750765056[0;39m update ends, take 44 millisecs
2022-04-29 18:55:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424835462238208[0;39m 生成今日电子书快照开始
2022-04-29 18:55:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424835462238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424835462238208[0;39m ==> Parameters: 
2022-04-29 18:55:40.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424835462238208[0;39m <==    Updates: 0
2022-04-29 18:55:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424835462238208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:55:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424856412786688[0;39m 生成今日电子书快照开始
2022-04-29 18:55:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424856412786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424856412786688[0;39m ==> Parameters: 
2022-04-29 18:55:45.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424856412786688[0;39m <==    Updates: 0
2022-04-29 18:55:45.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424856412786688[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 18:55:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424877371723776[0;39m 生成今日电子书快照开始
2022-04-29 18:55:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424877371723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424877371723776[0;39m ==> Parameters: 
2022-04-29 18:55:50.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424877371723776[0;39m <==    Updates: 0
2022-04-29 18:55:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424877371723776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:55:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424898360020992[0;39m 生成今日电子书快照开始
2022-04-29 18:55:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424898360020992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424898360020992[0;39m ==> Parameters: 
2022-04-29 18:55:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424898360020992[0;39m <==    Updates: 0
2022-04-29 18:55:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424898360020992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:56:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424919314763776[0;39m 生成今日电子书快照开始
2022-04-29 18:56:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424919314763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424919314763776[0;39m ==> Parameters: 
2022-04-29 18:56:00.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424919314763776[0;39m <==    Updates: 0
2022-04-29 18:56:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424919314763776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:56:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424940282089472[0;39m 生成今日电子书快照开始
2022-04-29 18:56:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424940282089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424940282089472[0;39m ==> Parameters: 
2022-04-29 18:56:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424940282089472[0;39m <==    Updates: 0
2022-04-29 18:56:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424940282089472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:56:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424940550524928[0;39m start updating Ebook doc
2022-04-29 18:56:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424940550524928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:56:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424940550524928[0;39m ==> Parameters: 
2022-04-29 18:56:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424940550524928[0;39m <==    Updates: 1
2022-04-29 18:56:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424940550524928[0;39m update ends, take 41 millisecs
2022-04-29 18:56:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424961270386688[0;39m 生成今日电子书快照开始
2022-04-29 18:56:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424961270386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424961270386688[0;39m ==> Parameters: 
2022-04-29 18:56:10.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424961270386688[0;39m <==    Updates: 0
2022-04-29 18:56:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424961270386688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:56:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424982237712384[0;39m 生成今日电子书快照开始
2022-04-29 18:56:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424982237712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424982237712384[0;39m ==> Parameters: 
2022-04-29 18:56:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424982237712384[0;39m <==    Updates: 0
2022-04-29 18:56:15.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424982237712384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:56:16.731 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175422965134004224[0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:56:16.732 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175422965134004224[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:56:16.732 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175422965134004224[0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:56:16.931 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175422965134004224[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:56:16.936 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424990341107712[0;39m ------------- 开始 -------------
2022-04-29 18:56:16.936 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424990341107712[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:56:16.936 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424990341107712[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:56:16.937 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424990341107712[0;39m 远程地址: 127.0.0.1
2022-04-29 18:56:16.939 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424990341107712[0;39m 请求参数: [{"category1Id":200,"category2Id":201,"docCount":0,"name":"Spring","viewCount":0,"voteCount":0}]
2022-04-29 18:56:28.269 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425037870960640[0;39m 生成今日电子书快照开始
2022-04-29 18:56:28.286 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424990341107712[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:56:28.287 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424990341107712[0;39m ==> Parameters: 175425037875154944(Long), Spring(String), 200(Long), 201(Long), null, null, 0(Integer), 0(Integer), 0(Integer)
2022-04-29 18:56:28.288 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425037870960640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:28.289 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425037870960640[0;39m ==> Parameters: 
2022-04-29 18:56:28.321 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424990341107712[0;39m <==    Updates: 1
2022-04-29 18:56:28.322 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424990341107712[0;39m 返回结果: {"success":true}
2022-04-29 18:56:28.322 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424990341107712[0;39m ------------- 结束 耗时：11386 ms -------------
2022-04-29 18:56:28.323 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175424990341107712[0;39m ------------- LoginInterceptor 结束 耗时：11591 ms -------------
2022-04-29 18:56:28.327 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425037870960640[0;39m <==    Updates: 1
2022-04-29 18:56:28.327 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425037870960640[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:56:28.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175425038252642304[0;39m ------------- 开始 -------------
2022-04-29 18:56:28.360 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175425038252642304[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:56:28.360 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175425038252642304[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:56:28.360 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175425038252642304[0;39m 远程地址: 127.0.0.1
2022-04-29 18:56:28.362 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175425038252642304[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:56:28.364 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175425038252642304[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:56:28.365 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175425038252642304[0;39m ==> Parameters: 
2022-04-29 18:56:28.379 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175425038252642304[0;39m <==    Columns: count(0)
2022-04-29 18:56:28.380 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175425038252642304[0;39m <==        Row: 7
2022-04-29 18:56:28.380 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175425038252642304[0;39m <==      Total: 1
2022-04-29 18:56:28.381 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175425038252642304[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:56:28.382 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175425038252642304[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:56:28.397 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:56:28.398 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:56:28.399 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:56:28.399 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:56:28.402 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:56:28.403 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:56:28.404 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 175424435505991680, 1, 175294069419937792, null, 1, 1, 0, 0, 0
2022-04-29 18:56:28.405 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 175425037875154944, Spring, 200, 201, null, null, 0, 0, 0
2022-04-29 18:56:28.406 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175425038252642304[0;39m <==      Total: 7
2022-04-29 18:56:28.407 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175425038252642304[0;39m total rows：7
2022-04-29 18:56:28.407 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175425038252642304[0;39m total pages：1
2022-04-29 18:56:28.408 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175425038252642304[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2},{"category1Id":175294069419937792,"cover":"1","description":"1","docCount":0,"id":175424435505991680,"name":"1","viewCount":0,"voteCount":0},{"category1Id":200,"category2Id":201,"docCount":0,"id":175425037875154944,"name":"Spring","viewCount":0,"voteCount":0}],"total":7},"success":true}
2022-04-29 18:56:28.409 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175425038252642304[0;39m ------------- 结束 耗时：50 ms -------------
2022-04-29 18:56:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425045135495168[0;39m 生成今日电子书快照开始
2022-04-29 18:56:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425045135495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425045135495168[0;39m ==> Parameters: 
2022-04-29 18:56:30.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425045135495168[0;39m <==    Updates: 0
2022-04-29 18:56:30.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425045135495168[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:56:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425066111209472[0;39m 生成今日电子书快照开始
2022-04-29 18:56:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425066111209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425066111209472[0;39m ==> Parameters: 
2022-04-29 18:56:35.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425066111209472[0;39m <==    Updates: 0
2022-04-29 18:56:35.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425066111209472[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 18:56:35.075 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425066421587968[0;39m start updating Ebook doc
2022-04-29 18:56:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425066421587968[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:56:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425066421587968[0;39m ==> Parameters: 
2022-04-29 18:56:35.116 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425066421587968[0;39m <==    Updates: 1
2022-04-29 18:56:35.116 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425066421587968[0;39m update ends, take 41 millisecs
2022-04-29 18:56:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425087078535168[0;39m 生成今日电子书快照开始
2022-04-29 18:56:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425087078535168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425087078535168[0;39m ==> Parameters: 
2022-04-29 18:56:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425087078535168[0;39m <==    Updates: 0
2022-04-29 18:56:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425087078535168[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:56:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425108058443776[0;39m 生成今日电子书快照开始
2022-04-29 18:56:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425108058443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425108058443776[0;39m ==> Parameters: 
2022-04-29 18:56:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425108058443776[0;39m <==    Updates: 0
2022-04-29 18:56:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425108058443776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:56:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425129025769472[0;39m 生成今日电子书快照开始
2022-04-29 18:56:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425129025769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425129025769472[0;39m ==> Parameters: 
2022-04-29 18:56:50.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425129025769472[0;39m <==    Updates: 0
2022-04-29 18:56:50.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425129025769472[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:56:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425150009872384[0;39m 生成今日电子书快照开始
2022-04-29 18:56:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425150009872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425150009872384[0;39m ==> Parameters: 
2022-04-29 18:56:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425150009872384[0;39m <==    Updates: 0
2022-04-29 18:56:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425150009872384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:57:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425170973003776[0;39m 生成今日电子书快照开始
2022-04-29 18:57:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425170973003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425170973003776[0;39m ==> Parameters: 
2022-04-29 18:57:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425170973003776[0;39m <==    Updates: 0
2022-04-29 18:57:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425170973003776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:57:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425191948718080[0;39m 生成今日电子书快照开始
2022-04-29 18:57:05.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425191948718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425191948718080[0;39m ==> Parameters: 
2022-04-29 18:57:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425191948718080[0;39m <==    Updates: 0
2022-04-29 18:57:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425191948718080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:57:05.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425192200376320[0;39m start updating Ebook doc
2022-04-29 18:57:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425192200376320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:57:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425192200376320[0;39m ==> Parameters: 
2022-04-29 18:57:05.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425192200376320[0;39m <==    Updates: 1
2022-04-29 18:57:05.103 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425192200376320[0;39m update ends, take 40 millisecs
2022-04-29 18:57:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425212920238080[0;39m 生成今日电子书快照开始
2022-04-29 18:57:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425212920238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425212920238080[0;39m ==> Parameters: 
2022-04-29 18:57:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425212920238080[0;39m <==    Updates: 0
2022-04-29 18:57:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425212920238080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:57:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425233879175168[0;39m 生成今日电子书快照开始
2022-04-29 18:57:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425233879175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425233879175168[0;39m ==> Parameters: 
2022-04-29 18:57:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425233879175168[0;39m <==    Updates: 0
2022-04-29 18:57:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425233879175168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:57:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425254867472384[0;39m 生成今日电子书快照开始
2022-04-29 18:57:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425254867472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:20.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425254867472384[0;39m ==> Parameters: 
2022-04-29 18:57:20.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425254867472384[0;39m <==    Updates: 0
2022-04-29 18:57:20.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425254867472384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:57:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425275830603776[0;39m 生成今日电子书快照开始
2022-04-29 18:57:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425275830603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425275830603776[0;39m ==> Parameters: 
2022-04-29 18:57:25.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425275830603776[0;39m <==    Updates: 0
2022-04-29 18:57:25.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425275830603776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:57:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425296814706688[0;39m 生成今日电子书快照开始
2022-04-29 18:57:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425296814706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:30.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425296814706688[0;39m ==> Parameters: 
2022-04-29 18:57:30.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425296814706688[0;39m <==    Updates: 0
2022-04-29 18:57:30.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425296814706688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:57:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425317773643776[0;39m 生成今日电子书快照开始
2022-04-29 18:57:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425317773643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425317773643776[0;39m ==> Parameters: 
2022-04-29 18:57:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425317773643776[0;39m <==    Updates: 0
2022-04-29 18:57:35.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425317773643776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:57:35.073 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425318071439360[0;39m start updating Ebook doc
2022-04-29 18:57:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425318071439360[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:57:35.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425318071439360[0;39m ==> Parameters: 
2022-04-29 18:57:35.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425318071439360[0;39m <==    Updates: 1
2022-04-29 18:57:35.119 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425318071439360[0;39m update ends, take 46 millisecs
2022-04-29 18:57:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425338740969472[0;39m 生成今日电子书快照开始
2022-04-29 18:57:40.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425338740969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:40.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425338740969472[0;39m ==> Parameters: 
2022-04-29 18:57:40.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425338740969472[0;39m <==    Updates: 0
2022-04-29 18:57:40.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425338740969472[0;39m 生成今日电子书快照结束，耗时：79毫秒
2022-04-29 18:57:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425359712489472[0;39m 生成今日电子书快照开始
2022-04-29 18:57:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425359712489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425359712489472[0;39m ==> Parameters: 
2022-04-29 18:57:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425359712489472[0;39m <==    Updates: 0
2022-04-29 18:57:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425359712489472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:57:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425380700786688[0;39m 生成今日电子书快照开始
2022-04-29 18:57:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425380700786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425380700786688[0;39m ==> Parameters: 
2022-04-29 18:57:50.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425380700786688[0;39m <==    Updates: 0
2022-04-29 18:57:50.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425380700786688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:57:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425401655529472[0;39m 生成今日电子书快照开始
2022-04-29 18:57:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425401655529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425401655529472[0;39m ==> Parameters: 
2022-04-29 18:57:55.187 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425401655529472[0;39m <==    Updates: 0
2022-04-29 18:57:55.188 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425401655529472[0;39m 生成今日电子书快照结束，耗时：187毫秒
2022-04-29 18:58:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425422631243776[0;39m 生成今日电子书快照开始
2022-04-29 18:58:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425422631243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425422631243776[0;39m ==> Parameters: 
2022-04-29 18:58:00.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425422631243776[0;39m <==    Updates: 0
2022-04-29 18:58:00.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425422631243776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:58:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425443611152384[0;39m 生成今日电子书快照开始
2022-04-29 18:58:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425443611152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425443611152384[0;39m ==> Parameters: 
2022-04-29 18:58:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425443611152384[0;39m <==    Updates: 0
2022-04-29 18:58:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425443611152384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:58:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425443892170752[0;39m start updating Ebook doc
2022-04-29 18:58:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425443892170752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:58:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425443892170752[0;39m ==> Parameters: 
2022-04-29 18:58:05.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425443892170752[0;39m <==    Updates: 1
2022-04-29 18:58:05.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425443892170752[0;39m update ends, take 38 millisecs
2022-04-29 18:58:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425464586866688[0;39m 生成今日电子书快照开始
2022-04-29 18:58:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425464586866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:10.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425464586866688[0;39m ==> Parameters: 
2022-04-29 18:58:10.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425464586866688[0;39m <==    Updates: 0
2022-04-29 18:58:10.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425464586866688[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:58:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425485549998080[0;39m 生成今日电子书快照开始
2022-04-29 18:58:15.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425485549998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:15.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425485549998080[0;39m ==> Parameters: 
2022-04-29 18:58:15.095 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425485549998080[0;39m <==    Updates: 0
2022-04-29 18:58:15.095 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425485549998080[0;39m 生成今日电子书快照结束，耗时：92毫秒
2022-04-29 18:58:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425506521518080[0;39m 生成今日电子书快照开始
2022-04-29 18:58:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425506521518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425506521518080[0;39m ==> Parameters: 
2022-04-29 18:58:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425506521518080[0;39m <==    Updates: 0
2022-04-29 18:58:20.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425506521518080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:58:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425527493038080[0;39m 生成今日电子书快照开始
2022-04-29 18:58:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425527493038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425527493038080[0;39m ==> Parameters: 
2022-04-29 18:58:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425527493038080[0;39m <==    Updates: 0
2022-04-29 18:58:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425527493038080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:58:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425548468752384[0;39m 生成今日电子书快照开始
2022-04-29 18:58:30.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425548468752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:30.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425548468752384[0;39m ==> Parameters: 
2022-04-29 18:58:30.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425548468752384[0;39m <==    Updates: 0
2022-04-29 18:58:30.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425548468752384[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 18:58:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425569436078080[0;39m start updating Ebook doc
2022-04-29 18:58:35.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425569436078080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:58:35.030 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425569436078080[0;39m ==> Parameters: 
2022-04-29 18:58:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425569436078080[0;39m <==    Updates: 1
2022-04-29 18:58:35.074 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425569436078080[0;39m update ends, take 70 millisecs
2022-04-29 18:58:35.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425569738067968[0;39m 生成今日电子书快照开始
2022-04-29 18:58:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425569738067968[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:35.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425569738067968[0;39m ==> Parameters: 
2022-04-29 18:58:35.127 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425569738067968[0;39m <==    Updates: 0
2022-04-29 18:58:35.128 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425569738067968[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 18:58:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425590415986688[0;39m 生成今日电子书快照开始
2022-04-29 18:58:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425590415986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425590415986688[0;39m ==> Parameters: 
2022-04-29 18:58:40.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425590415986688[0;39m <==    Updates: 0
2022-04-29 18:58:40.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425590415986688[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 18:58:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425611383312384[0;39m 生成今日电子书快照开始
2022-04-29 18:58:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425611383312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425611383312384[0;39m ==> Parameters: 
2022-04-29 18:58:45.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425611383312384[0;39m <==    Updates: 0
2022-04-29 18:58:45.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425611383312384[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 18:58:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425632359026688[0;39m 生成今日电子书快照开始
2022-04-29 18:58:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425632359026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425632359026688[0;39m ==> Parameters: 
2022-04-29 18:58:50.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425632359026688[0;39m <==    Updates: 0
2022-04-29 18:58:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425632359026688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:58:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425653317963776[0;39m 生成今日电子书快照开始
2022-04-29 18:58:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425653317963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425653317963776[0;39m ==> Parameters: 
2022-04-29 18:58:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425653317963776[0;39m <==    Updates: 0
2022-04-29 18:58:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425653317963776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:59:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425674285289472[0;39m 生成今日电子书快照开始
2022-04-29 18:59:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425674285289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425674285289472[0;39m ==> Parameters: 
2022-04-29 18:59:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425674285289472[0;39m <==    Updates: 0
2022-04-29 18:59:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425674285289472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:59:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425695269392384[0;39m 生成今日电子书快照开始
2022-04-29 18:59:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425695269392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425695269392384[0;39m ==> Parameters: 
2022-04-29 18:59:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425695269392384[0;39m <==    Updates: 0
2022-04-29 18:59:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425695269392384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:59:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425695529439232[0;39m start updating Ebook doc
2022-04-29 18:59:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425695529439232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:59:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425695529439232[0;39m ==> Parameters: 
2022-04-29 18:59:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425695529439232[0;39m <==    Updates: 1
2022-04-29 18:59:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425695529439232[0;39m update ends, take 40 millisecs
2022-04-29 18:59:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425716245106688[0;39m 生成今日电子书快照开始
2022-04-29 18:59:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425716245106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425716245106688[0;39m ==> Parameters: 
2022-04-29 18:59:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425716245106688[0;39m <==    Updates: 0
2022-04-29 18:59:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425716245106688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:59:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425737204043776[0;39m 生成今日电子书快照开始
2022-04-29 18:59:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425737204043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425737204043776[0;39m ==> Parameters: 
2022-04-29 18:59:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425737204043776[0;39m <==    Updates: 0
2022-04-29 18:59:15.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425737204043776[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 18:59:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425758183952384[0;39m 生成今日电子书快照开始
2022-04-29 18:59:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425758183952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425758183952384[0;39m ==> Parameters: 
2022-04-29 18:59:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425758183952384[0;39m <==    Updates: 0
2022-04-29 18:59:20.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425758183952384[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 18:59:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425779155472384[0;39m 生成今日电子书快照开始
2022-04-29 18:59:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425779155472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425779155472384[0;39m ==> Parameters: 
2022-04-29 18:59:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425779155472384[0;39m <==    Updates: 0
2022-04-29 18:59:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425779155472384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:59:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425800131186688[0;39m 生成今日电子书快照开始
2022-04-29 18:59:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425800131186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425800131186688[0;39m ==> Parameters: 
2022-04-29 18:59:30.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425800131186688[0;39m <==    Updates: 0
2022-04-29 18:59:30.113 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425800131186688[0;39m 生成今日电子书快照结束，耗时：107毫秒
2022-04-29 18:59:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425821090123776[0;39m 生成今日电子书快照开始
2022-04-29 18:59:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425821090123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:35.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425821090123776[0;39m ==> Parameters: 
2022-04-29 18:59:35.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425821090123776[0;39m <==    Updates: 0
2022-04-29 18:59:35.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425821090123776[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 18:59:35.081 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425821421473792[0;39m start updating Ebook doc
2022-04-29 18:59:35.081 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425821421473792[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:59:35.082 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425821421473792[0;39m ==> Parameters: 
2022-04-29 18:59:35.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425821421473792[0;39m <==    Updates: 1
2022-04-29 18:59:35.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425821421473792[0;39m update ends, take 39 millisecs
2022-04-29 18:59:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425842065838080[0;39m 生成今日电子书快照开始
2022-04-29 18:59:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425842065838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425842065838080[0;39m ==> Parameters: 
2022-04-29 18:59:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425842065838080[0;39m <==    Updates: 0
2022-04-29 18:59:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425842065838080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:59:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425863033163776[0;39m 生成今日电子书快照开始
2022-04-29 18:59:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425863033163776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425863033163776[0;39m ==> Parameters: 
2022-04-29 18:59:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425863033163776[0;39m <==    Updates: 0
2022-04-29 18:59:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425863033163776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:59:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425884017266688[0;39m 生成今日电子书快照开始
2022-04-29 18:59:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425884017266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425884017266688[0;39m ==> Parameters: 
2022-04-29 18:59:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425884017266688[0;39m <==    Updates: 0
2022-04-29 18:59:50.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425884017266688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:59:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425904967815168[0;39m 生成今日电子书快照开始
2022-04-29 18:59:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425904967815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425904967815168[0;39m ==> Parameters: 
2022-04-29 18:59:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425904967815168[0;39m <==    Updates: 0
2022-04-29 18:59:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425904967815168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:00:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425925951918080[0;39m 生成今日电子书快照开始
2022-04-29 19:00:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425925951918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425925951918080[0;39m ==> Parameters: 
2022-04-29 19:00:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425925951918080[0;39m <==    Updates: 0
2022-04-29 19:00:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425925951918080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:00:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425946927632384[0;39m 生成今日电子书快照开始
2022-04-29 19:00:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425946927632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425946927632384[0;39m ==> Parameters: 
2022-04-29 19:00:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425946927632384[0;39m <==    Updates: 0
2022-04-29 19:00:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425946927632384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:00:05.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425947196067840[0;39m start updating Ebook doc
2022-04-29 19:00:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425947196067840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:00:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425947196067840[0;39m ==> Parameters: 
2022-04-29 19:00:05.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425947196067840[0;39m <==    Updates: 1
2022-04-29 19:00:05.107 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425947196067840[0;39m update ends, take 39 millisecs
2022-04-29 19:00:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425967890763776[0;39m 生成今日电子书快照开始
2022-04-29 19:00:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425967890763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425967890763776[0;39m ==> Parameters: 
2022-04-29 19:00:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425967890763776[0;39m <==    Updates: 0
2022-04-29 19:00:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425967890763776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:00:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425988879060992[0;39m 生成今日电子书快照开始
2022-04-29 19:00:15.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425988879060992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:15.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425988879060992[0;39m ==> Parameters: 
2022-04-29 19:00:15.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425988879060992[0;39m <==    Updates: 0
2022-04-29 19:00:15.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425988879060992[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:00:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426009837998080[0;39m 生成今日电子书快照开始
2022-04-29 19:00:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426009837998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426009837998080[0;39m ==> Parameters: 
2022-04-29 19:00:20.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426009837998080[0;39m <==    Updates: 0
2022-04-29 19:00:20.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426009837998080[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 19:00:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426030805323776[0;39m 生成今日电子书快照开始
2022-04-29 19:00:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426030805323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426030805323776[0;39m ==> Parameters: 
2022-04-29 19:00:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426030805323776[0;39m <==    Updates: 0
2022-04-29 19:00:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426030805323776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:00:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426051781038080[0;39m 生成今日电子书快照开始
2022-04-29 19:00:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426051781038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426051781038080[0;39m ==> Parameters: 
2022-04-29 19:00:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426051781038080[0;39m <==    Updates: 0
2022-04-29 19:00:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426051781038080[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:00:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426072756752384[0;39m 生成今日电子书快照开始
2022-04-29 19:00:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426072756752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:35.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426072756752384[0;39m ==> Parameters: 
2022-04-29 19:00:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426072756752384[0;39m <==    Updates: 0
2022-04-29 19:00:35.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426072756752384[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:00:35.074 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426073050353664[0;39m start updating Ebook doc
2022-04-29 19:00:35.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426073050353664[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:00:35.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426073050353664[0;39m ==> Parameters: 
2022-04-29 19:00:35.113 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426073050353664[0;39m <==    Updates: 1
2022-04-29 19:00:35.113 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426073050353664[0;39m update ends, take 39 millisecs
2022-04-29 19:00:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426093711495168[0;39m 生成今日电子书快照开始
2022-04-29 19:00:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426093711495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426093711495168[0;39m ==> Parameters: 
2022-04-29 19:00:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426093711495168[0;39m <==    Updates: 0
2022-04-29 19:00:40.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426093711495168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:00:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426114703986688[0;39m 生成今日电子书快照开始
2022-04-29 19:00:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426114703986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426114703986688[0;39m ==> Parameters: 
2022-04-29 19:00:45.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426114703986688[0;39m <==    Updates: 0
2022-04-29 19:00:45.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426114703986688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:00:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426135654535168[0;39m 生成今日电子书快照开始
2022-04-29 19:00:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426135654535168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426135654535168[0;39m ==> Parameters: 
2022-04-29 19:00:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426135654535168[0;39m <==    Updates: 0
2022-04-29 19:00:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426135654535168[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:00:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426156642832384[0;39m 生成今日电子书快照开始
2022-04-29 19:00:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426156642832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426156642832384[0;39m ==> Parameters: 
2022-04-29 19:00:55.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426156642832384[0;39m <==    Updates: 0
2022-04-29 19:00:55.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426156642832384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 19:01:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426177605963776[0;39m 生成今日电子书快照开始
2022-04-29 19:01:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426177605963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426177605963776[0;39m ==> Parameters: 
2022-04-29 19:01:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426177605963776[0;39m <==    Updates: 0
2022-04-29 19:01:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426177605963776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:01:05.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426198569095168[0;39m start updating Ebook doc
2022-04-29 19:01:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426198569095168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:01:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426198569095168[0;39m ==> Parameters: 
2022-04-29 19:01:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426198569095168[0;39m <==    Updates: 1
2022-04-29 19:01:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426198569095168[0;39m update ends, take 65 millisecs
2022-04-29 19:01:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426198850113536[0;39m 生成今日电子书快照开始
2022-04-29 19:01:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426198850113536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426198850113536[0;39m ==> Parameters: 
2022-04-29 19:01:05.119 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426198850113536[0;39m <==    Updates: 0
2022-04-29 19:01:05.120 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426198850113536[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 19:01:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426219553198080[0;39m 生成今日电子书快照开始
2022-04-29 19:01:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426219553198080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426219553198080[0;39m ==> Parameters: 
2022-04-29 19:01:10.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426219553198080[0;39m <==    Updates: 0
2022-04-29 19:01:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426219553198080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:01:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426240537300992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426240537300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426240537300992[0;39m ==> Parameters: 
2022-04-29 19:01:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426240537300992[0;39m <==    Updates: 0
2022-04-29 19:01:15.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426240537300992[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:01:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426261492043776[0;39m 生成今日电子书快照开始
2022-04-29 19:01:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426261492043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426261492043776[0;39m ==> Parameters: 
2022-04-29 19:01:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426261492043776[0;39m <==    Updates: 0
2022-04-29 19:01:20.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426261492043776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 19:01:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426282480340992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426282480340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426282480340992[0;39m ==> Parameters: 
2022-04-29 19:01:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426282480340992[0;39m <==    Updates: 0
2022-04-29 19:01:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426282480340992[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:01:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426303443472384[0;39m 生成今日电子书快照开始
2022-04-29 19:01:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426303443472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426303443472384[0;39m ==> Parameters: 
2022-04-29 19:01:30.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426303443472384[0;39m <==    Updates: 0
2022-04-29 19:01:30.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426303443472384[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:01:35.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426324435963904[0;39m start updating Ebook doc
2022-04-29 19:01:35.036 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426324435963904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:01:35.037 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426324435963904[0;39m ==> Parameters: 
2022-04-29 19:01:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426324435963904[0;39m <==    Updates: 1
2022-04-29 19:01:35.076 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426324435963904[0;39m update ends, take 66 millisecs
2022-04-29 19:01:35.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426324721176576[0;39m 生成今日电子书快照开始
2022-04-29 19:01:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426324721176576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426324721176576[0;39m ==> Parameters: 
2022-04-29 19:01:35.121 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426324721176576[0;39m <==    Updates: 0
2022-04-29 19:01:35.121 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426324721176576[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-29 19:01:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426345386512384[0;39m 生成今日电子书快照开始
2022-04-29 19:01:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426345386512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426345386512384[0;39m ==> Parameters: 
2022-04-29 19:01:40.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426345386512384[0;39m <==    Updates: 0
2022-04-29 19:01:40.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426345386512384[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 19:01:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426366366420992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426366366420992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426366366420992[0;39m ==> Parameters: 
2022-04-29 19:01:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426366366420992[0;39m <==    Updates: 0
2022-04-29 19:01:45.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426366366420992[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:01:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426387333746688[0;39m 生成今日电子书快照开始
2022-04-29 19:01:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426387333746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426387333746688[0;39m ==> Parameters: 
2022-04-29 19:01:50.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426387333746688[0;39m <==    Updates: 0
2022-04-29 19:01:50.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426387333746688[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 19:01:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426408309460992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426408309460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426408309460992[0;39m ==> Parameters: 
2022-04-29 19:01:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426408309460992[0;39m <==    Updates: 0
2022-04-29 19:01:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426408309460992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:02:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426429272592384[0;39m 生成今日电子书快照开始
2022-04-29 19:02:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426429272592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426429272592384[0;39m ==> Parameters: 
2022-04-29 19:02:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426429272592384[0;39m <==    Updates: 0
2022-04-29 19:02:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426429272592384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:02:05.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426450252500992[0;39m 生成今日电子书快照开始
2022-04-29 19:02:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426450252500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426450252500992[0;39m ==> Parameters: 
2022-04-29 19:02:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426450252500992[0;39m <==    Updates: 0
2022-04-29 19:02:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426450252500992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:02:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426450525130752[0;39m start updating Ebook doc
2022-04-29 19:02:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426450525130752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:02:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426450525130752[0;39m ==> Parameters: 
2022-04-29 19:02:05.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426450525130752[0;39m <==    Updates: 1
2022-04-29 19:02:05.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426450525130752[0;39m update ends, take 39 millisecs
2022-04-29 19:02:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426471198855168[0;39m 生成今日电子书快照开始
2022-04-29 19:02:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426471198855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426471198855168[0;39m ==> Parameters: 
2022-04-29 19:02:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426471198855168[0;39m <==    Updates: 0
2022-04-29 19:02:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426471198855168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:02:15.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426492208123904[0;39m 生成今日电子书快照开始
2022-04-29 19:02:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426492208123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426492208123904[0;39m ==> Parameters: 
2022-04-29 19:02:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426492208123904[0;39m <==    Updates: 0
2022-04-29 19:02:15.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426492208123904[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:02:20.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426513171255296[0;39m 生成今日电子书快照开始
2022-04-29 19:02:20.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426513171255296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:20.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426513171255296[0;39m ==> Parameters: 
2022-04-29 19:02:20.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426513171255296[0;39m <==    Updates: 0
2022-04-29 19:02:20.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426513171255296[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:02:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426534130192384[0;39m 生成今日电子书快照开始
2022-04-29 19:02:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426534130192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426534130192384[0;39m ==> Parameters: 
2022-04-29 19:02:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426534130192384[0;39m <==    Updates: 0
2022-04-29 19:02:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426534130192384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:02:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426555126878208[0;39m 生成今日电子书快照开始
2022-04-29 19:02:30.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426555126878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:30.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426555126878208[0;39m ==> Parameters: 
2022-04-29 19:02:30.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426555126878208[0;39m <==    Updates: 0
2022-04-29 19:02:30.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426555126878208[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 19:02:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426576060649472[0;39m 生成今日电子书快照开始
2022-04-29 19:02:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426576060649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426576060649472[0;39m ==> Parameters: 
2022-04-29 19:02:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426576060649472[0;39m <==    Updates: 0
2022-04-29 19:02:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426576060649472[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:02:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426576350056448[0;39m start updating Ebook doc
2022-04-29 19:02:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426576350056448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:02:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426576350056448[0;39m ==> Parameters: 
2022-04-29 19:02:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426576350056448[0;39m <==    Updates: 1
2022-04-29 19:02:35.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426576350056448[0;39m update ends, take 39 millisecs
2022-04-29 19:02:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426597061529600[0;39m 生成今日电子书快照开始
2022-04-29 19:02:40.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426597061529600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:40.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426597061529600[0;39m ==> Parameters: 
2022-04-29 19:02:40.092 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426597061529600[0;39m <==    Updates: 0
2022-04-29 19:02:40.094 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426597061529600[0;39m 生成今日电子书快照结束，耗时：85毫秒
2022-04-29 19:02:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426618020466688[0;39m 生成今日电子书快照开始
2022-04-29 19:02:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426618020466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426618020466688[0;39m ==> Parameters: 
2022-04-29 19:02:45.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426618020466688[0;39m <==    Updates: 0
2022-04-29 19:02:45.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426618020466688[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:02:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426638987792384[0;39m 生成今日电子书快照开始
2022-04-29 19:02:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426638987792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:50.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426638987792384[0;39m ==> Parameters: 
2022-04-29 19:02:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426638987792384[0;39m <==    Updates: 0
2022-04-29 19:02:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426638987792384[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:02:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426659946729472[0;39m 生成今日电子书快照开始
2022-04-29 19:02:55.189 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426659946729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:55.190 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426659946729472[0;39m ==> Parameters: 
2022-04-29 19:02:55.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426659946729472[0;39m <==    Updates: 0
2022-04-29 19:02:55.228 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426659946729472[0;39m 生成今日电子书快照结束，耗时：227毫秒
2022-04-29 19:03:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426680926638080[0;39m 生成今日电子书快照开始
2022-04-29 19:03:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426680926638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426680926638080[0;39m ==> Parameters: 
2022-04-29 19:03:00.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426680926638080[0;39m <==    Updates: 0
2022-04-29 19:03:00.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426680926638080[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 19:03:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426701906546688[0;39m 生成今日电子书快照开始
2022-04-29 19:03:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426701906546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426701906546688[0;39m ==> Parameters: 
2022-04-29 19:03:05.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426701906546688[0;39m <==    Updates: 0
2022-04-29 19:03:05.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426701906546688[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 19:03:05.076 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426702204342272[0;39m start updating Ebook doc
2022-04-29 19:03:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426702204342272[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:03:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426702204342272[0;39m ==> Parameters: 
2022-04-29 19:03:05.124 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426702204342272[0;39m <==    Updates: 1
2022-04-29 19:03:05.125 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426702204342272[0;39m update ends, take 48 millisecs
2022-04-29 19:03:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426722899038208[0;39m 生成今日电子书快照开始
2022-04-29 19:03:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426722899038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426722899038208[0;39m ==> Parameters: 
2022-04-29 19:03:10.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426722899038208[0;39m <==    Updates: 0
2022-04-29 19:03:10.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426722899038208[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:03:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426743870558208[0;39m 生成今日电子书快照开始
2022-04-29 19:03:15.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426743870558208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:15.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426743870558208[0;39m ==> Parameters: 
2022-04-29 19:03:15.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426743870558208[0;39m <==    Updates: 0
2022-04-29 19:03:15.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426743870558208[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 19:03:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426764812718080[0;39m 生成今日电子书快照开始
2022-04-29 19:03:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426764812718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426764812718080[0;39m ==> Parameters: 
2022-04-29 19:03:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426764812718080[0;39m <==    Updates: 0
2022-04-29 19:03:20.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426764812718080[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 19:03:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426785813598208[0;39m 生成今日电子书快照开始
2022-04-29 19:03:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426785813598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426785813598208[0;39m ==> Parameters: 
2022-04-29 19:03:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426785813598208[0;39m <==    Updates: 0
2022-04-29 19:03:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426785813598208[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:03:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426806759952384[0;39m 生成今日电子书快照开始
2022-04-29 19:03:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426806759952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426806759952384[0;39m ==> Parameters: 
2022-04-29 19:03:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426806759952384[0;39m <==    Updates: 0
2022-04-29 19:03:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426806759952384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:03:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426827744055296[0;39m 生成今日电子书快照开始
2022-04-29 19:03:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426827744055296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426827744055296[0;39m ==> Parameters: 
2022-04-29 19:03:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426827744055296[0;39m <==    Updates: 0
2022-04-29 19:03:35.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426827744055296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:03:35.073 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426828020879360[0;39m start updating Ebook doc
2022-04-29 19:03:35.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426828020879360[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:03:35.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426828020879360[0;39m ==> Parameters: 
2022-04-29 19:03:35.117 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426828020879360[0;39m <==    Updates: 1
2022-04-29 19:03:35.118 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426828020879360[0;39m update ends, take 45 millisecs
2022-04-29 19:03:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426848723963904[0;39m 生成今日电子书快照开始
2022-04-29 19:03:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426848723963904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426848723963904[0;39m ==> Parameters: 
2022-04-29 19:03:40.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426848723963904[0;39m <==    Updates: 0
2022-04-29 19:03:40.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426848723963904[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 19:03:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426869678706688[0;39m 生成今日电子书快照开始
2022-04-29 19:03:45.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426869678706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:45.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426869678706688[0;39m ==> Parameters: 
2022-04-29 19:03:45.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426869678706688[0;39m <==    Updates: 0
2022-04-29 19:03:45.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426869678706688[0;39m 生成今日电子书快照结束，耗时：83毫秒
2022-04-29 19:03:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426890641838080[0;39m 生成今日电子书快照开始
2022-04-29 19:03:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426890641838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:50.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426890641838080[0;39m ==> Parameters: 
2022-04-29 19:03:50.120 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426890641838080[0;39m <==    Updates: 0
2022-04-29 19:03:50.121 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426890641838080[0;39m 生成今日电子书快照结束，耗时：117毫秒
2022-04-29 19:03:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426911634329600[0;39m 生成今日电子书快照开始
2022-04-29 19:03:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426911634329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426911634329600[0;39m ==> Parameters: 
2022-04-29 19:03:55.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426911634329600[0;39m <==    Updates: 0
2022-04-29 19:03:55.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426911634329600[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:04:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426932597460992[0;39m 生成今日电子书快照开始
2022-04-29 19:04:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426932597460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:00.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426932597460992[0;39m ==> Parameters: 
2022-04-29 19:04:00.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426932597460992[0;39m <==    Updates: 0
2022-04-29 19:04:00.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426932597460992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:04:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426953556398080[0;39m 生成今日电子书快照开始
2022-04-29 19:04:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426953556398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426953556398080[0;39m ==> Parameters: 
2022-04-29 19:04:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426953556398080[0;39m <==    Updates: 0
2022-04-29 19:04:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426953556398080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:04:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426953833222144[0;39m start updating Ebook doc
2022-04-29 19:04:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426953833222144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:04:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426953833222144[0;39m ==> Parameters: 
2022-04-29 19:04:05.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426953833222144[0;39m <==    Updates: 1
2022-04-29 19:04:05.107 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426953833222144[0;39m update ends, take 38 millisecs
2022-04-29 19:04:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426974557278208[0;39m 生成今日电子书快照开始
2022-04-29 19:04:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426974557278208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426974557278208[0;39m ==> Parameters: 
2022-04-29 19:04:10.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426974557278208[0;39m <==    Updates: 0
2022-04-29 19:04:10.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426974557278208[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:04:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426995491049472[0;39m 生成今日电子书快照开始
2022-04-29 19:04:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426995491049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426995491049472[0;39m ==> Parameters: 
2022-04-29 19:04:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426995491049472[0;39m <==    Updates: 0
2022-04-29 19:04:15.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426995491049472[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:04:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427016483540992[0;39m 生成今日电子书快照开始
2022-04-29 19:04:20.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427016483540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:20.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427016483540992[0;39m ==> Parameters: 
2022-04-29 19:04:20.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427016483540992[0;39m <==    Updates: 0
2022-04-29 19:04:20.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427016483540992[0;39m 生成今日电子书快照结束，耗时：80毫秒
2022-04-29 19:04:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427037463449600[0;39m 生成今日电子书快照开始
2022-04-29 19:04:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427037463449600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427037463449600[0;39m ==> Parameters: 
2022-04-29 19:04:25.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427037463449600[0;39m <==    Updates: 0
2022-04-29 19:04:25.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427037463449600[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:04:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427058434969600[0;39m 生成今日电子书快照开始
2022-04-29 19:04:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427058434969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427058434969600[0;39m ==> Parameters: 
2022-04-29 19:04:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427058434969600[0;39m <==    Updates: 0
2022-04-29 19:04:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427058434969600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 19:04:35.008 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427079406489600[0;39m start updating Ebook doc
2022-04-29 19:04:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427079406489600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:04:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427079406489600[0;39m ==> Parameters: 
2022-04-29 19:04:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427079406489600[0;39m <==    Updates: 1
2022-04-29 19:04:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427079406489600[0;39m update ends, take 57 millisecs
2022-04-29 19:04:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427079645564928[0;39m 生成今日电子书快照开始
2022-04-29 19:04:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427079645564928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427079645564928[0;39m ==> Parameters: 
2022-04-29 19:04:35.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427079645564928[0;39m <==    Updates: 0
2022-04-29 19:04:35.107 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427079645564928[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-29 19:04:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427100348649472[0;39m 生成今日电子书快照开始
2022-04-29 19:04:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427100348649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427100348649472[0;39m ==> Parameters: 
2022-04-29 19:04:40.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427100348649472[0;39m <==    Updates: 0
2022-04-29 19:04:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427100348649472[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 19:04:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427121328558080[0;39m 生成今日电子书快照开始
2022-04-29 19:04:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427121328558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427121328558080[0;39m ==> Parameters: 
2022-04-29 19:04:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427121328558080[0;39m <==    Updates: 0
2022-04-29 19:04:45.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427121328558080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:04:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427142329438208[0;39m 生成今日电子书快照开始
2022-04-29 19:04:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427142329438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427142329438208[0;39m ==> Parameters: 
2022-04-29 19:04:50.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427142329438208[0;39m <==    Updates: 0
2022-04-29 19:04:50.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427142329438208[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:04:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427163300958208[0;39m 生成今日电子书快照开始
2022-04-29 19:04:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427163300958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427163300958208[0;39m ==> Parameters: 
2022-04-29 19:04:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427163300958208[0;39m <==    Updates: 0
2022-04-29 19:04:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427163300958208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:05:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427184259895296[0;39m 生成今日电子书快照开始
2022-04-29 19:05:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427184259895296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:00.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427184259895296[0;39m ==> Parameters: 
2022-04-29 19:05:00.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427184259895296[0;39m <==    Updates: 0
2022-04-29 19:05:00.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427184259895296[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 19:05:05.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427205227220992[0;39m 生成今日电子书快照开始
2022-04-29 19:05:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427205227220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427205227220992[0;39m ==> Parameters: 
2022-04-29 19:05:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427205227220992[0;39m <==    Updates: 0
2022-04-29 19:05:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427205227220992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:05:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427205499850752[0;39m start updating Ebook doc
2022-04-29 19:05:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427205499850752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:05:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427205499850752[0;39m ==> Parameters: 
2022-04-29 19:05:05.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427205499850752[0;39m <==    Updates: 1
2022-04-29 19:05:05.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427205499850752[0;39m update ends, take 49 millisecs
2022-04-29 19:05:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427226202935296[0;39m 生成今日电子书快照开始
2022-04-29 19:05:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427226202935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427226202935296[0;39m ==> Parameters: 
2022-04-29 19:05:10.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427226202935296[0;39m <==    Updates: 0
2022-04-29 19:05:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427226202935296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:05:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427247161872384[0;39m 生成今日电子书快照开始
2022-04-29 19:05:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427247161872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427247161872384[0;39m ==> Parameters: 
2022-04-29 19:05:15.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427247161872384[0;39m <==    Updates: 0
2022-04-29 19:05:15.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427247161872384[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:05:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427268137586688[0;39m 生成今日电子书快照开始
2022-04-29 19:05:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427268137586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427268137586688[0;39m ==> Parameters: 
2022-04-29 19:05:20.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427268137586688[0;39m <==    Updates: 0
2022-04-29 19:05:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427268137586688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:05:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427289130078208[0;39m 生成今日电子书快照开始
2022-04-29 19:05:25.041 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427289130078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:25.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427289130078208[0;39m ==> Parameters: 
2022-04-29 19:05:25.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427289130078208[0;39m <==    Updates: 0
2022-04-29 19:05:25.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427289130078208[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 19:05:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427310076432384[0;39m 生成今日电子书快照开始
2022-04-29 19:05:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427310076432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427310076432384[0;39m ==> Parameters: 
2022-04-29 19:05:30.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427310076432384[0;39m <==    Updates: 0
2022-04-29 19:05:30.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427310076432384[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 19:05:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427331052146688[0;39m 生成今日电子书快照开始
2022-04-29 19:05:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427331052146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427331052146688[0;39m ==> Parameters: 
2022-04-29 19:05:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427331052146688[0;39m <==    Updates: 0
2022-04-29 19:05:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427331052146688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:05:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427331303804928[0;39m start updating Ebook doc
2022-04-29 19:05:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427331303804928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:05:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427331303804928[0;39m ==> Parameters: 
2022-04-29 19:05:35.112 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427331303804928[0;39m <==    Updates: 1
2022-04-29 19:05:35.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427331303804928[0;39m update ends, take 47 millisecs
2022-04-29 19:05:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427352023666688[0;39m 生成今日电子书快照开始
2022-04-29 19:05:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427352023666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427352023666688[0;39m ==> Parameters: 
2022-04-29 19:05:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427352023666688[0;39m <==    Updates: 0
2022-04-29 19:05:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427352023666688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:05:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427372999380992[0;39m 生成今日电子书快照开始
2022-04-29 19:05:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427372999380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427372999380992[0;39m ==> Parameters: 
2022-04-29 19:05:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427372999380992[0;39m <==    Updates: 0
2022-04-29 19:05:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427372999380992[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:05:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427393954123776[0;39m 生成今日电子书快照开始
2022-04-29 19:05:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427393954123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427393954123776[0;39m ==> Parameters: 
2022-04-29 19:05:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427393954123776[0;39m <==    Updates: 0
2022-04-29 19:05:50.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427393954123776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:05:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427414925643776[0;39m 生成今日电子书快照开始
2022-04-29 19:05:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427414925643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427414925643776[0;39m ==> Parameters: 
2022-04-29 19:05:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427414925643776[0;39m <==    Updates: 0
2022-04-29 19:05:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427414925643776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:06:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427435897163776[0;39m 生成今日电子书快照开始
2022-04-29 19:06:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427435897163776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427435897163776[0;39m ==> Parameters: 
2022-04-29 19:06:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427435897163776[0;39m <==    Updates: 0
2022-04-29 19:06:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427435897163776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:06:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427456872878080[0;39m 生成今日电子书快照开始
2022-04-29 19:06:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427456872878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427456872878080[0;39m ==> Parameters: 
2022-04-29 19:06:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427456872878080[0;39m <==    Updates: 0
2022-04-29 19:06:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427456872878080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:06:05.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427457153896448[0;39m start updating Ebook doc
2022-04-29 19:06:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427457153896448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:06:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427457153896448[0;39m ==> Parameters: 
2022-04-29 19:06:05.112 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427457153896448[0;39m <==    Updates: 1
2022-04-29 19:06:05.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427457153896448[0;39m update ends, take 42 millisecs
2022-04-29 19:06:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427477831815168[0;39m 生成今日电子书快照开始
2022-04-29 19:06:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427477831815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427477831815168[0;39m ==> Parameters: 
2022-04-29 19:06:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427477831815168[0;39m <==    Updates: 0
2022-04-29 19:06:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427477831815168[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:06:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427498815918080[0;39m 生成今日电子书快照开始
2022-04-29 19:06:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427498815918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427498815918080[0;39m ==> Parameters: 
2022-04-29 19:06:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427498815918080[0;39m <==    Updates: 0
2022-04-29 19:06:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427498815918080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:06:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427519783243776[0;39m 生成今日电子书快照开始
2022-04-29 19:06:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427519783243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427519783243776[0;39m ==> Parameters: 
2022-04-29 19:06:20.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427519783243776[0;39m <==    Updates: 0
2022-04-29 19:06:20.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427519783243776[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:06:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427540763152384[0;39m 生成今日电子书快照开始
2022-04-29 19:06:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427540763152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427540763152384[0;39m ==> Parameters: 
2022-04-29 19:06:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427540763152384[0;39m <==    Updates: 0
2022-04-29 19:06:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427540763152384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:06:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427561717895168[0;39m 生成今日电子书快照开始
2022-04-29 19:06:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427561717895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427561717895168[0;39m ==> Parameters: 
2022-04-29 19:06:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427561717895168[0;39m <==    Updates: 0
2022-04-29 19:06:30.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427561717895168[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:06:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427582706192384[0;39m 生成今日电子书快照开始
2022-04-29 19:06:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427582706192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427582706192384[0;39m ==> Parameters: 
2022-04-29 19:06:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427582706192384[0;39m <==    Updates: 0
2022-04-29 19:06:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427582706192384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:06:35.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427582987210752[0;39m start updating Ebook doc
2022-04-29 19:06:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427582987210752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:06:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427582987210752[0;39m ==> Parameters: 
2022-04-29 19:06:35.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427582987210752[0;39m <==    Updates: 1
2022-04-29 19:06:35.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427582987210752[0;39m update ends, take 49 millisecs
2022-04-29 19:06:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427603677712384[0;39m 生成今日电子书快照开始
2022-04-29 19:06:40.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427603677712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:40.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427603677712384[0;39m ==> Parameters: 
2022-04-29 19:06:40.095 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427603677712384[0;39m <==    Updates: 0
2022-04-29 19:06:40.096 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427603677712384[0;39m 生成今日电子书快照结束，耗时：91毫秒
2022-04-29 19:06:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427624636649472[0;39m 生成今日电子书快照开始
2022-04-29 19:06:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427624636649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427624636649472[0;39m ==> Parameters: 
2022-04-29 19:06:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427624636649472[0;39m <==    Updates: 0
2022-04-29 19:06:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427624636649472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:06:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427645612363776[0;39m 生成今日电子书快照开始
2022-04-29 19:06:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427645612363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427645612363776[0;39m ==> Parameters: 
2022-04-29 19:06:50.086 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427645612363776[0;39m <==    Updates: 0
2022-04-29 19:06:50.087 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427645612363776[0;39m 生成今日电子书快照结束，耗时：84毫秒
2022-04-29 19:06:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427666575495168[0;39m 生成今日电子书快照开始
2022-04-29 19:06:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427666575495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427666575495168[0;39m ==> Parameters: 
2022-04-29 19:06:55.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427666575495168[0;39m <==    Updates: 0
2022-04-29 19:06:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427666575495168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:07:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427687559598080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427687559598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427687559598080[0;39m ==> Parameters: 
2022-04-29 19:07:00.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427687559598080[0;39m <==    Updates: 0
2022-04-29 19:07:00.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427687559598080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:07:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427708531118080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427708531118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427708531118080[0;39m ==> Parameters: 
2022-04-29 19:07:05.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427708531118080[0;39m <==    Updates: 0
2022-04-29 19:07:05.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427708531118080[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 19:07:05.078 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427708845690880[0;39m start updating Ebook doc
2022-04-29 19:07:05.079 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427708845690880[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:07:05.080 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427708845690880[0;39m ==> Parameters: 
2022-04-29 19:07:05.132 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427708845690880[0;39m <==    Updates: 1
2022-04-29 19:07:05.133 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427708845690880[0;39m update ends, take 54 millisecs
2022-04-29 19:07:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427729494249472[0;39m 生成今日电子书快照开始
2022-04-29 19:07:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427729494249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427729494249472[0;39m ==> Parameters: 
2022-04-29 19:07:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427729494249472[0;39m <==    Updates: 0
2022-04-29 19:07:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427729494249472[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:07:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427750474158080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427750474158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427750474158080[0;39m ==> Parameters: 
2022-04-29 19:07:15.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427750474158080[0;39m <==    Updates: 0
2022-04-29 19:07:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427750474158080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:07:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427771441483776[0;39m 生成今日电子书快照开始
2022-04-29 19:07:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427771441483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427771441483776[0;39m ==> Parameters: 
2022-04-29 19:07:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427771441483776[0;39m <==    Updates: 0
2022-04-29 19:07:20.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427771441483776[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 19:07:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427792404615168[0;39m 生成今日电子书快照开始
2022-04-29 19:07:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427792404615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427792404615168[0;39m ==> Parameters: 
2022-04-29 19:07:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427792404615168[0;39m <==    Updates: 0
2022-04-29 19:07:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427792404615168[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:07:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427813397106688[0;39m 生成今日电子书快照开始
2022-04-29 19:07:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427813397106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427813397106688[0;39m ==> Parameters: 
2022-04-29 19:07:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427813397106688[0;39m <==    Updates: 0
2022-04-29 19:07:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427813397106688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:07:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427834364432384[0;39m 生成今日电子书快照开始
2022-04-29 19:07:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427834364432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427834364432384[0;39m ==> Parameters: 
2022-04-29 19:07:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427834364432384[0;39m <==    Updates: 0
2022-04-29 19:07:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427834364432384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:07:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427834641256448[0;39m start updating Ebook doc
2022-04-29 19:07:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427834641256448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:07:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427834641256448[0;39m ==> Parameters: 
2022-04-29 19:07:35.113 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427834641256448[0;39m <==    Updates: 1
2022-04-29 19:07:35.114 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427834641256448[0;39m update ends, take 44 millisecs
2022-04-29 19:07:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427855331758080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427855331758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427855331758080[0;39m ==> Parameters: 
2022-04-29 19:07:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427855331758080[0;39m <==    Updates: 0
2022-04-29 19:07:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427855331758080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:07:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427876294889472[0;39m 生成今日电子书快照开始
2022-04-29 19:07:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427876294889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427876294889472[0;39m ==> Parameters: 
2022-04-29 19:07:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427876294889472[0;39m <==    Updates: 0
2022-04-29 19:07:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427876294889472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:07:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427897274798080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427897274798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427897274798080[0;39m ==> Parameters: 
2022-04-29 19:07:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427897274798080[0;39m <==    Updates: 0
2022-04-29 19:07:50.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427897274798080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:07:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427918246318080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:55.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427918246318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:55.100 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427918246318080[0;39m ==> Parameters: 
2022-04-29 19:07:55.259 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427918246318080[0;39m <==    Updates: 0
2022-04-29 19:07:55.260 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427918246318080[0;39m 生成今日电子书快照结束，耗时：257毫秒
2022-04-29 19:08:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427939213643776[0;39m 生成今日电子书快照开始
2022-04-29 19:08:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427939213643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427939213643776[0;39m ==> Parameters: 
2022-04-29 19:08:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427939213643776[0;39m <==    Updates: 0
2022-04-29 19:08:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427939213643776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:08:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427960189358080[0;39m 生成今日电子书快照开始
2022-04-29 19:08:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427960189358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427960189358080[0;39m ==> Parameters: 
2022-04-29 19:08:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427960189358080[0;39m <==    Updates: 0
2022-04-29 19:08:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427960189358080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:08:05.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427960461987840[0;39m start updating Ebook doc
2022-04-29 19:08:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427960461987840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:08:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427960461987840[0;39m ==> Parameters: 
2022-04-29 19:08:05.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427960461987840[0;39m <==    Updates: 1
2022-04-29 19:08:05.107 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427960461987840[0;39m update ends, take 39 millisecs
2022-04-29 19:08:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427981165072384[0;39m 生成今日电子书快照开始
2022-04-29 19:08:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427981165072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427981165072384[0;39m ==> Parameters: 
2022-04-29 19:08:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427981165072384[0;39m <==    Updates: 0
2022-04-29 19:08:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427981165072384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:08:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428002132398080[0;39m 生成今日电子书快照开始
2022-04-29 19:08:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428002132398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428002132398080[0;39m ==> Parameters: 
2022-04-29 19:08:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428002132398080[0;39m <==    Updates: 0
2022-04-29 19:08:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428002132398080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:08:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428023095529472[0;39m 生成今日电子书快照开始
2022-04-29 19:08:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428023095529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428023095529472[0;39m ==> Parameters: 
2022-04-29 19:08:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428023095529472[0;39m <==    Updates: 0
2022-04-29 19:08:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428023095529472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:08:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428044071243776[0;39m 生成今日电子书快照开始
2022-04-29 19:08:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428044071243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428044071243776[0;39m ==> Parameters: 
2022-04-29 19:08:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428044071243776[0;39m <==    Updates: 0
2022-04-29 19:08:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428044071243776[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:08:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428065034375168[0;39m 生成今日电子书快照开始
2022-04-29 19:08:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428065034375168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428065034375168[0;39m ==> Parameters: 
2022-04-29 19:08:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428065034375168[0;39m <==    Updates: 0
2022-04-29 19:08:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428065034375168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:08:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428086026866688[0;39m 生成今日电子书快照开始
2022-04-29 19:08:35.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428086026866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:35.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428086026866688[0;39m ==> Parameters: 
2022-04-29 19:08:35.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428086026866688[0;39m <==    Updates: 0
2022-04-29 19:08:35.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428086026866688[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 19:08:35.082 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428086349828096[0;39m start updating Ebook doc
2022-04-29 19:08:35.083 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428086349828096[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:08:35.083 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428086349828096[0;39m ==> Parameters: 
2022-04-29 19:08:35.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428086349828096[0;39m <==    Updates: 1
2022-04-29 19:08:35.119 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428086349828096[0;39m update ends, take 37 millisecs
2022-04-29 19:08:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428106977415168[0;39m 生成今日电子书快照开始
2022-04-29 19:08:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428106977415168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428106977415168[0;39m ==> Parameters: 
2022-04-29 19:08:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428106977415168[0;39m <==    Updates: 0
2022-04-29 19:08:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428106977415168[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:08:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428127961518080[0;39m 生成今日电子书快照开始
2022-04-29 19:08:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428127961518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428127961518080[0;39m ==> Parameters: 
2022-04-29 19:08:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428127961518080[0;39m <==    Updates: 0
2022-04-29 19:08:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428127961518080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:08:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428148937232384[0;39m 生成今日电子书快照开始
2022-04-29 19:08:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428148937232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428148937232384[0;39m ==> Parameters: 
2022-04-29 19:08:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428148937232384[0;39m <==    Updates: 0
2022-04-29 19:08:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428148937232384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:08:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428169908752384[0;39m 生成今日电子书快照开始
2022-04-29 19:08:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428169908752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428169908752384[0;39m ==> Parameters: 
2022-04-29 19:08:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428169908752384[0;39m <==    Updates: 0
2022-04-29 19:08:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428169908752384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:09:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428190871883776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428190871883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428190871883776[0;39m ==> Parameters: 
2022-04-29 19:09:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428190871883776[0;39m <==    Updates: 0
2022-04-29 19:09:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428190871883776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:09:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428211835015168[0;39m 生成今日电子书快照开始
2022-04-29 19:09:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428211835015168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428211835015168[0;39m ==> Parameters: 
2022-04-29 19:09:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428211835015168[0;39m <==    Updates: 0
2022-04-29 19:09:05.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428211835015168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:09:05.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428212095062016[0;39m start updating Ebook doc
2022-04-29 19:09:05.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428212095062016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:09:05.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428212095062016[0;39m ==> Parameters: 
2022-04-29 19:09:05.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428212095062016[0;39m <==    Updates: 1
2022-04-29 19:09:05.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428212095062016[0;39m update ends, take 38 millisecs
2022-04-29 19:09:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428232823312384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428232823312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428232823312384[0;39m ==> Parameters: 
2022-04-29 19:09:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428232823312384[0;39m <==    Updates: 0
2022-04-29 19:09:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428232823312384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 19:09:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428253786443776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428253786443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428253786443776[0;39m ==> Parameters: 
2022-04-29 19:09:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428253786443776[0;39m <==    Updates: 0
2022-04-29 19:09:15.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428253786443776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:09:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428274762158080[0;39m 生成今日电子书快照开始
2022-04-29 19:09:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428274762158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428274762158080[0;39m ==> Parameters: 
2022-04-29 19:09:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428274762158080[0;39m <==    Updates: 0
2022-04-29 19:09:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428274762158080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:09:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428295737872384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428295737872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428295737872384[0;39m ==> Parameters: 
2022-04-29 19:09:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428295737872384[0;39m <==    Updates: 0
2022-04-29 19:09:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428295737872384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:09:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428316701003776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428316701003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428316701003776[0;39m ==> Parameters: 
2022-04-29 19:09:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428316701003776[0;39m <==    Updates: 0
2022-04-29 19:09:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428316701003776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:09:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428337672523776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428337672523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428337672523776[0;39m ==> Parameters: 
2022-04-29 19:09:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428337672523776[0;39m <==    Updates: 0
2022-04-29 19:09:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428337672523776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:09:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428337949347840[0;39m start updating Ebook doc
2022-04-29 19:09:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428337949347840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:09:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428337949347840[0;39m ==> Parameters: 
2022-04-29 19:09:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428337949347840[0;39m <==    Updates: 1
2022-04-29 19:09:35.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428337949347840[0;39m update ends, take 41 millisecs
2022-04-29 19:09:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428358652432384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428358652432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428358652432384[0;39m ==> Parameters: 
2022-04-29 19:09:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428358652432384[0;39m <==    Updates: 0
2022-04-29 19:09:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428358652432384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:09:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428379628146688[0;39m 生成今日电子书快照开始
2022-04-29 19:09:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428379628146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428379628146688[0;39m ==> Parameters: 
2022-04-29 19:09:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428379628146688[0;39m <==    Updates: 0
2022-04-29 19:09:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428379628146688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:09:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428400582889472[0;39m 生成今日电子书快照开始
2022-04-29 19:09:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428400582889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428400582889472[0;39m ==> Parameters: 
2022-04-29 19:09:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428400582889472[0;39m <==    Updates: 0
2022-04-29 19:09:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428400582889472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:09:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428421566992384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428421566992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428421566992384[0;39m ==> Parameters: 
2022-04-29 19:09:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428421566992384[0;39m <==    Updates: 0
2022-04-29 19:09:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428421566992384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:10:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428442530123776[0;39m 生成今日电子书快照开始
2022-04-29 19:10:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428442530123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428442530123776[0;39m ==> Parameters: 
2022-04-29 19:10:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428442530123776[0;39m <==    Updates: 0
2022-04-29 19:10:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428442530123776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:10:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428463505838080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428463505838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428463505838080[0;39m ==> Parameters: 
2022-04-29 19:10:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428463505838080[0;39m <==    Updates: 0
2022-04-29 19:10:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428463505838080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:10:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428463770079232[0;39m start updating Ebook doc
2022-04-29 19:10:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428463770079232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:10:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428463770079232[0;39m ==> Parameters: 
2022-04-29 19:10:05.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428463770079232[0;39m <==    Updates: 1
2022-04-29 19:10:05.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428463770079232[0;39m update ends, take 38 millisecs
2022-04-29 19:10:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428484481552384[0;39m 生成今日电子书快照开始
2022-04-29 19:10:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428484481552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428484481552384[0;39m ==> Parameters: 
2022-04-29 19:10:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428484481552384[0;39m <==    Updates: 0
2022-04-29 19:10:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428484481552384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:10:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428505436295168[0;39m 生成今日电子书快照开始
2022-04-29 19:10:15.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428505436295168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:15.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428505436295168[0;39m ==> Parameters: 
2022-04-29 19:10:15.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428505436295168[0;39m <==    Updates: 0
2022-04-29 19:10:15.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428505436295168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 19:10:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428526407815168[0;39m 生成今日电子书快照开始
2022-04-29 19:10:20.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428526407815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:20.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428526407815168[0;39m ==> Parameters: 
2022-04-29 19:10:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428526407815168[0;39m <==    Updates: 0
2022-04-29 19:10:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428526407815168[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:10:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428547396112384[0;39m 生成今日电子书快照开始
2022-04-29 19:10:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428547396112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428547396112384[0;39m ==> Parameters: 
2022-04-29 19:10:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428547396112384[0;39m <==    Updates: 0
2022-04-29 19:10:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428547396112384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:10:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428568363438080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428568363438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428568363438080[0;39m ==> Parameters: 
2022-04-29 19:10:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428568363438080[0;39m <==    Updates: 0
2022-04-29 19:10:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428568363438080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 19:10:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428589343346688[0;39m 生成今日电子书快照开始
2022-04-29 19:10:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428589343346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428589343346688[0;39m ==> Parameters: 
2022-04-29 19:10:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428589343346688[0;39m <==    Updates: 0
2022-04-29 19:10:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428589343346688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:10:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428589586616320[0;39m start updating Ebook doc
2022-04-29 19:10:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428589586616320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:10:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428589586616320[0;39m ==> Parameters: 
2022-04-29 19:10:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428589586616320[0;39m <==    Updates: 1
2022-04-29 19:10:35.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428589586616320[0;39m update ends, take 41 millisecs
2022-04-29 19:10:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428610306478080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428610306478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428610306478080[0;39m ==> Parameters: 
2022-04-29 19:10:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428610306478080[0;39m <==    Updates: 0
2022-04-29 19:10:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428610306478080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:10:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428631282192384[0;39m 生成今日电子书快照开始
2022-04-29 19:10:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428631282192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428631282192384[0;39m ==> Parameters: 
2022-04-29 19:10:45.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428631282192384[0;39m <==    Updates: 0
2022-04-29 19:10:45.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428631282192384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:10:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428652241129472[0;39m 生成今日电子书快照开始
2022-04-29 19:10:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428652241129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428652241129472[0;39m ==> Parameters: 
2022-04-29 19:10:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428652241129472[0;39m <==    Updates: 0
2022-04-29 19:10:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428652241129472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:10:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428673221038080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428673221038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428673221038080[0;39m ==> Parameters: 
2022-04-29 19:10:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428673221038080[0;39m <==    Updates: 0
2022-04-29 19:10:55.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428673221038080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 19:11:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428694196752384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428694196752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428694196752384[0;39m ==> Parameters: 
2022-04-29 19:11:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428694196752384[0;39m <==    Updates: 0
2022-04-29 19:11:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428694196752384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:11:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428715168272384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428715168272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428715168272384[0;39m ==> Parameters: 
2022-04-29 19:11:05.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428715168272384[0;39m <==    Updates: 0
2022-04-29 19:11:05.102 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428715168272384[0;39m 生成今日电子书快照结束，耗时：97毫秒
2022-04-29 19:11:05.102 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428715579314176[0;39m start updating Ebook doc
2022-04-29 19:11:05.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428715579314176[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:11:05.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428715579314176[0;39m ==> Parameters: 
2022-04-29 19:11:05.143 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428715579314176[0;39m <==    Updates: 1
2022-04-29 19:11:05.143 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428715579314176[0;39m update ends, take 41 millisecs
2022-04-29 19:11:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428736131403776[0;39m 生成今日电子书快照开始
2022-04-29 19:11:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428736131403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428736131403776[0;39m ==> Parameters: 
2022-04-29 19:11:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428736131403776[0;39m <==    Updates: 0
2022-04-29 19:11:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428736131403776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:11:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428757115506688[0;39m 生成今日电子书快照开始
2022-04-29 19:11:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428757115506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428757115506688[0;39m ==> Parameters: 
2022-04-29 19:11:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428757115506688[0;39m <==    Updates: 0
2022-04-29 19:11:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428757115506688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:11:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428778082832384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428778082832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428778082832384[0;39m ==> Parameters: 
2022-04-29 19:11:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428778082832384[0;39m <==    Updates: 0
2022-04-29 19:11:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428778082832384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:11:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428799037575168[0;39m 生成今日电子书快照开始
2022-04-29 19:11:25.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428799037575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:25.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428799037575168[0;39m ==> Parameters: 
2022-04-29 19:11:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428799037575168[0;39m <==    Updates: 0
2022-04-29 19:11:25.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428799037575168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:11:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428820025872384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428820025872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428820025872384[0;39m ==> Parameters: 
2022-04-29 19:11:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428820025872384[0;39m <==    Updates: 0
2022-04-29 19:11:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428820025872384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:11:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428840984809472[0;39m 生成今日电子书快照开始
2022-04-29 19:11:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428840984809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428840984809472[0;39m ==> Parameters: 
2022-04-29 19:11:35.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428840984809472[0;39m <==    Updates: 0
2022-04-29 19:11:35.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428840984809472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:11:35.057 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428841219690496[0;39m start updating Ebook doc
2022-04-29 19:11:35.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428841219690496[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:11:35.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428841219690496[0;39m ==> Parameters: 
2022-04-29 19:11:35.091 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428841219690496[0;39m <==    Updates: 1
2022-04-29 19:11:35.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428841219690496[0;39m update ends, take 34 millisecs
2022-04-29 19:11:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428861973106688[0;39m 生成今日电子书快照开始
2022-04-29 19:11:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428861973106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428861973106688[0;39m ==> Parameters: 
2022-04-29 19:11:40.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428861973106688[0;39m <==    Updates: 0
2022-04-29 19:11:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428861973106688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:11:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428882923655168[0;39m 生成今日电子书快照开始
2022-04-29 19:11:45.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428882923655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:45.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428882923655168[0;39m ==> Parameters: 
2022-04-29 19:11:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428882923655168[0;39m <==    Updates: 0
2022-04-29 19:11:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428882923655168[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:11:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428903911952384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428903911952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428903911952384[0;39m ==> Parameters: 
2022-04-29 19:11:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428903911952384[0;39m <==    Updates: 0
2022-04-29 19:11:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428903911952384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:11:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428924870889472[0;39m 生成今日电子书快照开始
2022-04-29 19:11:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428924870889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428924870889472[0;39m ==> Parameters: 
2022-04-29 19:11:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428924870889472[0;39m <==    Updates: 0
2022-04-29 19:11:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428924870889472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:12:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428945854992384[0;39m 生成今日电子书快照开始
2022-04-29 19:12:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428945854992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428945854992384[0;39m ==> Parameters: 
2022-04-29 19:12:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428945854992384[0;39m <==    Updates: 0
2022-04-29 19:12:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428945854992384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:12:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428966826512384[0;39m 生成今日电子书快照开始
2022-04-29 19:12:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428966826512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:05.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428966826512384[0;39m ==> Parameters: 
2022-04-29 19:12:05.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428966826512384[0;39m <==    Updates: 0
2022-04-29 19:12:05.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428966826512384[0;39m 生成今日电子书快照结束，耗时：111毫秒
2022-04-29 19:12:05.117 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428967300468736[0;39m start updating Ebook doc
2022-04-29 19:12:05.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428967300468736[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:12:05.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428967300468736[0;39m ==> Parameters: 
2022-04-29 19:12:05.162 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428967300468736[0;39m <==    Updates: 1
2022-04-29 19:12:05.163 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428967300468736[0;39m update ends, take 46 millisecs
2022-04-29 19:12:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428987798032384[0;39m 生成今日电子书快照开始
2022-04-29 19:12:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428987798032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428987798032384[0;39m ==> Parameters: 
2022-04-29 19:12:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428987798032384[0;39m <==    Updates: 0
2022-04-29 19:12:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428987798032384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:12:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429008756969472[0;39m 生成今日电子书快照开始
2022-04-29 19:12:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429008756969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429008756969472[0;39m ==> Parameters: 
2022-04-29 19:12:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429008756969472[0;39m <==    Updates: 0
2022-04-29 19:12:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429008756969472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:12:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429029745266688[0;39m 生成今日电子书快照开始
2022-04-29 19:12:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429029745266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429029745266688[0;39m ==> Parameters: 
2022-04-29 19:12:20.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429029745266688[0;39m <==    Updates: 0
2022-04-29 19:12:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429029745266688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:12:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429050716786688[0;39m 生成今日电子书快照开始
2022-04-29 19:12:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429050716786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429050716786688[0;39m ==> Parameters: 
2022-04-29 19:12:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429050716786688[0;39m <==    Updates: 0
2022-04-29 19:12:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429050716786688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:12:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429071671529472[0;39m 生成今日电子书快照开始
2022-04-29 19:12:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429071671529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429071671529472[0;39m ==> Parameters: 
2022-04-29 19:12:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429071671529472[0;39m <==    Updates: 0
2022-04-29 19:12:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429071671529472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:12:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429092647243776[0;39m 生成今日电子书快照开始
2022-04-29 19:12:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429092647243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429092647243776[0;39m ==> Parameters: 
2022-04-29 19:12:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429092647243776[0;39m <==    Updates: 0
2022-04-29 19:12:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429092647243776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:12:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175429092915679232[0;39m start updating Ebook doc
2022-04-29 19:12:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429092915679232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:12:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429092915679232[0;39m ==> Parameters: 
2022-04-29 19:12:35.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429092915679232[0;39m <==    Updates: 1
2022-04-29 19:12:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175429092915679232[0;39m update ends, take 42 millisecs
2022-04-29 19:12:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429113610375168[0;39m 生成今日电子书快照开始
2022-04-29 19:12:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429113610375168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429113610375168[0;39m ==> Parameters: 
2022-04-29 19:12:40.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429113610375168[0;39m <==    Updates: 0
2022-04-29 19:12:40.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429113610375168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 19:12:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429134602866688[0;39m 生成今日电子书快照开始
2022-04-29 19:12:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429134602866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429134602866688[0;39m ==> Parameters: 
2022-04-29 19:12:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429134602866688[0;39m <==    Updates: 0
2022-04-29 19:12:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429134602866688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:12:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429155561803776[0;39m 生成今日电子书快照开始
2022-04-29 19:12:50.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429155561803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:50.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429155561803776[0;39m ==> Parameters: 
2022-04-29 19:12:50.089 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429155561803776[0;39m <==    Updates: 0
2022-04-29 19:12:50.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429155561803776[0;39m 生成今日电子书快照结束，耗时：87毫秒
2022-04-29 19:12:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429176524935168[0;39m 生成今日电子书快照开始
2022-04-29 19:12:55.119 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429176524935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:55.120 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429176524935168[0;39m ==> Parameters: 
2022-04-29 19:12:55.281 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429176524935168[0;39m <==    Updates: 0
2022-04-29 19:12:55.284 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429176524935168[0;39m 生成今日电子书快照结束，耗时：284毫秒
2022-04-29 19:13:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429197504843776[0;39m 生成今日电子书快照开始
2022-04-29 19:13:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429197504843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429197504843776[0;39m ==> Parameters: 
2022-04-29 19:13:00.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429197504843776[0;39m <==    Updates: 0
2022-04-29 19:13:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429197504843776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 19:13:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429218488946688[0;39m 生成今日电子书快照开始
2022-04-29 19:13:05.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429218488946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429218488946688[0;39m ==> Parameters: 
2022-04-29 19:13:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429218488946688[0;39m <==    Updates: 0
2022-04-29 19:13:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429218488946688[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 19:13:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175429218711244800[0;39m start updating Ebook doc
2022-04-29 19:13:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429218711244800[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:13:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429218711244800[0;39m ==> Parameters: 
2022-04-29 19:13:05.096 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429218711244800[0;39m <==    Updates: 1
2022-04-29 19:13:05.097 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175429218711244800[0;39m update ends, take 38 millisecs
2022-04-29 19:13:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429239443689472[0;39m 生成今日电子书快照开始
2022-04-29 19:13:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429239443689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429239443689472[0;39m ==> Parameters: 
2022-04-29 19:13:10.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429239443689472[0;39m <==    Updates: 0
2022-04-29 19:13:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429239443689472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:13:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429260427792384[0;39m 生成今日电子书快照开始
2022-04-29 19:13:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429260427792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429260427792384[0;39m ==> Parameters: 
2022-04-29 19:13:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429260427792384[0;39m <==    Updates: 0
2022-04-29 19:13:15.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429260427792384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:13:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429281386729472[0;39m 生成今日电子书快照开始
2022-04-29 19:13:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429281386729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429281386729472[0;39m ==> Parameters: 
2022-04-29 19:13:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429281386729472[0;39m <==    Updates: 0
2022-04-29 19:13:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429281386729472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:13:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429302375026688[0;39m 生成今日电子书快照开始
2022-04-29 19:13:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429302375026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429302375026688[0;39m ==> Parameters: 
2022-04-29 19:13:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429302375026688[0;39m <==    Updates: 0
2022-04-29 19:13:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429302375026688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:13:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429323342352384[0;39m 生成今日电子书快照开始
2022-04-29 19:13:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429323342352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429323342352384[0;39m ==> Parameters: 
2022-04-29 19:13:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429323342352384[0;39m <==    Updates: 0
2022-04-29 19:13:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429323342352384[0;39m 生成今日电子书快照结束，耗时：56毫秒
