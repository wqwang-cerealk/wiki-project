2022-04-29 12:38:12.995 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-29 12:38:18.012 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5007 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 12:38:23.018 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 20538 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 12:38:23.021 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 12:38:23.086 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-29 12:38:23.087 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-29 12:38:23.880 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 12:38:23.884 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 12:38:23.921 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2022-04-29 12:38:25.091 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 12:38:25.107 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 12:38:25.108 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 12:38:25.108 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 12:38:25.186 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 12:38:25.187 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2100 ms
2022-04-29 12:38:26.414 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 12:38:26.856 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 12:38:26.903 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 12:38:26.925 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 12:38:26.946 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 12:38:26.959 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 24.519 seconds (JVM running for 25.244)
2022-04-29 12:38:26.962 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 12:38:26.962 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 12:38:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329918341746688[0;39m 生成今日电子书快照开始
2022-04-29 12:38:30.036 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175329918341746688[0;39m HikariPool-1 - Starting...
2022-04-29 12:38:30.565 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175329918341746688[0;39m HikariPool-1 - Start completed.
2022-04-29 12:38:30.574 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329918341746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:30.595 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329918341746688[0;39m ==> Parameters: 
2022-04-29 12:38:30.630 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329918341746688[0;39m <==    Updates: 0
2022-04-29 12:38:30.634 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329918341746688[0;39m 生成今日电子书快照结束，耗时：629毫秒
2022-04-29 12:38:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175329939304878080[0;39m start updating Ebook doc
2022-04-29 12:38:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175329939304878080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:38:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175329939304878080[0;39m ==> Parameters: 
2022-04-29 12:38:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175329939304878080[0;39m <==    Updates: 1
2022-04-29 12:38:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175329939304878080[0;39m update ends, take 66 millisecs
2022-04-29 12:38:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329939585896448[0;39m 生成今日电子书快照开始
2022-04-29 12:38:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329939585896448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329939585896448[0;39m ==> Parameters: 
2022-04-29 12:38:35.117 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329939585896448[0;39m <==    Updates: 0
2022-04-29 12:38:35.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329939585896448[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-29 12:38:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329960280592384[0;39m 生成今日电子书快照开始
2022-04-29 12:38:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329960280592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329960280592384[0;39m ==> Parameters: 
2022-04-29 12:38:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329960280592384[0;39m <==    Updates: 0
2022-04-29 12:38:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329960280592384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:38:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175329981243723776[0;39m 生成今日电子书快照开始
2022-04-29 12:38:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329981243723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329981243723776[0;39m ==> Parameters: 
2022-04-29 12:38:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175329981243723776[0;39m <==    Updates: 0
2022-04-29 12:38:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175329981243723776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:38:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330002206855168[0;39m 生成今日电子书快照开始
2022-04-29 12:38:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330002206855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330002206855168[0;39m ==> Parameters: 
2022-04-29 12:38:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330002206855168[0;39m <==    Updates: 0
2022-04-29 12:38:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330002206855168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:38:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330023195152384[0;39m 生成今日电子书快照开始
2022-04-29 12:38:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330023195152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:38:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330023195152384[0;39m ==> Parameters: 
2022-04-29 12:38:55.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330023195152384[0;39m <==    Updates: 0
2022-04-29 12:38:55.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330023195152384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:39:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330044149895168[0;39m 生成今日电子书快照开始
2022-04-29 12:39:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330044149895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330044149895168[0;39m ==> Parameters: 
2022-04-29 12:39:00.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330044149895168[0;39m <==    Updates: 0
2022-04-29 12:39:00.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330044149895168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:39:05.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330065142386688[0;39m 生成今日电子书快照开始
2022-04-29 12:39:05.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330065142386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:05.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330065142386688[0;39m ==> Parameters: 
2022-04-29 12:39:05.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330065142386688[0;39m <==    Updates: 0
2022-04-29 12:39:05.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330065142386688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:39:05.090 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330065498902528[0;39m start updating Ebook doc
2022-04-29 12:39:05.091 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330065498902528[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:39:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330065498902528[0;39m ==> Parameters: 
2022-04-29 12:39:05.132 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330065498902528[0;39m <==    Updates: 1
2022-04-29 12:39:05.133 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330065498902528[0;39m update ends, take 43 millisecs
2022-04-29 12:39:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330086097129472[0;39m 生成今日电子书快照开始
2022-04-29 12:39:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330086097129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330086097129472[0;39m ==> Parameters: 
2022-04-29 12:39:10.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330086097129472[0;39m <==    Updates: 0
2022-04-29 12:39:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330086097129472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:39:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330107085426688[0;39m 生成今日电子书快照开始
2022-04-29 12:39:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330107085426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330107085426688[0;39m ==> Parameters: 
2022-04-29 12:39:15.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330107085426688[0;39m <==    Updates: 0
2022-04-29 12:39:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330107085426688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:39:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330128052752384[0;39m 生成今日电子书快照开始
2022-04-29 12:39:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330128052752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330128052752384[0;39m ==> Parameters: 
2022-04-29 12:39:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330128052752384[0;39m <==    Updates: 0
2022-04-29 12:39:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330128052752384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:39:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330149032660992[0;39m 生成今日电子书快照开始
2022-04-29 12:39:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330149032660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330149032660992[0;39m ==> Parameters: 
2022-04-29 12:39:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330149032660992[0;39m <==    Updates: 0
2022-04-29 12:39:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330149032660992[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:39:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330170012569600[0;39m 生成今日电子书快照开始
2022-04-29 12:39:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330170012569600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330170012569600[0;39m ==> Parameters: 
2022-04-29 12:39:30.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330170012569600[0;39m <==    Updates: 0
2022-04-29 12:39:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330170012569600[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:39:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330190963118080[0;39m start updating Ebook doc
2022-04-29 12:39:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330190963118080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:39:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330190963118080[0;39m ==> Parameters: 
2022-04-29 12:39:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330190963118080[0;39m <==    Updates: 1
2022-04-29 12:39:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330190963118080[0;39m update ends, take 60 millisecs
2022-04-29 12:39:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330191214776320[0;39m 生成今日电子书快照开始
2022-04-29 12:39:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330191214776320[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330191214776320[0;39m ==> Parameters: 
2022-04-29 12:39:35.098 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330191214776320[0;39m <==    Updates: 0
2022-04-29 12:39:35.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330191214776320[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-29 12:39:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330211926249472[0;39m 生成今日电子书快照开始
2022-04-29 12:39:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330211926249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330211926249472[0;39m ==> Parameters: 
2022-04-29 12:39:40.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330211926249472[0;39m <==    Updates: 0
2022-04-29 12:39:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330211926249472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:39:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330232918740992[0;39m 生成今日电子书快照开始
2022-04-29 12:39:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330232918740992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330232918740992[0;39m ==> Parameters: 
2022-04-29 12:39:45.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330232918740992[0;39m <==    Updates: 0
2022-04-29 12:39:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330232918740992[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:39:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330253877678080[0;39m 生成今日电子书快照开始
2022-04-29 12:39:50.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330253877678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:50.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330253877678080[0;39m ==> Parameters: 
2022-04-29 12:39:50.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330253877678080[0;39m <==    Updates: 0
2022-04-29 12:39:50.087 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330253877678080[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 12:39:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330274845003776[0;39m 生成今日电子书快照开始
2022-04-29 12:39:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330274845003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:39:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330274845003776[0;39m ==> Parameters: 
2022-04-29 12:39:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330274845003776[0;39m <==    Updates: 0
2022-04-29 12:39:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330274845003776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:40:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330295812329472[0;39m 生成今日电子书快照开始
2022-04-29 12:40:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330295812329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330295812329472[0;39m ==> Parameters: 
2022-04-29 12:40:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330295812329472[0;39m <==    Updates: 0
2022-04-29 12:40:00.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330295812329472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:40:02.442 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 12:40:02.443 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 12:40:02.452 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 9 ms
2022-04-29 12:40:02.525 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：lsDuEMZABU，session id：0，当前连接数：1
2022-04-29 12:40:02.527 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330306398752770[0;39m ------------- 开始 -------------
2022-04-29 12:40:02.527 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330306398752768[0;39m ------------- 开始 -------------
2022-04-29 12:40:02.527 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330306398752769[0;39m ------------- 开始 -------------
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330306398752770[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330306398752769[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330306398752770[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330306398752768[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330306398752769[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330306398752768[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330306398752770[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:02.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330306398752769[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:02.530 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330306398752768[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:02.652 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330306398752769[0;39m 请求参数: []
2022-04-29 12:40:02.652 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330306398752770[0;39m 请求参数: []
2022-04-29 12:40:02.652 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330306398752768[0;39m 请求参数: []
2022-04-29 12:40:02.684 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175330306398752769[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:40:02.685 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175330306398752769[0;39m ==> Parameters: 
2022-04-29 12:40:02.688 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175330306398752770[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:40:02.688 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175330306398752770[0;39m ==> Parameters: 
2022-04-29 12:40:02.731 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175330306398752770[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 12:40:02.731 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 12:40:02.732 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 12:40:02.732 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175330306398752770[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 12:40:02.735 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 12:40:02.735 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175330306398752770[0;39m <==        Row: 2022-04-29, 1763, 63, 28, 2
2022-04-29 12:40:02.735 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 12:40:02.735 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175330306398752770[0;39m <==      Total: 2
2022-04-29 12:40:02.736 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 12:40:02.736 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330306398752768[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:40:02.737 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330306398752768[0;39m ==> Parameters: 
2022-04-29 12:40:02.737 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 12:40:02.738 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 12:40:02.738 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 12:40:02.739 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 12:40:02.740 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 12:40:02.740 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 12:40:02.741 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 12:40:02.741 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 12:40:02.742 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175330306398752769[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 12:40:02.743 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175330306398752769[0;39m <==      Total: 13
2022-04-29 12:40:02.756 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:40:02.757 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:40:02.757 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:40:02.758 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:40:02.759 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:40:02.759 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:40:02.760 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:40:02.760 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:40:02.761 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:40:02.761 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:40:02.762 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:40:02.763 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:40:02.763 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:40:02.764 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:40:02.765 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:40:02.765 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:40:02.766 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:40:02.767 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:40:02.768 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330306398752768[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:40:02.768 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330306398752768[0;39m <==      Total: 18
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330306398752770[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1763,"viewIncrease":28,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330306398752769[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330306398752770[0;39m ------------- 结束 耗时：246 ms -------------
2022-04-29 12:40:02.771 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330306398752769[0;39m ------------- 结束 耗时：246 ms -------------
2022-04-29 12:40:02.780 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330306398752768[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:40:02.781 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330306398752768[0;39m ------------- 结束 耗时：256 ms -------------
2022-04-29 12:40:05.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330316779655168[0;39m 生成今日电子书快照开始
2022-04-29 12:40:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330316779655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330316779655168[0;39m ==> Parameters: 
2022-04-29 12:40:05.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330316779655168[0;39m <==    Updates: 0
2022-04-29 12:40:05.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330316779655168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:40:05.056 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330317014536192[0;39m start updating Ebook doc
2022-04-29 12:40:05.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330317014536192[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:40:05.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330317014536192[0;39m ==> Parameters: 
2022-04-29 12:40:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330317014536192[0;39m <==    Updates: 1
2022-04-29 12:40:05.093 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330317014536192[0;39m update ends, take 37 millisecs
2022-04-29 12:40:05.848 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330320336424960[0;39m ------------- 开始 -------------
2022-04-29 12:40:05.849 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330320336424960[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-29 12:40:05.849 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330320336424960[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-29 12:40:05.849 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330320336424960[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:05.851 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330320336424960[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-29 12:40:05.887 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175330320336424960[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-29 12:40:05.892 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175330320336424960[0;39m ==> Parameters: test1(String)
2022-04-29 12:40:05.915 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175330320336424960[0;39m <==    Columns: id, login_name, name, password
2022-04-29 12:40:05.916 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175330320336424960[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 12:40:05.916 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175330320336424960[0;39m <==      Total: 1
2022-04-29 12:40:05.920 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175330320336424960[0;39m generate single sign-on token：175330320638414848，and put it into redis
2022-04-29 12:40:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330337751175168[0;39m 生成今日电子书快照开始
2022-04-29 12:40:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330337751175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330337751175168[0;39m ==> Parameters: 
2022-04-29 12:40:10.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330337751175168[0;39m <==    Updates: 0
2022-04-29 12:40:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330337751175168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:40:12.109 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330320336424960[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"},"success":true}
2022-04-29 12:40:12.109 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330320336424960[0;39m ------------- 结束 耗时：6261 ms -------------
2022-04-29 12:40:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330358726889472[0;39m 生成今日电子书快照开始
2022-04-29 12:40:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330358726889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330358726889472[0;39m ==> Parameters: 
2022-04-29 12:40:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330358726889472[0;39m <==    Updates: 0
2022-04-29 12:40:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330358726889472[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 12:40:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330379702603776[0;39m 生成今日电子书快照开始
2022-04-29 12:40:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330379702603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330379702603776[0;39m ==> Parameters: 
2022-04-29 12:40:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330379702603776[0;39m <==    Updates: 0
2022-04-29 12:40:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330379702603776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:40:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330400682512384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330400682512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330400682512384[0;39m ==> Parameters: 
2022-04-29 12:40:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330400682512384[0;39m <==    Updates: 0
2022-04-29 12:40:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330400682512384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:40:26.646 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330407569559552[0;39m ------------- 开始 -------------
2022-04-29 12:40:26.646 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330407569559552[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:40:26.646 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330407569559552[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:40:26.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330407569559552[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:26.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330407569559552[0;39m 请求参数: []
2022-04-29 12:40:26.676 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330407569559552[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:40:26.677 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330407569559552[0;39m ==> Parameters: 
2022-04-29 12:40:26.701 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:40:26.701 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:40:26.702 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:40:26.702 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:40:26.703 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:40:26.703 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:40:26.703 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:40:26.704 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:40:26.704 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:40:26.704 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:40:26.705 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:40:26.705 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:40:26.705 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:40:26.706 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:40:26.706 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:40:26.706 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:40:26.707 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:40:26.707 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:40:26.708 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175330407569559552[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:40:26.708 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175330407569559552[0;39m <==      Total: 18
2022-04-29 12:40:26.710 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330407569559552[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:40:26.711 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330407569559552[0;39m ------------- 结束 耗时：65 ms -------------
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330408030932992[0;39m ------------- 开始 -------------
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330408030932992[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330408030932992[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 12:40:26.756 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330408030932992[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:26.758 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330408030932992[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 12:40:26.805 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175330408030932992[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 12:40:26.805 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175330408030932992[0;39m ==> Parameters: 
2022-04-29 12:40:26.828 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175330408030932992[0;39m <==    Columns: count(0)
2022-04-29 12:40:26.829 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175330408030932992[0;39m <==        Row: 5
2022-04-29 12:40:26.830 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175330408030932992[0;39m <==      Total: 1
2022-04-29 12:40:26.832 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175330408030932992[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 12:40:26.833 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175330408030932992[0;39m ==> Parameters: 10(Integer)
2022-04-29 12:40:26.856 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 12:40:26.856 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 12:40:26.857 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 12:40:26.857 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 12:40:26.857 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 12:40:26.858 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175330408030932992[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 12:40:26.858 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175330408030932992[0;39m <==      Total: 5
2022-04-29 12:40:26.860 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175330408030932992[0;39m total rows：5
2022-04-29 12:40:26.860 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175330408030932992[0;39m total pages：1
2022-04-29 12:40:26.868 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175330408030932992[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 12:40:26.869 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175330408030932992[0;39m ------------- 结束 耗时：113 ms -------------
2022-04-29 12:40:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330421637255168[0;39m 生成今日电子书快照开始
2022-04-29 12:40:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330421637255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330421637255168[0;39m ==> Parameters: 
2022-04-29 12:40:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330421637255168[0;39m <==    Updates: 0
2022-04-29 12:40:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330421637255168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:40:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330442621358080[0;39m 生成今日电子书快照开始
2022-04-29 12:40:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330442621358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330442621358080[0;39m ==> Parameters: 
2022-04-29 12:40:35.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330442621358080[0;39m <==    Updates: 0
2022-04-29 12:40:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330442621358080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:40:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330442902376448[0;39m start updating Ebook doc
2022-04-29 12:40:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330442902376448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:40:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330442902376448[0;39m ==> Parameters: 
2022-04-29 12:40:35.114 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330442902376448[0;39m <==    Updates: 1
2022-04-29 12:40:35.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330442902376448[0;39m update ends, take 45 millisecs
2022-04-29 12:40:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330463597072384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330463597072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330463597072384[0;39m ==> Parameters: 
2022-04-29 12:40:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330463597072384[0;39m <==    Updates: 0
2022-04-29 12:40:40.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330463597072384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:40:42.330 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:40:42.331 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-29 12:40:42.334 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175330306398752770[0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:40:42.334 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175330306398752770[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 12:40:42.334 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175330306398752770[0;39m 登录校验开始，token：175330320638414848
2022-04-29 12:40:42.737 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175330306398752770[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"}
2022-04-29 12:40:42.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175330475102048256[0;39m ------------- 开始 -------------
2022-04-29 12:40:42.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175330475102048256[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 12:40:42.748 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175330475102048256[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 12:40:42.748 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175330475102048256[0;39m 远程地址: 127.0.0.1
2022-04-29 12:40:42.750 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175330475102048256[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"Spring"}]
2022-04-29 12:40:42.769 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175330475102048256[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 12:40:42.770 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175330475102048256[0;39m ==> Parameters: 175330475123019776(Long), Spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 12:40:42.886 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175330475102048256[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:33)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 12:40:42.889 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175330475102048256[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 12:40:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330484568592384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330484568592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330484568592384[0;39m ==> Parameters: 
2022-04-29 12:40:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330484568592384[0;39m <==    Updates: 0
2022-04-29 12:40:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330484568592384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:40:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330505540112384[0;39m 生成今日电子书快照开始
2022-04-29 12:40:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330505540112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330505540112384[0;39m ==> Parameters: 
2022-04-29 12:40:50.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330505540112384[0;39m <==    Updates: 0
2022-04-29 12:40:50.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330505540112384[0;39m 生成今日电子书快照结束，耗时：80毫秒
2022-04-29 12:40:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330526507438080[0;39m 生成今日电子书快照开始
2022-04-29 12:40:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330526507438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:40:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330526507438080[0;39m ==> Parameters: 
2022-04-29 12:40:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330526507438080[0;39m <==    Updates: 0
2022-04-29 12:40:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330526507438080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:41:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330547474763776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330547474763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330547474763776[0;39m ==> Parameters: 
2022-04-29 12:41:00.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330547474763776[0;39m <==    Updates: 0
2022-04-29 12:41:00.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330547474763776[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:41:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330568458866688[0;39m 生成今日电子书快照开始
2022-04-29 12:41:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330568458866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330568458866688[0;39m ==> Parameters: 
2022-04-29 12:41:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330568458866688[0;39m <==    Updates: 0
2022-04-29 12:41:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330568458866688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:41:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330568718913536[0;39m start updating Ebook doc
2022-04-29 12:41:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330568718913536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:41:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330568718913536[0;39m ==> Parameters: 
2022-04-29 12:41:05.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330568718913536[0;39m <==    Updates: 1
2022-04-29 12:41:05.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330568718913536[0;39m update ends, take 40 millisecs
2022-04-29 12:41:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330589413609472[0;39m 生成今日电子书快照开始
2022-04-29 12:41:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330589413609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330589413609472[0;39m ==> Parameters: 
2022-04-29 12:41:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330589413609472[0;39m <==    Updates: 0
2022-04-29 12:41:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330589413609472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:41:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330610389323776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330610389323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330610389323776[0;39m ==> Parameters: 
2022-04-29 12:41:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330610389323776[0;39m <==    Updates: 0
2022-04-29 12:41:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330610389323776[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:41:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330631352455168[0;39m 生成今日电子书快照开始
2022-04-29 12:41:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330631352455168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330631352455168[0;39m ==> Parameters: 
2022-04-29 12:41:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330631352455168[0;39m <==    Updates: 0
2022-04-29 12:41:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330631352455168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:41:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330652340752384[0;39m 生成今日电子书快照开始
2022-04-29 12:41:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330652340752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330652340752384[0;39m ==> Parameters: 
2022-04-29 12:41:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330652340752384[0;39m <==    Updates: 0
2022-04-29 12:41:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330652340752384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:41:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330673316466688[0;39m 生成今日电子书快照开始
2022-04-29 12:41:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330673316466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330673316466688[0;39m ==> Parameters: 
2022-04-29 12:41:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330673316466688[0;39m <==    Updates: 0
2022-04-29 12:41:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330673316466688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:41:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330694287986688[0;39m 生成今日电子书快照开始
2022-04-29 12:41:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330694287986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:35.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330694287986688[0;39m ==> Parameters: 
2022-04-29 12:41:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330694287986688[0;39m <==    Updates: 0
2022-04-29 12:41:35.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330694287986688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:41:35.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330694569005056[0;39m start updating Ebook doc
2022-04-29 12:41:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330694569005056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:41:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330694569005056[0;39m ==> Parameters: 
2022-04-29 12:41:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330694569005056[0;39m <==    Updates: 1
2022-04-29 12:41:35.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330694569005056[0;39m update ends, take 37 millisecs
2022-04-29 12:41:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330715246923776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330715246923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330715246923776[0;39m ==> Parameters: 
2022-04-29 12:41:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330715246923776[0;39m <==    Updates: 0
2022-04-29 12:41:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330715246923776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:41:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330736222638080[0;39m 生成今日电子书快照开始
2022-04-29 12:41:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330736222638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330736222638080[0;39m ==> Parameters: 
2022-04-29 12:41:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330736222638080[0;39m <==    Updates: 0
2022-04-29 12:41:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330736222638080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:41:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330757189963776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330757189963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330757189963776[0;39m ==> Parameters: 
2022-04-29 12:41:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330757189963776[0;39m <==    Updates: 0
2022-04-29 12:41:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330757189963776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:41:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330778161483776[0;39m 生成今日电子书快照开始
2022-04-29 12:41:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330778161483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:41:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330778161483776[0;39m ==> Parameters: 
2022-04-29 12:41:55.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330778161483776[0;39m <==    Updates: 0
2022-04-29 12:41:55.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330778161483776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:42:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330799128809472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330799128809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330799128809472[0;39m ==> Parameters: 
2022-04-29 12:42:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330799128809472[0;39m <==    Updates: 0
2022-04-29 12:42:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330799128809472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:42:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330820112912384[0;39m 生成今日电子书快照开始
2022-04-29 12:42:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330820112912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330820112912384[0;39m ==> Parameters: 
2022-04-29 12:42:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330820112912384[0;39m <==    Updates: 0
2022-04-29 12:42:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330820112912384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:42:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330820385542144[0;39m start updating Ebook doc
2022-04-29 12:42:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330820385542144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:42:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330820385542144[0;39m ==> Parameters: 
2022-04-29 12:42:05.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330820385542144[0;39m <==    Updates: 1
2022-04-29 12:42:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330820385542144[0;39m update ends, take 37 millisecs
2022-04-29 12:42:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330841071849472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330841071849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330841071849472[0;39m ==> Parameters: 
2022-04-29 12:42:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330841071849472[0;39m <==    Updates: 0
2022-04-29 12:42:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330841071849472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:42:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330862060146688[0;39m 生成今日电子书快照开始
2022-04-29 12:42:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330862060146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330862060146688[0;39m ==> Parameters: 
2022-04-29 12:42:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330862060146688[0;39m <==    Updates: 0
2022-04-29 12:42:15.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330862060146688[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 12:42:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330883023278080[0;39m 生成今日电子书快照开始
2022-04-29 12:42:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330883023278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330883023278080[0;39m ==> Parameters: 
2022-04-29 12:42:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330883023278080[0;39m <==    Updates: 0
2022-04-29 12:42:20.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330883023278080[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 12:42:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330904003186688[0;39m 生成今日电子书快照开始
2022-04-29 12:42:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330904003186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330904003186688[0;39m ==> Parameters: 
2022-04-29 12:42:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330904003186688[0;39m <==    Updates: 0
2022-04-29 12:42:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330904003186688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:42:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330924970512384[0;39m 生成今日电子书快照开始
2022-04-29 12:42:30.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330924970512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:30.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330924970512384[0;39m ==> Parameters: 
2022-04-29 12:42:30.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330924970512384[0;39m <==    Updates: 0
2022-04-29 12:42:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330924970512384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:42:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330945925255168[0;39m 生成今日电子书快照开始
2022-04-29 12:42:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330945925255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330945925255168[0;39m ==> Parameters: 
2022-04-29 12:42:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330945925255168[0;39m <==    Updates: 0
2022-04-29 12:42:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330945925255168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:42:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175330946210467840[0;39m start updating Ebook doc
2022-04-29 12:42:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330946210467840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:42:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330946210467840[0;39m ==> Parameters: 
2022-04-29 12:42:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175330946210467840[0;39m <==    Updates: 1
2022-04-29 12:42:35.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175330946210467840[0;39m update ends, take 37 millisecs
2022-04-29 12:42:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330966900969472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330966900969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330966900969472[0;39m ==> Parameters: 
2022-04-29 12:42:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330966900969472[0;39m <==    Updates: 0
2022-04-29 12:42:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330966900969472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:42:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175330987872489472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330987872489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330987872489472[0;39m ==> Parameters: 
2022-04-29 12:42:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175330987872489472[0;39m <==    Updates: 0
2022-04-29 12:42:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175330987872489472[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:42:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331008844009472[0;39m 生成今日电子书快照开始
2022-04-29 12:42:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331008844009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331008844009472[0;39m ==> Parameters: 
2022-04-29 12:42:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331008844009472[0;39m <==    Updates: 0
2022-04-29 12:42:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331008844009472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:42:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331029811335168[0;39m 生成今日电子书快照开始
2022-04-29 12:42:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331029811335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:42:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331029811335168[0;39m ==> Parameters: 
2022-04-29 12:42:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331029811335168[0;39m <==    Updates: 0
2022-04-29 12:42:55.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331029811335168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:43:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331050787049472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331050787049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331050787049472[0;39m ==> Parameters: 
2022-04-29 12:43:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331050787049472[0;39m <==    Updates: 0
2022-04-29 12:43:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331050787049472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:43:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331071771152384[0;39m 生成今日电子书快照开始
2022-04-29 12:43:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331071771152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331071771152384[0;39m ==> Parameters: 
2022-04-29 12:43:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331071771152384[0;39m <==    Updates: 0
2022-04-29 12:43:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331071771152384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:43:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331072043782144[0;39m start updating Ebook doc
2022-04-29 12:43:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331072043782144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:43:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331072043782144[0;39m ==> Parameters: 
2022-04-29 12:43:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331072043782144[0;39m <==    Updates: 1
2022-04-29 12:43:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331072043782144[0;39m update ends, take 36 millisecs
2022-04-29 12:43:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331092734283776[0;39m 生成今日电子书快照开始
2022-04-29 12:43:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331092734283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331092734283776[0;39m ==> Parameters: 
2022-04-29 12:43:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331092734283776[0;39m <==    Updates: 0
2022-04-29 12:43:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331092734283776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:43:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331113705803776[0;39m 生成今日电子书快照开始
2022-04-29 12:43:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331113705803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331113705803776[0;39m ==> Parameters: 
2022-04-29 12:43:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331113705803776[0;39m <==    Updates: 0
2022-04-29 12:43:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331113705803776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:43:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331134689906688[0;39m 生成今日电子书快照开始
2022-04-29 12:43:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331134689906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331134689906688[0;39m ==> Parameters: 
2022-04-29 12:43:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331134689906688[0;39m <==    Updates: 0
2022-04-29 12:43:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331134689906688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:43:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331155644649472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331155644649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331155644649472[0;39m ==> Parameters: 
2022-04-29 12:43:25.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331155644649472[0;39m <==    Updates: 0
2022-04-29 12:43:25.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331155644649472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:43:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331176632946688[0;39m 生成今日电子书快照开始
2022-04-29 12:43:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331176632946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331176632946688[0;39m ==> Parameters: 
2022-04-29 12:43:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331176632946688[0;39m <==    Updates: 0
2022-04-29 12:43:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331176632946688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 12:43:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331197583495168[0;39m 生成今日电子书快照开始
2022-04-29 12:43:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331197583495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331197583495168[0;39m ==> Parameters: 
2022-04-29 12:43:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331197583495168[0;39m <==    Updates: 0
2022-04-29 12:43:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331197583495168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:43:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331197847736320[0;39m start updating Ebook doc
2022-04-29 12:43:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331197847736320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:43:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331197847736320[0;39m ==> Parameters: 
2022-04-29 12:43:35.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331197847736320[0;39m <==    Updates: 1
2022-04-29 12:43:35.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331197847736320[0;39m update ends, take 36 millisecs
2022-04-29 12:43:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331218559209472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331218559209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331218559209472[0;39m ==> Parameters: 
2022-04-29 12:43:40.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331218559209472[0;39m <==    Updates: 0
2022-04-29 12:43:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331218559209472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:43:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331239530729472[0;39m 生成今日电子书快照开始
2022-04-29 12:43:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331239530729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331239530729472[0;39m ==> Parameters: 
2022-04-29 12:43:45.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331239530729472[0;39m <==    Updates: 0
2022-04-29 12:43:45.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331239530729472[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 12:43:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331260510638080[0;39m 生成今日电子书快照开始
2022-04-29 12:43:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331260510638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331260510638080[0;39m ==> Parameters: 
2022-04-29 12:43:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331260510638080[0;39m <==    Updates: 0
2022-04-29 12:43:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331260510638080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:43:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331281486352384[0;39m 生成今日电子书快照开始
2022-04-29 12:43:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331281486352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:43:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331281486352384[0;39m ==> Parameters: 
2022-04-29 12:43:55.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331281486352384[0;39m <==    Updates: 0
2022-04-29 12:43:55.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331281486352384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:44:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331302445289472[0;39m 生成今日电子书快照开始
2022-04-29 12:44:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331302445289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331302445289472[0;39m ==> Parameters: 
2022-04-29 12:44:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331302445289472[0;39m <==    Updates: 0
2022-04-29 12:44:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331302445289472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:44:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331323429392384[0;39m 生成今日电子书快照开始
2022-04-29 12:44:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331323429392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331323429392384[0;39m ==> Parameters: 
2022-04-29 12:44:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331323429392384[0;39m <==    Updates: 0
2022-04-29 12:44:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331323429392384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:44:05.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331323706216448[0;39m start updating Ebook doc
2022-04-29 12:44:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331323706216448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:44:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331323706216448[0;39m ==> Parameters: 
2022-04-29 12:44:05.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331323706216448[0;39m <==    Updates: 1
2022-04-29 12:44:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331323706216448[0;39m update ends, take 35 millisecs
2022-04-29 12:44:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331344388329472[0;39m 生成今日电子书快照开始
2022-04-29 12:44:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331344388329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331344388329472[0;39m ==> Parameters: 
2022-04-29 12:44:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331344388329472[0;39m <==    Updates: 0
2022-04-29 12:44:10.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331344388329472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:44:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331365372432384[0;39m 生成今日电子书快照开始
2022-04-29 12:44:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331365372432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331365372432384[0;39m ==> Parameters: 
2022-04-29 12:44:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331365372432384[0;39m <==    Updates: 0
2022-04-29 12:44:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331365372432384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:44:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331386327175168[0;39m 生成今日电子书快照开始
2022-04-29 12:44:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331386327175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331386327175168[0;39m ==> Parameters: 
2022-04-29 12:44:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331386327175168[0;39m <==    Updates: 0
2022-04-29 12:44:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331386327175168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:44:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331407311278080[0;39m 生成今日电子书快照开始
2022-04-29 12:44:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331407311278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331407311278080[0;39m ==> Parameters: 
2022-04-29 12:44:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331407311278080[0;39m <==    Updates: 0
2022-04-29 12:44:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331407311278080[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:44:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331428291186688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331428291186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331428291186688[0;39m ==> Parameters: 
2022-04-29 12:44:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331428291186688[0;39m <==    Updates: 0
2022-04-29 12:44:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331428291186688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:44:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331449262706688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331449262706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331449262706688[0;39m ==> Parameters: 
2022-04-29 12:44:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331449262706688[0;39m <==    Updates: 0
2022-04-29 12:44:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331449262706688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:44:35.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331449501782016[0;39m start updating Ebook doc
2022-04-29 12:44:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331449501782016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:44:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331449501782016[0;39m ==> Parameters: 
2022-04-29 12:44:35.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331449501782016[0;39m <==    Updates: 1
2022-04-29 12:44:35.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331449501782016[0;39m update ends, take 42 millisecs
2022-04-29 12:44:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331470234226688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331470234226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331470234226688[0;39m ==> Parameters: 
2022-04-29 12:44:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331470234226688[0;39m <==    Updates: 0
2022-04-29 12:44:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331470234226688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:44:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331491205746688[0;39m 生成今日电子书快照开始
2022-04-29 12:44:45.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331491205746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331491205746688[0;39m ==> Parameters: 
2022-04-29 12:44:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331491205746688[0;39m <==    Updates: 0
2022-04-29 12:44:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331491205746688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:44:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331512160489472[0;39m 生成今日电子书快照开始
2022-04-29 12:44:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331512160489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331512160489472[0;39m ==> Parameters: 
2022-04-29 12:44:50.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331512160489472[0;39m <==    Updates: 0
2022-04-29 12:44:50.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331512160489472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:44:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331533152980992[0;39m 生成今日电子书快照开始
2022-04-29 12:44:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331533152980992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:44:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331533152980992[0;39m ==> Parameters: 
2022-04-29 12:44:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331533152980992[0;39m <==    Updates: 0
2022-04-29 12:44:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331533152980992[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:45:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331554111918080[0;39m 生成今日电子书快照开始
2022-04-29 12:45:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331554111918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331554111918080[0;39m ==> Parameters: 
2022-04-29 12:45:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331554111918080[0;39m <==    Updates: 0
2022-04-29 12:45:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331554111918080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:45:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331575091826688[0;39m 生成今日电子书快照开始
2022-04-29 12:45:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331575091826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331575091826688[0;39m ==> Parameters: 
2022-04-29 12:45:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331575091826688[0;39m <==    Updates: 0
2022-04-29 12:45:05.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331575091826688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:45:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331575339290624[0;39m start updating Ebook doc
2022-04-29 12:45:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331575339290624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:45:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331575339290624[0;39m ==> Parameters: 
2022-04-29 12:45:05.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331575339290624[0;39m <==    Updates: 1
2022-04-29 12:45:05.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331575339290624[0;39m update ends, take 36 millisecs
2022-04-29 12:45:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331596046569472[0;39m 生成今日电子书快照开始
2022-04-29 12:45:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331596046569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331596046569472[0;39m ==> Parameters: 
2022-04-29 12:45:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331596046569472[0;39m <==    Updates: 0
2022-04-29 12:45:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331596046569472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:45:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331617022283776[0;39m 生成今日电子书快照开始
2022-04-29 12:45:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331617022283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331617022283776[0;39m ==> Parameters: 
2022-04-29 12:45:15.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331617022283776[0;39m <==    Updates: 0
2022-04-29 12:45:15.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331617022283776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:45:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331637989609472[0;39m 生成今日电子书快照开始
2022-04-29 12:45:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331637989609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331637989609472[0;39m ==> Parameters: 
2022-04-29 12:45:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331637989609472[0;39m <==    Updates: 0
2022-04-29 12:45:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331637989609472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:45:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331658977906688[0;39m 生成今日电子书快照开始
2022-04-29 12:45:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331658977906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331658977906688[0;39m ==> Parameters: 
2022-04-29 12:45:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331658977906688[0;39m <==    Updates: 0
2022-04-29 12:45:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331658977906688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:45:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331679953620992[0;39m 生成今日电子书快照开始
2022-04-29 12:45:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331679953620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331679953620992[0;39m ==> Parameters: 
2022-04-29 12:45:30.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331679953620992[0;39m <==    Updates: 0
2022-04-29 12:45:30.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331679953620992[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:45:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331700908363776[0;39m 生成今日电子书快照开始
2022-04-29 12:45:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331700908363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331700908363776[0;39m ==> Parameters: 
2022-04-29 12:45:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331700908363776[0;39m <==    Updates: 0
2022-04-29 12:45:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331700908363776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:45:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331701180993536[0;39m start updating Ebook doc
2022-04-29 12:45:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331701180993536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:45:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331701180993536[0;39m ==> Parameters: 
2022-04-29 12:45:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331701180993536[0;39m <==    Updates: 1
2022-04-29 12:45:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331701180993536[0;39m update ends, take 41 millisecs
2022-04-29 12:45:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331721884078080[0;39m 生成今日电子书快照开始
2022-04-29 12:45:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331721884078080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331721884078080[0;39m ==> Parameters: 
2022-04-29 12:45:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331721884078080[0;39m <==    Updates: 0
2022-04-29 12:45:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331721884078080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:45:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331742859792384[0;39m 生成今日电子书快照开始
2022-04-29 12:45:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331742859792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331742859792384[0;39m ==> Parameters: 
2022-04-29 12:45:45.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331742859792384[0;39m <==    Updates: 0
2022-04-29 12:45:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331742859792384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:45:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331763827118080[0;39m 生成今日电子书快照开始
2022-04-29 12:45:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331763827118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331763827118080[0;39m ==> Parameters: 
2022-04-29 12:45:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331763827118080[0;39m <==    Updates: 0
2022-04-29 12:45:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331763827118080[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:45:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331784794443776[0;39m 生成今日电子书快照开始
2022-04-29 12:45:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331784794443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:45:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331784794443776[0;39m ==> Parameters: 
2022-04-29 12:45:55.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331784794443776[0;39m <==    Updates: 0
2022-04-29 12:45:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331784794443776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:46:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331805770158080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331805770158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331805770158080[0;39m ==> Parameters: 
2022-04-29 12:46:00.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331805770158080[0;39m <==    Updates: 0
2022-04-29 12:46:00.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331805770158080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 12:46:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331826741678080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331826741678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331826741678080[0;39m ==> Parameters: 
2022-04-29 12:46:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331826741678080[0;39m <==    Updates: 0
2022-04-29 12:46:05.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331826741678080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:46:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331827001724928[0;39m start updating Ebook doc
2022-04-29 12:46:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331827001724928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:46:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331827001724928[0;39m ==> Parameters: 
2022-04-29 12:46:05.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331827001724928[0;39m <==    Updates: 1
2022-04-29 12:46:05.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331827001724928[0;39m update ends, take 37 millisecs
2022-04-29 12:46:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331847709003776[0;39m 生成今日电子书快照开始
2022-04-29 12:46:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331847709003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331847709003776[0;39m ==> Parameters: 
2022-04-29 12:46:10.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331847709003776[0;39m <==    Updates: 0
2022-04-29 12:46:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331847709003776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:46:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331868693106688[0;39m 生成今日电子书快照开始
2022-04-29 12:46:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331868693106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331868693106688[0;39m ==> Parameters: 
2022-04-29 12:46:15.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331868693106688[0;39m <==    Updates: 0
2022-04-29 12:46:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331868693106688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:46:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331889656238080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331889656238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331889656238080[0;39m ==> Parameters: 
2022-04-29 12:46:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331889656238080[0;39m <==    Updates: 0
2022-04-29 12:46:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331889656238080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:46:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331910640340992[0;39m 生成今日电子书快照开始
2022-04-29 12:46:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331910640340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331910640340992[0;39m ==> Parameters: 
2022-04-29 12:46:25.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331910640340992[0;39m <==    Updates: 0
2022-04-29 12:46:25.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331910640340992[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 12:46:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331931599278080[0;39m 生成今日电子书快照开始
2022-04-29 12:46:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331931599278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331931599278080[0;39m ==> Parameters: 
2022-04-29 12:46:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331931599278080[0;39m <==    Updates: 0
2022-04-29 12:46:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331931599278080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:46:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331952558215168[0;39m 生成今日电子书快照开始
2022-04-29 12:46:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331952558215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331952558215168[0;39m ==> Parameters: 
2022-04-29 12:46:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331952558215168[0;39m <==    Updates: 0
2022-04-29 12:46:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331952558215168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:46:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175331952826650624[0;39m start updating Ebook doc
2022-04-29 12:46:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331952826650624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:46:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331952826650624[0;39m ==> Parameters: 
2022-04-29 12:46:35.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175331952826650624[0;39m <==    Updates: 1
2022-04-29 12:46:35.103 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175331952826650624[0;39m update ends, take 39 millisecs
2022-04-29 12:46:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331973550706688[0;39m 生成今日电子书快照开始
2022-04-29 12:46:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331973550706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331973550706688[0;39m ==> Parameters: 
2022-04-29 12:46:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331973550706688[0;39m <==    Updates: 0
2022-04-29 12:46:40.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331973550706688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:46:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175331994518032384[0;39m 生成今日电子书快照开始
2022-04-29 12:46:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331994518032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331994518032384[0;39m ==> Parameters: 
2022-04-29 12:46:45.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175331994518032384[0;39m <==    Updates: 0
2022-04-29 12:46:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175331994518032384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:46:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332015476969472[0;39m 生成今日电子书快照开始
2022-04-29 12:46:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332015476969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332015476969472[0;39m ==> Parameters: 
2022-04-29 12:46:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332015476969472[0;39m <==    Updates: 0
2022-04-29 12:46:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332015476969472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:46:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332036469460992[0;39m 生成今日电子书快照开始
2022-04-29 12:46:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332036469460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:46:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332036469460992[0;39m ==> Parameters: 
2022-04-29 12:46:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332036469460992[0;39m <==    Updates: 0
2022-04-29 12:46:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332036469460992[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:47:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332057432592384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332057432592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332057432592384[0;39m ==> Parameters: 
2022-04-29 12:47:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332057432592384[0;39m <==    Updates: 0
2022-04-29 12:47:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332057432592384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:47:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332078408306688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332078408306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332078408306688[0;39m ==> Parameters: 
2022-04-29 12:47:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332078408306688[0;39m <==    Updates: 0
2022-04-29 12:47:05.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332078408306688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:47:05.073 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332078693519360[0;39m start updating Ebook doc
2022-04-29 12:47:05.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332078693519360[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:47:05.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332078693519360[0;39m ==> Parameters: 
2022-04-29 12:47:05.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332078693519360[0;39m <==    Updates: 1
2022-04-29 12:47:05.119 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332078693519360[0;39m update ends, take 46 millisecs
2022-04-29 12:47:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332099379826688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332099379826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332099379826688[0;39m ==> Parameters: 
2022-04-29 12:47:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332099379826688[0;39m <==    Updates: 0
2022-04-29 12:47:10.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332099379826688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:47:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332120338763776[0;39m 生成今日电子书快照开始
2022-04-29 12:47:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332120338763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332120338763776[0;39m ==> Parameters: 
2022-04-29 12:47:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332120338763776[0;39m <==    Updates: 0
2022-04-29 12:47:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332120338763776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:47:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332141322866688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332141322866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332141322866688[0;39m ==> Parameters: 
2022-04-29 12:47:20.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332141322866688[0;39m <==    Updates: 0
2022-04-29 12:47:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332141322866688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:47:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332162277609472[0;39m 生成今日电子书快照开始
2022-04-29 12:47:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332162277609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332162277609472[0;39m ==> Parameters: 
2022-04-29 12:47:25.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332162277609472[0;39m <==    Updates: 0
2022-04-29 12:47:25.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332162277609472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:47:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332183261712384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332183261712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332183261712384[0;39m ==> Parameters: 
2022-04-29 12:47:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332183261712384[0;39m <==    Updates: 0
2022-04-29 12:47:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332183261712384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:47:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332204229038080[0;39m 生成今日电子书快照开始
2022-04-29 12:47:35.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332204229038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:35.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332204229038080[0;39m ==> Parameters: 
2022-04-29 12:47:35.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332204229038080[0;39m <==    Updates: 0
2022-04-29 12:47:35.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332204229038080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:47:35.075 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332204531027968[0;39m start updating Ebook doc
2022-04-29 12:47:35.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332204531027968[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:47:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332204531027968[0;39m ==> Parameters: 
2022-04-29 12:47:35.112 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332204531027968[0;39m <==    Updates: 1
2022-04-29 12:47:35.113 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332204531027968[0;39m update ends, take 38 millisecs
2022-04-29 12:47:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332225204752384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332225204752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332225204752384[0;39m ==> Parameters: 
2022-04-29 12:47:40.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332225204752384[0;39m <==    Updates: 0
2022-04-29 12:47:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332225204752384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:47:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332246176272384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332246176272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332246176272384[0;39m ==> Parameters: 
2022-04-29 12:47:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332246176272384[0;39m <==    Updates: 0
2022-04-29 12:47:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332246176272384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:47:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332267151986688[0;39m 生成今日电子书快照开始
2022-04-29 12:47:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332267151986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332267151986688[0;39m ==> Parameters: 
2022-04-29 12:47:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332267151986688[0;39m <==    Updates: 0
2022-04-29 12:47:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332267151986688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:47:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332288119312384[0;39m 生成今日电子书快照开始
2022-04-29 12:47:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332288119312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:47:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332288119312384[0;39m ==> Parameters: 
2022-04-29 12:47:55.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332288119312384[0;39m <==    Updates: 0
2022-04-29 12:47:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332288119312384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:48:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332309074055168[0;39m 生成今日电子书快照开始
2022-04-29 12:48:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332309074055168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332309074055168[0;39m ==> Parameters: 
2022-04-29 12:48:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332309074055168[0;39m <==    Updates: 0
2022-04-29 12:48:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332309074055168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:48:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332330066546688[0;39m 生成今日电子书快照开始
2022-04-29 12:48:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332330066546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332330066546688[0;39m ==> Parameters: 
2022-04-29 12:48:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332330066546688[0;39m <==    Updates: 0
2022-04-29 12:48:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332330066546688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:48:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332330326593536[0;39m start updating Ebook doc
2022-04-29 12:48:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332330326593536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:48:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332330326593536[0;39m ==> Parameters: 
2022-04-29 12:48:05.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332330326593536[0;39m <==    Updates: 1
2022-04-29 12:48:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332330326593536[0;39m update ends, take 38 millisecs
2022-04-29 12:48:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332351033872384[0;39m 生成今日电子书快照开始
2022-04-29 12:48:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332351033872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332351033872384[0;39m ==> Parameters: 
2022-04-29 12:48:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332351033872384[0;39m <==    Updates: 0
2022-04-29 12:48:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332351033872384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:48:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332372005392384[0;39m 生成今日电子书快照开始
2022-04-29 12:48:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332372005392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332372005392384[0;39m ==> Parameters: 
2022-04-29 12:48:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332372005392384[0;39m <==    Updates: 0
2022-04-29 12:48:15.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332372005392384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:48:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332392976912384[0;39m 生成今日电子书快照开始
2022-04-29 12:48:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332392976912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332392976912384[0;39m ==> Parameters: 
2022-04-29 12:48:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332392976912384[0;39m <==    Updates: 0
2022-04-29 12:48:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332392976912384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:48:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332413944238080[0;39m 生成今日电子书快照开始
2022-04-29 12:48:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332413944238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332413944238080[0;39m ==> Parameters: 
2022-04-29 12:48:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332413944238080[0;39m <==    Updates: 0
2022-04-29 12:48:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332413944238080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:48:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332434915758080[0;39m 生成今日电子书快照开始
2022-04-29 12:48:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332434915758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332434915758080[0;39m ==> Parameters: 
2022-04-29 12:48:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332434915758080[0;39m <==    Updates: 0
2022-04-29 12:48:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332434915758080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:48:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332455887278080[0;39m 生成今日电子书快照开始
2022-04-29 12:48:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332455887278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332455887278080[0;39m ==> Parameters: 
2022-04-29 12:48:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332455887278080[0;39m <==    Updates: 0
2022-04-29 12:48:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332455887278080[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:48:35.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332456122159104[0;39m start updating Ebook doc
2022-04-29 12:48:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332456122159104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:48:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332456122159104[0;39m ==> Parameters: 
2022-04-29 12:48:35.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332456122159104[0;39m <==    Updates: 1
2022-04-29 12:48:35.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332456122159104[0;39m update ends, take 39 millisecs
2022-04-29 12:48:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332476867186688[0;39m 生成今日电子书快照开始
2022-04-29 12:48:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332476867186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:48:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332476867186688[0;39m ==> Parameters: 
2022-04-29 12:48:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332476867186688[0;39m <==    Updates: 0
2022-04-29 12:48:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332476867186688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:48:43.525 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m175330320336424960[0;39m 连接关闭，token：lsDuEMZABU，session id：0！当前连接数：0
2022-04-29 12:48:44.351 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 12:48:44.355 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 12:48:44.377 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-29 12:48:44.392 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-29 12:48:59.888 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5003 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 12:49:04.893 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 20538 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 12:49:04.894 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 12:49:05.173 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 12:49:05.173 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 12:49:05.175 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2022-04-29 12:49:05.326 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 12:49:05.327 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 12:49:05.327 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 12:49:05.327 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 12:49:05.337 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 12:49:05.337 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 432 ms
2022-04-29 12:49:05.688 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 12:49:05.977 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 12:49:06.006 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 12:49:06.016 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 12:49:06.018 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 12:49:06.022 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 21.198 seconds (JVM running for 664.299)
2022-04-29 12:49:06.024 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-29 12:49:06.024 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 12:49:06.024 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 12:49:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332602675335168[0;39m 生成今日电子书快照开始
2022-04-29 12:49:10.001 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175332602675335168[0;39m HikariPool-2 - Starting...
2022-04-29 12:49:10.231 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175332602675335168[0;39m HikariPool-2 - Start completed.
2022-04-29 12:49:10.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332602675335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:10.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332602675335168[0;39m ==> Parameters: 
2022-04-29 12:49:10.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332602675335168[0;39m <==    Updates: 0
2022-04-29 12:49:10.269 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332602675335168[0;39m 生成今日电子书快照结束，耗时：267毫秒
2022-04-29 12:49:13.585 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 12:49:13.585 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 12:49:13.586 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-29 12:49:13.606 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332617799995392[0;39m ------------- 开始 -------------
2022-04-29 12:49:13.607 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332617799995392[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:49:13.607 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332617799995392[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:49:13.607 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332617799995392[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:13.626 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332617799995392[0;39m 请求参数: []
2022-04-29 12:49:13.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332617971961856[0;39m ------------- 开始 -------------
2022-04-29 12:49:13.647 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332617971961857[0;39m ------------- 开始 -------------
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332617971961856[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332617971961857[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332617971961856[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332617971961856[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332617971961857[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332617971961856[0;39m 请求参数: []
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332617971961857[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:13.648 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332617971961857[0;39m 请求参数: []
2022-04-29 12:49:13.670 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332617799995392[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:49:13.670 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332617799995392[0;39m ==> Parameters: 
2022-04-29 12:49:13.674 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175332617971961856[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:49:13.674 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175332617971961856[0;39m ==> Parameters: 
2022-04-29 12:49:13.677 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175332617971961857[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 12:49:13.677 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175332617971961857[0;39m ==> Parameters: 
2022-04-29 12:49:13.688 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:49:13.688 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:49:13.688 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:49:13.689 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:49:13.690 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:49:13.691 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:49:13.691 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:49:13.691 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175332617971961856[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 12:49:13.692 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:49:13.692 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:49:13.693 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:49:13.693 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:49:13.694 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175332617971961856[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 12:49:13.695 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:49:13.695 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175332617971961856[0;39m <==        Row: 2022-04-29, 1763, 63, 28, 2
2022-04-29 12:49:13.696 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332617799995392[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:49:13.696 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175332617971961856[0;39m <==      Total: 2
2022-04-29 12:49:13.696 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332617799995392[0;39m <==      Total: 18
2022-04-29 12:49:13.699 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 12:49:13.700 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 12:49:13.700 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 12:49:13.701 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 12:49:13.702 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 12:49:13.702 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 12:49:13.702 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 12:49:13.703 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 12:49:13.703 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 12:49:13.704 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 12:49:13.704 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 12:49:13.704 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 12:49:13.705 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 12:49:13.705 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332617971961856[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1763,"viewIncrease":28,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 12:49:13.705 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332617971961856[0;39m ------------- 结束 耗时：58 ms -------------
2022-04-29 12:49:13.705 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175332617971961857[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 12:49:13.705 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175332617971961857[0;39m <==      Total: 13
2022-04-29 12:49:13.707 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332617971961857[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 12:49:13.707 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332617971961857[0;39m ------------- 结束 耗时：60 ms -------------
2022-04-29 12:49:13.711 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332617799995392[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:49:13.712 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332617799995392[0;39m ------------- 结束 耗时：106 ms -------------
2022-04-29 12:49:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332623663632384[0;39m 生成今日电子书快照开始
2022-04-29 12:49:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332623663632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332623663632384[0;39m ==> Parameters: 
2022-04-29 12:49:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332623663632384[0;39m <==    Updates: 0
2022-04-29 12:49:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332623663632384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:49:15.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332626939383808[0;39m ------------- 开始 -------------
2022-04-29 12:49:15.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332626939383808[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:49:15.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332626939383808[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:49:15.786 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332626939383808[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:15.786 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332626939383808[0;39m 请求参数: []
2022-04-29 12:49:15.802 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332626939383808[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:49:15.803 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332626939383808[0;39m ==> Parameters: 
2022-04-29 12:49:15.820 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:49:15.821 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:49:15.821 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:49:15.822 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:49:15.823 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:49:15.823 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:49:15.823 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:49:15.824 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:49:15.824 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:49:15.824 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:49:15.825 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:49:15.825 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:49:15.825 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:49:15.826 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:49:15.827 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:49:15.827 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175332626939383808[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:49:15.827 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175332626939383808[0;39m <==      Total: 18
2022-04-29 12:49:15.828 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332626939383808[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:49:15.829 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332626939383808[0;39m ------------- 结束 耗时：44 ms -------------
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332627249762304[0;39m ------------- 开始 -------------
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332627249762304[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332627249762304[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 12:49:15.859 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332627249762304[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:15.860 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332627249762304[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 12:49:15.872 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175332627249762304[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 12:49:15.873 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175332627249762304[0;39m ==> Parameters: 
2022-04-29 12:49:15.889 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175332627249762304[0;39m <==    Columns: count(0)
2022-04-29 12:49:15.890 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175332627249762304[0;39m <==        Row: 5
2022-04-29 12:49:15.891 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175332627249762304[0;39m <==      Total: 1
2022-04-29 12:49:15.891 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175332627249762304[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 12:49:15.892 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175332627249762304[0;39m ==> Parameters: 10(Integer)
2022-04-29 12:49:15.908 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 12:49:15.908 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 12:49:15.909 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 12:49:15.910 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 12:49:15.910 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 12:49:15.911 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175332627249762304[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 12:49:15.912 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175332627249762304[0;39m <==      Total: 5
2022-04-29 12:49:15.914 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175332627249762304[0;39m total rows：5
2022-04-29 12:49:15.914 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175332627249762304[0;39m total pages：1
2022-04-29 12:49:15.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175332627249762304[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 12:49:15.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175332627249762304[0;39m ------------- 结束 耗时：62 ms -------------
2022-04-29 12:49:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332644639346688[0;39m 生成今日电子书快照开始
2022-04-29 12:49:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332644639346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:20.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332644639346688[0;39m ==> Parameters: 
2022-04-29 12:49:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332644639346688[0;39m <==    Updates: 0
2022-04-29 12:49:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332644639346688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:49:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332665602478080[0;39m 生成今日电子书快照开始
2022-04-29 12:49:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332665602478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332665602478080[0;39m ==> Parameters: 
2022-04-29 12:49:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332665602478080[0;39m <==    Updates: 0
2022-04-29 12:49:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332665602478080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:49:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332686573998080[0;39m 生成今日电子书快照开始
2022-04-29 12:49:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332686573998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332686573998080[0;39m ==> Parameters: 
2022-04-29 12:49:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332686573998080[0;39m <==    Updates: 0
2022-04-29 12:49:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332686573998080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:49:31.029 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:49:31.030 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 12:49:31.030 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175330320638414848
2022-04-29 12:49:31.798 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"}
2022-04-29 12:49:31.809 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175332694148911104[0;39m ------------- 开始 -------------
2022-04-29 12:49:31.810 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175332694148911104[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 12:49:31.810 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175332694148911104[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 12:49:31.810 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175332694148911104[0;39m 远程地址: 127.0.0.1
2022-04-29 12:49:31.811 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175332694148911104[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"Spring"}]
2022-04-29 12:49:31.830 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175332694148911104[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 12:49:31.831 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175332694148911104[0;39m ==> Parameters: 175332694169882624(Long), Spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 12:49:31.870 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175332694148911104[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy150.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 12:49:31.874 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175332694148911104[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 12:49:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332707553906688[0;39m 生成今日电子书快照开始
2022-04-29 12:49:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332707553906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332707553906688[0;39m ==> Parameters: 
2022-04-29 12:49:35.091 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332707553906688[0;39m <==    Updates: 0
2022-04-29 12:49:35.092 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332707553906688[0;39m 生成今日电子书快照结束，耗时：86毫秒
2022-04-29 12:49:35.092 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332707918811136[0;39m start updating Ebook doc
2022-04-29 12:49:35.095 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332707918811136[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:49:35.096 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332707918811136[0;39m ==> Parameters: 
2022-04-29 12:49:35.125 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332707918811136[0;39m <==    Updates: 1
2022-04-29 12:49:35.126 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332707918811136[0;39m update ends, take 34 millisecs
2022-04-29 12:49:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332728517038080[0;39m 生成今日电子书快照开始
2022-04-29 12:49:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332728517038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332728517038080[0;39m ==> Parameters: 
2022-04-29 12:49:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332728517038080[0;39m <==    Updates: 0
2022-04-29 12:49:40.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332728517038080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:49:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332749492752384[0;39m 生成今日电子书快照开始
2022-04-29 12:49:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332749492752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332749492752384[0;39m ==> Parameters: 
2022-04-29 12:49:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332749492752384[0;39m <==    Updates: 0
2022-04-29 12:49:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332749492752384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:49:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332770451689472[0;39m 生成今日电子书快照开始
2022-04-29 12:49:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332770451689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332770451689472[0;39m ==> Parameters: 
2022-04-29 12:49:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332770451689472[0;39m <==    Updates: 0
2022-04-29 12:49:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332770451689472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:49:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332791427403776[0;39m 生成今日电子书快照开始
2022-04-29 12:49:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332791427403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:49:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332791427403776[0;39m ==> Parameters: 
2022-04-29 12:49:55.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332791427403776[0;39m <==    Updates: 0
2022-04-29 12:49:55.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332791427403776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:50:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332812407312384[0;39m 生成今日电子书快照开始
2022-04-29 12:50:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332812407312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332812407312384[0;39m ==> Parameters: 
2022-04-29 12:50:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332812407312384[0;39m <==    Updates: 0
2022-04-29 12:50:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332812407312384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:50:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332833383026688[0;39m start updating Ebook doc
2022-04-29 12:50:05.038 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332833383026688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:50:05.039 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332833383026688[0;39m ==> Parameters: 
2022-04-29 12:50:05.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332833383026688[0;39m <==    Updates: 1
2022-04-29 12:50:05.077 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332833383026688[0;39m update ends, take 71 millisecs
2022-04-29 12:50:05.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332833685016576[0;39m 生成今日电子书快照开始
2022-04-29 12:50:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332833685016576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332833685016576[0;39m ==> Parameters: 
2022-04-29 12:50:05.117 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332833685016576[0;39m <==    Updates: 0
2022-04-29 12:50:05.119 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332833685016576[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-29 12:50:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332854333575168[0;39m 生成今日电子书快照开始
2022-04-29 12:50:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332854333575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332854333575168[0;39m ==> Parameters: 
2022-04-29 12:50:10.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332854333575168[0;39m <==    Updates: 0
2022-04-29 12:50:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332854333575168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:50:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332875317678080[0;39m 生成今日电子书快照开始
2022-04-29 12:50:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332875317678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332875317678080[0;39m ==> Parameters: 
2022-04-29 12:50:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332875317678080[0;39m <==    Updates: 0
2022-04-29 12:50:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332875317678080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:50:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332896297586688[0;39m 生成今日电子书快照开始
2022-04-29 12:50:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332896297586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332896297586688[0;39m ==> Parameters: 
2022-04-29 12:50:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332896297586688[0;39m <==    Updates: 0
2022-04-29 12:50:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332896297586688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:50:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332917273300992[0;39m 生成今日电子书快照开始
2022-04-29 12:50:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332917273300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332917273300992[0;39m ==> Parameters: 
2022-04-29 12:50:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332917273300992[0;39m <==    Updates: 0
2022-04-29 12:50:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332917273300992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:50:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332938240626688[0;39m 生成今日电子书快照开始
2022-04-29 12:50:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332938240626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332938240626688[0;39m ==> Parameters: 
2022-04-29 12:50:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332938240626688[0;39m <==    Updates: 0
2022-04-29 12:50:30.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332938240626688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:50:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332959207952384[0;39m 生成今日电子书快照开始
2022-04-29 12:50:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332959207952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332959207952384[0;39m ==> Parameters: 
2022-04-29 12:50:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332959207952384[0;39m <==    Updates: 0
2022-04-29 12:50:35.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332959207952384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:50:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175332959476387840[0;39m start updating Ebook doc
2022-04-29 12:50:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332959476387840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:50:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332959476387840[0;39m ==> Parameters: 
2022-04-29 12:50:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175332959476387840[0;39m <==    Updates: 1
2022-04-29 12:50:35.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175332959476387840[0;39m update ends, take 38 millisecs
2022-04-29 12:50:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175332980171083776[0;39m 生成今日电子书快照开始
2022-04-29 12:50:40.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332980171083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:40.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332980171083776[0;39m ==> Parameters: 
2022-04-29 12:50:40.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175332980171083776[0;39m <==    Updates: 0
2022-04-29 12:50:40.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175332980171083776[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 12:50:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333001159380992[0;39m 生成今日电子书快照开始
2022-04-29 12:50:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333001159380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333001159380992[0;39m ==> Parameters: 
2022-04-29 12:50:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333001159380992[0;39m <==    Updates: 0
2022-04-29 12:50:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333001159380992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:50:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333022114123776[0;39m 生成今日电子书快照开始
2022-04-29 12:50:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333022114123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333022114123776[0;39m ==> Parameters: 
2022-04-29 12:50:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333022114123776[0;39m <==    Updates: 0
2022-04-29 12:50:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333022114123776[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:50:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333043098226688[0;39m 生成今日电子书快照开始
2022-04-29 12:50:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333043098226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:50:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333043098226688[0;39m ==> Parameters: 
2022-04-29 12:50:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333043098226688[0;39m <==    Updates: 0
2022-04-29 12:50:55.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333043098226688[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 12:51:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333064052969472[0;39m 生成今日电子书快照开始
2022-04-29 12:51:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333064052969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333064052969472[0;39m ==> Parameters: 
2022-04-29 12:51:00.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333064052969472[0;39m <==    Updates: 0
2022-04-29 12:51:00.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333064052969472[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:51:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333085028683776[0;39m 生成今日电子书快照开始
2022-04-29 12:51:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333085028683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333085028683776[0;39m ==> Parameters: 
2022-04-29 12:51:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333085028683776[0;39m <==    Updates: 0
2022-04-29 12:51:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333085028683776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:51:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333085271953408[0;39m start updating Ebook doc
2022-04-29 12:51:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333085271953408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:51:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333085271953408[0;39m ==> Parameters: 
2022-04-29 12:51:05.099 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333085271953408[0;39m <==    Updates: 1
2022-04-29 12:51:05.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333085271953408[0;39m update ends, take 39 millisecs
2022-04-29 12:51:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333105991815168[0;39m 生成今日电子书快照开始
2022-04-29 12:51:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333105991815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333105991815168[0;39m ==> Parameters: 
2022-04-29 12:51:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333105991815168[0;39m <==    Updates: 0
2022-04-29 12:51:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333105991815168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:51:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333126963335168[0;39m 生成今日电子书快照开始
2022-04-29 12:51:15.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333126963335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:15.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333126963335168[0;39m ==> Parameters: 
2022-04-29 12:51:15.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333126963335168[0;39m <==    Updates: 0
2022-04-29 12:51:15.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333126963335168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:51:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333147943243776[0;39m 生成今日电子书快照开始
2022-04-29 12:51:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333147943243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333147943243776[0;39m ==> Parameters: 
2022-04-29 12:51:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333147943243776[0;39m <==    Updates: 0
2022-04-29 12:51:20.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333147943243776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:51:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333168906375168[0;39m 生成今日电子书快照开始
2022-04-29 12:51:25.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333168906375168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:25.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333168906375168[0;39m ==> Parameters: 
2022-04-29 12:51:25.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333168906375168[0;39m <==    Updates: 0
2022-04-29 12:51:25.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333168906375168[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 12:51:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333189886283776[0;39m 生成今日电子书快照开始
2022-04-29 12:51:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333189886283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333189886283776[0;39m ==> Parameters: 
2022-04-29 12:51:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333189886283776[0;39m <==    Updates: 0
2022-04-29 12:51:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333189886283776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:51:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333210861998080[0;39m 生成今日电子书快照开始
2022-04-29 12:51:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333210861998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333210861998080[0;39m ==> Parameters: 
2022-04-29 12:51:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333210861998080[0;39m <==    Updates: 0
2022-04-29 12:51:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333210861998080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:51:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333211126239232[0;39m start updating Ebook doc
2022-04-29 12:51:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333211126239232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:51:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333211126239232[0;39m ==> Parameters: 
2022-04-29 12:51:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333211126239232[0;39m <==    Updates: 1
2022-04-29 12:51:35.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333211126239232[0;39m update ends, take 43 millisecs
2022-04-29 12:51:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333231841906688[0;39m 生成今日电子书快照开始
2022-04-29 12:51:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333231841906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333231841906688[0;39m ==> Parameters: 
2022-04-29 12:51:40.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333231841906688[0;39m <==    Updates: 0
2022-04-29 12:51:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333231841906688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:51:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333252813426688[0;39m 生成今日电子书快照开始
2022-04-29 12:51:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333252813426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333252813426688[0;39m ==> Parameters: 
2022-04-29 12:51:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333252813426688[0;39m <==    Updates: 0
2022-04-29 12:51:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333252813426688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:51:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333273776558080[0;39m 生成今日电子书快照开始
2022-04-29 12:51:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333273776558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333273776558080[0;39m ==> Parameters: 
2022-04-29 12:51:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333273776558080[0;39m <==    Updates: 0
2022-04-29 12:51:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333273776558080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:51:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333294739689472[0;39m 生成今日电子书快照开始
2022-04-29 12:51:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333294739689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:51:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333294739689472[0;39m ==> Parameters: 
2022-04-29 12:51:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333294739689472[0;39m <==    Updates: 0
2022-04-29 12:51:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333294739689472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:52:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333315727986688[0;39m 生成今日电子书快照开始
2022-04-29 12:52:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333315727986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333315727986688[0;39m ==> Parameters: 
2022-04-29 12:52:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333315727986688[0;39m <==    Updates: 0
2022-04-29 12:52:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333315727986688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:52:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333336695312384[0;39m 生成今日电子书快照开始
2022-04-29 12:52:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333336695312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:05.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333336695312384[0;39m ==> Parameters: 
2022-04-29 12:52:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333336695312384[0;39m <==    Updates: 0
2022-04-29 12:52:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333336695312384[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 12:52:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333336925999104[0;39m start updating Ebook doc
2022-04-29 12:52:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333336925999104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:52:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333336925999104[0;39m ==> Parameters: 
2022-04-29 12:52:05.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333336925999104[0;39m <==    Updates: 1
2022-04-29 12:52:05.103 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333336925999104[0;39m update ends, take 44 millisecs
2022-04-29 12:52:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333357675220992[0;39m 生成今日电子书快照开始
2022-04-29 12:52:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333357675220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333357675220992[0;39m ==> Parameters: 
2022-04-29 12:52:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333357675220992[0;39m <==    Updates: 0
2022-04-29 12:52:10.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333357675220992[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:52:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333378638352384[0;39m 生成今日电子书快照开始
2022-04-29 12:52:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333378638352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333378638352384[0;39m ==> Parameters: 
2022-04-29 12:52:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333378638352384[0;39m <==    Updates: 0
2022-04-29 12:52:15.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333378638352384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:52:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333399597289472[0;39m 生成今日电子书快照开始
2022-04-29 12:52:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333399597289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333399597289472[0;39m ==> Parameters: 
2022-04-29 12:52:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333399597289472[0;39m <==    Updates: 0
2022-04-29 12:52:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333399597289472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:52:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333420568809472[0;39m 生成今日电子书快照开始
2022-04-29 12:52:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333420568809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333420568809472[0;39m ==> Parameters: 
2022-04-29 12:52:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333420568809472[0;39m <==    Updates: 0
2022-04-29 12:52:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333420568809472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:52:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333441544523776[0;39m 生成今日电子书快照开始
2022-04-29 12:52:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333441544523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333441544523776[0;39m ==> Parameters: 
2022-04-29 12:52:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333441544523776[0;39m <==    Updates: 0
2022-04-29 12:52:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333441544523776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:52:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333462516043776[0;39m 生成今日电子书快照开始
2022-04-29 12:52:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333462516043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333462516043776[0;39m ==> Parameters: 
2022-04-29 12:52:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333462516043776[0;39m <==    Updates: 0
2022-04-29 12:52:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333462516043776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:52:35.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333462759313408[0;39m start updating Ebook doc
2022-04-29 12:52:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333462759313408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:52:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333462759313408[0;39m ==> Parameters: 
2022-04-29 12:52:35.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333462759313408[0;39m <==    Updates: 1
2022-04-29 12:52:35.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333462759313408[0;39m update ends, take 39 millisecs
2022-04-29 12:52:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333483495952384[0;39m 生成今日电子书快照开始
2022-04-29 12:52:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333483495952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333483495952384[0;39m ==> Parameters: 
2022-04-29 12:52:40.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333483495952384[0;39m <==    Updates: 0
2022-04-29 12:52:40.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333483495952384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:52:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333504459083776[0;39m 生成今日电子书快照开始
2022-04-29 12:52:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333504459083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333504459083776[0;39m ==> Parameters: 
2022-04-29 12:52:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333504459083776[0;39m <==    Updates: 0
2022-04-29 12:52:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333504459083776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:52:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333525426409472[0;39m 生成今日电子书快照开始
2022-04-29 12:52:50.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333525426409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:50.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333525426409472[0;39m ==> Parameters: 
2022-04-29 12:52:50.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333525426409472[0;39m <==    Updates: 0
2022-04-29 12:52:50.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333525426409472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:52:50.744 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：h7OAOeaOgR，session id：1，当前连接数：1
2022-04-29 12:52:50.813 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175333528832184320[0;39m ------------- 开始 -------------
2022-04-29 12:52:50.837 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175333528832184320[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 12:52:50.837 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175333528832184320[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 12:52:50.839 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175333528832184320[0;39m 远程地址: 127.0.0.1
2022-04-29 12:52:50.842 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175333528832184320[0;39m 请求参数: []
2022-04-29 12:52:50.865 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175333528832184320[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 12:52:50.869 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175333528832184320[0;39m ==> Parameters: 
2022-04-29 12:52:50.894 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==    Columns: id, parent, name, sort
2022-04-29 12:52:50.897 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 12:52:50.904 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 12:52:50.907 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 12:52:50.907 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 12:52:50.908 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 12:52:50.908 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 12:52:50.909 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 12:52:50.909 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 12:52:50.910 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 12:52:50.910 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 12:52:50.911 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 12:52:50.911 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 12:52:50.912 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 12:52:50.913 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 12:52:50.914 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 12:52:50.917 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 12:52:50.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 12:52:50.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175333528832184320[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 12:52:50.921 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175333528832184320[0;39m <==      Total: 18
2022-04-29 12:52:50.934 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175333528832184320[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 12:52:50.935 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175333528832184320[0;39m ------------- 结束 耗时：122 ms -------------
2022-04-29 12:52:50.989 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175333529570381824[0;39m ------------- 开始 -------------
2022-04-29 12:52:50.990 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175333529570381824[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 12:52:50.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175333529570381824[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 12:52:50.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175333529570381824[0;39m 远程地址: 127.0.0.1
2022-04-29 12:52:50.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175333529570381824[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 12:52:51.017 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175333529570381824[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 12:52:51.018 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175333529570381824[0;39m ==> Parameters: 
2022-04-29 12:52:51.034 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175333529570381824[0;39m <==    Columns: count(0)
2022-04-29 12:52:51.034 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175333529570381824[0;39m <==        Row: 5
2022-04-29 12:52:51.034 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175333529570381824[0;39m <==      Total: 1
2022-04-29 12:52:51.035 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175333529570381824[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 12:52:51.036 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175333529570381824[0;39m ==> Parameters: 10(Integer)
2022-04-29 12:52:51.053 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 12:52:51.054 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 12:52:51.054 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 12:52:51.055 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 12:52:51.055 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 12:52:51.056 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175333529570381824[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 12:52:51.059 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175333529570381824[0;39m <==      Total: 5
2022-04-29 12:52:51.062 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175333529570381824[0;39m total rows：5
2022-04-29 12:52:51.063 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175333529570381824[0;39m total pages：1
2022-04-29 12:52:51.064 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175333529570381824[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 12:52:51.065 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175333529570381824[0;39m ------------- 结束 耗时：76 ms -------------
2022-04-29 12:52:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333546406318080[0;39m 生成今日电子书快照开始
2022-04-29 12:52:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333546406318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:52:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333546406318080[0;39m ==> Parameters: 
2022-04-29 12:52:55.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333546406318080[0;39m <==    Updates: 0
2022-04-29 12:52:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333546406318080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:53:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333567369449472[0;39m 生成今日电子书快照开始
2022-04-29 12:53:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333567369449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333567369449472[0;39m ==> Parameters: 
2022-04-29 12:53:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333567369449472[0;39m <==    Updates: 0
2022-04-29 12:53:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333567369449472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:53:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333588357746688[0;39m 生成今日电子书快照开始
2022-04-29 12:53:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333588357746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333588357746688[0;39m ==> Parameters: 
2022-04-29 12:53:05.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333588357746688[0;39m <==    Updates: 0
2022-04-29 12:53:05.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333588357746688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:53:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333588605210624[0;39m start updating Ebook doc
2022-04-29 12:53:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333588605210624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:53:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333588605210624[0;39m ==> Parameters: 
2022-04-29 12:53:05.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333588605210624[0;39m <==    Updates: 1
2022-04-29 12:53:05.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333588605210624[0;39m update ends, take 35 millisecs
2022-04-29 12:53:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333609325072384[0;39m 生成今日电子书快照开始
2022-04-29 12:53:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333609325072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333609325072384[0;39m ==> Parameters: 
2022-04-29 12:53:10.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333609325072384[0;39m <==    Updates: 0
2022-04-29 12:53:10.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333609325072384[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 12:53:13.169 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175332617971961857[0;39m ------------- LoginInterceptor start -------------
2022-04-29 12:53:13.170 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175332617971961857[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 12:53:13.170 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175332617971961857[0;39m 登录校验开始，token：175330320638414848
2022-04-29 12:53:13.354 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175332617971961857[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175330320638414848"}
2022-04-29 12:53:13.358 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175333623392768000[0;39m ------------- 开始 -------------
2022-04-29 12:53:13.358 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175333623392768000[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 12:53:13.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175333623392768000[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 12:53:13.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175333623392768000[0;39m 远程地址: 127.0.0.1
2022-04-29 12:53:13.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175333623392768000[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"Spring"}]
2022-04-29 12:53:13.379 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175333623392768000[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 12:53:13.381 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175333623392768000[0;39m ==> Parameters: 175333623401156608(Long), Spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 12:53:13.427 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175333623392768000[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy150.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 12:53:13.431 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175333623392768000[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 12:53:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333630288203776[0;39m 生成今日电子书快照开始
2022-04-29 12:53:15.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333630288203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:15.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333630288203776[0;39m ==> Parameters: 
2022-04-29 12:53:15.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333630288203776[0;39m <==    Updates: 0
2022-04-29 12:53:15.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333630288203776[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 12:53:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333651251335168[0;39m 生成今日电子书快照开始
2022-04-29 12:53:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333651251335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333651251335168[0;39m ==> Parameters: 
2022-04-29 12:53:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333651251335168[0;39m <==    Updates: 0
2022-04-29 12:53:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333651251335168[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:53:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333672222855168[0;39m 生成今日电子书快照开始
2022-04-29 12:53:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333672222855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333672222855168[0;39m ==> Parameters: 
2022-04-29 12:53:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333672222855168[0;39m <==    Updates: 0
2022-04-29 12:53:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333672222855168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:53:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333693211152384[0;39m 生成今日电子书快照开始
2022-04-29 12:53:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333693211152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333693211152384[0;39m ==> Parameters: 
2022-04-29 12:53:30.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333693211152384[0;39m <==    Updates: 0
2022-04-29 12:53:30.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333693211152384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 12:53:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333714170089472[0;39m 生成今日电子书快照开始
2022-04-29 12:53:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333714170089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333714170089472[0;39m ==> Parameters: 
2022-04-29 12:53:35.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333714170089472[0;39m <==    Updates: 0
2022-04-29 12:53:35.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333714170089472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:53:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333714421747712[0;39m start updating Ebook doc
2022-04-29 12:53:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333714421747712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:53:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333714421747712[0;39m ==> Parameters: 
2022-04-29 12:53:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333714421747712[0;39m <==    Updates: 1
2022-04-29 12:53:35.101 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333714421747712[0;39m update ends, take 40 millisecs
2022-04-29 12:53:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333735149998080[0;39m 生成今日电子书快照开始
2022-04-29 12:53:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333735149998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333735149998080[0;39m ==> Parameters: 
2022-04-29 12:53:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333735149998080[0;39m <==    Updates: 0
2022-04-29 12:53:40.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333735149998080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:53:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333756125712384[0;39m 生成今日电子书快照开始
2022-04-29 12:53:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333756125712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333756125712384[0;39m ==> Parameters: 
2022-04-29 12:53:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333756125712384[0;39m <==    Updates: 0
2022-04-29 12:53:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333756125712384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:53:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333777093038080[0;39m 生成今日电子书快照开始
2022-04-29 12:53:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333777093038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333777093038080[0;39m ==> Parameters: 
2022-04-29 12:53:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333777093038080[0;39m <==    Updates: 0
2022-04-29 12:53:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333777093038080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:53:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333798056169472[0;39m 生成今日电子书快照开始
2022-04-29 12:53:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333798056169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:53:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333798056169472[0;39m ==> Parameters: 
2022-04-29 12:53:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333798056169472[0;39m <==    Updates: 0
2022-04-29 12:53:55.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333798056169472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:54:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333819027689472[0;39m 生成今日电子书快照开始
2022-04-29 12:54:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333819027689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333819027689472[0;39m ==> Parameters: 
2022-04-29 12:54:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333819027689472[0;39m <==    Updates: 0
2022-04-29 12:54:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333819027689472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:54:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333840015986688[0;39m 生成今日电子书快照开始
2022-04-29 12:54:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333840015986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333840015986688[0;39m ==> Parameters: 
2022-04-29 12:54:05.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333840015986688[0;39m <==    Updates: 0
2022-04-29 12:54:05.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333840015986688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 12:54:05.057 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333840234090496[0;39m start updating Ebook doc
2022-04-29 12:54:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333840234090496[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:54:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333840234090496[0;39m ==> Parameters: 
2022-04-29 12:54:05.093 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333840234090496[0;39m <==    Updates: 1
2022-04-29 12:54:05.093 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333840234090496[0;39m update ends, take 35 millisecs
2022-04-29 12:54:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333860987506688[0;39m 生成今日电子书快照开始
2022-04-29 12:54:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333860987506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333860987506688[0;39m ==> Parameters: 
2022-04-29 12:54:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333860987506688[0;39m <==    Updates: 0
2022-04-29 12:54:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333860987506688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:54:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333881946443776[0;39m 生成今日电子书快照开始
2022-04-29 12:54:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333881946443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333881946443776[0;39m ==> Parameters: 
2022-04-29 12:54:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333881946443776[0;39m <==    Updates: 0
2022-04-29 12:54:15.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333881946443776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:54:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333902926352384[0;39m 生成今日电子书快照开始
2022-04-29 12:54:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333902926352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333902926352384[0;39m ==> Parameters: 
2022-04-29 12:54:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333902926352384[0;39m <==    Updates: 0
2022-04-29 12:54:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333902926352384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:54:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333923881095168[0;39m 生成今日电子书快照开始
2022-04-29 12:54:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333923881095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333923881095168[0;39m ==> Parameters: 
2022-04-29 12:54:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333923881095168[0;39m <==    Updates: 0
2022-04-29 12:54:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333923881095168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:54:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333944869392384[0;39m 生成今日电子书快照开始
2022-04-29 12:54:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333944869392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333944869392384[0;39m ==> Parameters: 
2022-04-29 12:54:30.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333944869392384[0;39m <==    Updates: 0
2022-04-29 12:54:30.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333944869392384[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-29 12:54:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333965824135168[0;39m 生成今日电子书快照开始
2022-04-29 12:54:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333965824135168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333965824135168[0;39m ==> Parameters: 
2022-04-29 12:54:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333965824135168[0;39m <==    Updates: 0
2022-04-29 12:54:35.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333965824135168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:54:35.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175333966071599104[0;39m start updating Ebook doc
2022-04-29 12:54:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333966071599104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:54:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333966071599104[0;39m ==> Parameters: 
2022-04-29 12:54:35.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175333966071599104[0;39m <==    Updates: 1
2022-04-29 12:54:35.098 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175333966071599104[0;39m update ends, take 39 millisecs
2022-04-29 12:54:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175333986816626688[0;39m 生成今日电子书快照开始
2022-04-29 12:54:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333986816626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:40.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333986816626688[0;39m ==> Parameters: 
2022-04-29 12:54:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175333986816626688[0;39m <==    Updates: 0
2022-04-29 12:54:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175333986816626688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:54:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334007783952384[0;39m 生成今日电子书快照开始
2022-04-29 12:54:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334007783952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334007783952384[0;39m ==> Parameters: 
2022-04-29 12:54:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334007783952384[0;39m <==    Updates: 0
2022-04-29 12:54:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334007783952384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:54:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334028747083776[0;39m 生成今日电子书快照开始
2022-04-29 12:54:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334028747083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334028747083776[0;39m ==> Parameters: 
2022-04-29 12:54:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334028747083776[0;39m <==    Updates: 0
2022-04-29 12:54:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334028747083776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:54:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334049710215168[0;39m 生成今日电子书快照开始
2022-04-29 12:54:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334049710215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:54:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334049710215168[0;39m ==> Parameters: 
2022-04-29 12:54:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334049710215168[0;39m <==    Updates: 0
2022-04-29 12:54:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334049710215168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:55:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334070685929472[0;39m 生成今日电子书快照开始
2022-04-29 12:55:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334070685929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334070685929472[0;39m ==> Parameters: 
2022-04-29 12:55:00.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334070685929472[0;39m <==    Updates: 0
2022-04-29 12:55:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334070685929472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:55:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334091674226688[0;39m 生成今日电子书快照开始
2022-04-29 12:55:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334091674226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334091674226688[0;39m ==> Parameters: 
2022-04-29 12:55:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334091674226688[0;39m <==    Updates: 0
2022-04-29 12:55:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334091674226688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:05.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334091913302016[0;39m start updating Ebook doc
2022-04-29 12:55:05.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334091913302016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:55:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334091913302016[0;39m ==> Parameters: 
2022-04-29 12:55:05.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334091913302016[0;39m <==    Updates: 1
2022-04-29 12:55:05.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334091913302016[0;39m update ends, take 36 millisecs
2022-04-29 12:55:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334112637358080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334112637358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334112637358080[0;39m ==> Parameters: 
2022-04-29 12:55:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334112637358080[0;39m <==    Updates: 0
2022-04-29 12:55:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334112637358080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:55:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334133600489472[0;39m 生成今日电子书快照开始
2022-04-29 12:55:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334133600489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334133600489472[0;39m ==> Parameters: 
2022-04-29 12:55:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334133600489472[0;39m <==    Updates: 0
2022-04-29 12:55:15.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334133600489472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:55:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334154580398080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334154580398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334154580398080[0;39m ==> Parameters: 
2022-04-29 12:55:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334154580398080[0;39m <==    Updates: 0
2022-04-29 12:55:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334154580398080[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:55:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334175551918080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334175551918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334175551918080[0;39m ==> Parameters: 
2022-04-29 12:55:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334175551918080[0;39m <==    Updates: 0
2022-04-29 12:55:25.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334175551918080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334196519243776[0;39m 生成今日电子书快照开始
2022-04-29 12:55:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334196519243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334196519243776[0;39m ==> Parameters: 
2022-04-29 12:55:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334196519243776[0;39m <==    Updates: 0
2022-04-29 12:55:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334196519243776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:55:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334217494958080[0;39m 生成今日电子书快照开始
2022-04-29 12:55:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334217494958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334217494958080[0;39m ==> Parameters: 
2022-04-29 12:55:35.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334217494958080[0;39m <==    Updates: 0
2022-04-29 12:55:35.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334217494958080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334217738227712[0;39m start updating Ebook doc
2022-04-29 12:55:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334217738227712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:55:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334217738227712[0;39m ==> Parameters: 
2022-04-29 12:55:35.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334217738227712[0;39m <==    Updates: 1
2022-04-29 12:55:35.098 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334217738227712[0;39m update ends, take 37 millisecs
2022-04-29 12:55:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334238462283776[0;39m 生成今日电子书快照开始
2022-04-29 12:55:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334238462283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334238462283776[0;39m ==> Parameters: 
2022-04-29 12:55:40.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334238462283776[0;39m <==    Updates: 0
2022-04-29 12:55:40.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334238462283776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:55:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334259446386688[0;39m 生成今日电子书快照开始
2022-04-29 12:55:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334259446386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334259446386688[0;39m ==> Parameters: 
2022-04-29 12:55:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334259446386688[0;39m <==    Updates: 0
2022-04-29 12:55:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334259446386688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:55:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334280413712384[0;39m 生成今日电子书快照开始
2022-04-29 12:55:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334280413712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334280413712384[0;39m ==> Parameters: 
2022-04-29 12:55:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334280413712384[0;39m <==    Updates: 0
2022-04-29 12:55:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334280413712384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:55:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334301376843776[0;39m 生成今日电子书快照开始
2022-04-29 12:55:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334301376843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:55:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334301376843776[0;39m ==> Parameters: 
2022-04-29 12:55:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334301376843776[0;39m <==    Updates: 0
2022-04-29 12:55:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334301376843776[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:56:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334322348363776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334322348363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334322348363776[0;39m ==> Parameters: 
2022-04-29 12:56:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334322348363776[0;39m <==    Updates: 0
2022-04-29 12:56:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334322348363776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:56:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334343332466688[0;39m start updating Ebook doc
2022-04-29 12:56:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334343332466688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:56:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334343332466688[0;39m ==> Parameters: 
2022-04-29 12:56:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334343332466688[0;39m <==    Updates: 1
2022-04-29 12:56:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334343332466688[0;39m update ends, take 59 millisecs
2022-04-29 12:56:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334343588319232[0;39m 生成今日电子书快照开始
2022-04-29 12:56:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334343588319232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334343588319232[0;39m ==> Parameters: 
2022-04-29 12:56:05.105 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334343588319232[0;39m <==    Updates: 0
2022-04-29 12:56:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334343588319232[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 12:56:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334364303986688[0;39m 生成今日电子书快照开始
2022-04-29 12:56:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334364303986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334364303986688[0;39m ==> Parameters: 
2022-04-29 12:56:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334364303986688[0;39m <==    Updates: 0
2022-04-29 12:56:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334364303986688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:56:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334385258729472[0;39m 生成今日电子书快照开始
2022-04-29 12:56:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334385258729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334385258729472[0;39m ==> Parameters: 
2022-04-29 12:56:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334385258729472[0;39m <==    Updates: 0
2022-04-29 12:56:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334385258729472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 12:56:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334406234443776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334406234443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334406234443776[0;39m ==> Parameters: 
2022-04-29 12:56:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334406234443776[0;39m <==    Updates: 0
2022-04-29 12:56:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334406234443776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:56:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334427218546688[0;39m 生成今日电子书快照开始
2022-04-29 12:56:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334427218546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334427218546688[0;39m ==> Parameters: 
2022-04-29 12:56:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334427218546688[0;39m <==    Updates: 0
2022-04-29 12:56:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334427218546688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:56:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334448169095168[0;39m 生成今日电子书快照开始
2022-04-29 12:56:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334448169095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334448169095168[0;39m ==> Parameters: 
2022-04-29 12:56:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334448169095168[0;39m <==    Updates: 0
2022-04-29 12:56:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334448169095168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:56:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334469149003776[0;39m start updating Ebook doc
2022-04-29 12:56:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334469149003776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:56:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334469149003776[0;39m ==> Parameters: 
2022-04-29 12:56:35.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334469149003776[0;39m <==    Updates: 1
2022-04-29 12:56:35.056 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334469149003776[0;39m update ends, take 54 millisecs
2022-04-29 12:56:35.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334469375496192[0;39m 生成今日电子书快照开始
2022-04-29 12:56:35.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334469375496192[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:35.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334469375496192[0;39m ==> Parameters: 
2022-04-29 12:56:35.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334469375496192[0;39m <==    Updates: 0
2022-04-29 12:56:35.091 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334469375496192[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-29 12:56:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334490120523776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334490120523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334490120523776[0;39m ==> Parameters: 
2022-04-29 12:56:40.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334490120523776[0;39m <==    Updates: 0
2022-04-29 12:56:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334490120523776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:56:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334511092043776[0;39m 生成今日电子书快照开始
2022-04-29 12:56:45.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334511092043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:45.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334511092043776[0;39m ==> Parameters: 
2022-04-29 12:56:45.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334511092043776[0;39m <==    Updates: 0
2022-04-29 12:56:45.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334511092043776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:56:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334532055175168[0;39m 生成今日电子书快照开始
2022-04-29 12:56:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334532055175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334532055175168[0;39m ==> Parameters: 
2022-04-29 12:56:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334532055175168[0;39m <==    Updates: 0
2022-04-29 12:56:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334532055175168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:56:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334553030889472[0;39m 生成今日电子书快照开始
2022-04-29 12:56:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334553030889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:56:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334553030889472[0;39m ==> Parameters: 
2022-04-29 12:56:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334553030889472[0;39m <==    Updates: 0
2022-04-29 12:56:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334553030889472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:57:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334574019186688[0;39m 生成今日电子书快照开始
2022-04-29 12:57:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334574019186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334574019186688[0;39m ==> Parameters: 
2022-04-29 12:57:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334574019186688[0;39m <==    Updates: 0
2022-04-29 12:57:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334574019186688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:57:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334594982318080[0;39m 生成今日电子书快照开始
2022-04-29 12:57:05.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334594982318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334594982318080[0;39m ==> Parameters: 
2022-04-29 12:57:05.114 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334594982318080[0;39m <==    Updates: 0
2022-04-29 12:57:05.115 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334594982318080[0;39m 生成今日电子书快照结束，耗时：111毫秒
2022-04-29 12:57:05.120 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334595473051648[0;39m start updating Ebook doc
2022-04-29 12:57:05.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334595473051648[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:57:05.121 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334595473051648[0;39m ==> Parameters: 
2022-04-29 12:57:05.162 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334595473051648[0;39m <==    Updates: 1
2022-04-29 12:57:05.162 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334595473051648[0;39m update ends, take 42 millisecs
2022-04-29 12:57:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334615958032384[0;39m 生成今日电子书快照开始
2022-04-29 12:57:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334615958032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334615958032384[0;39m ==> Parameters: 
2022-04-29 12:57:10.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334615958032384[0;39m <==    Updates: 0
2022-04-29 12:57:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334615958032384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 12:57:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334636912775168[0;39m 生成今日电子书快照开始
2022-04-29 12:57:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334636912775168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334636912775168[0;39m ==> Parameters: 
2022-04-29 12:57:15.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334636912775168[0;39m <==    Updates: 0
2022-04-29 12:57:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334636912775168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:57:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334657888489472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334657888489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334657888489472[0;39m ==> Parameters: 
2022-04-29 12:57:20.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334657888489472[0;39m <==    Updates: 0
2022-04-29 12:57:20.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334657888489472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:57:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334678860009472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334678860009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334678860009472[0;39m ==> Parameters: 
2022-04-29 12:57:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334678860009472[0;39m <==    Updates: 0
2022-04-29 12:57:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334678860009472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:57:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334699831529472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334699831529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334699831529472[0;39m ==> Parameters: 
2022-04-29 12:57:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334699831529472[0;39m <==    Updates: 0
2022-04-29 12:57:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334699831529472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:57:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334720819826688[0;39m start updating Ebook doc
2022-04-29 12:57:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334720819826688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:57:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334720819826688[0;39m ==> Parameters: 
2022-04-29 12:57:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334720819826688[0;39m <==    Updates: 1
2022-04-29 12:57:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334720819826688[0;39m update ends, take 60 millisecs
2022-04-29 12:57:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334721075679232[0;39m 生成今日电子书快照开始
2022-04-29 12:57:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334721075679232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:35.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334721075679232[0;39m ==> Parameters: 
2022-04-29 12:57:35.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334721075679232[0;39m <==    Updates: 0
2022-04-29 12:57:35.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334721075679232[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-29 12:57:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334741774569472[0;39m 生成今日电子书快照开始
2022-04-29 12:57:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334741774569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334741774569472[0;39m ==> Parameters: 
2022-04-29 12:57:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334741774569472[0;39m <==    Updates: 0
2022-04-29 12:57:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334741774569472[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 12:57:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334762758672384[0;39m 生成今日电子书快照开始
2022-04-29 12:57:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334762758672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334762758672384[0;39m ==> Parameters: 
2022-04-29 12:57:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334762758672384[0;39m <==    Updates: 0
2022-04-29 12:57:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334762758672384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:57:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334783734386688[0;39m 生成今日电子书快照开始
2022-04-29 12:57:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334783734386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334783734386688[0;39m ==> Parameters: 
2022-04-29 12:57:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334783734386688[0;39m <==    Updates: 0
2022-04-29 12:57:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334783734386688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:57:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334804705906688[0;39m 生成今日电子书快照开始
2022-04-29 12:57:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334804705906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:57:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334804705906688[0;39m ==> Parameters: 
2022-04-29 12:57:55.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334804705906688[0;39m <==    Updates: 0
2022-04-29 12:57:55.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334804705906688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 12:58:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334825673232384[0;39m 生成今日电子书快照开始
2022-04-29 12:58:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334825673232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334825673232384[0;39m ==> Parameters: 
2022-04-29 12:58:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334825673232384[0;39m <==    Updates: 0
2022-04-29 12:58:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334825673232384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:58:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334846648946688[0;39m 生成今日电子书快照开始
2022-04-29 12:58:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334846648946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:05.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334846648946688[0;39m ==> Parameters: 
2022-04-29 12:58:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334846648946688[0;39m <==    Updates: 0
2022-04-29 12:58:05.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334846648946688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 12:58:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334846900604928[0;39m start updating Ebook doc
2022-04-29 12:58:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334846900604928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:58:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334846900604928[0;39m ==> Parameters: 
2022-04-29 12:58:05.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334846900604928[0;39m <==    Updates: 1
2022-04-29 12:58:05.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334846900604928[0;39m update ends, take 37 millisecs
2022-04-29 12:58:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334867599495168[0;39m 生成今日电子书快照开始
2022-04-29 12:58:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334867599495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334867599495168[0;39m ==> Parameters: 
2022-04-29 12:58:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334867599495168[0;39m <==    Updates: 0
2022-04-29 12:58:10.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334867599495168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:58:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334888587792384[0;39m 生成今日电子书快照开始
2022-04-29 12:58:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334888587792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334888587792384[0;39m ==> Parameters: 
2022-04-29 12:58:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334888587792384[0;39m <==    Updates: 0
2022-04-29 12:58:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334888587792384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:58:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334909555118080[0;39m 生成今日电子书快照开始
2022-04-29 12:58:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334909555118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334909555118080[0;39m ==> Parameters: 
2022-04-29 12:58:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334909555118080[0;39m <==    Updates: 0
2022-04-29 12:58:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334909555118080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:58:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334930526638080[0;39m 生成今日电子书快照开始
2022-04-29 12:58:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334930526638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334930526638080[0;39m ==> Parameters: 
2022-04-29 12:58:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334930526638080[0;39m <==    Updates: 0
2022-04-29 12:58:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334930526638080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 12:58:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334951506546688[0;39m 生成今日电子书快照开始
2022-04-29 12:58:30.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334951506546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334951506546688[0;39m ==> Parameters: 
2022-04-29 12:58:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334951506546688[0;39m <==    Updates: 0
2022-04-29 12:58:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334951506546688[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:58:35.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175334972473872384[0;39m start updating Ebook doc
2022-04-29 12:58:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334972473872384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:58:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334972473872384[0;39m ==> Parameters: 
2022-04-29 12:58:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175334972473872384[0;39m <==    Updates: 1
2022-04-29 12:58:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175334972473872384[0;39m update ends, take 59 millisecs
2022-04-29 12:58:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334972725530624[0;39m 生成今日电子书快照开始
2022-04-29 12:58:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334972725530624[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334972725530624[0;39m ==> Parameters: 
2022-04-29 12:58:35.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334972725530624[0;39m <==    Updates: 0
2022-04-29 12:58:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334972725530624[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-29 12:58:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175334993428615168[0;39m 生成今日电子书快照开始
2022-04-29 12:58:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334993428615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334993428615168[0;39m ==> Parameters: 
2022-04-29 12:58:40.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175334993428615168[0;39m <==    Updates: 0
2022-04-29 12:58:40.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175334993428615168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:58:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335014412718080[0;39m 生成今日电子书快照开始
2022-04-29 12:58:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335014412718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335014412718080[0;39m ==> Parameters: 
2022-04-29 12:58:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335014412718080[0;39m <==    Updates: 0
2022-04-29 12:58:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335014412718080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 12:58:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335035380043776[0;39m 生成今日电子书快照开始
2022-04-29 12:58:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335035380043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335035380043776[0;39m ==> Parameters: 
2022-04-29 12:58:50.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335035380043776[0;39m <==    Updates: 0
2022-04-29 12:58:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335035380043776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:58:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335056347369472[0;39m 生成今日电子书快照开始
2022-04-29 12:58:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335056347369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:58:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335056347369472[0;39m ==> Parameters: 
2022-04-29 12:58:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335056347369472[0;39m <==    Updates: 0
2022-04-29 12:58:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335056347369472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 12:59:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335077314695168[0;39m 生成今日电子书快照开始
2022-04-29 12:59:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335077314695168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335077314695168[0;39m ==> Parameters: 
2022-04-29 12:59:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335077314695168[0;39m <==    Updates: 0
2022-04-29 12:59:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335077314695168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:59:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335098302992384[0;39m 生成今日电子书快照开始
2022-04-29 12:59:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335098302992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335098302992384[0;39m ==> Parameters: 
2022-04-29 12:59:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335098302992384[0;39m <==    Updates: 0
2022-04-29 12:59:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335098302992384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 12:59:05.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335098542067712[0;39m start updating Ebook doc
2022-04-29 12:59:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335098542067712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:59:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335098542067712[0;39m ==> Parameters: 
2022-04-29 12:59:05.096 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335098542067712[0;39m <==    Updates: 1
2022-04-29 12:59:05.096 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335098542067712[0;39m update ends, take 35 millisecs
2022-04-29 12:59:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335119261929472[0;39m 生成今日电子书快照开始
2022-04-29 12:59:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335119261929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335119261929472[0;39m ==> Parameters: 
2022-04-29 12:59:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335119261929472[0;39m <==    Updates: 0
2022-04-29 12:59:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335119261929472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:59:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335140237643776[0;39m 生成今日电子书快照开始
2022-04-29 12:59:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335140237643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335140237643776[0;39m ==> Parameters: 
2022-04-29 12:59:15.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335140237643776[0;39m <==    Updates: 0
2022-04-29 12:59:15.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335140237643776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 12:59:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335161213358080[0;39m 生成今日电子书快照开始
2022-04-29 12:59:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335161213358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335161213358080[0;39m ==> Parameters: 
2022-04-29 12:59:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335161213358080[0;39m <==    Updates: 0
2022-04-29 12:59:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335161213358080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:59:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335182184878080[0;39m 生成今日电子书快照开始
2022-04-29 12:59:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335182184878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335182184878080[0;39m ==> Parameters: 
2022-04-29 12:59:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335182184878080[0;39m <==    Updates: 0
2022-04-29 12:59:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335182184878080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 12:59:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335203156398080[0;39m 生成今日电子书快照开始
2022-04-29 12:59:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335203156398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335203156398080[0;39m ==> Parameters: 
2022-04-29 12:59:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335203156398080[0;39m <==    Updates: 0
2022-04-29 12:59:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335203156398080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 12:59:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335224115335168[0;39m 生成今日电子书快照开始
2022-04-29 12:59:35.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335224115335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:35.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335224115335168[0;39m ==> Parameters: 
2022-04-29 12:59:35.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335224115335168[0;39m <==    Updates: 0
2022-04-29 12:59:35.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335224115335168[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 12:59:35.054 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335224341827584[0;39m start updating Ebook doc
2022-04-29 12:59:35.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335224341827584[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 12:59:35.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335224341827584[0;39m ==> Parameters: 
2022-04-29 12:59:35.089 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335224341827584[0;39m <==    Updates: 1
2022-04-29 12:59:35.090 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335224341827584[0;39m update ends, take 36 millisecs
2022-04-29 12:59:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335245103632384[0;39m 生成今日电子书快照开始
2022-04-29 12:59:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335245103632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335245103632384[0;39m ==> Parameters: 
2022-04-29 12:59:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335245103632384[0;39m <==    Updates: 0
2022-04-29 12:59:40.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335245103632384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 12:59:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335266075152384[0;39m 生成今日电子书快照开始
2022-04-29 12:59:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335266075152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335266075152384[0;39m ==> Parameters: 
2022-04-29 12:59:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335266075152384[0;39m <==    Updates: 0
2022-04-29 12:59:45.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335266075152384[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 12:59:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335287050866688[0;39m 生成今日电子书快照开始
2022-04-29 12:59:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335287050866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335287050866688[0;39m ==> Parameters: 
2022-04-29 12:59:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335287050866688[0;39m <==    Updates: 0
2022-04-29 12:59:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335287050866688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 12:59:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335308005609472[0;39m 生成今日电子书快照开始
2022-04-29 12:59:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335308005609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 12:59:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335308005609472[0;39m ==> Parameters: 
2022-04-29 12:59:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335308005609472[0;39m <==    Updates: 0
2022-04-29 12:59:55.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335308005609472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:00:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335328977129472[0;39m 生成今日电子书快照开始
2022-04-29 13:00:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335328977129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335328977129472[0;39m ==> Parameters: 
2022-04-29 13:00:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335328977129472[0;39m <==    Updates: 0
2022-04-29 13:00:00.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335328977129472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 13:00:01.916 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：h7OAOeaOgR，session id：1！当前连接数：0
2022-04-29 13:00:01.963 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 13:00:01.964 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 13:00:01.968 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-2 - Shutdown initiated...
2022-04-29 13:00:01.975 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-2 - Shutdown completed.
2022-04-29 13:00:17.726 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5006 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 13:00:22.732 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 20538 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 13:00:22.732 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 13:00:23.082 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 13:00:23.083 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 13:00:23.084 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2022-04-29 13:00:23.239 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 13:00:23.240 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 13:00:23.240 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 13:00:23.240 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 13:00:23.250 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 13:00:23.251 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 509 ms
2022-04-29 13:00:23.628 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 13:00:23.836 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 13:00:23.863 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 13:00:23.872 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 13:00:23.874 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 13:00:23.878 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 21.236 seconds (JVM running for 1342.147)
2022-04-29 13:00:23.880 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-29 13:00:23.880 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 13:00:23.880 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 13:00:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335433851506688[0;39m 生成今日电子书快照开始
2022-04-29 13:00:25.008 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175335433851506688[0;39m HikariPool-3 - Starting...
2022-04-29 13:00:25.254 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175335433851506688[0;39m HikariPool-3 - Start completed.
2022-04-29 13:00:25.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335433851506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:25.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335433851506688[0;39m ==> Parameters: 
2022-04-29 13:00:25.294 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335433851506688[0;39m <==    Updates: 0
2022-04-29 13:00:25.295 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335433851506688[0;39m 生成今日电子书快照结束，耗时：288毫秒
2022-04-29 13:00:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335454818832384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:30.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335454818832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:30.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335454818832384[0;39m ==> Parameters: 
2022-04-29 13:00:30.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335454818832384[0;39m <==    Updates: 0
2022-04-29 13:00:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335454818832384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 13:00:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335475794546688[0;39m 生成今日电子书快照开始
2022-04-29 13:00:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335475794546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335475794546688[0;39m ==> Parameters: 
2022-04-29 13:00:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335475794546688[0;39m <==    Updates: 0
2022-04-29 13:00:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335475794546688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 13:00:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335476054593536[0;39m start updating Ebook doc
2022-04-29 13:00:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335476054593536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:00:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335476054593536[0;39m ==> Parameters: 
2022-04-29 13:00:35.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335476054593536[0;39m <==    Updates: 1
2022-04-29 13:00:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335476054593536[0;39m update ends, take 41 millisecs
2022-04-29 13:00:39.490 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 13:00:39.490 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 13:00:39.491 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-29 13:00:39.493 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：zdSkxDWUUv，session id：2，当前连接数：1
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335495021236225[0;39m ------------- 开始 -------------
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335495021236226[0;39m ------------- 开始 -------------
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335495021236224[0;39m ------------- 开始 -------------
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335495021236224[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335495021236225[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 13:00:39.589 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335495021236226[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335495021236224[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335495021236225[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335495021236226[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335495021236224[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335495021236226[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:39.590 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335495021236225[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:39.591 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335495021236226[0;39m 请求参数: []
2022-04-29 13:00:39.591 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335495021236225[0;39m 请求参数: []
2022-04-29 13:00:39.591 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335495021236224[0;39m 请求参数: []
2022-04-29 13:00:39.609 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175335495021236226[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 13:00:39.609 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175335495021236226[0;39m ==> Parameters: 
2022-04-29 13:00:39.615 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335495021236224[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 13:00:39.615 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175335495021236225[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 13:00:39.616 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335495021236224[0;39m ==> Parameters: 
2022-04-29 13:00:39.616 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175335495021236225[0;39m ==> Parameters: 
2022-04-29 13:00:39.631 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 13:00:39.631 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 13:00:39.632 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 13:00:39.633 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 13:00:39.634 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 13:00:39.634 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 13:00:39.635 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 13:00:39.636 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 13:00:39.636 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==    Columns: id, parent, name, sort
2022-04-29 13:00:39.637 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 13:00:39.637 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 13:00:39.637 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175335495021236225[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 13:00:39.637 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 13:00:39.637 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175335495021236225[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 13:00:39.637 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 13:00:39.638 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 13:00:39.638 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 13:00:39.638 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175335495021236225[0;39m <==        Row: 2022-04-29, 1763, 63, 28, 2
2022-04-29 13:00:39.638 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 13:00:39.638 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175335495021236225[0;39m <==      Total: 2
2022-04-29 13:00:39.639 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 13:00:39.638 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 13:00:39.639 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 13:00:39.639 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 13:00:39.640 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175335495021236226[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 13:00:39.639 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 13:00:39.640 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 13:00:39.640 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175335495021236226[0;39m <==      Total: 13
2022-04-29 13:00:39.640 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335495021236225[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1763,"viewIncrease":28,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 13:00:39.641 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335495021236225[0;39m ------------- 结束 耗时：52 ms -------------
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335495021236226[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 13:00:39.641 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 13:00:39.641 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335495021236226[0;39m ------------- 结束 耗时：52 ms -------------
2022-04-29 13:00:39.642 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 13:00:39.642 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 13:00:39.643 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 13:00:39.644 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 13:00:39.644 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 13:00:39.646 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 13:00:39.646 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335495021236224[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 13:00:39.647 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335495021236224[0;39m <==      Total: 18
2022-04-29 13:00:39.656 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335495021236224[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 13:00:39.656 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335495021236224[0;39m ------------- 结束 耗时：67 ms -------------
2022-04-29 13:00:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335496761872384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:40.004 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335496761872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:40.005 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335496761872384[0;39m ==> Parameters: 
2022-04-29 13:00:40.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335496761872384[0;39m <==    Updates: 0
2022-04-29 13:00:40.044 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335496761872384[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 13:00:44.128 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335514059182080[0;39m ------------- 开始 -------------
2022-04-29 13:00:44.128 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335514059182080[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-29 13:00:44.129 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335514059182080[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-29 13:00:44.129 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335514059182080[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:44.130 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335514059182080[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-29 13:00:44.162 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335514059182080[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-29 13:00:44.163 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335514059182080[0;39m ==> Parameters: test1(String)
2022-04-29 13:00:44.180 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335514059182080[0;39m <==    Columns: id, login_name, name, password
2022-04-29 13:00:44.181 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335514059182080[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 13:00:44.182 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335514059182080[0;39m <==      Total: 1
2022-04-29 13:00:44.189 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175335514059182080[0;39m generate single sign-on token：175335514315034624，and put it into redis
2022-04-29 13:00:44.959 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335514059182080[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175335514315034624"},"success":true}
2022-04-29 13:00:44.960 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335514059182080[0;39m ------------- 结束 耗时：832 ms -------------
2022-04-29 13:00:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335517733392384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:45.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335517733392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:45.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335517733392384[0;39m ==> Parameters: 
2022-04-29 13:00:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335517733392384[0;39m <==    Updates: 0
2022-04-29 13:00:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335517733392384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 13:00:47.109 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335526562402304[0;39m ------------- 开始 -------------
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335526562402304[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335526562402304[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335526562402304[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:47.110 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335526562402304[0;39m 请求参数: []
2022-04-29 13:00:47.142 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335526562402304[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 13:00:47.142 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335526562402304[0;39m ==> Parameters: 
2022-04-29 13:00:47.162 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==    Columns: id, parent, name, sort
2022-04-29 13:00:47.162 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 13:00:47.163 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 13:00:47.163 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 13:00:47.164 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 13:00:47.164 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 13:00:47.165 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 13:00:47.165 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 13:00:47.166 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 13:00:47.166 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 13:00:47.167 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 13:00:47.168 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 13:00:47.168 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 13:00:47.169 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 13:00:47.169 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 13:00:47.169 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 13:00:47.170 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 13:00:47.170 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 13:00:47.170 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175335526562402304[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 13:00:47.171 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175335526562402304[0;39m <==      Total: 18
2022-04-29 13:00:47.172 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335526562402304[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 13:00:47.173 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335526562402304[0;39m ------------- 结束 耗时：64 ms -------------
2022-04-29 13:00:47.196 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335526927306752[0;39m ------------- 开始 -------------
2022-04-29 13:00:47.197 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335526927306752[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 13:00:47.197 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335526927306752[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 13:00:47.197 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335526927306752[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:47.198 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335526927306752[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 13:00:47.203 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175335526927306752[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 13:00:47.203 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175335526927306752[0;39m ==> Parameters: 
2022-04-29 13:00:47.218 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175335526927306752[0;39m <==    Columns: count(0)
2022-04-29 13:00:47.219 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175335526927306752[0;39m <==        Row: 5
2022-04-29 13:00:47.219 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175335526927306752[0;39m <==      Total: 1
2022-04-29 13:00:47.220 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175335526927306752[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 13:00:47.220 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175335526927306752[0;39m ==> Parameters: 10(Integer)
2022-04-29 13:00:47.242 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 13:00:47.242 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 108, 10
2022-04-29 13:00:47.243 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 13:00:47.243 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 13:00:47.243 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 13:00:47.244 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175335526927306752[0;39m <==        Row: 5, Oracle Tutorial1111, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 13:00:47.244 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175335526927306752[0;39m <==      Total: 5
2022-04-29 13:00:47.245 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175335526927306752[0;39m total rows：5
2022-04-29 13:00:47.246 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175335526927306752[0;39m total pages：1
2022-04-29 13:00:47.250 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335526927306752[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":108,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial1111","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 13:00:47.251 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335526927306752[0;39m ------------- 结束 耗时：55 ms -------------
2022-04-29 13:00:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335538704912384[0;39m 生成今日电子书快照开始
2022-04-29 13:00:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335538704912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335538704912384[0;39m ==> Parameters: 
2022-04-29 13:00:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335538704912384[0;39m <==    Updates: 0
2022-04-29 13:00:50.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335538704912384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 13:00:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335559663849472[0;39m 生成今日电子书快照开始
2022-04-29 13:00:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335559663849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:00:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335559663849472[0;39m ==> Parameters: 
2022-04-29 13:00:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335559663849472[0;39m <==    Updates: 0
2022-04-29 13:00:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335559663849472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 13:00:59.161 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 13:00:59.162 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 13:00:59.162 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175335514315034624
2022-04-29 13:00:59.327 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175335514315034624"}
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335577829380096[0;39m ------------- 开始 -------------
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335577829380096[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335577829380096[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 13:00:59.332 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335577829380096[0;39m 远程地址: 127.0.0.1
2022-04-29 13:00:59.333 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335577829380096[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"name":"spring"}]
2022-04-29 13:00:59.362 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175335577829380096[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 13:00:59.363 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175335577829380096[0;39m ==> Parameters: 175335577841963008(Long), spring(String), 200(Long), 202(Long), null, null, null, null, null
2022-04-29 13:00:59.404 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175335577829380096[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy161.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$cb5ec2f7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 13:00:59.408 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175335577829380096[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 13:01:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335580652146688[0;39m 生成今日电子书快照开始
2022-04-29 13:01:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335580652146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335580652146688[0;39m ==> Parameters: 
2022-04-29 13:01:00.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335580652146688[0;39m <==    Updates: 0
2022-04-29 13:01:00.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335580652146688[0;39m 生成今日电子书快照结束，耗时：80毫秒
2022-04-29 13:01:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335601623666688[0;39m start updating Ebook doc
2022-04-29 13:01:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335601623666688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:01:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335601623666688[0;39m ==> Parameters: 
2022-04-29 13:01:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335601623666688[0;39m <==    Updates: 1
2022-04-29 13:01:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335601623666688[0;39m update ends, take 60 millisecs
2022-04-29 13:01:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335601879519232[0;39m 生成今日电子书快照开始
2022-04-29 13:01:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335601879519232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335601879519232[0;39m ==> Parameters: 
2022-04-29 13:01:05.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335601879519232[0;39m <==    Updates: 0
2022-04-29 13:01:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335601879519232[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 13:01:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335622595186688[0;39m 生成今日电子书快照开始
2022-04-29 13:01:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335622595186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335622595186688[0;39m ==> Parameters: 
2022-04-29 13:01:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335622595186688[0;39m <==    Updates: 0
2022-04-29 13:01:10.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335622595186688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:01:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335643562512384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335643562512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335643562512384[0;39m ==> Parameters: 
2022-04-29 13:01:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335643562512384[0;39m <==    Updates: 0
2022-04-29 13:01:15.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335643562512384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 13:01:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335664517255168[0;39m 生成今日电子书快照开始
2022-04-29 13:01:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335664517255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335664517255168[0;39m ==> Parameters: 
2022-04-29 13:01:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335664517255168[0;39m <==    Updates: 0
2022-04-29 13:01:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335664517255168[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 13:01:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335685501358080[0;39m 生成今日电子书快照开始
2022-04-29 13:01:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335685501358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335685501358080[0;39m ==> Parameters: 
2022-04-29 13:01:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335685501358080[0;39m <==    Updates: 0
2022-04-29 13:01:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335685501358080[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 13:01:25.491 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 13:01:25.492 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-29 13:01:25.494 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 13:01:25.494 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/user/list
2022-04-29 13:01:25.494 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175335514315034624
2022-04-29 13:01:25.660 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175335514315034624"}
2022-04-29 13:01:25.673 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175335688311541760[0;39m ------------- 开始 -------------
2022-04-29 13:01:25.673 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175335688311541760[0;39m 请求地址: http://127.0.0.1:8080/user/list GET
2022-04-29 13:01:25.674 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175335688311541760[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.list
2022-04-29 13:01:25.674 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175335688311541760[0;39m 远程地址: 127.0.0.1
2022-04-29 13:01:25.675 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175335688311541760[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 13:01:25.690 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175335688311541760[0;39m ==>  Preparing: SELECT count(0) FROM user
2022-04-29 13:01:25.691 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175335688311541760[0;39m ==> Parameters: 
2022-04-29 13:01:25.709 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175335688311541760[0;39m <==    Columns: count(0)
2022-04-29 13:01:25.709 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175335688311541760[0;39m <==        Row: 2
2022-04-29 13:01:25.710 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175335688311541760[0;39m <==      Total: 1
2022-04-29 13:01:25.712 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335688311541760[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2022-04-29 13:01:25.713 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335688311541760[0;39m ==> Parameters: 10(Integer)
2022-04-29 13:01:25.729 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335688311541760[0;39m <==    Columns: id, login_name, name, password
2022-04-29 13:01:25.730 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335688311541760[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 13:01:25.732 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175335688311541760[0;39m <==        Row: 175296442951405568, nongzexi, nongzexi, 4db71c791e6a5f87027698565abc76c8
2022-04-29 13:01:25.734 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175335688311541760[0;39m <==      Total: 2
2022-04-29 13:01:25.735 INFO  com.ameliawiki.wiki.service.UserService           :49   [32m175335688311541760[0;39m 总行数：2
2022-04-29 13:01:25.735 INFO  com.ameliawiki.wiki.service.UserService           :50   [32m175335688311541760[0;39m 总页数：1
2022-04-29 13:01:25.740 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175335688311541760[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test1","name":"test1"},{"id":175296442951405568,"loginName":"nongzexi","name":"nongzexi"}],"total":2},"success":true}
2022-04-29 13:01:25.741 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175335688311541760[0;39m ------------- 结束 耗时：68 ms -------------
2022-04-29 13:01:25.743 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175335688311541760[0;39m ------------- LoginInterceptor 结束 耗时：249 ms -------------
2022-04-29 13:01:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335706477072384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335706477072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335706477072384[0;39m ==> Parameters: 
2022-04-29 13:01:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335706477072384[0;39m <==    Updates: 0
2022-04-29 13:01:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335706477072384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 13:01:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335727431815168[0;39m 生成今日电子书快照开始
2022-04-29 13:01:35.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335727431815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:35.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335727431815168[0;39m ==> Parameters: 
2022-04-29 13:01:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335727431815168[0;39m <==    Updates: 0
2022-04-29 13:01:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335727431815168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 13:01:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335727700250624[0;39m start updating Ebook doc
2022-04-29 13:01:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335727700250624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:01:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335727700250624[0;39m ==> Parameters: 
2022-04-29 13:01:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335727700250624[0;39m <==    Updates: 1
2022-04-29 13:01:35.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335727700250624[0;39m update ends, take 38 millisecs
2022-04-29 13:01:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335748407529472[0;39m 生成今日电子书快照开始
2022-04-29 13:01:40.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335748407529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335748407529472[0;39m ==> Parameters: 
2022-04-29 13:01:40.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335748407529472[0;39m <==    Updates: 0
2022-04-29 13:01:40.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335748407529472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 13:01:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335769374855168[0;39m 生成今日电子书快照开始
2022-04-29 13:01:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335769374855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335769374855168[0;39m ==> Parameters: 
2022-04-29 13:01:45.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335769374855168[0;39m <==    Updates: 0
2022-04-29 13:01:45.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335769374855168[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 13:01:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335790363152384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335790363152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335790363152384[0;39m ==> Parameters: 
2022-04-29 13:01:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335790363152384[0;39m <==    Updates: 0
2022-04-29 13:01:50.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335790363152384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 13:01:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335811334672384[0;39m 生成今日电子书快照开始
2022-04-29 13:01:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335811334672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:01:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335811334672384[0;39m ==> Parameters: 
2022-04-29 13:01:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335811334672384[0;39m <==    Updates: 0
2022-04-29 13:01:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335811334672384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 13:02:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335832293609472[0;39m 生成今日电子书快照开始
2022-04-29 13:02:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335832293609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335832293609472[0;39m ==> Parameters: 
2022-04-29 13:02:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335832293609472[0;39m <==    Updates: 0
2022-04-29 13:02:00.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335832293609472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:02:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335853277712384[0;39m 生成今日电子书快照开始
2022-04-29 13:02:05.275 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335853277712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:05.276 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335853277712384[0;39m ==> Parameters: 
2022-04-29 13:02:05.312 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335853277712384[0;39m <==    Updates: 0
2022-04-29 13:02:05.312 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335853277712384[0;39m 生成今日电子书快照结束，耗时：308毫秒
2022-04-29 13:02:05.313 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335854573752320[0;39m start updating Ebook doc
2022-04-29 13:02:05.313 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335854573752320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:02:05.314 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335854573752320[0;39m ==> Parameters: 
2022-04-29 13:02:05.472 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335854573752320[0;39m <==    Updates: 1
2022-04-29 13:02:05.473 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335854573752320[0;39m update ends, take 160 millisecs
2022-04-29 13:02:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335874253426688[0;39m 生成今日电子书快照开始
2022-04-29 13:02:10.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335874253426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:10.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335874253426688[0;39m ==> Parameters: 
2022-04-29 13:02:10.147 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335874253426688[0;39m <==    Updates: 0
2022-04-29 13:02:10.147 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335874253426688[0;39m 生成今日电子书快照结束，耗时：142毫秒
2022-04-29 13:02:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335895220752384[0;39m 生成今日电子书快照开始
2022-04-29 13:02:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335895220752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335895220752384[0;39m ==> Parameters: 
2022-04-29 13:02:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335895220752384[0;39m <==    Updates: 0
2022-04-29 13:02:15.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335895220752384[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:02:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335916175495168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335916175495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335916175495168[0;39m ==> Parameters: 
2022-04-29 13:02:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335916175495168[0;39m <==    Updates: 0
2022-04-29 13:02:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335916175495168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:02:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335937151209472[0;39m 生成今日电子书快照开始
2022-04-29 13:02:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335937151209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335937151209472[0;39m ==> Parameters: 
2022-04-29 13:02:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335937151209472[0;39m <==    Updates: 0
2022-04-29 13:02:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335937151209472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 13:02:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335958131118080[0;39m 生成今日电子书快照开始
2022-04-29 13:02:30.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335958131118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:30.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335958131118080[0;39m ==> Parameters: 
2022-04-29 13:02:30.109 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335958131118080[0;39m <==    Updates: 0
2022-04-29 13:02:30.110 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335958131118080[0;39m 生成今日电子书快照结束，耗时：106毫秒
2022-04-29 13:02:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175335979111026688[0;39m 生成今日电子书快照开始
2022-04-29 13:02:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335979111026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335979111026688[0;39m ==> Parameters: 
2022-04-29 13:02:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175335979111026688[0;39m <==    Updates: 0
2022-04-29 13:02:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175335979111026688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:02:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175335979366879232[0;39m start updating Ebook doc
2022-04-29 13:02:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335979366879232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:02:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335979366879232[0;39m ==> Parameters: 
2022-04-29 13:02:35.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175335979366879232[0;39m <==    Updates: 1
2022-04-29 13:02:35.111 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175335979366879232[0;39m update ends, take 45 millisecs
2022-04-29 13:02:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336000065769472[0;39m 生成今日电子书快照开始
2022-04-29 13:02:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336000065769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336000065769472[0;39m ==> Parameters: 
2022-04-29 13:02:40.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336000065769472[0;39m <==    Updates: 0
2022-04-29 13:02:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336000065769472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 13:02:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336021033095168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336021033095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336021033095168[0;39m ==> Parameters: 
2022-04-29 13:02:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336021033095168[0;39m <==    Updates: 0
2022-04-29 13:02:45.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336021033095168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 13:02:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336042004615168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336042004615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336042004615168[0;39m ==> Parameters: 
2022-04-29 13:02:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336042004615168[0;39m <==    Updates: 0
2022-04-29 13:02:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336042004615168[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 13:02:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336062976135168[0;39m 生成今日电子书快照开始
2022-04-29 13:02:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336062976135168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:02:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336062976135168[0;39m ==> Parameters: 
2022-04-29 13:02:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336062976135168[0;39m <==    Updates: 0
2022-04-29 13:02:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336062976135168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 13:03:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336083964432384[0;39m 生成今日电子书快照开始
2022-04-29 13:03:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336083964432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336083964432384[0;39m ==> Parameters: 
2022-04-29 13:03:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336083964432384[0;39m <==    Updates: 0
2022-04-29 13:03:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336083964432384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:03:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175336104923369472[0;39m start updating Ebook doc
2022-04-29 13:03:05.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336104923369472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:03:05.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336104923369472[0;39m ==> Parameters: 
2022-04-29 13:03:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336104923369472[0;39m <==    Updates: 1
2022-04-29 13:03:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175336104923369472[0;39m update ends, take 63 millisecs
2022-04-29 13:03:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336105191804928[0;39m 生成今日电子书快照开始
2022-04-29 13:03:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336105191804928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336105191804928[0;39m ==> Parameters: 
2022-04-29 13:03:05.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336105191804928[0;39m <==    Updates: 0
2022-04-29 13:03:05.107 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336105191804928[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-29 13:03:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336125903278080[0;39m 生成今日电子书快照开始
2022-04-29 13:03:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336125903278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336125903278080[0;39m ==> Parameters: 
2022-04-29 13:03:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336125903278080[0;39m <==    Updates: 0
2022-04-29 13:03:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336125903278080[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 13:03:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336146870603776[0;39m 生成今日电子书快照开始
2022-04-29 13:03:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336146870603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336146870603776[0;39m ==> Parameters: 
2022-04-29 13:03:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336146870603776[0;39m <==    Updates: 0
2022-04-29 13:03:15.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336146870603776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 13:03:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336167842123776[0;39m 生成今日电子书快照开始
2022-04-29 13:03:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336167842123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336167842123776[0;39m ==> Parameters: 
2022-04-29 13:03:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336167842123776[0;39m <==    Updates: 0
2022-04-29 13:03:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336167842123776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 13:03:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336188805255168[0;39m 生成今日电子书快照开始
2022-04-29 13:03:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336188805255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336188805255168[0;39m ==> Parameters: 
2022-04-29 13:03:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336188805255168[0;39m <==    Updates: 0
2022-04-29 13:03:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336188805255168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 13:03:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336209789358080[0;39m 生成今日电子书快照开始
2022-04-29 13:03:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336209789358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336209789358080[0;39m ==> Parameters: 
2022-04-29 13:03:30.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336209789358080[0;39m <==    Updates: 0
2022-04-29 13:03:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336209789358080[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 13:03:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336230765072384[0;39m 生成今日电子书快照开始
2022-04-29 13:03:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336230765072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336230765072384[0;39m ==> Parameters: 
2022-04-29 13:03:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336230765072384[0;39m <==    Updates: 0
2022-04-29 13:03:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336230765072384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 13:03:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175336231029313536[0;39m start updating Ebook doc
2022-04-29 13:03:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336231029313536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:03:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336231029313536[0;39m ==> Parameters: 
2022-04-29 13:03:35.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336231029313536[0;39m <==    Updates: 1
2022-04-29 13:03:35.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175336231029313536[0;39m update ends, take 38 millisecs
2022-04-29 13:03:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336251724009472[0;39m 生成今日电子书快照开始
2022-04-29 13:03:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336251724009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336251724009472[0;39m ==> Parameters: 
2022-04-29 13:03:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336251724009472[0;39m <==    Updates: 0
2022-04-29 13:03:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336251724009472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 13:03:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336272703918080[0;39m 生成今日电子书快照开始
2022-04-29 13:03:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336272703918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336272703918080[0;39m ==> Parameters: 
2022-04-29 13:03:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336272703918080[0;39m <==    Updates: 0
2022-04-29 13:03:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336272703918080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 13:03:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336293671243776[0;39m 生成今日电子书快照开始
2022-04-29 13:03:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336293671243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336293671243776[0;39m ==> Parameters: 
2022-04-29 13:03:50.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336293671243776[0;39m <==    Updates: 0
2022-04-29 13:03:50.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336293671243776[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 13:03:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336314638569472[0;39m 生成今日电子书快照开始
2022-04-29 13:03:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336314638569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:03:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336314638569472[0;39m ==> Parameters: 
2022-04-29 13:03:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336314638569472[0;39m <==    Updates: 0
2022-04-29 13:03:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336314638569472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 13:04:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336335618478080[0;39m 生成今日电子书快照开始
2022-04-29 13:04:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336335618478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:04:00.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336335618478080[0;39m ==> Parameters: 
2022-04-29 13:04:00.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336335618478080[0;39m <==    Updates: 0
2022-04-29 13:04:00.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336335618478080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 13:04:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336356585803776[0;39m 生成今日电子书快照开始
2022-04-29 13:04:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336356585803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:04:05.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336356585803776[0;39m ==> Parameters: 
2022-04-29 13:04:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336356585803776[0;39m <==    Updates: 0
2022-04-29 13:04:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336356585803776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 13:04:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175336356829073408[0;39m start updating Ebook doc
2022-04-29 13:04:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336356829073408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 13:04:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336356829073408[0;39m ==> Parameters: 
2022-04-29 13:04:05.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175336356829073408[0;39m <==    Updates: 1
2022-04-29 13:04:05.098 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175336356829073408[0;39m update ends, take 38 millisecs
2022-04-29 13:04:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175336377569906688[0;39m 生成今日电子书快照开始
2022-04-29 13:04:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336377569906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 13:04:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336377569906688[0;39m ==> Parameters: 
2022-04-29 13:04:10.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175336377569906688[0;39m <==    Updates: 0
2022-04-29 13:04:10.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175336377569906688[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 13:04:11.408 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：zdSkxDWUUv，session id：2！当前连接数：0
2022-04-29 13:04:11.458 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 13:04:11.459 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 13:04:11.462 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-3 - Shutdown initiated...
2022-04-29 13:04:11.466 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-3 - Shutdown completed.
2022-04-29 18:33:57.627 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-29 18:34:02.638 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5004 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 18:34:07.647 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 27548 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 18:34:07.649 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 18:34:07.724 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-29 18:34:07.725 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-29 18:34:08.406 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 18:34:08.409 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 18:34:08.435 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2022-04-29 18:34:09.123 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 18:34:09.138 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 18:34:09.140 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 18:34:09.140 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 18:34:09.231 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 18:34:09.231 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1506 ms
2022-04-29 18:34:10.373 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 18:34:10.870 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 18:34:10.938 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 18:34:10.975 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 18:34:11.004 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 18:34:11.019 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 23.925 seconds (JVM running for 24.528)
2022-04-29 18:34:11.022 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 18:34:11.022 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 18:34:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419445760626688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:15.036 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175419445760626688[0;39m HikariPool-1 - Starting...
2022-04-29 18:34:15.565 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175419445760626688[0;39m HikariPool-1 - Start completed.
2022-04-29 18:34:15.577 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419445760626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:15.600 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419445760626688[0;39m ==> Parameters: 
2022-04-29 18:34:15.640 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419445760626688[0;39m <==    Updates: 0
2022-04-29 18:34:15.642 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419445760626688[0;39m 生成今日电子书快照结束，耗时：635毫秒
2022-04-29 18:34:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419466723758080[0;39m 生成今日电子书快照开始
2022-04-29 18:34:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419466723758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419466723758080[0;39m ==> Parameters: 
2022-04-29 18:34:20.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419466723758080[0;39m <==    Updates: 0
2022-04-29 18:34:20.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419466723758080[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 18:34:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419487699472384[0;39m 生成今日电子书快照开始
2022-04-29 18:34:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419487699472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419487699472384[0;39m ==> Parameters: 
2022-04-29 18:34:25.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419487699472384[0;39m <==    Updates: 0
2022-04-29 18:34:25.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419487699472384[0;39m 生成今日电子书快照结束，耗时：94毫秒
2022-04-29 18:34:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419508675186688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419508675186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419508675186688[0;39m ==> Parameters: 
2022-04-29 18:34:30.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419508675186688[0;39m <==    Updates: 0
2022-04-29 18:34:30.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419508675186688[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 18:34:33.826 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 18:34:33.827 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 18:34:33.829 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 2 ms
2022-04-29 18:34:33.894 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：T9nhVIXu7P，session id：0，当前连接数：1
2022-04-29 18:34:33.895 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419524982640642[0;39m ------------- 开始 -------------
2022-04-29 18:34:33.895 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419524982640640[0;39m ------------- 开始 -------------
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419524982640641[0;39m ------------- 开始 -------------
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419524982640640[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419524982640641[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:34:33.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419524982640642[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419524982640641[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419524982640642[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419524982640641[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419524982640642[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:33.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419524982640640[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-29 18:34:33.898 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419524982640640[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:33.964 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419524982640642[0;39m 请求参数: []
2022-04-29 18:34:33.964 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419524982640640[0;39m 请求参数: []
2022-04-29 18:34:33.964 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419524982640641[0;39m 请求参数: []
2022-04-29 18:34:34.001 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175419524982640640[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 18:34:34.002 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175419524982640640[0;39m ==> Parameters: 
2022-04-29 18:34:34.007 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419524982640641[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:34:34.007 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175419524982640642[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-29 18:34:34.008 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419524982640641[0;39m ==> Parameters: 
2022-04-29 18:34:34.008 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175419524982640642[0;39m ==> Parameters: 
2022-04-29 18:34:34.044 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:34:34.044 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-29 18:34:34.044 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175419524982640640[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-29 18:34:34.044 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:34:34.045 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-29 18:34:34.045 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175419524982640640[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-29 18:34:34.046 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:34:34.046 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:34:34.047 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-29 18:34:34.047 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175419524982640640[0;39m <==        Row: 2022-04-29, 1764, 63, 29, 2
2022-04-29 18:34:34.047 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:34:34.047 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-29 18:34:34.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175419524982640640[0;39m <==      Total: 2
2022-04-29 18:34:34.048 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:34:34.048 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-29 18:34:34.048 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:34:34.048 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-29 18:34:34.049 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:34:34.049 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-29 18:34:34.049 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:34:34.049 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-29 18:34:34.050 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:34:34.050 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-29 18:34:34.050 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:34:34.050 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-29 18:34:34.050 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:34:34.051 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-29 18:34:34.051 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:34:34.051 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-29 18:34:34.051 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:34:34.052 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-29 18:34:34.052 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:34:34.052 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:34:34.052 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175419524982640642[0;39m <==        Row: 2022-04-28, 1735, 61
2022-04-29 18:34:34.053 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175419524982640642[0;39m <==      Total: 13
2022-04-29 18:34:34.053 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:34:34.054 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:34:34.054 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419524982640641[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:34:34.055 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419524982640641[0;39m <==      Total: 18
2022-04-29 18:34:34.072 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419524982640641[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:34:34.072 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419524982640641[0;39m ------------- 结束 耗时：179 ms -------------
2022-04-29 18:34:34.073 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419524982640640[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61},{"date":1651215600000,"viewCount":1764,"viewIncrease":29,"voteCount":63,"voteIncrease":2}],"success":true}
2022-04-29 18:34:34.073 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419524982640640[0;39m ------------- 结束 耗时：180 ms -------------
2022-04-29 18:34:34.073 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419524982640642[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1651129200000,"viewCount":0,"viewIncrease":1735,"voteCount":0,"voteIncrease":61}],"success":true}
2022-04-29 18:34:34.074 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419524982640642[0;39m ------------- 结束 耗时：181 ms -------------
2022-04-29 18:34:35.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419529650900992[0;39m 生成今日电子书快照开始
2022-04-29 18:34:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419529650900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419529650900992[0;39m ==> Parameters: 
2022-04-29 18:34:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419529650900992[0;39m <==    Updates: 0
2022-04-29 18:34:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419529650900992[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:34:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419529902559232[0;39m start updating Ebook doc
2022-04-29 18:34:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419529902559232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:34:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419529902559232[0;39m ==> Parameters: 
2022-04-29 18:34:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419529902559232[0;39m <==    Updates: 1
2022-04-29 18:34:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419529902559232[0;39m update ends, take 42 millisecs
2022-04-29 18:34:37.528 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419540228935680[0;39m ------------- 开始 -------------
2022-04-29 18:34:37.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419540228935680[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-29 18:34:37.529 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419540228935680[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-29 18:34:37.530 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419540228935680[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:37.532 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419540228935680[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-29 18:34:37.576 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175419540228935680[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-29 18:34:37.578 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175419540228935680[0;39m ==> Parameters: test1(String)
2022-04-29 18:34:37.598 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175419540228935680[0;39m <==    Columns: id, login_name, name, password
2022-04-29 18:34:37.598 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175419540228935680[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-29 18:34:37.599 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175419540228935680[0;39m <==      Total: 1
2022-04-29 18:34:37.602 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175419540228935680[0;39m generate single sign-on token：175419540539314176，and put it into redis
2022-04-29 18:34:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419550618226688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419550618226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419550618226688[0;39m ==> Parameters: 
2022-04-29 18:34:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419550618226688[0;39m <==    Updates: 0
2022-04-29 18:34:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419550618226688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:34:43.853 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419540228935680[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"},"success":true}
2022-04-29 18:34:43.854 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419540228935680[0;39m ------------- 结束 耗时：6326 ms -------------
2022-04-29 18:34:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419571589746688[0;39m 生成今日电子书快照开始
2022-04-29 18:34:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419571589746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419571589746688[0;39m ==> Parameters: 
2022-04-29 18:34:45.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419571589746688[0;39m <==    Updates: 0
2022-04-29 18:34:45.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419571589746688[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 18:34:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419592552878080[0;39m 生成今日电子书快照开始
2022-04-29 18:34:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419592552878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419592552878080[0;39m ==> Parameters: 
2022-04-29 18:34:50.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419592552878080[0;39m <==    Updates: 0
2022-04-29 18:34:50.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419592552878080[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:34:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419613516009472[0;39m 生成今日电子书快照开始
2022-04-29 18:34:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419613516009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:34:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419613516009472[0;39m ==> Parameters: 
2022-04-29 18:34:55.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419613516009472[0;39m <==    Updates: 0
2022-04-29 18:34:55.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419613516009472[0;39m 生成今日电子书快照结束，耗时：107毫秒
2022-04-29 18:34:55.996 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419617689341952[0;39m ------------- 开始 -------------
2022-04-29 18:34:55.996 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419617689341952[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:34:55.997 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419617689341952[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:34:55.997 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419617689341952[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:55.997 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419617689341952[0;39m 请求参数: []
2022-04-29 18:34:56.013 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419617689341952[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:34:56.013 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419617689341952[0;39m ==> Parameters: 
2022-04-29 18:34:56.034 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:34:56.034 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:34:56.035 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:34:56.036 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:34:56.036 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:34:56.036 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:34:56.037 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:34:56.037 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:34:56.038 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:34:56.038 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:34:56.038 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:34:56.039 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:34:56.039 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:34:56.039 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:34:56.040 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:34:56.041 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175419617689341952[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:34:56.041 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175419617689341952[0;39m <==      Total: 18
2022-04-29 18:34:56.042 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419617689341952[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:34:56.043 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419617689341952[0;39m ------------- 结束 耗时：47 ms -------------
2022-04-29 18:34:56.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419618020691968[0;39m ------------- 开始 -------------
2022-04-29 18:34:56.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419618020691968[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:34:56.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419618020691968[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:34:56.076 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419618020691968[0;39m 远程地址: 127.0.0.1
2022-04-29 18:34:56.078 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419618020691968[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:34:56.109 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175419618020691968[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:34:56.110 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175419618020691968[0;39m ==> Parameters: 
2022-04-29 18:34:56.124 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175419618020691968[0;39m <==    Columns: count(0)
2022-04-29 18:34:56.125 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175419618020691968[0;39m <==        Row: 5
2022-04-29 18:34:56.126 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175419618020691968[0;39m <==      Total: 1
2022-04-29 18:34:56.129 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175419618020691968[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:34:56.130 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175419618020691968[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:34:56.146 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:34:56.147 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:34:56.148 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:34:56.148 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:34:56.149 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:34:56.149 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175419618020691968[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:34:56.150 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175419618020691968[0;39m <==      Total: 5
2022-04-29 18:34:56.152 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175419618020691968[0;39m total rows：5
2022-04-29 18:34:56.153 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175419618020691968[0;39m total pages：1
2022-04-29 18:34:56.165 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175419618020691968[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 18:34:56.165 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175419618020691968[0;39m ------------- 结束 耗时：90 ms -------------
2022-04-29 18:35:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419634491723776[0;39m 生成今日电子书快照开始
2022-04-29 18:35:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419634491723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419634491723776[0;39m ==> Parameters: 
2022-04-29 18:35:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419634491723776[0;39m <==    Updates: 0
2022-04-29 18:35:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419634491723776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:35:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419655463243776[0;39m 生成今日电子书快照开始
2022-04-29 18:35:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419655463243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419655463243776[0;39m ==> Parameters: 
2022-04-29 18:35:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419655463243776[0;39m <==    Updates: 0
2022-04-29 18:35:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419655463243776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:35:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419655752650752[0;39m start updating Ebook doc
2022-04-29 18:35:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419655752650752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:35:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419655752650752[0;39m ==> Parameters: 
2022-04-29 18:35:05.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419655752650752[0;39m <==    Updates: 1
2022-04-29 18:35:05.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419655752650752[0;39m update ends, take 38 millisecs
2022-04-29 18:35:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419676443152384[0;39m 生成今日电子书快照开始
2022-04-29 18:35:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419676443152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419676443152384[0;39m ==> Parameters: 
2022-04-29 18:35:10.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419676443152384[0;39m <==    Updates: 0
2022-04-29 18:35:10.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419676443152384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:35:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419697410478080[0;39m 生成今日电子书快照开始
2022-04-29 18:35:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419697410478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419697410478080[0;39m ==> Parameters: 
2022-04-29 18:35:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419697410478080[0;39m <==    Updates: 0
2022-04-29 18:35:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419697410478080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:35:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419718390386688[0;39m 生成今日电子书快照开始
2022-04-29 18:35:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419718390386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419718390386688[0;39m ==> Parameters: 
2022-04-29 18:35:20.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419718390386688[0;39m <==    Updates: 0
2022-04-29 18:35:20.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419718390386688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419739340935168[0;39m 生成今日电子书快照开始
2022-04-29 18:35:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419739340935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:25.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419739340935168[0;39m ==> Parameters: 
2022-04-29 18:35:25.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419739340935168[0;39m <==    Updates: 0
2022-04-29 18:35:25.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419739340935168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:35:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419760329232384[0;39m 生成今日电子书快照开始
2022-04-29 18:35:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419760329232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419760329232384[0;39m ==> Parameters: 
2022-04-29 18:35:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419760329232384[0;39m <==    Updates: 0
2022-04-29 18:35:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419760329232384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419781292363776[0;39m 生成今日电子书快照开始
2022-04-29 18:35:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419781292363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419781292363776[0;39m ==> Parameters: 
2022-04-29 18:35:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419781292363776[0;39m <==    Updates: 0
2022-04-29 18:35:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419781292363776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:35:35.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419781544022016[0;39m start updating Ebook doc
2022-04-29 18:35:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419781544022016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:35:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419781544022016[0;39m ==> Parameters: 
2022-04-29 18:35:35.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419781544022016[0;39m <==    Updates: 1
2022-04-29 18:35:35.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419781544022016[0;39m update ends, take 36 millisecs
2022-04-29 18:35:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419802276466688[0;39m 生成今日电子书快照开始
2022-04-29 18:35:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419802276466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419802276466688[0;39m ==> Parameters: 
2022-04-29 18:35:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419802276466688[0;39m <==    Updates: 0
2022-04-29 18:35:40.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419802276466688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:35:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419823243792384[0;39m 生成今日电子书快照开始
2022-04-29 18:35:45.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419823243792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419823243792384[0;39m ==> Parameters: 
2022-04-29 18:35:45.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419823243792384[0;39m <==    Updates: 0
2022-04-29 18:35:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419823243792384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419844219506688[0;39m 生成今日电子书快照开始
2022-04-29 18:35:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419844219506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419844219506688[0;39m ==> Parameters: 
2022-04-29 18:35:50.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419844219506688[0;39m <==    Updates: 0
2022-04-29 18:35:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419844219506688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:35:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419865182638080[0;39m 生成今日电子书快照开始
2022-04-29 18:35:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419865182638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:35:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419865182638080[0;39m ==> Parameters: 
2022-04-29 18:35:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419865182638080[0;39m <==    Updates: 0
2022-04-29 18:35:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419865182638080[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:35:59.478 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175419524982640640[0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:35:59.479 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175419524982640640[0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-29 18:35:59.483 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:35:59.483 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:35:59.483 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:35:59.654 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:35:59.664 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175419884732289024[0;39m ------------- 开始 -------------
2022-04-29 18:35:59.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175419884732289024[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:35:59.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175419884732289024[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:35:59.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175419884732289024[0;39m 远程地址: 127.0.0.1
2022-04-29 18:35:59.667 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175419884732289024[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"cover":"1","description":"1","name":"1"}]
2022-04-29 18:35:59.692 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175419884732289024[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:35:59.693 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175419884732289024[0;39m ==> Parameters: 175419884757454848(Long), 1(String), 200(Long), 202(Long), 1(String), 1(String), null, null, null
2022-04-29 18:35:59.942 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175419884732289024[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$2fe88302.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor89.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 18:35:59.946 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175419884732289024[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 18:36:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419886158352384[0;39m 生成今日电子书快照开始
2022-04-29 18:36:00.005 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419886158352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:00.005 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419886158352384[0;39m ==> Parameters: 
2022-04-29 18:36:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419886158352384[0;39m <==    Updates: 0
2022-04-29 18:36:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419886158352384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:36:05.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419907113095168[0;39m 生成今日电子书快照开始
2022-04-29 18:36:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419907113095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419907113095168[0;39m ==> Parameters: 
2022-04-29 18:36:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419907113095168[0;39m <==    Updates: 0
2022-04-29 18:36:05.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419907113095168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:36:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175419907410890752[0;39m start updating Ebook doc
2022-04-29 18:36:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419907410890752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:36:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419907410890752[0;39m ==> Parameters: 
2022-04-29 18:36:05.115 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175419907410890752[0;39m <==    Updates: 1
2022-04-29 18:36:05.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175419907410890752[0;39m update ends, take 43 millisecs
2022-04-29 18:36:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419928105586688[0;39m 生成今日电子书快照开始
2022-04-29 18:36:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419928105586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419928105586688[0;39m ==> Parameters: 
2022-04-29 18:36:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419928105586688[0;39m <==    Updates: 0
2022-04-29 18:36:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419928105586688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:36:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419949068718080[0;39m 生成今日电子书快照开始
2022-04-29 18:36:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419949068718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419949068718080[0;39m ==> Parameters: 
2022-04-29 18:36:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419949068718080[0;39m <==    Updates: 0
2022-04-29 18:36:15.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419949068718080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:36:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419970027655168[0;39m 生成今日电子书快照开始
2022-04-29 18:36:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419970027655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419970027655168[0;39m ==> Parameters: 
2022-04-29 18:36:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419970027655168[0;39m <==    Updates: 0
2022-04-29 18:36:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419970027655168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:36:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175419991011758080[0;39m 生成今日电子书快照开始
2022-04-29 18:36:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419991011758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419991011758080[0;39m ==> Parameters: 
2022-04-29 18:36:25.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175419991011758080[0;39m <==    Updates: 0
2022-04-29 18:36:25.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175419991011758080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 18:36:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420011987472384[0;39m 生成今日电子书快照开始
2022-04-29 18:36:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420011987472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420011987472384[0;39m ==> Parameters: 
2022-04-29 18:36:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420011987472384[0;39m <==    Updates: 0
2022-04-29 18:36:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420011987472384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:36:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420032950603776[0;39m 生成今日电子书快照开始
2022-04-29 18:36:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420032950603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420032950603776[0;39m ==> Parameters: 
2022-04-29 18:36:35.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420032950603776[0;39m <==    Updates: 0
2022-04-29 18:36:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420032950603776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:36:35.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420033231622144[0;39m start updating Ebook doc
2022-04-29 18:36:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420033231622144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:36:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420033231622144[0;39m ==> Parameters: 
2022-04-29 18:36:35.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420033231622144[0;39m <==    Updates: 1
2022-04-29 18:36:35.121 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420033231622144[0;39m update ends, take 51 millisecs
2022-04-29 18:36:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420053938900992[0;39m 生成今日电子书快照开始
2022-04-29 18:36:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420053938900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420053938900992[0;39m ==> Parameters: 
2022-04-29 18:36:40.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420053938900992[0;39m <==    Updates: 0
2022-04-29 18:36:40.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420053938900992[0;39m 生成今日电子书快照结束，耗时：82毫秒
2022-04-29 18:36:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420074889449472[0;39m 生成今日电子书快照开始
2022-04-29 18:36:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420074889449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420074889449472[0;39m ==> Parameters: 
2022-04-29 18:36:45.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420074889449472[0;39m <==    Updates: 0
2022-04-29 18:36:45.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420074889449472[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 18:36:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420095869358080[0;39m 生成今日电子书快照开始
2022-04-29 18:36:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420095869358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420095869358080[0;39m ==> Parameters: 
2022-04-29 18:36:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420095869358080[0;39m <==    Updates: 0
2022-04-29 18:36:50.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420095869358080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:36:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420116845072384[0;39m 生成今日电子书快照开始
2022-04-29 18:36:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420116845072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:36:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420116845072384[0;39m ==> Parameters: 
2022-04-29 18:36:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420116845072384[0;39m <==    Updates: 0
2022-04-29 18:36:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420116845072384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:37:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420137808203776[0;39m 生成今日电子书快照开始
2022-04-29 18:37:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420137808203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420137808203776[0;39m ==> Parameters: 
2022-04-29 18:37:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420137808203776[0;39m <==    Updates: 0
2022-04-29 18:37:00.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420137808203776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:37:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420158788112384[0;39m start updating Ebook doc
2022-04-29 18:37:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420158788112384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:37:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420158788112384[0;39m ==> Parameters: 
2022-04-29 18:37:05.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420158788112384[0;39m <==    Updates: 1
2022-04-29 18:37:05.074 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420158788112384[0;39m update ends, take 59 millisecs
2022-04-29 18:37:05.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420159085907968[0;39m 生成今日电子书快照开始
2022-04-29 18:37:05.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420159085907968[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:05.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420159085907968[0;39m ==> Parameters: 
2022-04-29 18:37:05.114 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420159085907968[0;39m <==    Updates: 0
2022-04-29 18:37:05.115 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420159085907968[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 18:37:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420179751243776[0;39m 生成今日电子书快照开始
2022-04-29 18:37:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420179751243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420179751243776[0;39m ==> Parameters: 
2022-04-29 18:37:10.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420179751243776[0;39m <==    Updates: 0
2022-04-29 18:37:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420179751243776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:37:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420200735346688[0;39m 生成今日电子书快照开始
2022-04-29 18:37:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420200735346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420200735346688[0;39m ==> Parameters: 
2022-04-29 18:37:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420200735346688[0;39m <==    Updates: 0
2022-04-29 18:37:15.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420200735346688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:37:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420221706866688[0;39m 生成今日电子书快照开始
2022-04-29 18:37:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420221706866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420221706866688[0;39m ==> Parameters: 
2022-04-29 18:37:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420221706866688[0;39m <==    Updates: 0
2022-04-29 18:37:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420221706866688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:37:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420242661609472[0;39m 生成今日电子书快照开始
2022-04-29 18:37:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420242661609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420242661609472[0;39m ==> Parameters: 
2022-04-29 18:37:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420242661609472[0;39m <==    Updates: 0
2022-04-29 18:37:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420242661609472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:37:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420263633129472[0;39m 生成今日电子书快照开始
2022-04-29 18:37:30.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420263633129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420263633129472[0;39m ==> Parameters: 
2022-04-29 18:37:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420263633129472[0;39m <==    Updates: 0
2022-04-29 18:37:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420263633129472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:37:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420284604649472[0;39m start updating Ebook doc
2022-04-29 18:37:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420284604649472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:37:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420284604649472[0;39m ==> Parameters: 
2022-04-29 18:37:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420284604649472[0;39m <==    Updates: 1
2022-04-29 18:37:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420284604649472[0;39m update ends, take 61 millisecs
2022-04-29 18:37:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420284873084928[0;39m 生成今日电子书快照开始
2022-04-29 18:37:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420284873084928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420284873084928[0;39m ==> Parameters: 
2022-04-29 18:37:35.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420284873084928[0;39m <==    Updates: 0
2022-04-29 18:37:35.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420284873084928[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-29 18:37:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420305571975168[0;39m 生成今日电子书快照开始
2022-04-29 18:37:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420305571975168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420305571975168[0;39m ==> Parameters: 
2022-04-29 18:37:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420305571975168[0;39m <==    Updates: 0
2022-04-29 18:37:40.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420305571975168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:37:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420326560272384[0;39m 生成今日电子书快照开始
2022-04-29 18:37:45.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420326560272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420326560272384[0;39m ==> Parameters: 
2022-04-29 18:37:45.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420326560272384[0;39m <==    Updates: 0
2022-04-29 18:37:45.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420326560272384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:37:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420347519209472[0;39m 生成今日电子书快照开始
2022-04-29 18:37:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420347519209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420347519209472[0;39m ==> Parameters: 
2022-04-29 18:37:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420347519209472[0;39m <==    Updates: 0
2022-04-29 18:37:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420347519209472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:37:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420368494923776[0;39m 生成今日电子书快照开始
2022-04-29 18:37:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420368494923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:37:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420368494923776[0;39m ==> Parameters: 
2022-04-29 18:37:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420368494923776[0;39m <==    Updates: 0
2022-04-29 18:37:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420368494923776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:38:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420389466443776[0;39m 生成今日电子书快照开始
2022-04-29 18:38:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420389466443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420389466443776[0;39m ==> Parameters: 
2022-04-29 18:38:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420389466443776[0;39m <==    Updates: 0
2022-04-29 18:38:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420389466443776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:38:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420410450546688[0;39m start updating Ebook doc
2022-04-29 18:38:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420410450546688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:38:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420410450546688[0;39m ==> Parameters: 
2022-04-29 18:38:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420410450546688[0;39m <==    Updates: 1
2022-04-29 18:38:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420410450546688[0;39m update ends, take 51 millisecs
2022-04-29 18:38:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420410677039104[0;39m 生成今日电子书快照开始
2022-04-29 18:38:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420410677039104[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420410677039104[0;39m ==> Parameters: 
2022-04-29 18:38:05.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420410677039104[0;39m <==    Updates: 0
2022-04-29 18:38:05.096 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420410677039104[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-29 18:38:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420431413678080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420431413678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420431413678080[0;39m ==> Parameters: 
2022-04-29 18:38:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420431413678080[0;39m <==    Updates: 0
2022-04-29 18:38:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420431413678080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:38:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420452385198080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420452385198080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420452385198080[0;39m ==> Parameters: 
2022-04-29 18:38:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420452385198080[0;39m <==    Updates: 0
2022-04-29 18:38:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420452385198080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:38:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420473356718080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420473356718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420473356718080[0;39m ==> Parameters: 
2022-04-29 18:38:20.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420473356718080[0;39m <==    Updates: 0
2022-04-29 18:38:20.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420473356718080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:38:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420494328238080[0;39m 生成今日电子书快照开始
2022-04-29 18:38:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420494328238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:38:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420494328238080[0;39m ==> Parameters: 
2022-04-29 18:38:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420494328238080[0;39m <==    Updates: 0
2022-04-29 18:38:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420494328238080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:38:28.019 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：T9nhVIXu7P，session id：0！当前连接数：0
2022-04-29 18:38:28.063 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-29 18:38:28.065 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-29 18:38:28.069 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-29 18:38:28.089 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-29 18:38:47.241 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-29 18:38:52.254 WARN  org.springframework.boot.StartupInfoLogger        :117  [32m                  [0;39m InetAddress.getLocalHost().getHostName() took 5004 milliseconds to respond. Please verify your network configuration (macOS machines may need to add entries to /etc/hosts).
2022-04-29 18:38:57.258 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_312 on Alexs-MacBook-Pro.local with PID 27737 (/Users/alex/Desktop/wiki 5/target/classes started by alex in /Users/alex/Desktop/wiki 5)
2022-04-29 18:38:57.259 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-29 18:38:57.301 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-29 18:38:57.302 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-29 18:38:57.909 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-29 18:38:57.911 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-29 18:38:57.929 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2022-04-29 18:38:58.606 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-29 18:38:58.614 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-29 18:38:58.615 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-29 18:38:58.615 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-29 18:38:58.686 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-29 18:38:58.687 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1385 ms
2022-04-29 18:38:59.749 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-29 18:39:00.124 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-29 18:39:00.185 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-29 18:39:00.206 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-29 18:39:00.231 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-29 18:39:00.248 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 23.531 seconds (JVM running for 25.487)
2022-04-29 18:39:00.252 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-29 18:39:00.253 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-29 18:39:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420662104592384[0;39m start updating Ebook doc
2022-04-29 18:39:05.027 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175420662104592384[0;39m HikariPool-1 - Starting...
2022-04-29 18:39:05.444 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175420662104592384[0;39m HikariPool-1 - Start completed.
2022-04-29 18:39:05.452 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420662104592384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:39:05.474 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420662104592384[0;39m ==> Parameters: 
2022-04-29 18:39:05.511 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420662104592384[0;39m <==    Updates: 1
2022-04-29 18:39:05.513 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420662104592384[0;39m update ends, take 508 millisecs
2022-04-29 18:39:05.514 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420664239493120[0;39m 生成今日电子书快照开始
2022-04-29 18:39:05.514 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420664239493120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:05.515 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420664239493120[0;39m ==> Parameters: 
2022-04-29 18:39:05.560 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420664239493120[0;39m <==    Updates: 0
2022-04-29 18:39:05.561 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420664239493120[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-29 18:39:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420683076112384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420683076112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420683076112384[0;39m ==> Parameters: 
2022-04-29 18:39:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420683076112384[0;39m <==    Updates: 0
2022-04-29 18:39:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420683076112384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:39:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420704047632384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420704047632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420704047632384[0;39m ==> Parameters: 
2022-04-29 18:39:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420704047632384[0;39m <==    Updates: 0
2022-04-29 18:39:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420704047632384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:39:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420725019152384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420725019152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420725019152384[0;39m ==> Parameters: 
2022-04-29 18:39:20.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420725019152384[0;39m <==    Updates: 0
2022-04-29 18:39:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420725019152384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:39:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420745990672384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420745990672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420745990672384[0;39m ==> Parameters: 
2022-04-29 18:39:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420745990672384[0;39m <==    Updates: 0
2022-04-29 18:39:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420745990672384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:39:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420766962192384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420766962192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420766962192384[0;39m ==> Parameters: 
2022-04-29 18:39:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420766962192384[0;39m <==    Updates: 0
2022-04-29 18:39:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420766962192384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:39:31.244 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-29 18:39:31.245 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-29 18:39:31.249 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 4 ms
2022-04-29 18:39:31.282 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:39:31.283 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:39:31.283 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:39:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175420787933712384[0;39m 生成今日电子书快照开始
2022-04-29 18:39:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420787933712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:39:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420787933712384[0;39m ==> Parameters: 
2022-04-29 18:39:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175420787933712384[0;39m <==    Updates: 0
2022-04-29 18:39:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175420787933712384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:39:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175420788197953536[0;39m start updating Ebook doc
2022-04-29 18:39:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420788197953536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:39:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420788197953536[0;39m ==> Parameters: 
2022-04-29 18:39:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175420788197953536[0;39m <==    Updates: 1
2022-04-29 18:39:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175420788197953536[0;39m update ends, take 41 millisecs
2022-04-29 18:39:37.613 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175420799459659776[0;39m ------------- 开始 -------------
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175420799459659776[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175420799459659776[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:39:37.754 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175420799459659776[0;39m 远程地址: 127.0.0.1
2022-04-29 18:39:37.817 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175420799459659776[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"cover":"1","description":"1","name":"1"}]
2022-04-29 18:41:11.968 WARN  com.zaxxer.hikari.pool.HikariPool                 :787  [32m                  [0;39m HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m36s420ms).
2022-04-29 18:41:11.967 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421194621816832[0;39m 生成今日电子书快照开始
2022-04-29 18:42:13.507 WARN  com.zaxxer.hikari.pool.HikariPool                 :787  [32m                  [0;39m HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m1s540ms).
2022-04-29 18:43:03.311 WARN  com.zaxxer.hikari.pool.HikariPool                 :787  [32m                  [0;39m HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=49s805ms).
2022-04-29 18:43:03.312 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421194621816832[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:16.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421194621816832[0;39m ==> Parameters: 
2022-04-29 18:43:16.136 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421194621816832[0;39m <==    Updates: 0
2022-04-29 18:43:16.137 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421194621816832[0;39m 生成今日电子书快照结束，耗时：124164毫秒
2022-04-29 18:43:16.138 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175421715436933120[0;39m start updating Ebook doc
2022-04-29 18:43:16.137 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175420799459659776[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:43:16.138 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421715436933120[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:43:16.139 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421715436933120[0;39m ==> Parameters: 
2022-04-29 18:43:16.151 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175420799459659776[0;39m ==> Parameters: 175421452743479296(Long), 1(String), 200(Long), 202(Long), 1(String), 1(String), null, null, null
2022-04-29 18:43:16.174 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421715436933120[0;39m <==    Updates: 1
2022-04-29 18:43:16.175 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175421715436933120[0;39m update ends, take 37 millisecs
2022-04-29 18:43:20.773 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421734877532160[0;39m 生成今日电子书快照开始
2022-04-29 18:43:47.667 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421734877532160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:47.671 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421734877532160[0;39m ==> Parameters: 
2022-04-29 18:43:47.680 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175420799459659776[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$98bbfea7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 18:43:47.710 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421734877532160[0;39m <==    Updates: 0
2022-04-29 18:43:47.710 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421734877532160[0;39m 生成今日电子书快照结束，耗时：21422毫秒
2022-04-29 18:43:47.711 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175421847863693312[0;39m start updating Ebook doc
2022-04-29 18:43:47.712 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421847863693312[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:43:47.712 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421847863693312[0;39m ==> Parameters: 
2022-04-29 18:43:47.730 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175420799459659776[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 18:43:47.751 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421847863693312[0;39m <==    Updates: 1
2022-04-29 18:43:47.752 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175421847863693312[0;39m update ends, take 41 millisecs
2022-04-29 18:43:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421857485426688[0;39m 生成今日电子书快照开始
2022-04-29 18:43:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421857485426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:50.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421857485426688[0;39m ==> Parameters: 
2022-04-29 18:43:50.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421857485426688[0;39m <==    Updates: 0
2022-04-29 18:43:50.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421857485426688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:43:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421878477918208[0;39m 生成今日电子书快照开始
2022-04-29 18:43:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421878477918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:43:55.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421878477918208[0;39m ==> Parameters: 
2022-04-29 18:43:55.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421878477918208[0;39m <==    Updates: 0
2022-04-29 18:43:55.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421878477918208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:44:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421899407495168[0;39m 生成今日电子书快照开始
2022-04-29 18:44:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421899407495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421899407495168[0;39m ==> Parameters: 
2022-04-29 18:44:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421899407495168[0;39m <==    Updates: 0
2022-04-29 18:44:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421899407495168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:44:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175421920404180992[0;39m start updating Ebook doc
2022-04-29 18:44:05.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421920404180992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:44:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421920404180992[0;39m ==> Parameters: 
2022-04-29 18:44:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175421920404180992[0;39m <==    Updates: 1
2022-04-29 18:44:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175421920404180992[0;39m update ends, take 52 millisecs
2022-04-29 18:44:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421920626479104[0;39m 生成今日电子书快照开始
2022-04-29 18:44:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421920626479104[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421920626479104[0;39m ==> Parameters: 
2022-04-29 18:44:05.097 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421920626479104[0;39m <==    Updates: 0
2022-04-29 18:44:05.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421920626479104[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-29 18:44:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421941375700992[0;39m 生成今日电子书快照开始
2022-04-29 18:44:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421941375700992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421941375700992[0;39m ==> Parameters: 
2022-04-29 18:44:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421941375700992[0;39m <==    Updates: 0
2022-04-29 18:44:10.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421941375700992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:44:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421962334638080[0;39m 生成今日电子书快照开始
2022-04-29 18:44:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421962334638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421962334638080[0;39m ==> Parameters: 
2022-04-29 18:44:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421962334638080[0;39m <==    Updates: 0
2022-04-29 18:44:15.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421962334638080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:44:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175421983335518208[0;39m 生成今日电子书快照开始
2022-04-29 18:44:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421983335518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421983335518208[0;39m ==> Parameters: 
2022-04-29 18:44:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175421983335518208[0;39m <==    Updates: 0
2022-04-29 18:44:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175421983335518208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:44:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422004269289472[0;39m 生成今日电子书快照开始
2022-04-29 18:44:25.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422004269289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:25.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422004269289472[0;39m ==> Parameters: 
2022-04-29 18:44:25.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422004269289472[0;39m <==    Updates: 0
2022-04-29 18:44:25.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422004269289472[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 18:44:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422025270169600[0;39m 生成今日电子书快照开始
2022-04-29 18:44:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422025270169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422025270169600[0;39m ==> Parameters: 
2022-04-29 18:44:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422025270169600[0;39m <==    Updates: 0
2022-04-29 18:44:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422025270169600[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:44:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422046245883904[0;39m 生成今日电子书快照开始
2022-04-29 18:44:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422046245883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422046245883904[0;39m ==> Parameters: 
2022-04-29 18:44:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422046245883904[0;39m <==    Updates: 0
2022-04-29 18:44:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422046245883904[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:44:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422046484959232[0;39m start updating Ebook doc
2022-04-29 18:44:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422046484959232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:44:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422046484959232[0;39m ==> Parameters: 
2022-04-29 18:44:35.117 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422046484959232[0;39m <==    Updates: 1
2022-04-29 18:44:35.118 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422046484959232[0;39m update ends, take 51 millisecs
2022-04-29 18:44:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422067213209600[0;39m 生成今日电子书快照开始
2022-04-29 18:44:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422067213209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422067213209600[0;39m ==> Parameters: 
2022-04-29 18:44:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422067213209600[0;39m <==    Updates: 0
2022-04-29 18:44:40.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422067213209600[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:44:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422088180535296[0;39m 生成今日电子书快照开始
2022-04-29 18:44:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422088180535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:45.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422088180535296[0;39m ==> Parameters: 
2022-04-29 18:44:45.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422088180535296[0;39m <==    Updates: 0
2022-04-29 18:44:45.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422088180535296[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:44:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422109147860992[0;39m 生成今日电子书快照开始
2022-04-29 18:44:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422109147860992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422109147860992[0;39m ==> Parameters: 
2022-04-29 18:44:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422109147860992[0;39m <==    Updates: 0
2022-04-29 18:44:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422109147860992[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:44:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422130127769600[0;39m 生成今日电子书快照开始
2022-04-29 18:44:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422130127769600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:44:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422130127769600[0;39m ==> Parameters: 
2022-04-29 18:44:55.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422130127769600[0;39m <==    Updates: 0
2022-04-29 18:44:55.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422130127769600[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:45:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422151074123776[0;39m 生成今日电子书快照开始
2022-04-29 18:45:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422151074123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422151074123776[0;39m ==> Parameters: 
2022-04-29 18:45:00.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422151074123776[0;39m <==    Updates: 0
2022-04-29 18:45:00.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422151074123776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:45:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422172062420992[0;39m start updating Ebook doc
2022-04-29 18:45:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422172062420992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:45:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422172062420992[0;39m ==> Parameters: 
2022-04-29 18:45:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422172062420992[0;39m <==    Updates: 1
2022-04-29 18:45:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422172062420992[0;39m update ends, take 59 millisecs
2022-04-29 18:45:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422172318273536[0;39m 生成今日电子书快照开始
2022-04-29 18:45:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422172318273536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422172318273536[0;39m ==> Parameters: 
2022-04-29 18:45:05.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422172318273536[0;39m <==    Updates: 0
2022-04-29 18:45:05.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422172318273536[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:45:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422193033940992[0;39m 生成今日电子书快照开始
2022-04-29 18:45:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422193033940992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422193033940992[0;39m ==> Parameters: 
2022-04-29 18:45:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422193033940992[0;39m <==    Updates: 0
2022-04-29 18:45:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422193033940992[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:45:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422214001266688[0;39m 生成今日电子书快照开始
2022-04-29 18:45:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422214001266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422214001266688[0;39m ==> Parameters: 
2022-04-29 18:45:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422214001266688[0;39m <==    Updates: 0
2022-04-29 18:45:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422214001266688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:45:20.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422234989563904[0;39m 生成今日电子书快照开始
2022-04-29 18:45:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422234989563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422234989563904[0;39m ==> Parameters: 
2022-04-29 18:45:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422234989563904[0;39m <==    Updates: 0
2022-04-29 18:45:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422234989563904[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:45:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422255948500992[0;39m 生成今日电子书快照开始
2022-04-29 18:45:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422255948500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422255948500992[0;39m ==> Parameters: 
2022-04-29 18:45:25.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422255948500992[0;39m <==    Updates: 0
2022-04-29 18:45:25.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422255948500992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:45:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422276932603904[0;39m 生成今日电子书快照开始
2022-04-29 18:45:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422276932603904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422276932603904[0;39m ==> Parameters: 
2022-04-29 18:45:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422276932603904[0;39m <==    Updates: 0
2022-04-29 18:45:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422276932603904[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:45:35.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422297904123904[0;39m 生成今日电子书快照开始
2022-04-29 18:45:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422297904123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422297904123904[0;39m ==> Parameters: 
2022-04-29 18:45:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422297904123904[0;39m <==    Updates: 0
2022-04-29 18:45:35.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422297904123904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:45:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422298151587840[0;39m start updating Ebook doc
2022-04-29 18:45:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422298151587840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:45:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422298151587840[0;39m ==> Parameters: 
2022-04-29 18:45:35.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422298151587840[0;39m <==    Updates: 1
2022-04-29 18:45:35.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422298151587840[0;39m update ends, take 43 millisecs
2022-04-29 18:45:40.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422318867255296[0;39m 生成今日电子书快照开始
2022-04-29 18:45:40.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422318867255296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:40.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422318867255296[0;39m ==> Parameters: 
2022-04-29 18:45:40.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422318867255296[0;39m <==    Updates: 0
2022-04-29 18:45:40.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422318867255296[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 18:45:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422339842969600[0;39m 生成今日电子书快照开始
2022-04-29 18:45:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422339842969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422339842969600[0;39m ==> Parameters: 
2022-04-29 18:45:45.092 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422339842969600[0;39m <==    Updates: 0
2022-04-29 18:45:45.093 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422339842969600[0;39m 生成今日电子书快照结束，耗时：84毫秒
2022-04-29 18:45:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422360797712384[0;39m 生成今日电子书快照开始
2022-04-29 18:45:50.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422360797712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:50.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422360797712384[0;39m ==> Parameters: 
2022-04-29 18:45:50.086 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422360797712384[0;39m <==    Updates: 0
2022-04-29 18:45:50.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422360797712384[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 18:45:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422381773426688[0;39m 生成今日电子书快照开始
2022-04-29 18:45:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422381773426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:45:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422381773426688[0;39m ==> Parameters: 
2022-04-29 18:45:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422381773426688[0;39m <==    Updates: 0
2022-04-29 18:45:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422381773426688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:46:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422402740752384[0;39m 生成今日电子书快照开始
2022-04-29 18:46:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422402740752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422402740752384[0;39m ==> Parameters: 
2022-04-29 18:46:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422402740752384[0;39m <==    Updates: 0
2022-04-29 18:46:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422402740752384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:46:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422423716466688[0;39m 生成今日电子书快照开始
2022-04-29 18:46:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422423716466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422423716466688[0;39m ==> Parameters: 
2022-04-29 18:46:05.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422423716466688[0;39m <==    Updates: 0
2022-04-29 18:46:05.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422423716466688[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 18:46:05.085 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422424052011008[0;39m start updating Ebook doc
2022-04-29 18:46:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422424052011008[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:46:05.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422424052011008[0;39m ==> Parameters: 
2022-04-29 18:46:05.144 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422424052011008[0;39m <==    Updates: 1
2022-04-29 18:46:05.145 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422424052011008[0;39m update ends, take 59 millisecs
2022-04-29 18:46:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422444696375296[0;39m 生成今日电子书快照开始
2022-04-29 18:46:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422444696375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422444696375296[0;39m ==> Parameters: 
2022-04-29 18:46:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422444696375296[0;39m <==    Updates: 0
2022-04-29 18:46:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422444696375296[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:46:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422465667895296[0;39m 生成今日电子书快照开始
2022-04-29 18:46:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422465667895296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422465667895296[0;39m ==> Parameters: 
2022-04-29 18:46:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422465667895296[0;39m <==    Updates: 0
2022-04-29 18:46:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422465667895296[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-29 18:46:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422486626832384[0;39m 生成今日电子书快照开始
2022-04-29 18:46:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422486626832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422486626832384[0;39m ==> Parameters: 
2022-04-29 18:46:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422486626832384[0;39m <==    Updates: 0
2022-04-29 18:46:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422486626832384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:46:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422507610935296[0;39m 生成今日电子书快照开始
2022-04-29 18:46:25.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422507610935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:25.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422507610935296[0;39m ==> Parameters: 
2022-04-29 18:46:25.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422507610935296[0;39m <==    Updates: 0
2022-04-29 18:46:25.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422507610935296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:46:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422528595038208[0;39m 生成今日电子书快照开始
2022-04-29 18:46:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422528595038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422528595038208[0;39m ==> Parameters: 
2022-04-29 18:46:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422528595038208[0;39m <==    Updates: 0
2022-04-29 18:46:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422528595038208[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 18:46:35.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422549558169600[0;39m 生成今日电子书快照开始
2022-04-29 18:46:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422549558169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422549558169600[0;39m ==> Parameters: 
2022-04-29 18:46:35.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422549558169600[0;39m <==    Updates: 0
2022-04-29 18:46:35.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422549558169600[0;39m 生成今日电子书快照结束，耗时：100毫秒
2022-04-29 18:46:35.109 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422549981794304[0;39m start updating Ebook doc
2022-04-29 18:46:35.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422549981794304[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:46:35.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422549981794304[0;39m ==> Parameters: 
2022-04-29 18:46:35.166 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422549981794304[0;39m <==    Updates: 1
2022-04-29 18:46:35.167 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422549981794304[0;39m update ends, take 58 millisecs
2022-04-29 18:46:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422570504523776[0;39m 生成今日电子书快照开始
2022-04-29 18:46:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422570504523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422570504523776[0;39m ==> Parameters: 
2022-04-29 18:46:40.097 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422570504523776[0;39m <==    Updates: 0
2022-04-29 18:46:40.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422570504523776[0;39m 生成今日电子书快照结束，耗时：96毫秒
2022-04-29 18:46:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422591492820992[0;39m 生成今日电子书快照开始
2022-04-29 18:46:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422591492820992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422591492820992[0;39m ==> Parameters: 
2022-04-29 18:46:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422591492820992[0;39m <==    Updates: 0
2022-04-29 18:46:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422591492820992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:46:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422612464340992[0;39m 生成今日电子书快照开始
2022-04-29 18:46:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422612464340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422612464340992[0;39m ==> Parameters: 
2022-04-29 18:46:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422612464340992[0;39m <==    Updates: 0
2022-04-29 18:46:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422612464340992[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:46:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422633414889472[0;39m 生成今日电子书快照开始
2022-04-29 18:46:55.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422633414889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:46:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422633414889472[0;39m ==> Parameters: 
2022-04-29 18:46:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422633414889472[0;39m <==    Updates: 0
2022-04-29 18:46:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422633414889472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:47:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422654407380992[0;39m 生成今日电子书快照开始
2022-04-29 18:47:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422654407380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422654407380992[0;39m ==> Parameters: 
2022-04-29 18:47:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422654407380992[0;39m <==    Updates: 0
2022-04-29 18:47:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422654407380992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:47:05.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422675395678208[0;39m 生成今日电子书快照开始
2022-04-29 18:47:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422675395678208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422675395678208[0;39m ==> Parameters: 
2022-04-29 18:47:05.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422675395678208[0;39m <==    Updates: 0
2022-04-29 18:47:05.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422675395678208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:47:05.074 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422675664113664[0;39m start updating Ebook doc
2022-04-29 18:47:05.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422675664113664[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:47:05.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422675664113664[0;39m ==> Parameters: 
2022-04-29 18:47:05.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422675664113664[0;39m <==    Updates: 1
2022-04-29 18:47:05.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422675664113664[0;39m update ends, take 38 millisecs
2022-04-29 18:47:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422696346226688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422696346226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422696346226688[0;39m ==> Parameters: 
2022-04-29 18:47:10.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422696346226688[0;39m <==    Updates: 0
2022-04-29 18:47:10.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422696346226688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:47:15.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422717330329600[0;39m 生成今日电子书快照开始
2022-04-29 18:47:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422717330329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422717330329600[0;39m ==> Parameters: 
2022-04-29 18:47:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422717330329600[0;39m <==    Updates: 0
2022-04-29 18:47:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422717330329600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:47:20.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422738297655296[0;39m 生成今日电子书快照开始
2022-04-29 18:47:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422738297655296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422738297655296[0;39m ==> Parameters: 
2022-04-29 18:47:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422738297655296[0;39m <==    Updates: 0
2022-04-29 18:47:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422738297655296[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:47:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422759277563904[0;39m 生成今日电子书快照开始
2022-04-29 18:47:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422759277563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422759277563904[0;39m ==> Parameters: 
2022-04-29 18:47:25.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422759277563904[0;39m <==    Updates: 0
2022-04-29 18:47:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422759277563904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:47:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422780232306688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422780232306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422780232306688[0;39m ==> Parameters: 
2022-04-29 18:47:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422780232306688[0;39m <==    Updates: 0
2022-04-29 18:47:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422780232306688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:47:35.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422801208020992[0;39m start updating Ebook doc
2022-04-29 18:47:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422801208020992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:47:35.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422801208020992[0;39m ==> Parameters: 
2022-04-29 18:47:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422801208020992[0;39m <==    Updates: 1
2022-04-29 18:47:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422801208020992[0;39m update ends, take 58 millisecs
2022-04-29 18:47:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422801455484928[0;39m 生成今日电子书快照开始
2022-04-29 18:47:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422801455484928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422801455484928[0;39m ==> Parameters: 
2022-04-29 18:47:35.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422801455484928[0;39m <==    Updates: 0
2022-04-29 18:47:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422801455484928[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-29 18:47:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422822166958080[0;39m 生成今日电子书快照开始
2022-04-29 18:47:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422822166958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:40.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422822166958080[0;39m ==> Parameters: 
2022-04-29 18:47:40.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422822166958080[0;39m <==    Updates: 0
2022-04-29 18:47:40.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422822166958080[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:47:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422843146866688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:45.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422843146866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:45.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422843146866688[0;39m ==> Parameters: 
2022-04-29 18:47:45.093 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422843146866688[0;39m <==    Updates: 0
2022-04-29 18:47:45.093 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422843146866688[0;39m 生成今日电子书快照结束，耗时：88毫秒
2022-04-29 18:47:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422864109998080[0;39m 生成今日电子书快照开始
2022-04-29 18:47:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422864109998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422864109998080[0;39m ==> Parameters: 
2022-04-29 18:47:50.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422864109998080[0;39m <==    Updates: 0
2022-04-29 18:47:50.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422864109998080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 18:47:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422885089906688[0;39m 生成今日电子书快照开始
2022-04-29 18:47:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422885089906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:47:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422885089906688[0;39m ==> Parameters: 
2022-04-29 18:47:55.188 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422885089906688[0;39m <==    Updates: 0
2022-04-29 18:47:55.189 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422885089906688[0;39m 生成今日电子书快照结束，耗时：183毫秒
2022-04-29 18:48:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422906044649472[0;39m 生成今日电子书快照开始
2022-04-29 18:48:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422906044649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422906044649472[0;39m ==> Parameters: 
2022-04-29 18:48:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422906044649472[0;39m <==    Updates: 0
2022-04-29 18:48:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422906044649472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:48:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175422927032946688[0;39m start updating Ebook doc
2022-04-29 18:48:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422927032946688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:48:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422927032946688[0;39m ==> Parameters: 
2022-04-29 18:48:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175422927032946688[0;39m <==    Updates: 1
2022-04-29 18:48:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175422927032946688[0;39m update ends, take 58 millisecs
2022-04-29 18:48:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422927284604928[0;39m 生成今日电子书快照开始
2022-04-29 18:48:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422927284604928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422927284604928[0;39m ==> Parameters: 
2022-04-29 18:48:05.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422927284604928[0;39m <==    Updates: 0
2022-04-29 18:48:05.116 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422927284604928[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-29 18:48:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422948000272384[0;39m 生成今日电子书快照开始
2022-04-29 18:48:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422948000272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422948000272384[0;39m ==> Parameters: 
2022-04-29 18:48:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422948000272384[0;39m <==    Updates: 0
2022-04-29 18:48:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422948000272384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:48:13.872 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:48:13.873 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:48:13.873 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:48:14.075 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:48:14.089 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175422965134004224[0;39m ------------- 开始 -------------
2022-04-29 18:48:14.090 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175422965134004224[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:48:14.090 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175422965134004224[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:48:14.090 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175422965134004224[0;39m 远程地址: 127.0.0.1
2022-04-29 18:48:14.093 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175422965134004224[0;39m 请求参数: [{"category1Id":200,"category2Id":202,"cover":"1","description":"1","name":"1"}]
2022-04-29 18:48:21.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175422994330554368[0;39m 生成今日电子书快照开始
2022-04-29 18:48:21.079 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175422965134004224[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:48:21.080 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175422965134004224[0;39m ==> Parameters: 175422994330554369(Long), 1(String), 200(Long), 202(Long), 1(String), 1(String), null, null, null
2022-04-29 18:48:21.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422994330554368[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:21.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422994330554368[0;39m ==> Parameters: 
2022-04-29 18:48:21.125 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175422965134004224[0;39m 系统异常：
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:88)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy89.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:271)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy102.insert(Unknown Source)
	at com.ameliawiki.wiki.service.EbookService.save(EbookService.java:72)
	at com.ameliawiki.wiki.controller.EbookController.save(EbookController.java:34)
	at com.ameliawiki.wiki.controller.EbookController$$FastClassBySpringCGLIB$$6ee34e90.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.ameliawiki.wiki.aspect.LogAspect.doAround(LogAspect.java:83)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691)
	at com.ameliawiki.wiki.controller.EbookController$$EnhancerBySpringCGLIB$$98bbfea7.save(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at sun.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 82 common frames omitted
2022-04-29 18:48:21.131 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175422965134004224[0;39m Resolved [org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
### The error may exist in file [/Users/alex/Desktop/wiki 5/target/classes/mapper/EbookMapper.xml]
### The error may involve com.ameliawiki.wiki.mapper.EbookMapper.insert-Inline
### The error occurred while setting parameters
### SQL: insert into ebook (id, `name`, category1_id,        category2_id, description, cover,        doc_count, view_count, vote_count       )     values (?, ?, ?,        ?, ?, ?,        ?, ?, ?       )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null
; Column 'doc_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'doc_count' cannot be null]
2022-04-29 18:48:21.140 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175422994330554368[0;39m <==    Updates: 0
2022-04-29 18:48:21.141 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175422994330554368[0;39m 生成今日电子书快照结束，耗时：91毫秒
2022-04-29 18:48:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423010902249472[0;39m 生成今日电子书快照开始
2022-04-29 18:48:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423010902249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423010902249472[0;39m ==> Parameters: 
2022-04-29 18:48:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423010902249472[0;39m <==    Updates: 0
2022-04-29 18:48:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423010902249472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:48:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423031890546688[0;39m 生成今日电子书快照开始
2022-04-29 18:48:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423031890546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423031890546688[0;39m ==> Parameters: 
2022-04-29 18:48:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423031890546688[0;39m <==    Updates: 0
2022-04-29 18:48:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423031890546688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:48:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423052849483776[0;39m 生成今日电子书快照开始
2022-04-29 18:48:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423052849483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423052849483776[0;39m ==> Parameters: 
2022-04-29 18:48:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423052849483776[0;39m <==    Updates: 0
2022-04-29 18:48:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423052849483776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:48:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423053105336320[0;39m start updating Ebook doc
2022-04-29 18:48:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423053105336320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:48:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423053105336320[0;39m ==> Parameters: 
2022-04-29 18:48:35.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423053105336320[0;39m <==    Updates: 1
2022-04-29 18:48:35.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423053105336320[0;39m update ends, take 41 millisecs
2022-04-29 18:48:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423073837780992[0;39m 生成今日电子书快照开始
2022-04-29 18:48:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423073837780992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423073837780992[0;39m ==> Parameters: 
2022-04-29 18:48:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423073837780992[0;39m <==    Updates: 0
2022-04-29 18:48:40.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423073837780992[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:48:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423094813495296[0;39m 生成今日电子书快照开始
2022-04-29 18:48:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423094813495296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423094813495296[0;39m ==> Parameters: 
2022-04-29 18:48:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423094813495296[0;39m <==    Updates: 0
2022-04-29 18:48:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423094813495296[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:48:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423115789209600[0;39m 生成今日电子书快照开始
2022-04-29 18:48:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423115789209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423115789209600[0;39m ==> Parameters: 
2022-04-29 18:48:50.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423115789209600[0;39m <==    Updates: 0
2022-04-29 18:48:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423115789209600[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:48:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423136752340992[0;39m 生成今日电子书快照开始
2022-04-29 18:48:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423136752340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:48:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423136752340992[0;39m ==> Parameters: 
2022-04-29 18:48:55.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423136752340992[0;39m <==    Updates: 0
2022-04-29 18:48:55.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423136752340992[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:49:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423157711278080[0;39m 生成今日电子书快照开始
2022-04-29 18:49:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423157711278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423157711278080[0;39m ==> Parameters: 
2022-04-29 18:49:00.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423157711278080[0;39m <==    Updates: 0
2022-04-29 18:49:00.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423157711278080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:49:05.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423178695380992[0;39m 生成今日电子书快照开始
2022-04-29 18:49:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423178695380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423178695380992[0;39m ==> Parameters: 
2022-04-29 18:49:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423178695380992[0;39m <==    Updates: 0
2022-04-29 18:49:05.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423178695380992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:49:05.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423178972205056[0;39m start updating Ebook doc
2022-04-29 18:49:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423178972205056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:49:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423178972205056[0;39m ==> Parameters: 
2022-04-29 18:49:05.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423178972205056[0;39m <==    Updates: 1
2022-04-29 18:49:05.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423178972205056[0;39m update ends, take 40 millisecs
2022-04-29 18:49:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423199679483904[0;39m 生成今日电子书快照开始
2022-04-29 18:49:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423199679483904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423199679483904[0;39m ==> Parameters: 
2022-04-29 18:49:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423199679483904[0;39m <==    Updates: 0
2022-04-29 18:49:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423199679483904[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:49:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423220638420992[0;39m 生成今日电子书快照开始
2022-04-29 18:49:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423220638420992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423220638420992[0;39m ==> Parameters: 
2022-04-29 18:49:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423220638420992[0;39m <==    Updates: 0
2022-04-29 18:49:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423220638420992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:49:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423241609940992[0;39m 生成今日电子书快照开始
2022-04-29 18:49:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423241609940992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423241609940992[0;39m ==> Parameters: 
2022-04-29 18:49:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423241609940992[0;39m <==    Updates: 0
2022-04-29 18:49:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423241609940992[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:49:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423262564683776[0;39m 生成今日电子书快照开始
2022-04-29 18:49:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423262564683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423262564683776[0;39m ==> Parameters: 
2022-04-29 18:49:25.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423262564683776[0;39m <==    Updates: 0
2022-04-29 18:49:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423262564683776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:49:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423283557175296[0;39m 生成今日电子书快照开始
2022-04-29 18:49:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423283557175296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423283557175296[0;39m ==> Parameters: 
2022-04-29 18:49:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423283557175296[0;39m <==    Updates: 0
2022-04-29 18:49:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423283557175296[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:49:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423304516112384[0;39m 生成今日电子书快照开始
2022-04-29 18:49:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423304516112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423304516112384[0;39m ==> Parameters: 
2022-04-29 18:49:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423304516112384[0;39m <==    Updates: 0
2022-04-29 18:49:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423304516112384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:49:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423304780353536[0;39m start updating Ebook doc
2022-04-29 18:49:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423304780353536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:49:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423304780353536[0;39m ==> Parameters: 
2022-04-29 18:49:35.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423304780353536[0;39m <==    Updates: 1
2022-04-29 18:49:35.111 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423304780353536[0;39m update ends, take 43 millisecs
2022-04-29 18:49:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423325504409600[0;39m 生成今日电子书快照开始
2022-04-29 18:49:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423325504409600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423325504409600[0;39m ==> Parameters: 
2022-04-29 18:49:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423325504409600[0;39m <==    Updates: 0
2022-04-29 18:49:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423325504409600[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:49:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423346480123904[0;39m 生成今日电子书快照开始
2022-04-29 18:49:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423346480123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423346480123904[0;39m ==> Parameters: 
2022-04-29 18:49:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423346480123904[0;39m <==    Updates: 0
2022-04-29 18:49:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423346480123904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:49:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423367447449600[0;39m 生成今日电子书快照开始
2022-04-29 18:49:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423367447449600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423367447449600[0;39m ==> Parameters: 
2022-04-29 18:49:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423367447449600[0;39m <==    Updates: 0
2022-04-29 18:49:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423367447449600[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:49:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423388427358208[0;39m 生成今日电子书快照开始
2022-04-29 18:49:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423388427358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:49:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423388427358208[0;39m ==> Parameters: 
2022-04-29 18:49:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423388427358208[0;39m <==    Updates: 0
2022-04-29 18:49:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423388427358208[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-29 18:50:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423409394683904[0;39m 生成今日电子书快照开始
2022-04-29 18:50:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423409394683904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423409394683904[0;39m ==> Parameters: 
2022-04-29 18:50:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423409394683904[0;39m <==    Updates: 0
2022-04-29 18:50:00.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423409394683904[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:50:05.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423430362009600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423430362009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423430362009600[0;39m ==> Parameters: 
2022-04-29 18:50:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423430362009600[0;39m <==    Updates: 0
2022-04-29 18:50:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423430362009600[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:50:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423430601084928[0;39m start updating Ebook doc
2022-04-29 18:50:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423430601084928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:50:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423430601084928[0;39m ==> Parameters: 
2022-04-29 18:50:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423430601084928[0;39m <==    Updates: 1
2022-04-29 18:50:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423430601084928[0;39m update ends, take 40 millisecs
2022-04-29 18:50:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423451329335296[0;39m 生成今日电子书快照开始
2022-04-29 18:50:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423451329335296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423451329335296[0;39m ==> Parameters: 
2022-04-29 18:50:10.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423451329335296[0;39m <==    Updates: 0
2022-04-29 18:50:10.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423451329335296[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:50:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423472271495168[0;39m 生成今日电子书快照开始
2022-04-29 18:50:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423472271495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423472271495168[0;39m ==> Parameters: 
2022-04-29 18:50:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423472271495168[0;39m <==    Updates: 0
2022-04-29 18:50:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423472271495168[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:50:20.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423493276569600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423493276569600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423493276569600[0;39m ==> Parameters: 
2022-04-29 18:50:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423493276569600[0;39m <==    Updates: 0
2022-04-29 18:50:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423493276569600[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:50:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423514248089600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423514248089600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423514248089600[0;39m ==> Parameters: 
2022-04-29 18:50:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423514248089600[0;39m <==    Updates: 0
2022-04-29 18:50:25.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423514248089600[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:50:30.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423535232192512[0;39m 生成今日电子书快照开始
2022-04-29 18:50:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423535232192512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423535232192512[0;39m ==> Parameters: 
2022-04-29 18:50:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423535232192512[0;39m <==    Updates: 0
2022-04-29 18:50:30.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423535232192512[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:50:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423556161769472[0;39m 生成今日电子书快照开始
2022-04-29 18:50:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423556161769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423556161769472[0;39m ==> Parameters: 
2022-04-29 18:50:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423556161769472[0;39m <==    Updates: 0
2022-04-29 18:50:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423556161769472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:50:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423556434399232[0;39m start updating Ebook doc
2022-04-29 18:50:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423556434399232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:50:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423556434399232[0;39m ==> Parameters: 
2022-04-29 18:50:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423556434399232[0;39m <==    Updates: 1
2022-04-29 18:50:35.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423556434399232[0;39m update ends, take 40 millisecs
2022-04-29 18:50:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423577171038208[0;39m 生成今日电子书快照开始
2022-04-29 18:50:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423577171038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423577171038208[0;39m ==> Parameters: 
2022-04-29 18:50:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423577171038208[0;39m <==    Updates: 0
2022-04-29 18:50:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423577171038208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:50:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423598134169600[0;39m 生成今日电子书快照开始
2022-04-29 18:50:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423598134169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423598134169600[0;39m ==> Parameters: 
2022-04-29 18:50:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423598134169600[0;39m <==    Updates: 0
2022-04-29 18:50:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423598134169600[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:50:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423619114078208[0;39m 生成今日电子书快照开始
2022-04-29 18:50:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423619114078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423619114078208[0;39m ==> Parameters: 
2022-04-29 18:50:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423619114078208[0;39m <==    Updates: 0
2022-04-29 18:50:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423619114078208[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:50:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423640047849472[0;39m 生成今日电子书快照开始
2022-04-29 18:50:55.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423640047849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:50:55.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423640047849472[0;39m ==> Parameters: 
2022-04-29 18:50:55.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423640047849472[0;39m <==    Updates: 0
2022-04-29 18:50:55.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423640047849472[0;39m 生成今日电子书快照结束，耗时：84毫秒
2022-04-29 18:51:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423661044535296[0;39m 生成今日电子书快照开始
2022-04-29 18:51:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423661044535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:00.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423661044535296[0;39m ==> Parameters: 
2022-04-29 18:51:00.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423661044535296[0;39m <==    Updates: 0
2022-04-29 18:51:00.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423661044535296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:51:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423681990889472[0;39m start updating Ebook doc
2022-04-29 18:51:05.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423681990889472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:51:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423681990889472[0;39m ==> Parameters: 
2022-04-29 18:51:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423681990889472[0;39m <==    Updates: 1
2022-04-29 18:51:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423681990889472[0;39m update ends, take 58 millisecs
2022-04-29 18:51:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423682238353408[0;39m 生成今日电子书快照开始
2022-04-29 18:51:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423682238353408[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423682238353408[0;39m ==> Parameters: 
2022-04-29 18:51:05.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423682238353408[0;39m <==    Updates: 0
2022-04-29 18:51:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423682238353408[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-29 18:51:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423702995963904[0;39m 生成今日电子书快照开始
2022-04-29 18:51:10.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423702995963904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:10.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423702995963904[0;39m ==> Parameters: 
2022-04-29 18:51:10.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423702995963904[0;39m <==    Updates: 0
2022-04-29 18:51:10.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423702995963904[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 18:51:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423723933929472[0;39m 生成今日电子书快照开始
2022-04-29 18:51:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423723933929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423723933929472[0;39m ==> Parameters: 
2022-04-29 18:51:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423723933929472[0;39m <==    Updates: 0
2022-04-29 18:51:15.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423723933929472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:51:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423744905449472[0;39m 生成今日电子书快照开始
2022-04-29 18:51:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423744905449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423744905449472[0;39m ==> Parameters: 
2022-04-29 18:51:20.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423744905449472[0;39m <==    Updates: 0
2022-04-29 18:51:20.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423744905449472[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 18:51:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423765906329600[0;39m 生成今日电子书快照开始
2022-04-29 18:51:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423765906329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423765906329600[0;39m ==> Parameters: 
2022-04-29 18:51:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423765906329600[0;39m <==    Updates: 0
2022-04-29 18:51:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423765906329600[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:51:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423786882043904[0;39m 生成今日电子书快照开始
2022-04-29 18:51:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423786882043904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423786882043904[0;39m ==> Parameters: 
2022-04-29 18:51:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423786882043904[0;39m <==    Updates: 0
2022-04-29 18:51:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423786882043904[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:51:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423807820009472[0;39m 生成今日电子书快照开始
2022-04-29 18:51:35.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423807820009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423807820009472[0;39m ==> Parameters: 
2022-04-29 18:51:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423807820009472[0;39m <==    Updates: 0
2022-04-29 18:51:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423807820009472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:51:35.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423808067473408[0;39m start updating Ebook doc
2022-04-29 18:51:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423808067473408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:51:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423808067473408[0;39m ==> Parameters: 
2022-04-29 18:51:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423808067473408[0;39m <==    Updates: 1
2022-04-29 18:51:35.101 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423808067473408[0;39m update ends, take 41 millisecs
2022-04-29 18:51:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423828820889600[0;39m 生成今日电子书快照开始
2022-04-29 18:51:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423828820889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423828820889600[0;39m ==> Parameters: 
2022-04-29 18:51:40.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423828820889600[0;39m <==    Updates: 0
2022-04-29 18:51:40.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423828820889600[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:51:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423849788215296[0;39m 生成今日电子书快照开始
2022-04-29 18:51:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423849788215296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423849788215296[0;39m ==> Parameters: 
2022-04-29 18:51:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423849788215296[0;39m <==    Updates: 0
2022-04-29 18:51:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423849788215296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:51:50.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423870759735296[0;39m 生成今日电子书快照开始
2022-04-29 18:51:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423870759735296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423870759735296[0;39m ==> Parameters: 
2022-04-29 18:51:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423870759735296[0;39m <==    Updates: 0
2022-04-29 18:51:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423870759735296[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:51:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423891722866688[0;39m 生成今日电子书快照开始
2022-04-29 18:51:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423891722866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:51:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423891722866688[0;39m ==> Parameters: 
2022-04-29 18:51:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423891722866688[0;39m <==    Updates: 0
2022-04-29 18:51:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423891722866688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:52:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423912698580992[0;39m 生成今日电子书快照开始
2022-04-29 18:52:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423912698580992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423912698580992[0;39m ==> Parameters: 
2022-04-29 18:52:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423912698580992[0;39m <==    Updates: 0
2022-04-29 18:52:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423912698580992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:52:05.008 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175423933678489600[0;39m start updating Ebook doc
2022-04-29 18:52:05.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423933678489600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:52:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423933678489600[0;39m ==> Parameters: 
2022-04-29 18:52:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175423933678489600[0;39m <==    Updates: 1
2022-04-29 18:52:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175423933678489600[0;39m update ends, take 57 millisecs
2022-04-29 18:52:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423933925953536[0;39m 生成今日电子书快照开始
2022-04-29 18:52:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423933925953536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423933925953536[0;39m ==> Parameters: 
2022-04-29 18:52:05.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423933925953536[0;39m <==    Updates: 0
2022-04-29 18:52:05.107 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423933925953536[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-29 18:52:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423954650009600[0;39m 生成今日电子书快照开始
2022-04-29 18:52:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423954650009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423954650009600[0;39m ==> Parameters: 
2022-04-29 18:52:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423954650009600[0;39m <==    Updates: 0
2022-04-29 18:52:10.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423954650009600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:52:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423975596363776[0;39m 生成今日电子书快照开始
2022-04-29 18:52:15.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423975596363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:15.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423975596363776[0;39m ==> Parameters: 
2022-04-29 18:52:15.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423975596363776[0;39m <==    Updates: 0
2022-04-29 18:52:15.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423975596363776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:52:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175423996584660992[0;39m 生成今日电子书快照开始
2022-04-29 18:52:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423996584660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423996584660992[0;39m ==> Parameters: 
2022-04-29 18:52:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175423996584660992[0;39m <==    Updates: 0
2022-04-29 18:52:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175423996584660992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:52:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424017560375296[0;39m 生成今日电子书快照开始
2022-04-29 18:52:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424017560375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424017560375296[0;39m ==> Parameters: 
2022-04-29 18:52:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424017560375296[0;39m <==    Updates: 0
2022-04-29 18:52:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424017560375296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:52:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424038519312384[0;39m 生成今日电子书快照开始
2022-04-29 18:52:30.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424038519312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424038519312384[0;39m ==> Parameters: 
2022-04-29 18:52:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424038519312384[0;39m <==    Updates: 0
2022-04-29 18:52:30.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424038519312384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:52:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424059503415296[0;39m 生成今日电子书快照开始
2022-04-29 18:52:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424059503415296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424059503415296[0;39m ==> Parameters: 
2022-04-29 18:52:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424059503415296[0;39m <==    Updates: 0
2022-04-29 18:52:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424059503415296[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:52:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424059742490624[0;39m start updating Ebook doc
2022-04-29 18:52:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424059742490624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:52:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424059742490624[0;39m ==> Parameters: 
2022-04-29 18:52:35.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424059742490624[0;39m <==    Updates: 1
2022-04-29 18:52:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424059742490624[0;39m update ends, take 44 millisecs
2022-04-29 18:52:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424080453963776[0;39m 生成今日电子书快照开始
2022-04-29 18:52:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424080453963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424080453963776[0;39m ==> Parameters: 
2022-04-29 18:52:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424080453963776[0;39m <==    Updates: 0
2022-04-29 18:52:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424080453963776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:52:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424101454843904[0;39m 生成今日电子书快照开始
2022-04-29 18:52:45.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424101454843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:45.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424101454843904[0;39m ==> Parameters: 
2022-04-29 18:52:45.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424101454843904[0;39m <==    Updates: 0
2022-04-29 18:52:45.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424101454843904[0;39m 生成今日电子书快照结束，耗时：79毫秒
2022-04-29 18:52:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424122409586688[0;39m 生成今日电子书快照开始
2022-04-29 18:52:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424122409586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424122409586688[0;39m ==> Parameters: 
2022-04-29 18:52:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424122409586688[0;39m <==    Updates: 0
2022-04-29 18:52:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424122409586688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:52:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424143397883904[0;39m 生成今日电子书快照开始
2022-04-29 18:52:55.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424143397883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:52:55.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424143397883904[0;39m ==> Parameters: 
2022-04-29 18:52:55.393 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424143397883904[0;39m <==    Updates: 0
2022-04-29 18:52:55.393 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424143397883904[0;39m 生成今日电子书快照结束，耗时：384毫秒
2022-04-29 18:53:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424164365209600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424164365209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424164365209600[0;39m ==> Parameters: 
2022-04-29 18:53:00.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424164365209600[0;39m <==    Updates: 0
2022-04-29 18:53:00.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424164365209600[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:53:05.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424185345118208[0;39m start updating Ebook doc
2022-04-29 18:53:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424185345118208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:53:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424185345118208[0;39m ==> Parameters: 
2022-04-29 18:53:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424185345118208[0;39m <==    Updates: 1
2022-04-29 18:53:05.073 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424185345118208[0;39m update ends, take 63 millisecs
2022-04-29 18:53:05.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424185609359360[0;39m 生成今日电子书快照开始
2022-04-29 18:53:05.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424185609359360[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:05.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424185609359360[0;39m ==> Parameters: 
2022-04-29 18:53:05.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424185609359360[0;39m <==    Updates: 0
2022-04-29 18:53:05.112 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424185609359360[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-29 18:53:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424206308249600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424206308249600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424206308249600[0;39m ==> Parameters: 
2022-04-29 18:53:10.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424206308249600[0;39m <==    Updates: 0
2022-04-29 18:53:10.090 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424206308249600[0;39m 生成今日电子书快照结束，耗时：81毫秒
2022-04-29 18:53:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424227262992384[0;39m 生成今日电子书快照开始
2022-04-29 18:53:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424227262992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424227262992384[0;39m ==> Parameters: 
2022-04-29 18:53:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424227262992384[0;39m <==    Updates: 0
2022-04-29 18:53:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424227262992384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:53:20.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424248247095296[0;39m 生成今日电子书快照开始
2022-04-29 18:53:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424248247095296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424248247095296[0;39m ==> Parameters: 
2022-04-29 18:53:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424248247095296[0;39m <==    Updates: 0
2022-04-29 18:53:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424248247095296[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:53:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424269206032384[0;39m 生成今日电子书快照开始
2022-04-29 18:53:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424269206032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424269206032384[0;39m ==> Parameters: 
2022-04-29 18:53:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424269206032384[0;39m <==    Updates: 0
2022-04-29 18:53:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424269206032384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:53:25.290 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424270401409024[0;39m ------------- 开始 -------------
2022-04-29 18:53:25.294 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424270401409024[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:53:25.295 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424270401409024[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:53:25.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424270401409024[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:25.299 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424270401409024[0;39m 请求参数: []
2022-04-29 18:53:25.549 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424270401409024[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:53:25.555 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424270401409024[0;39m ==> Parameters: 
2022-04-29 18:53:25.654 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:53:25.655 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:53:25.657 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:53:25.658 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:53:25.658 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:53:25.658 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:53:25.659 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:53:25.659 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:53:25.660 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:53:25.662 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:53:25.662 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:53:25.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:53:25.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:53:25.664 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:53:25.664 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:53:25.665 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:53:25.666 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:53:25.668 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:53:25.669 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424270401409024[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:53:25.671 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424270401409024[0;39m <==      Total: 18
2022-04-29 18:53:25.697 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424270401409024[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:53:25.697 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424270401409024[0;39m ------------- 结束 耗时：408 ms -------------
2022-04-29 18:53:25.835 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424272691499008[0;39m ------------- 开始 -------------
2022-04-29 18:53:25.836 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424272691499008[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:53:25.836 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424272691499008[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:53:25.836 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424272691499008[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:25.839 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424272691499008[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:53:26.262 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424272691499008[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:53:26.263 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424272691499008[0;39m ==> Parameters: 
2022-04-29 18:53:26.287 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424272691499008[0;39m <==    Columns: count(0)
2022-04-29 18:53:26.288 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424272691499008[0;39m <==        Row: 5
2022-04-29 18:53:26.289 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424272691499008[0;39m <==      Total: 1
2022-04-29 18:53:26.292 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424272691499008[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:53:26.293 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424272691499008[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:53:26.306 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:53:26.307 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:53:26.307 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:53:26.308 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:53:26.308 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:53:26.309 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424272691499008[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:53:26.309 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424272691499008[0;39m <==      Total: 5
2022-04-29 18:53:26.311 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175424272691499008[0;39m total rows：5
2022-04-29 18:53:26.311 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175424272691499008[0;39m total pages：1
2022-04-29 18:53:26.323 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424272691499008[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 18:53:26.323 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424272691499008[0;39m ------------- 结束 耗时：488 ms -------------
2022-04-29 18:53:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424290173358080[0;39m 生成今日电子书快照开始
2022-04-29 18:53:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424290173358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424290173358080[0;39m ==> Parameters: 
2022-04-29 18:53:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424290173358080[0;39m <==    Updates: 0
2022-04-29 18:53:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424290173358080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:53:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424311140683776[0;39m 生成今日电子书快照开始
2022-04-29 18:53:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424311140683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424311140683776[0;39m ==> Parameters: 
2022-04-29 18:53:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424311140683776[0;39m <==    Updates: 0
2022-04-29 18:53:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424311140683776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:53:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424311417507840[0;39m start updating Ebook doc
2022-04-29 18:53:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424311417507840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:53:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424311417507840[0;39m ==> Parameters: 
2022-04-29 18:53:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424311417507840[0;39m <==    Updates: 1
2022-04-29 18:53:35.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424311417507840[0;39m update ends, take 41 millisecs
2022-04-29 18:53:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424332141563904[0;39m 生成今日电子书快照开始
2022-04-29 18:53:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424332141563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424332141563904[0;39m ==> Parameters: 
2022-04-29 18:53:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424332141563904[0;39m <==    Updates: 0
2022-04-29 18:53:40.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424332141563904[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:53:40.296 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424333345329152[0;39m ------------- 开始 -------------
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424333345329152[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424333345329152[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424333345329152[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:40.297 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424333345329152[0;39m 请求参数: []
2022-04-29 18:53:40.315 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424333345329152[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-29 18:53:40.316 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424333345329152[0;39m ==> Parameters: 
2022-04-29 18:53:40.350 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==    Columns: id, parent, name, sort
2022-04-29 18:53:40.351 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-29 18:53:40.352 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-29 18:53:40.354 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 101, 100, Vue, 101
2022-04-29 18:53:40.371 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-29 18:53:40.373 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 200, 0, Java, 200
2022-04-29 18:53:40.375 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 201, 200, Basics, 201
2022-04-29 18:53:40.376 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-29 18:53:40.377 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-29 18:53:40.377 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 300, 0, Python, 300
2022-04-29 18:53:40.378 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-29 18:53:40.379 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-29 18:53:40.380 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 400, 0, Database, 400
2022-04-29 18:53:40.381 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-29 18:53:40.382 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-29 18:53:40.383 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 500, 0, Others, 500
2022-04-29 18:53:40.396 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 501, 500, Servers, 501
2022-04-29 18:53:40.396 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 502, 500, Tools, 502
2022-04-29 18:53:40.397 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175424333345329152[0;39m <==        Row: 503, 500, Languages, 503
2022-04-29 18:53:40.397 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175424333345329152[0;39m <==      Total: 18
2022-04-29 18:53:40.415 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424333345329152[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-29 18:53:40.415 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424333345329152[0;39m ------------- 结束 耗时：119 ms -------------
2022-04-29 18:53:40.657 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：lZnmgIKmxC，session id：0，当前连接数：1
2022-04-29 18:53:40.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424335316652032[0;39m ------------- 开始 -------------
2022-04-29 18:53:40.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424335316652032[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:53:40.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424335316652032[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:53:40.767 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424335316652032[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:40.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424335316652032[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:53:40.824 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424335316652032[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:53:40.825 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424335316652032[0;39m ==> Parameters: 
2022-04-29 18:53:40.838 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424335316652032[0;39m <==    Columns: count(0)
2022-04-29 18:53:40.839 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424335316652032[0;39m <==        Row: 5
2022-04-29 18:53:40.839 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424335316652032[0;39m <==      Total: 1
2022-04-29 18:53:40.840 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424335316652032[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:53:40.840 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424335316652032[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:53:40.860 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:53:40.860 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:53:40.861 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:53:40.861 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:53:40.862 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:53:40.864 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424335316652032[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:53:40.865 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424335316652032[0;39m <==      Total: 5
2022-04-29 18:53:40.866 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175424335316652032[0;39m total rows：5
2022-04-29 18:53:40.866 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175424335316652032[0;39m total pages：1
2022-04-29 18:53:40.884 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424335316652032[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-29 18:53:40.885 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424335316652032[0;39m ------------- 结束 耗时：120 ms -------------
2022-04-29 18:53:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424353108889600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424353108889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424353108889600[0;39m ==> Parameters: 
2022-04-29 18:53:45.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424353108889600[0;39m <==    Updates: 0
2022-04-29 18:53:45.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424353108889600[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:53:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424374080409600[0;39m 生成今日电子书快照开始
2022-04-29 18:53:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424374080409600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424374080409600[0;39m ==> Parameters: 
2022-04-29 18:53:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424374080409600[0;39m <==    Updates: 0
2022-04-29 18:53:50.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424374080409600[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:53:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424395026763776[0;39m 生成今日电子书快照开始
2022-04-29 18:53:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424395026763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:53:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424395026763776[0;39m ==> Parameters: 
2022-04-29 18:53:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424395026763776[0;39m <==    Updates: 0
2022-04-29 18:53:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424395026763776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:53:57.458 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:53:57.459 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:53:57.459 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:53:57.658 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m                  [0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:53:57.660 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424406175223808[0;39m ------------- 开始 -------------
2022-04-29 18:53:57.661 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424406175223808[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:53:57.661 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424406175223808[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:53:57.661 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424406175223808[0;39m 远程地址: 127.0.0.1
2022-04-29 18:53:57.662 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424406175223808[0;39m 请求参数: [{"category1Id":175294069419937792,"cover":"1","description":"1","docCount":0,"name":"1","viewCount":0,"voteCount":0}]
2022-04-29 18:54:04.665 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424435518574592[0;39m 生成今日电子书快照开始
2022-04-29 18:54:04.706 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424435518574592[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:04.713 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424435518574592[0;39m ==> Parameters: 
2022-04-29 18:54:04.719 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424406175223808[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:54:04.736 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424406175223808[0;39m ==> Parameters: 175424435505991680(Long), 1(String), 175294069419937792(Long), null, 1(String), 1(String), 0(Integer), 0(Integer), 0(Integer)
2022-04-29 18:54:04.757 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424435518574592[0;39m <==    Updates: 0
2022-04-29 18:54:04.760 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424435518574592[0;39m 生成今日电子书快照结束，耗时：86毫秒
2022-04-29 18:54:04.776 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424406175223808[0;39m <==    Updates: 1
2022-04-29 18:54:04.779 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424406175223808[0;39m 返回结果: {"success":true}
2022-04-29 18:54:04.780 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424406175223808[0;39m ------------- 结束 耗时：7120 ms -------------
2022-04-29 18:54:04.814 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175424406175223808[0;39m ------------- LoginInterceptor 结束 耗时：7355 ms -------------
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424436525207552[0;39m ------------- 开始 -------------
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424436525207552[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424436525207552[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:54:04.896 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424436525207552[0;39m 远程地址: 127.0.0.1
2022-04-29 18:54:04.897 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424436525207552[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:54:04.899 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424436525207552[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:54:04.899 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424436525207552[0;39m ==> Parameters: 
2022-04-29 18:54:04.921 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424436525207552[0;39m <==    Columns: count(0)
2022-04-29 18:54:04.923 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175424436525207552[0;39m <==        Row: 6
2022-04-29 18:54:04.924 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175424436525207552[0;39m <==      Total: 1
2022-04-29 18:54:04.926 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424436525207552[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:54:04.926 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424436525207552[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:54:04.945 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:54:04.946 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:54:04.946 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:54:04.947 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:54:04.952 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:54:04.953 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:54:04.954 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175424436525207552[0;39m <==        Row: 175424435505991680, 1, 175294069419937792, null, 1, 1, 0, 0, 0
2022-04-29 18:54:04.960 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175424436525207552[0;39m <==      Total: 6
2022-04-29 18:54:04.960 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175424436525207552[0;39m total rows：6
2022-04-29 18:54:04.961 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175424436525207552[0;39m total pages：1
2022-04-29 18:54:04.968 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424436525207552[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2},{"category1Id":175294069419937792,"cover":"1","description":"1","docCount":0,"id":175424435505991680,"name":"1","viewCount":0,"voteCount":0}],"total":6},"success":true}
2022-04-29 18:54:04.968 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424436525207552[0;39m ------------- 结束 耗时：72 ms -------------
2022-04-29 18:54:05.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424436990775296[0;39m 生成今日电子书快照开始
2022-04-29 18:54:05.008 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424436990775296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:05.008 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424436990775296[0;39m ==> Parameters: 
2022-04-29 18:54:05.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424436990775296[0;39m <==    Updates: 1
2022-04-29 18:54:05.048 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424436990775296[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-29 18:54:05.049 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424437166936064[0;39m start updating Ebook doc
2022-04-29 18:54:05.050 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424437166936064[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:54:05.051 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424437166936064[0;39m ==> Parameters: 
2022-04-29 18:54:05.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424437166936064[0;39m <==    Updates: 1
2022-04-29 18:54:05.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424437166936064[0;39m update ends, take 51 millisecs
2022-04-29 18:54:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424457974878208[0;39m 生成今日电子书快照开始
2022-04-29 18:54:10.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424457974878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:10.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424457974878208[0;39m ==> Parameters: 
2022-04-29 18:54:10.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424457974878208[0;39m <==    Updates: 0
2022-04-29 18:54:10.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424457974878208[0;39m 生成今日电子书快照结束，耗时：79毫秒
2022-04-29 18:54:15.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424478942203904[0;39m 生成今日电子书快照开始
2022-04-29 18:54:15.049 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424478942203904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:15.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424478942203904[0;39m ==> Parameters: 
2022-04-29 18:54:15.092 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424478942203904[0;39m <==    Updates: 0
2022-04-29 18:54:15.092 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424478942203904[0;39m 生成今日电子书快照结束，耗时：83毫秒
2022-04-29 18:54:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424499884363776[0;39m 生成今日电子书快照开始
2022-04-29 18:54:20.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424499884363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:20.041 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424499884363776[0;39m ==> Parameters: 
2022-04-29 18:54:20.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424499884363776[0;39m <==    Updates: 0
2022-04-29 18:54:20.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424499884363776[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 18:54:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424520855883776[0;39m 生成今日电子书快照开始
2022-04-29 18:54:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424520855883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424520855883776[0;39m ==> Parameters: 
2022-04-29 18:54:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424520855883776[0;39m <==    Updates: 0
2022-04-29 18:54:25.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424520855883776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 18:54:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424541860958208[0;39m 生成今日电子书快照开始
2022-04-29 18:54:30.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424541860958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:30.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424541860958208[0;39m ==> Parameters: 
2022-04-29 18:54:30.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424541860958208[0;39m <==    Updates: 0
2022-04-29 18:54:30.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424541860958208[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:54:35.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424562824089600[0;39m 生成今日电子书快照开始
2022-04-29 18:54:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424562824089600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424562824089600[0;39m ==> Parameters: 
2022-04-29 18:54:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424562824089600[0;39m <==    Updates: 0
2022-04-29 18:54:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424562824089600[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:54:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424563084136448[0;39m start updating Ebook doc
2022-04-29 18:54:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424563084136448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:54:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424563084136448[0;39m ==> Parameters: 
2022-04-29 18:54:35.114 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424563084136448[0;39m <==    Updates: 1
2022-04-29 18:54:35.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424563084136448[0;39m update ends, take 44 millisecs
2022-04-29 18:54:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424583787220992[0;39m 生成今日电子书快照开始
2022-04-29 18:54:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424583787220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:40.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424583787220992[0;39m ==> Parameters: 
2022-04-29 18:54:40.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424583787220992[0;39m <==    Updates: 0
2022-04-29 18:54:40.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424583787220992[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 18:54:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424604775518208[0;39m 生成今日电子书快照开始
2022-04-29 18:54:45.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424604775518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:45.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424604775518208[0;39m ==> Parameters: 
2022-04-29 18:54:45.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424604775518208[0;39m <==    Updates: 0
2022-04-29 18:54:45.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424604775518208[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:54:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424625709289472[0;39m 生成今日电子书快照开始
2022-04-29 18:54:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424625709289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424625709289472[0;39m ==> Parameters: 
2022-04-29 18:54:50.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424625709289472[0;39m <==    Updates: 0
2022-04-29 18:54:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424625709289472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:54:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424646693392384[0;39m 生成今日电子书快照开始
2022-04-29 18:54:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424646693392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:54:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424646693392384[0;39m ==> Parameters: 
2022-04-29 18:54:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424646693392384[0;39m <==    Updates: 0
2022-04-29 18:54:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424646693392384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:55:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424667685883904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424667685883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:00.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424667685883904[0;39m ==> Parameters: 
2022-04-29 18:55:00.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424667685883904[0;39m <==    Updates: 0
2022-04-29 18:55:00.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424667685883904[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 18:55:05.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424688657403904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:05.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424688657403904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:05.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424688657403904[0;39m ==> Parameters: 
2022-04-29 18:55:05.127 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424688657403904[0;39m <==    Updates: 0
2022-04-29 18:55:05.128 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424688657403904[0;39m 生成今日电子书快照结束，耗时：117毫秒
2022-04-29 18:55:05.128 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424689156526080[0;39m start updating Ebook doc
2022-04-29 18:55:05.129 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424689156526080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:55:05.129 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424689156526080[0;39m ==> Parameters: 
2022-04-29 18:55:05.181 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424689156526080[0;39m <==    Updates: 1
2022-04-29 18:55:05.182 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424689156526080[0;39m update ends, take 54 millisecs
2022-04-29 18:55:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424709628923904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424709628923904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424709628923904[0;39m ==> Parameters: 
2022-04-29 18:55:10.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424709628923904[0;39m <==    Updates: 0
2022-04-29 18:55:10.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424709628923904[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:55:15.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424730600443904[0;39m 生成今日电子书快照开始
2022-04-29 18:55:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424730600443904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424730600443904[0;39m ==> Parameters: 
2022-04-29 18:55:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424730600443904[0;39m <==    Updates: 0
2022-04-29 18:55:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424730600443904[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:55:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424751546798080[0;39m 生成今日电子书快照开始
2022-04-29 18:55:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424751546798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424751546798080[0;39m ==> Parameters: 
2022-04-29 18:55:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424751546798080[0;39m <==    Updates: 0
2022-04-29 18:55:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424751546798080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:55:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424772530900992[0;39m 生成今日电子书快照开始
2022-04-29 18:55:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424772530900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424772530900992[0;39m ==> Parameters: 
2022-04-29 18:55:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424772530900992[0;39m <==    Updates: 0
2022-04-29 18:55:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424772530900992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:55:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424793477255168[0;39m 生成今日电子书快照开始
2022-04-29 18:55:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424793477255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424793477255168[0;39m ==> Parameters: 
2022-04-29 18:55:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424793477255168[0;39m <==    Updates: 0
2022-04-29 18:55:30.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424793477255168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:55:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424814478135296[0;39m 生成今日电子书快照开始
2022-04-29 18:55:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424814478135296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424814478135296[0;39m ==> Parameters: 
2022-04-29 18:55:35.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424814478135296[0;39m <==    Updates: 0
2022-04-29 18:55:35.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424814478135296[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:55:35.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424814750765056[0;39m start updating Ebook doc
2022-04-29 18:55:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424814750765056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:55:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424814750765056[0;39m ==> Parameters: 
2022-04-29 18:55:35.115 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424814750765056[0;39m <==    Updates: 1
2022-04-29 18:55:35.116 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424814750765056[0;39m update ends, take 44 millisecs
2022-04-29 18:55:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424835462238208[0;39m 生成今日电子书快照开始
2022-04-29 18:55:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424835462238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424835462238208[0;39m ==> Parameters: 
2022-04-29 18:55:40.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424835462238208[0;39m <==    Updates: 0
2022-04-29 18:55:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424835462238208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 18:55:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424856412786688[0;39m 生成今日电子书快照开始
2022-04-29 18:55:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424856412786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424856412786688[0;39m ==> Parameters: 
2022-04-29 18:55:45.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424856412786688[0;39m <==    Updates: 0
2022-04-29 18:55:45.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424856412786688[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 18:55:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424877371723776[0;39m 生成今日电子书快照开始
2022-04-29 18:55:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424877371723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424877371723776[0;39m ==> Parameters: 
2022-04-29 18:55:50.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424877371723776[0;39m <==    Updates: 0
2022-04-29 18:55:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424877371723776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:55:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424898360020992[0;39m 生成今日电子书快照开始
2022-04-29 18:55:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424898360020992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:55:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424898360020992[0;39m ==> Parameters: 
2022-04-29 18:55:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424898360020992[0;39m <==    Updates: 0
2022-04-29 18:55:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424898360020992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 18:56:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424919314763776[0;39m 生成今日电子书快照开始
2022-04-29 18:56:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424919314763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424919314763776[0;39m ==> Parameters: 
2022-04-29 18:56:00.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424919314763776[0;39m <==    Updates: 0
2022-04-29 18:56:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424919314763776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:56:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424940282089472[0;39m 生成今日电子书快照开始
2022-04-29 18:56:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424940282089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424940282089472[0;39m ==> Parameters: 
2022-04-29 18:56:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424940282089472[0;39m <==    Updates: 0
2022-04-29 18:56:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424940282089472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:56:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175424940550524928[0;39m start updating Ebook doc
2022-04-29 18:56:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424940550524928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:56:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424940550524928[0;39m ==> Parameters: 
2022-04-29 18:56:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175424940550524928[0;39m <==    Updates: 1
2022-04-29 18:56:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175424940550524928[0;39m update ends, take 41 millisecs
2022-04-29 18:56:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424961270386688[0;39m 生成今日电子书快照开始
2022-04-29 18:56:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424961270386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424961270386688[0;39m ==> Parameters: 
2022-04-29 18:56:10.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424961270386688[0;39m <==    Updates: 0
2022-04-29 18:56:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424961270386688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 18:56:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175424982237712384[0;39m 生成今日电子书快照开始
2022-04-29 18:56:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424982237712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424982237712384[0;39m ==> Parameters: 
2022-04-29 18:56:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175424982237712384[0;39m <==    Updates: 0
2022-04-29 18:56:15.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175424982237712384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:56:16.731 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175422965134004224[0;39m ------------- LoginInterceptor start -------------
2022-04-29 18:56:16.732 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175422965134004224[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/ebook/save
2022-04-29 18:56:16.732 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175422965134004224[0;39m 登录校验开始，token：175419540539314176
2022-04-29 18:56:16.931 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175422965134004224[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175419540539314176"}
2022-04-29 18:56:16.936 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175424990341107712[0;39m ------------- 开始 -------------
2022-04-29 18:56:16.936 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175424990341107712[0;39m 请求地址: http://127.0.0.1:8080/ebook/save POST
2022-04-29 18:56:16.936 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175424990341107712[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.save
2022-04-29 18:56:16.937 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175424990341107712[0;39m 远程地址: 127.0.0.1
2022-04-29 18:56:16.939 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175424990341107712[0;39m 请求参数: [{"category1Id":200,"category2Id":201,"docCount":0,"name":"Spring","viewCount":0,"voteCount":0}]
2022-04-29 18:56:28.269 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425037870960640[0;39m 生成今日电子书快照开始
2022-04-29 18:56:28.286 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424990341107712[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2022-04-29 18:56:28.287 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424990341107712[0;39m ==> Parameters: 175425037875154944(Long), Spring(String), 200(Long), 201(Long), null, null, 0(Integer), 0(Integer), 0(Integer)
2022-04-29 18:56:28.288 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425037870960640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:28.289 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425037870960640[0;39m ==> Parameters: 
2022-04-29 18:56:28.321 DEBUG com.ameliawiki.wiki.mapper.EbookMapper.insert     :137  [32m175424990341107712[0;39m <==    Updates: 1
2022-04-29 18:56:28.322 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175424990341107712[0;39m 返回结果: {"success":true}
2022-04-29 18:56:28.322 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175424990341107712[0;39m ------------- 结束 耗时：11386 ms -------------
2022-04-29 18:56:28.323 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175424990341107712[0;39m ------------- LoginInterceptor 结束 耗时：11591 ms -------------
2022-04-29 18:56:28.327 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425037870960640[0;39m <==    Updates: 1
2022-04-29 18:56:28.327 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425037870960640[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:56:28.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175425038252642304[0;39m ------------- 开始 -------------
2022-04-29 18:56:28.360 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175425038252642304[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-29 18:56:28.360 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175425038252642304[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-29 18:56:28.360 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175425038252642304[0;39m 远程地址: 127.0.0.1
2022-04-29 18:56:28.362 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175425038252642304[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-29 18:56:28.364 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175425038252642304[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-29 18:56:28.365 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175425038252642304[0;39m ==> Parameters: 
2022-04-29 18:56:28.379 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175425038252642304[0;39m <==    Columns: count(0)
2022-04-29 18:56:28.380 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175425038252642304[0;39m <==        Row: 7
2022-04-29 18:56:28.380 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175425038252642304[0;39m <==      Total: 1
2022-04-29 18:56:28.381 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175425038252642304[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-29 18:56:28.382 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175425038252642304[0;39m ==> Parameters: 10(Integer)
2022-04-29 18:56:28.397 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-29 18:56:28.398 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-29 18:56:28.399 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-29 18:56:28.399 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-29 18:56:28.402 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-29 18:56:28.403 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-29 18:56:28.404 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 175424435505991680, 1, 175294069419937792, null, 1, 1, 0, 0, 0
2022-04-29 18:56:28.405 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175425038252642304[0;39m <==        Row: 175425037875154944, Spring, 200, 201, null, null, 0, 0, 0
2022-04-29 18:56:28.406 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175425038252642304[0;39m <==      Total: 7
2022-04-29 18:56:28.407 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175425038252642304[0;39m total rows：7
2022-04-29 18:56:28.407 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175425038252642304[0;39m total pages：1
2022-04-29 18:56:28.408 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175425038252642304[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2},{"category1Id":175294069419937792,"cover":"1","description":"1","docCount":0,"id":175424435505991680,"name":"1","viewCount":0,"voteCount":0},{"category1Id":200,"category2Id":201,"docCount":0,"id":175425037875154944,"name":"Spring","viewCount":0,"voteCount":0}],"total":7},"success":true}
2022-04-29 18:56:28.409 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175425038252642304[0;39m ------------- 结束 耗时：50 ms -------------
2022-04-29 18:56:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425045135495168[0;39m 生成今日电子书快照开始
2022-04-29 18:56:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425045135495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425045135495168[0;39m ==> Parameters: 
2022-04-29 18:56:30.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425045135495168[0;39m <==    Updates: 0
2022-04-29 18:56:30.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425045135495168[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:56:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425066111209472[0;39m 生成今日电子书快照开始
2022-04-29 18:56:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425066111209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425066111209472[0;39m ==> Parameters: 
2022-04-29 18:56:35.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425066111209472[0;39m <==    Updates: 0
2022-04-29 18:56:35.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425066111209472[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 18:56:35.075 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425066421587968[0;39m start updating Ebook doc
2022-04-29 18:56:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425066421587968[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:56:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425066421587968[0;39m ==> Parameters: 
2022-04-29 18:56:35.116 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425066421587968[0;39m <==    Updates: 1
2022-04-29 18:56:35.116 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425066421587968[0;39m update ends, take 41 millisecs
2022-04-29 18:56:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425087078535168[0;39m 生成今日电子书快照开始
2022-04-29 18:56:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425087078535168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425087078535168[0;39m ==> Parameters: 
2022-04-29 18:56:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425087078535168[0;39m <==    Updates: 0
2022-04-29 18:56:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425087078535168[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:56:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425108058443776[0;39m 生成今日电子书快照开始
2022-04-29 18:56:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425108058443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425108058443776[0;39m ==> Parameters: 
2022-04-29 18:56:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425108058443776[0;39m <==    Updates: 0
2022-04-29 18:56:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425108058443776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:56:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425129025769472[0;39m 生成今日电子书快照开始
2022-04-29 18:56:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425129025769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425129025769472[0;39m ==> Parameters: 
2022-04-29 18:56:50.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425129025769472[0;39m <==    Updates: 0
2022-04-29 18:56:50.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425129025769472[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:56:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425150009872384[0;39m 生成今日电子书快照开始
2022-04-29 18:56:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425150009872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:56:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425150009872384[0;39m ==> Parameters: 
2022-04-29 18:56:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425150009872384[0;39m <==    Updates: 0
2022-04-29 18:56:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425150009872384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:57:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425170973003776[0;39m 生成今日电子书快照开始
2022-04-29 18:57:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425170973003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425170973003776[0;39m ==> Parameters: 
2022-04-29 18:57:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425170973003776[0;39m <==    Updates: 0
2022-04-29 18:57:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425170973003776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:57:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425191948718080[0;39m 生成今日电子书快照开始
2022-04-29 18:57:05.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425191948718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425191948718080[0;39m ==> Parameters: 
2022-04-29 18:57:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425191948718080[0;39m <==    Updates: 0
2022-04-29 18:57:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425191948718080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:57:05.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425192200376320[0;39m start updating Ebook doc
2022-04-29 18:57:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425192200376320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:57:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425192200376320[0;39m ==> Parameters: 
2022-04-29 18:57:05.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425192200376320[0;39m <==    Updates: 1
2022-04-29 18:57:05.103 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425192200376320[0;39m update ends, take 40 millisecs
2022-04-29 18:57:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425212920238080[0;39m 生成今日电子书快照开始
2022-04-29 18:57:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425212920238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425212920238080[0;39m ==> Parameters: 
2022-04-29 18:57:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425212920238080[0;39m <==    Updates: 0
2022-04-29 18:57:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425212920238080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 18:57:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425233879175168[0;39m 生成今日电子书快照开始
2022-04-29 18:57:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425233879175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425233879175168[0;39m ==> Parameters: 
2022-04-29 18:57:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425233879175168[0;39m <==    Updates: 0
2022-04-29 18:57:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425233879175168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:57:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425254867472384[0;39m 生成今日电子书快照开始
2022-04-29 18:57:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425254867472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:20.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425254867472384[0;39m ==> Parameters: 
2022-04-29 18:57:20.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425254867472384[0;39m <==    Updates: 0
2022-04-29 18:57:20.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425254867472384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:57:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425275830603776[0;39m 生成今日电子书快照开始
2022-04-29 18:57:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425275830603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425275830603776[0;39m ==> Parameters: 
2022-04-29 18:57:25.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425275830603776[0;39m <==    Updates: 0
2022-04-29 18:57:25.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425275830603776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 18:57:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425296814706688[0;39m 生成今日电子书快照开始
2022-04-29 18:57:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425296814706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:30.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425296814706688[0;39m ==> Parameters: 
2022-04-29 18:57:30.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425296814706688[0;39m <==    Updates: 0
2022-04-29 18:57:30.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425296814706688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:57:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425317773643776[0;39m 生成今日电子书快照开始
2022-04-29 18:57:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425317773643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425317773643776[0;39m ==> Parameters: 
2022-04-29 18:57:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425317773643776[0;39m <==    Updates: 0
2022-04-29 18:57:35.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425317773643776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:57:35.073 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425318071439360[0;39m start updating Ebook doc
2022-04-29 18:57:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425318071439360[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:57:35.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425318071439360[0;39m ==> Parameters: 
2022-04-29 18:57:35.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425318071439360[0;39m <==    Updates: 1
2022-04-29 18:57:35.119 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425318071439360[0;39m update ends, take 46 millisecs
2022-04-29 18:57:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425338740969472[0;39m 生成今日电子书快照开始
2022-04-29 18:57:40.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425338740969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:40.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425338740969472[0;39m ==> Parameters: 
2022-04-29 18:57:40.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425338740969472[0;39m <==    Updates: 0
2022-04-29 18:57:40.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425338740969472[0;39m 生成今日电子书快照结束，耗时：79毫秒
2022-04-29 18:57:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425359712489472[0;39m 生成今日电子书快照开始
2022-04-29 18:57:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425359712489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425359712489472[0;39m ==> Parameters: 
2022-04-29 18:57:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425359712489472[0;39m <==    Updates: 0
2022-04-29 18:57:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425359712489472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:57:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425380700786688[0;39m 生成今日电子书快照开始
2022-04-29 18:57:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425380700786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425380700786688[0;39m ==> Parameters: 
2022-04-29 18:57:50.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425380700786688[0;39m <==    Updates: 0
2022-04-29 18:57:50.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425380700786688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 18:57:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425401655529472[0;39m 生成今日电子书快照开始
2022-04-29 18:57:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425401655529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:57:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425401655529472[0;39m ==> Parameters: 
2022-04-29 18:57:55.187 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425401655529472[0;39m <==    Updates: 0
2022-04-29 18:57:55.188 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425401655529472[0;39m 生成今日电子书快照结束，耗时：187毫秒
2022-04-29 18:58:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425422631243776[0;39m 生成今日电子书快照开始
2022-04-29 18:58:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425422631243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425422631243776[0;39m ==> Parameters: 
2022-04-29 18:58:00.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425422631243776[0;39m <==    Updates: 0
2022-04-29 18:58:00.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425422631243776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:58:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425443611152384[0;39m 生成今日电子书快照开始
2022-04-29 18:58:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425443611152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425443611152384[0;39m ==> Parameters: 
2022-04-29 18:58:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425443611152384[0;39m <==    Updates: 0
2022-04-29 18:58:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425443611152384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:58:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425443892170752[0;39m start updating Ebook doc
2022-04-29 18:58:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425443892170752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:58:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425443892170752[0;39m ==> Parameters: 
2022-04-29 18:58:05.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425443892170752[0;39m <==    Updates: 1
2022-04-29 18:58:05.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425443892170752[0;39m update ends, take 38 millisecs
2022-04-29 18:58:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425464586866688[0;39m 生成今日电子书快照开始
2022-04-29 18:58:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425464586866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:10.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425464586866688[0;39m ==> Parameters: 
2022-04-29 18:58:10.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425464586866688[0;39m <==    Updates: 0
2022-04-29 18:58:10.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425464586866688[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 18:58:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425485549998080[0;39m 生成今日电子书快照开始
2022-04-29 18:58:15.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425485549998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:15.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425485549998080[0;39m ==> Parameters: 
2022-04-29 18:58:15.095 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425485549998080[0;39m <==    Updates: 0
2022-04-29 18:58:15.095 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425485549998080[0;39m 生成今日电子书快照结束，耗时：92毫秒
2022-04-29 18:58:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425506521518080[0;39m 生成今日电子书快照开始
2022-04-29 18:58:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425506521518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425506521518080[0;39m ==> Parameters: 
2022-04-29 18:58:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425506521518080[0;39m <==    Updates: 0
2022-04-29 18:58:20.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425506521518080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 18:58:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425527493038080[0;39m 生成今日电子书快照开始
2022-04-29 18:58:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425527493038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425527493038080[0;39m ==> Parameters: 
2022-04-29 18:58:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425527493038080[0;39m <==    Updates: 0
2022-04-29 18:58:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425527493038080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:58:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425548468752384[0;39m 生成今日电子书快照开始
2022-04-29 18:58:30.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425548468752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:30.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425548468752384[0;39m ==> Parameters: 
2022-04-29 18:58:30.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425548468752384[0;39m <==    Updates: 0
2022-04-29 18:58:30.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425548468752384[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 18:58:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425569436078080[0;39m start updating Ebook doc
2022-04-29 18:58:35.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425569436078080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:58:35.030 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425569436078080[0;39m ==> Parameters: 
2022-04-29 18:58:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425569436078080[0;39m <==    Updates: 1
2022-04-29 18:58:35.074 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425569436078080[0;39m update ends, take 70 millisecs
2022-04-29 18:58:35.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425569738067968[0;39m 生成今日电子书快照开始
2022-04-29 18:58:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425569738067968[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:35.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425569738067968[0;39m ==> Parameters: 
2022-04-29 18:58:35.127 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425569738067968[0;39m <==    Updates: 0
2022-04-29 18:58:35.128 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425569738067968[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 18:58:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425590415986688[0;39m 生成今日电子书快照开始
2022-04-29 18:58:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425590415986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425590415986688[0;39m ==> Parameters: 
2022-04-29 18:58:40.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425590415986688[0;39m <==    Updates: 0
2022-04-29 18:58:40.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425590415986688[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 18:58:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425611383312384[0;39m 生成今日电子书快照开始
2022-04-29 18:58:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425611383312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425611383312384[0;39m ==> Parameters: 
2022-04-29 18:58:45.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425611383312384[0;39m <==    Updates: 0
2022-04-29 18:58:45.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425611383312384[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 18:58:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425632359026688[0;39m 生成今日电子书快照开始
2022-04-29 18:58:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425632359026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425632359026688[0;39m ==> Parameters: 
2022-04-29 18:58:50.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425632359026688[0;39m <==    Updates: 0
2022-04-29 18:58:50.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425632359026688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 18:58:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425653317963776[0;39m 生成今日电子书快照开始
2022-04-29 18:58:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425653317963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:58:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425653317963776[0;39m ==> Parameters: 
2022-04-29 18:58:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425653317963776[0;39m <==    Updates: 0
2022-04-29 18:58:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425653317963776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 18:59:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425674285289472[0;39m 生成今日电子书快照开始
2022-04-29 18:59:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425674285289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425674285289472[0;39m ==> Parameters: 
2022-04-29 18:59:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425674285289472[0;39m <==    Updates: 0
2022-04-29 18:59:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425674285289472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 18:59:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425695269392384[0;39m 生成今日电子书快照开始
2022-04-29 18:59:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425695269392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425695269392384[0;39m ==> Parameters: 
2022-04-29 18:59:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425695269392384[0;39m <==    Updates: 0
2022-04-29 18:59:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425695269392384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 18:59:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425695529439232[0;39m start updating Ebook doc
2022-04-29 18:59:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425695529439232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:59:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425695529439232[0;39m ==> Parameters: 
2022-04-29 18:59:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425695529439232[0;39m <==    Updates: 1
2022-04-29 18:59:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425695529439232[0;39m update ends, take 40 millisecs
2022-04-29 18:59:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425716245106688[0;39m 生成今日电子书快照开始
2022-04-29 18:59:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425716245106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425716245106688[0;39m ==> Parameters: 
2022-04-29 18:59:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425716245106688[0;39m <==    Updates: 0
2022-04-29 18:59:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425716245106688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 18:59:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425737204043776[0;39m 生成今日电子书快照开始
2022-04-29 18:59:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425737204043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425737204043776[0;39m ==> Parameters: 
2022-04-29 18:59:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425737204043776[0;39m <==    Updates: 0
2022-04-29 18:59:15.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425737204043776[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 18:59:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425758183952384[0;39m 生成今日电子书快照开始
2022-04-29 18:59:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425758183952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425758183952384[0;39m ==> Parameters: 
2022-04-29 18:59:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425758183952384[0;39m <==    Updates: 0
2022-04-29 18:59:20.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425758183952384[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 18:59:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425779155472384[0;39m 生成今日电子书快照开始
2022-04-29 18:59:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425779155472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425779155472384[0;39m ==> Parameters: 
2022-04-29 18:59:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425779155472384[0;39m <==    Updates: 0
2022-04-29 18:59:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425779155472384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 18:59:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425800131186688[0;39m 生成今日电子书快照开始
2022-04-29 18:59:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425800131186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425800131186688[0;39m ==> Parameters: 
2022-04-29 18:59:30.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425800131186688[0;39m <==    Updates: 0
2022-04-29 18:59:30.113 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425800131186688[0;39m 生成今日电子书快照结束，耗时：107毫秒
2022-04-29 18:59:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425821090123776[0;39m 生成今日电子书快照开始
2022-04-29 18:59:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425821090123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:35.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425821090123776[0;39m ==> Parameters: 
2022-04-29 18:59:35.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425821090123776[0;39m <==    Updates: 0
2022-04-29 18:59:35.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425821090123776[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 18:59:35.081 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425821421473792[0;39m start updating Ebook doc
2022-04-29 18:59:35.081 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425821421473792[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 18:59:35.082 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425821421473792[0;39m ==> Parameters: 
2022-04-29 18:59:35.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425821421473792[0;39m <==    Updates: 1
2022-04-29 18:59:35.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425821421473792[0;39m update ends, take 39 millisecs
2022-04-29 18:59:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425842065838080[0;39m 生成今日电子书快照开始
2022-04-29 18:59:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425842065838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425842065838080[0;39m ==> Parameters: 
2022-04-29 18:59:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425842065838080[0;39m <==    Updates: 0
2022-04-29 18:59:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425842065838080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:59:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425863033163776[0;39m 生成今日电子书快照开始
2022-04-29 18:59:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425863033163776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425863033163776[0;39m ==> Parameters: 
2022-04-29 18:59:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425863033163776[0;39m <==    Updates: 0
2022-04-29 18:59:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425863033163776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 18:59:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425884017266688[0;39m 生成今日电子书快照开始
2022-04-29 18:59:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425884017266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425884017266688[0;39m ==> Parameters: 
2022-04-29 18:59:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425884017266688[0;39m <==    Updates: 0
2022-04-29 18:59:50.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425884017266688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 18:59:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425904967815168[0;39m 生成今日电子书快照开始
2022-04-29 18:59:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425904967815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 18:59:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425904967815168[0;39m ==> Parameters: 
2022-04-29 18:59:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425904967815168[0;39m <==    Updates: 0
2022-04-29 18:59:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425904967815168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:00:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425925951918080[0;39m 生成今日电子书快照开始
2022-04-29 19:00:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425925951918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425925951918080[0;39m ==> Parameters: 
2022-04-29 19:00:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425925951918080[0;39m <==    Updates: 0
2022-04-29 19:00:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425925951918080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:00:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425946927632384[0;39m 生成今日电子书快照开始
2022-04-29 19:00:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425946927632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425946927632384[0;39m ==> Parameters: 
2022-04-29 19:00:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425946927632384[0;39m <==    Updates: 0
2022-04-29 19:00:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425946927632384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:00:05.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175425947196067840[0;39m start updating Ebook doc
2022-04-29 19:00:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425947196067840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:00:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425947196067840[0;39m ==> Parameters: 
2022-04-29 19:00:05.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175425947196067840[0;39m <==    Updates: 1
2022-04-29 19:00:05.107 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175425947196067840[0;39m update ends, take 39 millisecs
2022-04-29 19:00:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425967890763776[0;39m 生成今日电子书快照开始
2022-04-29 19:00:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425967890763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425967890763776[0;39m ==> Parameters: 
2022-04-29 19:00:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425967890763776[0;39m <==    Updates: 0
2022-04-29 19:00:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425967890763776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:00:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175425988879060992[0;39m 生成今日电子书快照开始
2022-04-29 19:00:15.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425988879060992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:15.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425988879060992[0;39m ==> Parameters: 
2022-04-29 19:00:15.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175425988879060992[0;39m <==    Updates: 0
2022-04-29 19:00:15.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175425988879060992[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:00:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426009837998080[0;39m 生成今日电子书快照开始
2022-04-29 19:00:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426009837998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426009837998080[0;39m ==> Parameters: 
2022-04-29 19:00:20.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426009837998080[0;39m <==    Updates: 0
2022-04-29 19:00:20.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426009837998080[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 19:00:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426030805323776[0;39m 生成今日电子书快照开始
2022-04-29 19:00:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426030805323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426030805323776[0;39m ==> Parameters: 
2022-04-29 19:00:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426030805323776[0;39m <==    Updates: 0
2022-04-29 19:00:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426030805323776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:00:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426051781038080[0;39m 生成今日电子书快照开始
2022-04-29 19:00:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426051781038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426051781038080[0;39m ==> Parameters: 
2022-04-29 19:00:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426051781038080[0;39m <==    Updates: 0
2022-04-29 19:00:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426051781038080[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:00:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426072756752384[0;39m 生成今日电子书快照开始
2022-04-29 19:00:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426072756752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:35.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426072756752384[0;39m ==> Parameters: 
2022-04-29 19:00:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426072756752384[0;39m <==    Updates: 0
2022-04-29 19:00:35.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426072756752384[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:00:35.074 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426073050353664[0;39m start updating Ebook doc
2022-04-29 19:00:35.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426073050353664[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:00:35.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426073050353664[0;39m ==> Parameters: 
2022-04-29 19:00:35.113 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426073050353664[0;39m <==    Updates: 1
2022-04-29 19:00:35.113 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426073050353664[0;39m update ends, take 39 millisecs
2022-04-29 19:00:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426093711495168[0;39m 生成今日电子书快照开始
2022-04-29 19:00:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426093711495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426093711495168[0;39m ==> Parameters: 
2022-04-29 19:00:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426093711495168[0;39m <==    Updates: 0
2022-04-29 19:00:40.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426093711495168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:00:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426114703986688[0;39m 生成今日电子书快照开始
2022-04-29 19:00:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426114703986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426114703986688[0;39m ==> Parameters: 
2022-04-29 19:00:45.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426114703986688[0;39m <==    Updates: 0
2022-04-29 19:00:45.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426114703986688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:00:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426135654535168[0;39m 生成今日电子书快照开始
2022-04-29 19:00:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426135654535168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426135654535168[0;39m ==> Parameters: 
2022-04-29 19:00:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426135654535168[0;39m <==    Updates: 0
2022-04-29 19:00:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426135654535168[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:00:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426156642832384[0;39m 生成今日电子书快照开始
2022-04-29 19:00:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426156642832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:00:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426156642832384[0;39m ==> Parameters: 
2022-04-29 19:00:55.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426156642832384[0;39m <==    Updates: 0
2022-04-29 19:00:55.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426156642832384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 19:01:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426177605963776[0;39m 生成今日电子书快照开始
2022-04-29 19:01:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426177605963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426177605963776[0;39m ==> Parameters: 
2022-04-29 19:01:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426177605963776[0;39m <==    Updates: 0
2022-04-29 19:01:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426177605963776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:01:05.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426198569095168[0;39m start updating Ebook doc
2022-04-29 19:01:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426198569095168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:01:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426198569095168[0;39m ==> Parameters: 
2022-04-29 19:01:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426198569095168[0;39m <==    Updates: 1
2022-04-29 19:01:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426198569095168[0;39m update ends, take 65 millisecs
2022-04-29 19:01:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426198850113536[0;39m 生成今日电子书快照开始
2022-04-29 19:01:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426198850113536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426198850113536[0;39m ==> Parameters: 
2022-04-29 19:01:05.119 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426198850113536[0;39m <==    Updates: 0
2022-04-29 19:01:05.120 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426198850113536[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 19:01:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426219553198080[0;39m 生成今日电子书快照开始
2022-04-29 19:01:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426219553198080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426219553198080[0;39m ==> Parameters: 
2022-04-29 19:01:10.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426219553198080[0;39m <==    Updates: 0
2022-04-29 19:01:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426219553198080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:01:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426240537300992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426240537300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426240537300992[0;39m ==> Parameters: 
2022-04-29 19:01:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426240537300992[0;39m <==    Updates: 0
2022-04-29 19:01:15.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426240537300992[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:01:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426261492043776[0;39m 生成今日电子书快照开始
2022-04-29 19:01:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426261492043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426261492043776[0;39m ==> Parameters: 
2022-04-29 19:01:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426261492043776[0;39m <==    Updates: 0
2022-04-29 19:01:20.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426261492043776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 19:01:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426282480340992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426282480340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426282480340992[0;39m ==> Parameters: 
2022-04-29 19:01:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426282480340992[0;39m <==    Updates: 0
2022-04-29 19:01:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426282480340992[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:01:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426303443472384[0;39m 生成今日电子书快照开始
2022-04-29 19:01:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426303443472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426303443472384[0;39m ==> Parameters: 
2022-04-29 19:01:30.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426303443472384[0;39m <==    Updates: 0
2022-04-29 19:01:30.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426303443472384[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:01:35.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426324435963904[0;39m start updating Ebook doc
2022-04-29 19:01:35.036 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426324435963904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:01:35.037 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426324435963904[0;39m ==> Parameters: 
2022-04-29 19:01:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426324435963904[0;39m <==    Updates: 1
2022-04-29 19:01:35.076 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426324435963904[0;39m update ends, take 66 millisecs
2022-04-29 19:01:35.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426324721176576[0;39m 生成今日电子书快照开始
2022-04-29 19:01:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426324721176576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426324721176576[0;39m ==> Parameters: 
2022-04-29 19:01:35.121 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426324721176576[0;39m <==    Updates: 0
2022-04-29 19:01:35.121 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426324721176576[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-29 19:01:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426345386512384[0;39m 生成今日电子书快照开始
2022-04-29 19:01:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426345386512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426345386512384[0;39m ==> Parameters: 
2022-04-29 19:01:40.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426345386512384[0;39m <==    Updates: 0
2022-04-29 19:01:40.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426345386512384[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-29 19:01:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426366366420992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426366366420992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426366366420992[0;39m ==> Parameters: 
2022-04-29 19:01:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426366366420992[0;39m <==    Updates: 0
2022-04-29 19:01:45.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426366366420992[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:01:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426387333746688[0;39m 生成今日电子书快照开始
2022-04-29 19:01:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426387333746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426387333746688[0;39m ==> Parameters: 
2022-04-29 19:01:50.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426387333746688[0;39m <==    Updates: 0
2022-04-29 19:01:50.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426387333746688[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 19:01:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426408309460992[0;39m 生成今日电子书快照开始
2022-04-29 19:01:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426408309460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:01:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426408309460992[0;39m ==> Parameters: 
2022-04-29 19:01:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426408309460992[0;39m <==    Updates: 0
2022-04-29 19:01:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426408309460992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:02:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426429272592384[0;39m 生成今日电子书快照开始
2022-04-29 19:02:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426429272592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426429272592384[0;39m ==> Parameters: 
2022-04-29 19:02:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426429272592384[0;39m <==    Updates: 0
2022-04-29 19:02:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426429272592384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:02:05.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426450252500992[0;39m 生成今日电子书快照开始
2022-04-29 19:02:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426450252500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426450252500992[0;39m ==> Parameters: 
2022-04-29 19:02:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426450252500992[0;39m <==    Updates: 0
2022-04-29 19:02:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426450252500992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:02:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426450525130752[0;39m start updating Ebook doc
2022-04-29 19:02:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426450525130752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:02:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426450525130752[0;39m ==> Parameters: 
2022-04-29 19:02:05.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426450525130752[0;39m <==    Updates: 1
2022-04-29 19:02:05.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426450525130752[0;39m update ends, take 39 millisecs
2022-04-29 19:02:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426471198855168[0;39m 生成今日电子书快照开始
2022-04-29 19:02:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426471198855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426471198855168[0;39m ==> Parameters: 
2022-04-29 19:02:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426471198855168[0;39m <==    Updates: 0
2022-04-29 19:02:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426471198855168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:02:15.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426492208123904[0;39m 生成今日电子书快照开始
2022-04-29 19:02:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426492208123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426492208123904[0;39m ==> Parameters: 
2022-04-29 19:02:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426492208123904[0;39m <==    Updates: 0
2022-04-29 19:02:15.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426492208123904[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:02:20.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426513171255296[0;39m 生成今日电子书快照开始
2022-04-29 19:02:20.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426513171255296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:20.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426513171255296[0;39m ==> Parameters: 
2022-04-29 19:02:20.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426513171255296[0;39m <==    Updates: 0
2022-04-29 19:02:20.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426513171255296[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:02:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426534130192384[0;39m 生成今日电子书快照开始
2022-04-29 19:02:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426534130192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426534130192384[0;39m ==> Parameters: 
2022-04-29 19:02:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426534130192384[0;39m <==    Updates: 0
2022-04-29 19:02:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426534130192384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:02:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426555126878208[0;39m 生成今日电子书快照开始
2022-04-29 19:02:30.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426555126878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:30.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426555126878208[0;39m ==> Parameters: 
2022-04-29 19:02:30.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426555126878208[0;39m <==    Updates: 0
2022-04-29 19:02:30.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426555126878208[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 19:02:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426576060649472[0;39m 生成今日电子书快照开始
2022-04-29 19:02:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426576060649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426576060649472[0;39m ==> Parameters: 
2022-04-29 19:02:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426576060649472[0;39m <==    Updates: 0
2022-04-29 19:02:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426576060649472[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:02:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426576350056448[0;39m start updating Ebook doc
2022-04-29 19:02:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426576350056448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:02:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426576350056448[0;39m ==> Parameters: 
2022-04-29 19:02:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426576350056448[0;39m <==    Updates: 1
2022-04-29 19:02:35.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426576350056448[0;39m update ends, take 39 millisecs
2022-04-29 19:02:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426597061529600[0;39m 生成今日电子书快照开始
2022-04-29 19:02:40.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426597061529600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:40.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426597061529600[0;39m ==> Parameters: 
2022-04-29 19:02:40.092 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426597061529600[0;39m <==    Updates: 0
2022-04-29 19:02:40.094 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426597061529600[0;39m 生成今日电子书快照结束，耗时：85毫秒
2022-04-29 19:02:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426618020466688[0;39m 生成今日电子书快照开始
2022-04-29 19:02:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426618020466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426618020466688[0;39m ==> Parameters: 
2022-04-29 19:02:45.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426618020466688[0;39m <==    Updates: 0
2022-04-29 19:02:45.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426618020466688[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:02:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426638987792384[0;39m 生成今日电子书快照开始
2022-04-29 19:02:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426638987792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:50.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426638987792384[0;39m ==> Parameters: 
2022-04-29 19:02:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426638987792384[0;39m <==    Updates: 0
2022-04-29 19:02:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426638987792384[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:02:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426659946729472[0;39m 生成今日电子书快照开始
2022-04-29 19:02:55.189 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426659946729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:02:55.190 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426659946729472[0;39m ==> Parameters: 
2022-04-29 19:02:55.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426659946729472[0;39m <==    Updates: 0
2022-04-29 19:02:55.228 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426659946729472[0;39m 生成今日电子书快照结束，耗时：227毫秒
2022-04-29 19:03:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426680926638080[0;39m 生成今日电子书快照开始
2022-04-29 19:03:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426680926638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426680926638080[0;39m ==> Parameters: 
2022-04-29 19:03:00.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426680926638080[0;39m <==    Updates: 0
2022-04-29 19:03:00.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426680926638080[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 19:03:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426701906546688[0;39m 生成今日电子书快照开始
2022-04-29 19:03:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426701906546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426701906546688[0;39m ==> Parameters: 
2022-04-29 19:03:05.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426701906546688[0;39m <==    Updates: 0
2022-04-29 19:03:05.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426701906546688[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-29 19:03:05.076 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426702204342272[0;39m start updating Ebook doc
2022-04-29 19:03:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426702204342272[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:03:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426702204342272[0;39m ==> Parameters: 
2022-04-29 19:03:05.124 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426702204342272[0;39m <==    Updates: 1
2022-04-29 19:03:05.125 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426702204342272[0;39m update ends, take 48 millisecs
2022-04-29 19:03:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426722899038208[0;39m 生成今日电子书快照开始
2022-04-29 19:03:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426722899038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426722899038208[0;39m ==> Parameters: 
2022-04-29 19:03:10.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426722899038208[0;39m <==    Updates: 0
2022-04-29 19:03:10.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426722899038208[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:03:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426743870558208[0;39m 生成今日电子书快照开始
2022-04-29 19:03:15.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426743870558208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:15.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426743870558208[0;39m ==> Parameters: 
2022-04-29 19:03:15.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426743870558208[0;39m <==    Updates: 0
2022-04-29 19:03:15.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426743870558208[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 19:03:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426764812718080[0;39m 生成今日电子书快照开始
2022-04-29 19:03:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426764812718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426764812718080[0;39m ==> Parameters: 
2022-04-29 19:03:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426764812718080[0;39m <==    Updates: 0
2022-04-29 19:03:20.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426764812718080[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 19:03:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426785813598208[0;39m 生成今日电子书快照开始
2022-04-29 19:03:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426785813598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426785813598208[0;39m ==> Parameters: 
2022-04-29 19:03:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426785813598208[0;39m <==    Updates: 0
2022-04-29 19:03:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426785813598208[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:03:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426806759952384[0;39m 生成今日电子书快照开始
2022-04-29 19:03:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426806759952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426806759952384[0;39m ==> Parameters: 
2022-04-29 19:03:30.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426806759952384[0;39m <==    Updates: 0
2022-04-29 19:03:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426806759952384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:03:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426827744055296[0;39m 生成今日电子书快照开始
2022-04-29 19:03:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426827744055296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426827744055296[0;39m ==> Parameters: 
2022-04-29 19:03:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426827744055296[0;39m <==    Updates: 0
2022-04-29 19:03:35.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426827744055296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:03:35.073 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426828020879360[0;39m start updating Ebook doc
2022-04-29 19:03:35.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426828020879360[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:03:35.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426828020879360[0;39m ==> Parameters: 
2022-04-29 19:03:35.117 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426828020879360[0;39m <==    Updates: 1
2022-04-29 19:03:35.118 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426828020879360[0;39m update ends, take 45 millisecs
2022-04-29 19:03:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426848723963904[0;39m 生成今日电子书快照开始
2022-04-29 19:03:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426848723963904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426848723963904[0;39m ==> Parameters: 
2022-04-29 19:03:40.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426848723963904[0;39m <==    Updates: 0
2022-04-29 19:03:40.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426848723963904[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 19:03:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426869678706688[0;39m 生成今日电子书快照开始
2022-04-29 19:03:45.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426869678706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:45.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426869678706688[0;39m ==> Parameters: 
2022-04-29 19:03:45.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426869678706688[0;39m <==    Updates: 0
2022-04-29 19:03:45.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426869678706688[0;39m 生成今日电子书快照结束，耗时：83毫秒
2022-04-29 19:03:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426890641838080[0;39m 生成今日电子书快照开始
2022-04-29 19:03:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426890641838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:50.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426890641838080[0;39m ==> Parameters: 
2022-04-29 19:03:50.120 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426890641838080[0;39m <==    Updates: 0
2022-04-29 19:03:50.121 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426890641838080[0;39m 生成今日电子书快照结束，耗时：117毫秒
2022-04-29 19:03:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426911634329600[0;39m 生成今日电子书快照开始
2022-04-29 19:03:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426911634329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:03:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426911634329600[0;39m ==> Parameters: 
2022-04-29 19:03:55.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426911634329600[0;39m <==    Updates: 0
2022-04-29 19:03:55.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426911634329600[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:04:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426932597460992[0;39m 生成今日电子书快照开始
2022-04-29 19:04:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426932597460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:00.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426932597460992[0;39m ==> Parameters: 
2022-04-29 19:04:00.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426932597460992[0;39m <==    Updates: 0
2022-04-29 19:04:00.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426932597460992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:04:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426953556398080[0;39m 生成今日电子书快照开始
2022-04-29 19:04:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426953556398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426953556398080[0;39m ==> Parameters: 
2022-04-29 19:04:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426953556398080[0;39m <==    Updates: 0
2022-04-29 19:04:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426953556398080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:04:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175426953833222144[0;39m start updating Ebook doc
2022-04-29 19:04:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426953833222144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:04:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426953833222144[0;39m ==> Parameters: 
2022-04-29 19:04:05.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175426953833222144[0;39m <==    Updates: 1
2022-04-29 19:04:05.107 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175426953833222144[0;39m update ends, take 38 millisecs
2022-04-29 19:04:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426974557278208[0;39m 生成今日电子书快照开始
2022-04-29 19:04:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426974557278208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426974557278208[0;39m ==> Parameters: 
2022-04-29 19:04:10.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426974557278208[0;39m <==    Updates: 0
2022-04-29 19:04:10.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426974557278208[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:04:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175426995491049472[0;39m 生成今日电子书快照开始
2022-04-29 19:04:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426995491049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426995491049472[0;39m ==> Parameters: 
2022-04-29 19:04:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175426995491049472[0;39m <==    Updates: 0
2022-04-29 19:04:15.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175426995491049472[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:04:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427016483540992[0;39m 生成今日电子书快照开始
2022-04-29 19:04:20.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427016483540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:20.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427016483540992[0;39m ==> Parameters: 
2022-04-29 19:04:20.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427016483540992[0;39m <==    Updates: 0
2022-04-29 19:04:20.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427016483540992[0;39m 生成今日电子书快照结束，耗时：80毫秒
2022-04-29 19:04:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427037463449600[0;39m 生成今日电子书快照开始
2022-04-29 19:04:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427037463449600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427037463449600[0;39m ==> Parameters: 
2022-04-29 19:04:25.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427037463449600[0;39m <==    Updates: 0
2022-04-29 19:04:25.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427037463449600[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:04:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427058434969600[0;39m 生成今日电子书快照开始
2022-04-29 19:04:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427058434969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427058434969600[0;39m ==> Parameters: 
2022-04-29 19:04:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427058434969600[0;39m <==    Updates: 0
2022-04-29 19:04:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427058434969600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 19:04:35.008 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427079406489600[0;39m start updating Ebook doc
2022-04-29 19:04:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427079406489600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:04:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427079406489600[0;39m ==> Parameters: 
2022-04-29 19:04:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427079406489600[0;39m <==    Updates: 1
2022-04-29 19:04:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427079406489600[0;39m update ends, take 57 millisecs
2022-04-29 19:04:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427079645564928[0;39m 生成今日电子书快照开始
2022-04-29 19:04:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427079645564928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427079645564928[0;39m ==> Parameters: 
2022-04-29 19:04:35.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427079645564928[0;39m <==    Updates: 0
2022-04-29 19:04:35.107 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427079645564928[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-29 19:04:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427100348649472[0;39m 生成今日电子书快照开始
2022-04-29 19:04:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427100348649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427100348649472[0;39m ==> Parameters: 
2022-04-29 19:04:40.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427100348649472[0;39m <==    Updates: 0
2022-04-29 19:04:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427100348649472[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-29 19:04:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427121328558080[0;39m 生成今日电子书快照开始
2022-04-29 19:04:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427121328558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427121328558080[0;39m ==> Parameters: 
2022-04-29 19:04:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427121328558080[0;39m <==    Updates: 0
2022-04-29 19:04:45.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427121328558080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:04:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427142329438208[0;39m 生成今日电子书快照开始
2022-04-29 19:04:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427142329438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427142329438208[0;39m ==> Parameters: 
2022-04-29 19:04:50.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427142329438208[0;39m <==    Updates: 0
2022-04-29 19:04:50.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427142329438208[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:04:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427163300958208[0;39m 生成今日电子书快照开始
2022-04-29 19:04:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427163300958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:04:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427163300958208[0;39m ==> Parameters: 
2022-04-29 19:04:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427163300958208[0;39m <==    Updates: 0
2022-04-29 19:04:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427163300958208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:05:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427184259895296[0;39m 生成今日电子书快照开始
2022-04-29 19:05:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427184259895296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:00.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427184259895296[0;39m ==> Parameters: 
2022-04-29 19:05:00.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427184259895296[0;39m <==    Updates: 0
2022-04-29 19:05:00.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427184259895296[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 19:05:05.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427205227220992[0;39m 生成今日电子书快照开始
2022-04-29 19:05:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427205227220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427205227220992[0;39m ==> Parameters: 
2022-04-29 19:05:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427205227220992[0;39m <==    Updates: 0
2022-04-29 19:05:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427205227220992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:05:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427205499850752[0;39m start updating Ebook doc
2022-04-29 19:05:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427205499850752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:05:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427205499850752[0;39m ==> Parameters: 
2022-04-29 19:05:05.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427205499850752[0;39m <==    Updates: 1
2022-04-29 19:05:05.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427205499850752[0;39m update ends, take 49 millisecs
2022-04-29 19:05:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427226202935296[0;39m 生成今日电子书快照开始
2022-04-29 19:05:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427226202935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427226202935296[0;39m ==> Parameters: 
2022-04-29 19:05:10.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427226202935296[0;39m <==    Updates: 0
2022-04-29 19:05:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427226202935296[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:05:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427247161872384[0;39m 生成今日电子书快照开始
2022-04-29 19:05:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427247161872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427247161872384[0;39m ==> Parameters: 
2022-04-29 19:05:15.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427247161872384[0;39m <==    Updates: 0
2022-04-29 19:05:15.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427247161872384[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-29 19:05:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427268137586688[0;39m 生成今日电子书快照开始
2022-04-29 19:05:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427268137586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427268137586688[0;39m ==> Parameters: 
2022-04-29 19:05:20.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427268137586688[0;39m <==    Updates: 0
2022-04-29 19:05:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427268137586688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:05:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427289130078208[0;39m 生成今日电子书快照开始
2022-04-29 19:05:25.041 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427289130078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:25.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427289130078208[0;39m ==> Parameters: 
2022-04-29 19:05:25.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427289130078208[0;39m <==    Updates: 0
2022-04-29 19:05:25.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427289130078208[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-29 19:05:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427310076432384[0;39m 生成今日电子书快照开始
2022-04-29 19:05:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427310076432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427310076432384[0;39m ==> Parameters: 
2022-04-29 19:05:30.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427310076432384[0;39m <==    Updates: 0
2022-04-29 19:05:30.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427310076432384[0;39m 生成今日电子书快照结束，耗时：77毫秒
2022-04-29 19:05:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427331052146688[0;39m 生成今日电子书快照开始
2022-04-29 19:05:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427331052146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427331052146688[0;39m ==> Parameters: 
2022-04-29 19:05:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427331052146688[0;39m <==    Updates: 0
2022-04-29 19:05:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427331052146688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:05:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427331303804928[0;39m start updating Ebook doc
2022-04-29 19:05:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427331303804928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:05:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427331303804928[0;39m ==> Parameters: 
2022-04-29 19:05:35.112 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427331303804928[0;39m <==    Updates: 1
2022-04-29 19:05:35.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427331303804928[0;39m update ends, take 47 millisecs
2022-04-29 19:05:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427352023666688[0;39m 生成今日电子书快照开始
2022-04-29 19:05:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427352023666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427352023666688[0;39m ==> Parameters: 
2022-04-29 19:05:40.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427352023666688[0;39m <==    Updates: 0
2022-04-29 19:05:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427352023666688[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-29 19:05:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427372999380992[0;39m 生成今日电子书快照开始
2022-04-29 19:05:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427372999380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427372999380992[0;39m ==> Parameters: 
2022-04-29 19:05:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427372999380992[0;39m <==    Updates: 0
2022-04-29 19:05:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427372999380992[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:05:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427393954123776[0;39m 生成今日电子书快照开始
2022-04-29 19:05:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427393954123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427393954123776[0;39m ==> Parameters: 
2022-04-29 19:05:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427393954123776[0;39m <==    Updates: 0
2022-04-29 19:05:50.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427393954123776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:05:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427414925643776[0;39m 生成今日电子书快照开始
2022-04-29 19:05:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427414925643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:05:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427414925643776[0;39m ==> Parameters: 
2022-04-29 19:05:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427414925643776[0;39m <==    Updates: 0
2022-04-29 19:05:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427414925643776[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:06:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427435897163776[0;39m 生成今日电子书快照开始
2022-04-29 19:06:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427435897163776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427435897163776[0;39m ==> Parameters: 
2022-04-29 19:06:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427435897163776[0;39m <==    Updates: 0
2022-04-29 19:06:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427435897163776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:06:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427456872878080[0;39m 生成今日电子书快照开始
2022-04-29 19:06:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427456872878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427456872878080[0;39m ==> Parameters: 
2022-04-29 19:06:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427456872878080[0;39m <==    Updates: 0
2022-04-29 19:06:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427456872878080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:06:05.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427457153896448[0;39m start updating Ebook doc
2022-04-29 19:06:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427457153896448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:06:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427457153896448[0;39m ==> Parameters: 
2022-04-29 19:06:05.112 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427457153896448[0;39m <==    Updates: 1
2022-04-29 19:06:05.112 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427457153896448[0;39m update ends, take 42 millisecs
2022-04-29 19:06:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427477831815168[0;39m 生成今日电子书快照开始
2022-04-29 19:06:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427477831815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427477831815168[0;39m ==> Parameters: 
2022-04-29 19:06:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427477831815168[0;39m <==    Updates: 0
2022-04-29 19:06:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427477831815168[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-29 19:06:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427498815918080[0;39m 生成今日电子书快照开始
2022-04-29 19:06:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427498815918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427498815918080[0;39m ==> Parameters: 
2022-04-29 19:06:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427498815918080[0;39m <==    Updates: 0
2022-04-29 19:06:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427498815918080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:06:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427519783243776[0;39m 生成今日电子书快照开始
2022-04-29 19:06:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427519783243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427519783243776[0;39m ==> Parameters: 
2022-04-29 19:06:20.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427519783243776[0;39m <==    Updates: 0
2022-04-29 19:06:20.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427519783243776[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:06:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427540763152384[0;39m 生成今日电子书快照开始
2022-04-29 19:06:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427540763152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427540763152384[0;39m ==> Parameters: 
2022-04-29 19:06:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427540763152384[0;39m <==    Updates: 0
2022-04-29 19:06:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427540763152384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:06:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427561717895168[0;39m 生成今日电子书快照开始
2022-04-29 19:06:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427561717895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427561717895168[0;39m ==> Parameters: 
2022-04-29 19:06:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427561717895168[0;39m <==    Updates: 0
2022-04-29 19:06:30.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427561717895168[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:06:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427582706192384[0;39m 生成今日电子书快照开始
2022-04-29 19:06:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427582706192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427582706192384[0;39m ==> Parameters: 
2022-04-29 19:06:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427582706192384[0;39m <==    Updates: 0
2022-04-29 19:06:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427582706192384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:06:35.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427582987210752[0;39m start updating Ebook doc
2022-04-29 19:06:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427582987210752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:06:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427582987210752[0;39m ==> Parameters: 
2022-04-29 19:06:35.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427582987210752[0;39m <==    Updates: 1
2022-04-29 19:06:35.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427582987210752[0;39m update ends, take 49 millisecs
2022-04-29 19:06:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427603677712384[0;39m 生成今日电子书快照开始
2022-04-29 19:06:40.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427603677712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:40.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427603677712384[0;39m ==> Parameters: 
2022-04-29 19:06:40.095 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427603677712384[0;39m <==    Updates: 0
2022-04-29 19:06:40.096 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427603677712384[0;39m 生成今日电子书快照结束，耗时：91毫秒
2022-04-29 19:06:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427624636649472[0;39m 生成今日电子书快照开始
2022-04-29 19:06:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427624636649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427624636649472[0;39m ==> Parameters: 
2022-04-29 19:06:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427624636649472[0;39m <==    Updates: 0
2022-04-29 19:06:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427624636649472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:06:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427645612363776[0;39m 生成今日电子书快照开始
2022-04-29 19:06:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427645612363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427645612363776[0;39m ==> Parameters: 
2022-04-29 19:06:50.086 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427645612363776[0;39m <==    Updates: 0
2022-04-29 19:06:50.087 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427645612363776[0;39m 生成今日电子书快照结束，耗时：84毫秒
2022-04-29 19:06:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427666575495168[0;39m 生成今日电子书快照开始
2022-04-29 19:06:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427666575495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:06:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427666575495168[0;39m ==> Parameters: 
2022-04-29 19:06:55.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427666575495168[0;39m <==    Updates: 0
2022-04-29 19:06:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427666575495168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:07:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427687559598080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427687559598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427687559598080[0;39m ==> Parameters: 
2022-04-29 19:07:00.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427687559598080[0;39m <==    Updates: 0
2022-04-29 19:07:00.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427687559598080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:07:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427708531118080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427708531118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427708531118080[0;39m ==> Parameters: 
2022-04-29 19:07:05.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427708531118080[0;39m <==    Updates: 0
2022-04-29 19:07:05.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427708531118080[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 19:07:05.078 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427708845690880[0;39m start updating Ebook doc
2022-04-29 19:07:05.079 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427708845690880[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:07:05.080 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427708845690880[0;39m ==> Parameters: 
2022-04-29 19:07:05.132 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427708845690880[0;39m <==    Updates: 1
2022-04-29 19:07:05.133 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427708845690880[0;39m update ends, take 54 millisecs
2022-04-29 19:07:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427729494249472[0;39m 生成今日电子书快照开始
2022-04-29 19:07:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427729494249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427729494249472[0;39m ==> Parameters: 
2022-04-29 19:07:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427729494249472[0;39m <==    Updates: 0
2022-04-29 19:07:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427729494249472[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:07:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427750474158080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427750474158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427750474158080[0;39m ==> Parameters: 
2022-04-29 19:07:15.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427750474158080[0;39m <==    Updates: 0
2022-04-29 19:07:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427750474158080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:07:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427771441483776[0;39m 生成今日电子书快照开始
2022-04-29 19:07:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427771441483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427771441483776[0;39m ==> Parameters: 
2022-04-29 19:07:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427771441483776[0;39m <==    Updates: 0
2022-04-29 19:07:20.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427771441483776[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-29 19:07:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427792404615168[0;39m 生成今日电子书快照开始
2022-04-29 19:07:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427792404615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427792404615168[0;39m ==> Parameters: 
2022-04-29 19:07:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427792404615168[0;39m <==    Updates: 0
2022-04-29 19:07:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427792404615168[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:07:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427813397106688[0;39m 生成今日电子书快照开始
2022-04-29 19:07:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427813397106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427813397106688[0;39m ==> Parameters: 
2022-04-29 19:07:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427813397106688[0;39m <==    Updates: 0
2022-04-29 19:07:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427813397106688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:07:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427834364432384[0;39m 生成今日电子书快照开始
2022-04-29 19:07:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427834364432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427834364432384[0;39m ==> Parameters: 
2022-04-29 19:07:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427834364432384[0;39m <==    Updates: 0
2022-04-29 19:07:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427834364432384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:07:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427834641256448[0;39m start updating Ebook doc
2022-04-29 19:07:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427834641256448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:07:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427834641256448[0;39m ==> Parameters: 
2022-04-29 19:07:35.113 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427834641256448[0;39m <==    Updates: 1
2022-04-29 19:07:35.114 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427834641256448[0;39m update ends, take 44 millisecs
2022-04-29 19:07:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427855331758080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427855331758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427855331758080[0;39m ==> Parameters: 
2022-04-29 19:07:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427855331758080[0;39m <==    Updates: 0
2022-04-29 19:07:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427855331758080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:07:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427876294889472[0;39m 生成今日电子书快照开始
2022-04-29 19:07:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427876294889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427876294889472[0;39m ==> Parameters: 
2022-04-29 19:07:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427876294889472[0;39m <==    Updates: 0
2022-04-29 19:07:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427876294889472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:07:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427897274798080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427897274798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427897274798080[0;39m ==> Parameters: 
2022-04-29 19:07:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427897274798080[0;39m <==    Updates: 0
2022-04-29 19:07:50.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427897274798080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:07:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427918246318080[0;39m 生成今日电子书快照开始
2022-04-29 19:07:55.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427918246318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:07:55.100 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427918246318080[0;39m ==> Parameters: 
2022-04-29 19:07:55.259 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427918246318080[0;39m <==    Updates: 0
2022-04-29 19:07:55.260 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427918246318080[0;39m 生成今日电子书快照结束，耗时：257毫秒
2022-04-29 19:08:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427939213643776[0;39m 生成今日电子书快照开始
2022-04-29 19:08:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427939213643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427939213643776[0;39m ==> Parameters: 
2022-04-29 19:08:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427939213643776[0;39m <==    Updates: 0
2022-04-29 19:08:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427939213643776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:08:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427960189358080[0;39m 生成今日电子书快照开始
2022-04-29 19:08:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427960189358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427960189358080[0;39m ==> Parameters: 
2022-04-29 19:08:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427960189358080[0;39m <==    Updates: 0
2022-04-29 19:08:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427960189358080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:08:05.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175427960461987840[0;39m start updating Ebook doc
2022-04-29 19:08:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427960461987840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:08:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427960461987840[0;39m ==> Parameters: 
2022-04-29 19:08:05.107 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175427960461987840[0;39m <==    Updates: 1
2022-04-29 19:08:05.107 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175427960461987840[0;39m update ends, take 39 millisecs
2022-04-29 19:08:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175427981165072384[0;39m 生成今日电子书快照开始
2022-04-29 19:08:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427981165072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427981165072384[0;39m ==> Parameters: 
2022-04-29 19:08:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175427981165072384[0;39m <==    Updates: 0
2022-04-29 19:08:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175427981165072384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:08:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428002132398080[0;39m 生成今日电子书快照开始
2022-04-29 19:08:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428002132398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428002132398080[0;39m ==> Parameters: 
2022-04-29 19:08:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428002132398080[0;39m <==    Updates: 0
2022-04-29 19:08:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428002132398080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:08:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428023095529472[0;39m 生成今日电子书快照开始
2022-04-29 19:08:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428023095529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428023095529472[0;39m ==> Parameters: 
2022-04-29 19:08:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428023095529472[0;39m <==    Updates: 0
2022-04-29 19:08:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428023095529472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:08:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428044071243776[0;39m 生成今日电子书快照开始
2022-04-29 19:08:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428044071243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428044071243776[0;39m ==> Parameters: 
2022-04-29 19:08:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428044071243776[0;39m <==    Updates: 0
2022-04-29 19:08:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428044071243776[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:08:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428065034375168[0;39m 生成今日电子书快照开始
2022-04-29 19:08:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428065034375168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428065034375168[0;39m ==> Parameters: 
2022-04-29 19:08:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428065034375168[0;39m <==    Updates: 0
2022-04-29 19:08:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428065034375168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:08:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428086026866688[0;39m 生成今日电子书快照开始
2022-04-29 19:08:35.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428086026866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:35.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428086026866688[0;39m ==> Parameters: 
2022-04-29 19:08:35.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428086026866688[0;39m <==    Updates: 0
2022-04-29 19:08:35.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428086026866688[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-29 19:08:35.082 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428086349828096[0;39m start updating Ebook doc
2022-04-29 19:08:35.083 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428086349828096[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:08:35.083 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428086349828096[0;39m ==> Parameters: 
2022-04-29 19:08:35.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428086349828096[0;39m <==    Updates: 1
2022-04-29 19:08:35.119 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428086349828096[0;39m update ends, take 37 millisecs
2022-04-29 19:08:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428106977415168[0;39m 生成今日电子书快照开始
2022-04-29 19:08:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428106977415168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428106977415168[0;39m ==> Parameters: 
2022-04-29 19:08:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428106977415168[0;39m <==    Updates: 0
2022-04-29 19:08:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428106977415168[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-29 19:08:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428127961518080[0;39m 生成今日电子书快照开始
2022-04-29 19:08:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428127961518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428127961518080[0;39m ==> Parameters: 
2022-04-29 19:08:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428127961518080[0;39m <==    Updates: 0
2022-04-29 19:08:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428127961518080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:08:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428148937232384[0;39m 生成今日电子书快照开始
2022-04-29 19:08:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428148937232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428148937232384[0;39m ==> Parameters: 
2022-04-29 19:08:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428148937232384[0;39m <==    Updates: 0
2022-04-29 19:08:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428148937232384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:08:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428169908752384[0;39m 生成今日电子书快照开始
2022-04-29 19:08:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428169908752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:08:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428169908752384[0;39m ==> Parameters: 
2022-04-29 19:08:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428169908752384[0;39m <==    Updates: 0
2022-04-29 19:08:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428169908752384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:09:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428190871883776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428190871883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428190871883776[0;39m ==> Parameters: 
2022-04-29 19:09:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428190871883776[0;39m <==    Updates: 0
2022-04-29 19:09:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428190871883776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:09:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428211835015168[0;39m 生成今日电子书快照开始
2022-04-29 19:09:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428211835015168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428211835015168[0;39m ==> Parameters: 
2022-04-29 19:09:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428211835015168[0;39m <==    Updates: 0
2022-04-29 19:09:05.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428211835015168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:09:05.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428212095062016[0;39m start updating Ebook doc
2022-04-29 19:09:05.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428212095062016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:09:05.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428212095062016[0;39m ==> Parameters: 
2022-04-29 19:09:05.100 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428212095062016[0;39m <==    Updates: 1
2022-04-29 19:09:05.100 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428212095062016[0;39m update ends, take 38 millisecs
2022-04-29 19:09:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428232823312384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428232823312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428232823312384[0;39m ==> Parameters: 
2022-04-29 19:09:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428232823312384[0;39m <==    Updates: 0
2022-04-29 19:09:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428232823312384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 19:09:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428253786443776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428253786443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428253786443776[0;39m ==> Parameters: 
2022-04-29 19:09:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428253786443776[0;39m <==    Updates: 0
2022-04-29 19:09:15.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428253786443776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:09:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428274762158080[0;39m 生成今日电子书快照开始
2022-04-29 19:09:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428274762158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428274762158080[0;39m ==> Parameters: 
2022-04-29 19:09:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428274762158080[0;39m <==    Updates: 0
2022-04-29 19:09:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428274762158080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:09:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428295737872384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428295737872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428295737872384[0;39m ==> Parameters: 
2022-04-29 19:09:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428295737872384[0;39m <==    Updates: 0
2022-04-29 19:09:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428295737872384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:09:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428316701003776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428316701003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428316701003776[0;39m ==> Parameters: 
2022-04-29 19:09:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428316701003776[0;39m <==    Updates: 0
2022-04-29 19:09:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428316701003776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:09:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428337672523776[0;39m 生成今日电子书快照开始
2022-04-29 19:09:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428337672523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428337672523776[0;39m ==> Parameters: 
2022-04-29 19:09:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428337672523776[0;39m <==    Updates: 0
2022-04-29 19:09:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428337672523776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:09:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428337949347840[0;39m start updating Ebook doc
2022-04-29 19:09:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428337949347840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:09:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428337949347840[0;39m ==> Parameters: 
2022-04-29 19:09:35.109 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428337949347840[0;39m <==    Updates: 1
2022-04-29 19:09:35.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428337949347840[0;39m update ends, take 41 millisecs
2022-04-29 19:09:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428358652432384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428358652432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428358652432384[0;39m ==> Parameters: 
2022-04-29 19:09:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428358652432384[0;39m <==    Updates: 0
2022-04-29 19:09:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428358652432384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:09:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428379628146688[0;39m 生成今日电子书快照开始
2022-04-29 19:09:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428379628146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428379628146688[0;39m ==> Parameters: 
2022-04-29 19:09:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428379628146688[0;39m <==    Updates: 0
2022-04-29 19:09:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428379628146688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:09:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428400582889472[0;39m 生成今日电子书快照开始
2022-04-29 19:09:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428400582889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428400582889472[0;39m ==> Parameters: 
2022-04-29 19:09:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428400582889472[0;39m <==    Updates: 0
2022-04-29 19:09:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428400582889472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:09:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428421566992384[0;39m 生成今日电子书快照开始
2022-04-29 19:09:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428421566992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:09:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428421566992384[0;39m ==> Parameters: 
2022-04-29 19:09:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428421566992384[0;39m <==    Updates: 0
2022-04-29 19:09:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428421566992384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:10:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428442530123776[0;39m 生成今日电子书快照开始
2022-04-29 19:10:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428442530123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428442530123776[0;39m ==> Parameters: 
2022-04-29 19:10:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428442530123776[0;39m <==    Updates: 0
2022-04-29 19:10:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428442530123776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:10:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428463505838080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428463505838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428463505838080[0;39m ==> Parameters: 
2022-04-29 19:10:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428463505838080[0;39m <==    Updates: 0
2022-04-29 19:10:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428463505838080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:10:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428463770079232[0;39m start updating Ebook doc
2022-04-29 19:10:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428463770079232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:10:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428463770079232[0;39m ==> Parameters: 
2022-04-29 19:10:05.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428463770079232[0;39m <==    Updates: 1
2022-04-29 19:10:05.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428463770079232[0;39m update ends, take 38 millisecs
2022-04-29 19:10:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428484481552384[0;39m 生成今日电子书快照开始
2022-04-29 19:10:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428484481552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428484481552384[0;39m ==> Parameters: 
2022-04-29 19:10:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428484481552384[0;39m <==    Updates: 0
2022-04-29 19:10:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428484481552384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:10:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428505436295168[0;39m 生成今日电子书快照开始
2022-04-29 19:10:15.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428505436295168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:15.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428505436295168[0;39m ==> Parameters: 
2022-04-29 19:10:15.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428505436295168[0;39m <==    Updates: 0
2022-04-29 19:10:15.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428505436295168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 19:10:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428526407815168[0;39m 生成今日电子书快照开始
2022-04-29 19:10:20.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428526407815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:20.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428526407815168[0;39m ==> Parameters: 
2022-04-29 19:10:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428526407815168[0;39m <==    Updates: 0
2022-04-29 19:10:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428526407815168[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:10:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428547396112384[0;39m 生成今日电子书快照开始
2022-04-29 19:10:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428547396112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428547396112384[0;39m ==> Parameters: 
2022-04-29 19:10:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428547396112384[0;39m <==    Updates: 0
2022-04-29 19:10:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428547396112384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:10:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428568363438080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428568363438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428568363438080[0;39m ==> Parameters: 
2022-04-29 19:10:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428568363438080[0;39m <==    Updates: 0
2022-04-29 19:10:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428568363438080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 19:10:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428589343346688[0;39m 生成今日电子书快照开始
2022-04-29 19:10:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428589343346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428589343346688[0;39m ==> Parameters: 
2022-04-29 19:10:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428589343346688[0;39m <==    Updates: 0
2022-04-29 19:10:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428589343346688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:10:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428589586616320[0;39m start updating Ebook doc
2022-04-29 19:10:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428589586616320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:10:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428589586616320[0;39m ==> Parameters: 
2022-04-29 19:10:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428589586616320[0;39m <==    Updates: 1
2022-04-29 19:10:35.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428589586616320[0;39m update ends, take 41 millisecs
2022-04-29 19:10:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428610306478080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428610306478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428610306478080[0;39m ==> Parameters: 
2022-04-29 19:10:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428610306478080[0;39m <==    Updates: 0
2022-04-29 19:10:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428610306478080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-29 19:10:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428631282192384[0;39m 生成今日电子书快照开始
2022-04-29 19:10:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428631282192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428631282192384[0;39m ==> Parameters: 
2022-04-29 19:10:45.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428631282192384[0;39m <==    Updates: 0
2022-04-29 19:10:45.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428631282192384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:10:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428652241129472[0;39m 生成今日电子书快照开始
2022-04-29 19:10:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428652241129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428652241129472[0;39m ==> Parameters: 
2022-04-29 19:10:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428652241129472[0;39m <==    Updates: 0
2022-04-29 19:10:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428652241129472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:10:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428673221038080[0;39m 生成今日电子书快照开始
2022-04-29 19:10:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428673221038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:10:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428673221038080[0;39m ==> Parameters: 
2022-04-29 19:10:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428673221038080[0;39m <==    Updates: 0
2022-04-29 19:10:55.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428673221038080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-29 19:11:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428694196752384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428694196752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428694196752384[0;39m ==> Parameters: 
2022-04-29 19:11:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428694196752384[0;39m <==    Updates: 0
2022-04-29 19:11:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428694196752384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:11:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428715168272384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428715168272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428715168272384[0;39m ==> Parameters: 
2022-04-29 19:11:05.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428715168272384[0;39m <==    Updates: 0
2022-04-29 19:11:05.102 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428715168272384[0;39m 生成今日电子书快照结束，耗时：97毫秒
2022-04-29 19:11:05.102 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428715579314176[0;39m start updating Ebook doc
2022-04-29 19:11:05.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428715579314176[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:11:05.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428715579314176[0;39m ==> Parameters: 
2022-04-29 19:11:05.143 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428715579314176[0;39m <==    Updates: 1
2022-04-29 19:11:05.143 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428715579314176[0;39m update ends, take 41 millisecs
2022-04-29 19:11:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428736131403776[0;39m 生成今日电子书快照开始
2022-04-29 19:11:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428736131403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428736131403776[0;39m ==> Parameters: 
2022-04-29 19:11:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428736131403776[0;39m <==    Updates: 0
2022-04-29 19:11:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428736131403776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:11:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428757115506688[0;39m 生成今日电子书快照开始
2022-04-29 19:11:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428757115506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428757115506688[0;39m ==> Parameters: 
2022-04-29 19:11:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428757115506688[0;39m <==    Updates: 0
2022-04-29 19:11:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428757115506688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:11:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428778082832384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428778082832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428778082832384[0;39m ==> Parameters: 
2022-04-29 19:11:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428778082832384[0;39m <==    Updates: 0
2022-04-29 19:11:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428778082832384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:11:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428799037575168[0;39m 生成今日电子书快照开始
2022-04-29 19:11:25.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428799037575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:25.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428799037575168[0;39m ==> Parameters: 
2022-04-29 19:11:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428799037575168[0;39m <==    Updates: 0
2022-04-29 19:11:25.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428799037575168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:11:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428820025872384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428820025872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428820025872384[0;39m ==> Parameters: 
2022-04-29 19:11:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428820025872384[0;39m <==    Updates: 0
2022-04-29 19:11:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428820025872384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:11:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428840984809472[0;39m 生成今日电子书快照开始
2022-04-29 19:11:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428840984809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428840984809472[0;39m ==> Parameters: 
2022-04-29 19:11:35.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428840984809472[0;39m <==    Updates: 0
2022-04-29 19:11:35.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428840984809472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:11:35.057 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428841219690496[0;39m start updating Ebook doc
2022-04-29 19:11:35.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428841219690496[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:11:35.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428841219690496[0;39m ==> Parameters: 
2022-04-29 19:11:35.091 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428841219690496[0;39m <==    Updates: 1
2022-04-29 19:11:35.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428841219690496[0;39m update ends, take 34 millisecs
2022-04-29 19:11:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428861973106688[0;39m 生成今日电子书快照开始
2022-04-29 19:11:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428861973106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428861973106688[0;39m ==> Parameters: 
2022-04-29 19:11:40.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428861973106688[0;39m <==    Updates: 0
2022-04-29 19:11:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428861973106688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-29 19:11:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428882923655168[0;39m 生成今日电子书快照开始
2022-04-29 19:11:45.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428882923655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:45.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428882923655168[0;39m ==> Parameters: 
2022-04-29 19:11:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428882923655168[0;39m <==    Updates: 0
2022-04-29 19:11:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428882923655168[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:11:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428903911952384[0;39m 生成今日电子书快照开始
2022-04-29 19:11:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428903911952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428903911952384[0;39m ==> Parameters: 
2022-04-29 19:11:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428903911952384[0;39m <==    Updates: 0
2022-04-29 19:11:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428903911952384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-29 19:11:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428924870889472[0;39m 生成今日电子书快照开始
2022-04-29 19:11:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428924870889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:11:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428924870889472[0;39m ==> Parameters: 
2022-04-29 19:11:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428924870889472[0;39m <==    Updates: 0
2022-04-29 19:11:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428924870889472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:12:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428945854992384[0;39m 生成今日电子书快照开始
2022-04-29 19:12:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428945854992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428945854992384[0;39m ==> Parameters: 
2022-04-29 19:12:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428945854992384[0;39m <==    Updates: 0
2022-04-29 19:12:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428945854992384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:12:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428966826512384[0;39m 生成今日电子书快照开始
2022-04-29 19:12:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428966826512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:05.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428966826512384[0;39m ==> Parameters: 
2022-04-29 19:12:05.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428966826512384[0;39m <==    Updates: 0
2022-04-29 19:12:05.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428966826512384[0;39m 生成今日电子书快照结束，耗时：111毫秒
2022-04-29 19:12:05.117 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175428967300468736[0;39m start updating Ebook doc
2022-04-29 19:12:05.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428967300468736[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:12:05.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428967300468736[0;39m ==> Parameters: 
2022-04-29 19:12:05.162 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175428967300468736[0;39m <==    Updates: 1
2022-04-29 19:12:05.163 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175428967300468736[0;39m update ends, take 46 millisecs
2022-04-29 19:12:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175428987798032384[0;39m 生成今日电子书快照开始
2022-04-29 19:12:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428987798032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428987798032384[0;39m ==> Parameters: 
2022-04-29 19:12:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175428987798032384[0;39m <==    Updates: 0
2022-04-29 19:12:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175428987798032384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-29 19:12:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429008756969472[0;39m 生成今日电子书快照开始
2022-04-29 19:12:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429008756969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429008756969472[0;39m ==> Parameters: 
2022-04-29 19:12:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429008756969472[0;39m <==    Updates: 0
2022-04-29 19:12:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429008756969472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:12:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429029745266688[0;39m 生成今日电子书快照开始
2022-04-29 19:12:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429029745266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429029745266688[0;39m ==> Parameters: 
2022-04-29 19:12:20.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429029745266688[0;39m <==    Updates: 0
2022-04-29 19:12:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429029745266688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:12:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429050716786688[0;39m 生成今日电子书快照开始
2022-04-29 19:12:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429050716786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429050716786688[0;39m ==> Parameters: 
2022-04-29 19:12:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429050716786688[0;39m <==    Updates: 0
2022-04-29 19:12:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429050716786688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-29 19:12:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429071671529472[0;39m 生成今日电子书快照开始
2022-04-29 19:12:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429071671529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429071671529472[0;39m ==> Parameters: 
2022-04-29 19:12:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429071671529472[0;39m <==    Updates: 0
2022-04-29 19:12:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429071671529472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-29 19:12:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429092647243776[0;39m 生成今日电子书快照开始
2022-04-29 19:12:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429092647243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429092647243776[0;39m ==> Parameters: 
2022-04-29 19:12:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429092647243776[0;39m <==    Updates: 0
2022-04-29 19:12:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429092647243776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-29 19:12:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175429092915679232[0;39m start updating Ebook doc
2022-04-29 19:12:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429092915679232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:12:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429092915679232[0;39m ==> Parameters: 
2022-04-29 19:12:35.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429092915679232[0;39m <==    Updates: 1
2022-04-29 19:12:35.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175429092915679232[0;39m update ends, take 42 millisecs
2022-04-29 19:12:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429113610375168[0;39m 生成今日电子书快照开始
2022-04-29 19:12:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429113610375168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429113610375168[0;39m ==> Parameters: 
2022-04-29 19:12:40.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429113610375168[0;39m <==    Updates: 0
2022-04-29 19:12:40.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429113610375168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-29 19:12:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429134602866688[0;39m 生成今日电子书快照开始
2022-04-29 19:12:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429134602866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429134602866688[0;39m ==> Parameters: 
2022-04-29 19:12:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429134602866688[0;39m <==    Updates: 0
2022-04-29 19:12:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429134602866688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-29 19:12:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429155561803776[0;39m 生成今日电子书快照开始
2022-04-29 19:12:50.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429155561803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:50.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429155561803776[0;39m ==> Parameters: 
2022-04-29 19:12:50.089 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429155561803776[0;39m <==    Updates: 0
2022-04-29 19:12:50.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429155561803776[0;39m 生成今日电子书快照结束，耗时：87毫秒
2022-04-29 19:12:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429176524935168[0;39m 生成今日电子书快照开始
2022-04-29 19:12:55.119 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429176524935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:12:55.120 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429176524935168[0;39m ==> Parameters: 
2022-04-29 19:12:55.281 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429176524935168[0;39m <==    Updates: 0
2022-04-29 19:12:55.284 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429176524935168[0;39m 生成今日电子书快照结束，耗时：284毫秒
2022-04-29 19:13:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429197504843776[0;39m 生成今日电子书快照开始
2022-04-29 19:13:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429197504843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429197504843776[0;39m ==> Parameters: 
2022-04-29 19:13:00.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429197504843776[0;39m <==    Updates: 0
2022-04-29 19:13:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429197504843776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-29 19:13:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429218488946688[0;39m 生成今日电子书快照开始
2022-04-29 19:13:05.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429218488946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429218488946688[0;39m ==> Parameters: 
2022-04-29 19:13:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429218488946688[0;39m <==    Updates: 0
2022-04-29 19:13:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429218488946688[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-29 19:13:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175429218711244800[0;39m start updating Ebook doc
2022-04-29 19:13:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429218711244800[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-29 19:13:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429218711244800[0;39m ==> Parameters: 
2022-04-29 19:13:05.096 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175429218711244800[0;39m <==    Updates: 1
2022-04-29 19:13:05.097 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175429218711244800[0;39m update ends, take 38 millisecs
2022-04-29 19:13:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429239443689472[0;39m 生成今日电子书快照开始
2022-04-29 19:13:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429239443689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429239443689472[0;39m ==> Parameters: 
2022-04-29 19:13:10.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429239443689472[0;39m <==    Updates: 0
2022-04-29 19:13:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429239443689472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-29 19:13:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429260427792384[0;39m 生成今日电子书快照开始
2022-04-29 19:13:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429260427792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429260427792384[0;39m ==> Parameters: 
2022-04-29 19:13:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429260427792384[0;39m <==    Updates: 0
2022-04-29 19:13:15.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429260427792384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-29 19:13:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429281386729472[0;39m 生成今日电子书快照开始
2022-04-29 19:13:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429281386729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429281386729472[0;39m ==> Parameters: 
2022-04-29 19:13:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429281386729472[0;39m <==    Updates: 0
2022-04-29 19:13:20.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429281386729472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-29 19:13:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429302375026688[0;39m 生成今日电子书快照开始
2022-04-29 19:13:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429302375026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429302375026688[0;39m ==> Parameters: 
2022-04-29 19:13:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429302375026688[0;39m <==    Updates: 0
2022-04-29 19:13:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429302375026688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-29 19:13:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175429323342352384[0;39m 生成今日电子书快照开始
2022-04-29 19:13:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429323342352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-29 19:13:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429323342352384[0;39m ==> Parameters: 
2022-04-29 19:13:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175429323342352384[0;39m <==    Updates: 0
2022-04-29 19:13:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175429323342352384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-30 10:24:44.994 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:24:44.998 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 61631 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:24:44.999 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:24:45.020 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:24:45.020 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:24:45.326 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:24:45.327 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:24:45.335 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:24:45.639 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:24:45.644 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:24:45.645 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:24:45.645 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:24:45.673 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:24:45.673 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 652 ms
2022-04-30 10:24:46.116 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:24:46.181 INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping     :54   [32m                  [0;39m Adding welcome page: class path resource [static/index.html]
2022-04-30 10:24:46.330 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:24:46.353 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:24:46.367 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:24:46.377 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:24:46.385 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.636 seconds (JVM running for 2.089)
2022-04-30 10:24:46.386 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:24:46.386 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:24:49.550 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:24:49.551 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:24:49.551 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 0 ms
2022-04-30 10:24:49.563 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:24:49.564 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/
2022-04-30 10:24:49.564 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:24:49.564 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :46   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:24:49.570 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:24:49.570 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/
2022-04-30 10:24:49.570 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:24:49.570 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :46   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:24:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432175473266688[0;39m 生成今日电子书快照开始
2022-04-30 10:24:50.015 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175432175473266688[0;39m HikariPool-1 - Starting...
2022-04-30 10:24:53.171 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175432175473266688[0;39m HikariPool-1 - Start completed.
2022-04-30 10:24:53.181 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432175473266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:24:53.203 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432175473266688[0;39m ==> Parameters: 
2022-04-30 10:24:53.664 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432175473266688[0;39m <==    Updates: 0
2022-04-30 10:24:53.671 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432175473266688[0;39m 生成今日电子书快照结束，耗时：3666毫秒
2022-04-30 10:24:54.500 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:24:54.500 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/static
2022-04-30 10:24:54.500 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:24:54.500 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :46   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:24:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432196444786688[0;39m 生成今日电子书快照开始
2022-04-30 10:24:55.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432196444786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:24:55.216 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432196444786688[0;39m ==> Parameters: 
2022-04-30 10:24:55.749 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432196444786688[0;39m <==    Updates: 0
2022-04-30 10:24:55.750 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432196444786688[0;39m 生成今日电子书快照结束，耗时：743毫秒
2022-04-30 10:24:56.692 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:24:56.692 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/static/
2022-04-30 10:24:56.693 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:24:56.694 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :46   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:25:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432217416306688[0;39m 生成今日电子书快照开始
2022-04-30 10:25:00.216 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432217416306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:00.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432217416306688[0;39m ==> Parameters: 
2022-04-30 10:25:00.667 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432217416306688[0;39m <==    Updates: 0
2022-04-30 10:25:00.669 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432217416306688[0;39m 生成今日电子书快照结束，耗时：662毫秒
2022-04-30 10:25:02.204 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:25:02.204 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/static/index.html
2022-04-30 10:25:02.204 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:25:02.205 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :46   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:25:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432238383632384[0;39m 生成今日电子书快照开始
2022-04-30 10:25:05.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432238383632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:05.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432238383632384[0;39m ==> Parameters: 
2022-04-30 10:25:06.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432238383632384[0;39m <==    Updates: 0
2022-04-30 10:25:06.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432238383632384[0;39m 生成今日电子书快照结束，耗时：1079毫秒
2022-04-30 10:25:06.085 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175432242917675008[0;39m start updating Ebook doc
2022-04-30 10:25:06.324 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432242917675008[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:25:06.327 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432242917675008[0;39m ==> Parameters: 
2022-04-30 10:25:06.792 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432242917675008[0;39m <==    Updates: 1
2022-04-30 10:25:06.793 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175432242917675008[0;39m update ends, take 708 millisecs
2022-04-30 10:25:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432259359346688[0;39m 生成今日电子书快照开始
2022-04-30 10:25:10.658 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432259359346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:10.659 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432259359346688[0;39m ==> Parameters: 
2022-04-30 10:25:12.008 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432259359346688[0;39m <==    Updates: 0
2022-04-30 10:25:12.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432259359346688[0;39m 生成今日电子书快照结束，耗时：2002毫秒
2022-04-30 10:25:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432280330866688[0;39m 生成今日电子书快照开始
2022-04-30 10:25:15.248 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432280330866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:15.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432280330866688[0;39m ==> Parameters: 
2022-04-30 10:25:15.887 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432280330866688[0;39m <==    Updates: 0
2022-04-30 10:25:15.888 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432280330866688[0;39m 生成今日电子书快照结束，耗时：880毫秒
2022-04-30 10:25:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432301302386688[0;39m 生成今日电子书快照开始
2022-04-30 10:25:20.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432301302386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:20.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432301302386688[0;39m ==> Parameters: 
2022-04-30 10:25:21.579 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432301302386688[0;39m <==    Updates: 0
2022-04-30 10:25:21.580 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432301302386688[0;39m 生成今日电子书快照结束，耗时：1575毫秒
2022-04-30 10:25:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432322252935168[0;39m 生成今日电子书快照开始
2022-04-30 10:25:25.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432322252935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:25.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432322252935168[0;39m ==> Parameters: 
2022-04-30 10:25:25.652 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432322252935168[0;39m <==    Updates: 0
2022-04-30 10:25:25.652 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432322252935168[0;39m 生成今日电子书快照结束，耗时：649毫秒
2022-04-30 10:25:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432343245426688[0;39m 生成今日电子书快照开始
2022-04-30 10:25:30.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432343245426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:30.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432343245426688[0;39m ==> Parameters: 
2022-04-30 10:25:31.010 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432343245426688[0;39m <==    Updates: 0
2022-04-30 10:25:31.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432343245426688[0;39m 生成今日电子书快照结束，耗时：1005毫秒
2022-04-30 10:25:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432364212752384[0;39m 生成今日电子书快照开始
2022-04-30 10:25:35.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432364212752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:35.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432364212752384[0;39m ==> Parameters: 
2022-04-30 10:25:35.941 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432364212752384[0;39m <==    Updates: 0
2022-04-30 10:25:35.942 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432364212752384[0;39m 生成今日电子书快照结束，耗时：938毫秒
2022-04-30 10:25:35.942 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175432368147009536[0;39m start updating Ebook doc
2022-04-30 10:25:36.152 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432368147009536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:25:36.152 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432368147009536[0;39m ==> Parameters: 
2022-04-30 10:25:36.680 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432368147009536[0;39m <==    Updates: 1
2022-04-30 10:25:36.681 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175432368147009536[0;39m update ends, take 739 millisecs
2022-04-30 10:25:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432385180078080[0;39m 生成今日电子书快照开始
2022-04-30 10:25:40.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432385180078080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:40.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432385180078080[0;39m ==> Parameters: 
2022-04-30 10:25:40.722 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432385180078080[0;39m <==    Updates: 0
2022-04-30 10:25:40.724 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432385180078080[0;39m 生成今日电子书快照结束，耗时：721毫秒
2022-04-30 10:25:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432406159986688[0;39m 生成今日电子书快照开始
2022-04-30 10:25:45.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432406159986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:45.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432406159986688[0;39m ==> Parameters: 
2022-04-30 10:25:45.741 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432406159986688[0;39m <==    Updates: 0
2022-04-30 10:25:45.741 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432406159986688[0;39m 生成今日电子书快照结束，耗时：734毫秒
2022-04-30 10:25:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432427123118080[0;39m 生成今日电子书快照开始
2022-04-30 10:25:50.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432427123118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:50.269 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432427123118080[0;39m ==> Parameters: 
2022-04-30 10:25:50.758 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432427123118080[0;39m <==    Updates: 0
2022-04-30 10:25:50.760 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432427123118080[0;39m 生成今日电子书快照结束，耗时：757毫秒
2022-04-30 10:25:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432448090443776[0;39m 生成今日电子书快照开始
2022-04-30 10:25:55.222 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432448090443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:25:55.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432448090443776[0;39m ==> Parameters: 
2022-04-30 10:25:56.432 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432448090443776[0;39m <==    Updates: 0
2022-04-30 10:25:56.436 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432448090443776[0;39m 生成今日电子书快照结束，耗时：1432毫秒
2022-04-30 10:26:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432469074546688[0;39m 生成今日电子书快照开始
2022-04-30 10:26:00.222 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432469074546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:26:00.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432469074546688[0;39m ==> Parameters: 
2022-04-30 10:26:00.567 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:26:00.567 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:26:00.568 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:26:00.574 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:26:00.576 WARN  com.zaxxer.hikari.pool.ProxyConnection            :182  [32m175432469074546688[0;39m HikariPool-1 - Connection com.mysql.cj.jdbc.ConnectionImpl@5527c453 marked as broken because of SQLSTATE(08S01), ErrorCode(0)
com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 133 milliseconds ago. The last packet sent successfully to the server was 133 milliseconds ago.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor63.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy131.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor61.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy129.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.getSnapshot(Unknown Source)
	at com.ameliawiki.wiki.service.EbookSnapshotService.getSnapshot(EbookSnapshotService.java:17)
	at com.ameliawiki.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:35)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet successfully received from the server was 133 milliseconds ago. The last packet sent successfully to the server was 133 milliseconds ago.
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:544)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:708)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:647)
	at com.mysql.cj.protocol.a.NativeProtocol.sendQueryPacket(NativeProtocol.java:946)
	at com.mysql.cj.NativeSession.execSQL(NativeSession.java:1075)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:930)
	... 44 common frames omitted
Caused by: java.net.SocketException: Socket closed
	at java.base/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:140)
	at com.mysql.cj.protocol.ReadAheadInputStream.fill(ReadAheadInputStream.java:107)
	at com.mysql.cj.protocol.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:150)
	at com.mysql.cj.protocol.ReadAheadInputStream.read(ReadAheadInputStream.java:180)
	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:133)
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:52)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:41)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:54)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:44)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:538)
	... 49 common frames omitted
2022-04-30 10:26:03.237 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:26:03.238 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 62535 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:26:03.240 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:26:03.264 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:26:03.264 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:26:03.588 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:26:03.589 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:26:03.596 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:26:03.918 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:26:03.923 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:26:03.923 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:26:03.923 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:26:03.952 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:26:03.954 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 689 ms
2022-04-30 10:26:04.489 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:26:04.546 INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping     :54   [32m                  [0;39m Adding welcome page: class path resource [static/index.html]
2022-04-30 10:26:04.708 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:26:04.737 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:26:04.752 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:26:04.764 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:26:04.773 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.715 seconds (JVM running for 2.409)
2022-04-30 10:26:04.774 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:26:04.774 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:26:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175432490046066688[0;39m start updating Ebook doc
2022-04-30 10:26:05.018 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175432490046066688[0;39m HikariPool-1 - Starting...
2022-04-30 10:26:08.322 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175432490046066688[0;39m HikariPool-1 - Start completed.
2022-04-30 10:26:08.331 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432490046066688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:26:08.346 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432490046066688[0;39m ==> Parameters: 
2022-04-30 10:26:08.801 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175432490046066688[0;39m <==    Updates: 1
2022-04-30 10:26:08.803 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175432490046066688[0;39m update ends, take 3798 millisecs
2022-04-30 10:26:08.803 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175432505976033280[0;39m 生成今日电子书快照开始
2022-04-30 10:26:08.804 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432505976033280[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:26:08.805 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432505976033280[0;39m ==> Parameters: 
2022-04-30 10:26:09.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175432505976033280[0;39m <==    Updates: 0
2022-04-30 10:26:09.241 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175432505976033280[0;39m 生成今日电子书快照结束，耗时：438毫秒
2022-04-30 10:26:09.395 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:26:09.396 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:26:09.396 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 0 ms
2022-04-30 10:26:09.405 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:28:13.839 WARN  com.zaxxer.hikari.pool.HikariPool                 :787  [32m                  [0;39m HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=2m5s412ms).
2022-04-30 10:28:13.840 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/static/index.html
2022-04-30 10:28:13.839 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433030415028224[0;39m 生成今日电子书快照开始
2022-04-30 10:28:13.842 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:28:13.843 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :46   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:28:13.956 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:28:13.957 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:28:13.958 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:28:14.120 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433030415028224[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:14.121 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433030415028224[0;39m ==> Parameters: 
2022-04-30 10:28:15.228 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:28:15.237 WARN  com.zaxxer.hikari.pool.ProxyConnection            :182  [32m175433030415028224[0;39m HikariPool-1 - Connection com.mysql.cj.jdbc.ConnectionImpl@65d9bec3 marked as broken because of SQLSTATE(08S01), ErrorCode(0)
com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 601 milliseconds ago. The last packet sent successfully to the server was 898 milliseconds ago.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy131.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy129.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.getSnapshot(Unknown Source)
	at com.ameliawiki.wiki.service.EbookSnapshotService.getSnapshot(EbookSnapshotService.java:17)
	at com.ameliawiki.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:35)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet successfully received from the server was 601 milliseconds ago. The last packet sent successfully to the server was 898 milliseconds ago.
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:544)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:708)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:685)
	at com.mysql.cj.protocol.a.NativeProtocol.readNextResultset(NativeProtocol.java:1628)
	at com.mysql.cj.protocol.a.NativeProtocol.readAllResults(NativeProtocol.java:1658)
	at com.mysql.cj.protocol.a.NativeProtocol.sendQueryPacket(NativeProtocol.java:959)
	at com.mysql.cj.NativeSession.execSQL(NativeSession.java:1075)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:930)
	... 48 common frames omitted
Caused by: java.net.SocketException: Socket closed
	at java.base/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:140)
	at com.mysql.cj.protocol.ReadAheadInputStream.fill(ReadAheadInputStream.java:107)
	at com.mysql.cj.protocol.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:150)
	at com.mysql.cj.protocol.ReadAheadInputStream.read(ReadAheadInputStream.java:180)
	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:133)
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:52)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:41)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:54)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:44)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:538)
	... 55 common frames omitted
2022-04-30 10:28:21.743 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:28:21.746 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 64209 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:28:21.747 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:28:21.768 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:28:21.769 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:28:22.057 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:28:22.058 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:28:22.065 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:28:22.396 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:28:22.401 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:28:22.401 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:28:22.401 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:28:22.428 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:28:22.428 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 659 ms
2022-04-30 10:28:22.899 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:28:22.947 INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping     :54   [32m                  [0;39m Adding welcome page: class path resource [static/index.html]
2022-04-30 10:28:23.110 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:28:23.138 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:28:23.154 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:28:23.164 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:28:23.173 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.621 seconds (JVM running for 2.025)
2022-04-30 10:28:23.174 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:28:23.175 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:28:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433077252820992[0;39m 生成今日电子书快照开始
2022-04-30 10:28:25.040 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175433077252820992[0;39m HikariPool-1 - Starting...
2022-04-30 10:28:28.277 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175433077252820992[0;39m HikariPool-1 - Start completed.
2022-04-30 10:28:28.296 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433077252820992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:28.326 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433077252820992[0;39m ==> Parameters: 
2022-04-30 10:28:28.874 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433077252820992[0;39m <==    Updates: 0
2022-04-30 10:28:28.885 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433077252820992[0;39m 生成今日电子书快照结束，耗时：3877毫秒
2022-04-30 10:28:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433098220146688[0;39m 生成今日电子书快照开始
2022-04-30 10:28:30.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433098220146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:30.271 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433098220146688[0;39m ==> Parameters: 
2022-04-30 10:28:30.795 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433098220146688[0;39m <==    Updates: 0
2022-04-30 10:28:30.796 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433098220146688[0;39m 生成今日电子书快照结束，耗时：789毫秒
2022-04-30 10:28:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433119174889472[0;39m start updating Ebook doc
2022-04-30 10:28:35.273 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433119174889472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:28:35.274 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433119174889472[0;39m ==> Parameters: 
2022-04-30 10:28:35.780 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433119174889472[0;39m <==    Updates: 1
2022-04-30 10:28:35.781 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433119174889472[0;39m update ends, take 780 millisecs
2022-04-30 10:28:35.781 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433122446446592[0;39m 生成今日电子书快照开始
2022-04-30 10:28:36.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433122446446592[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:36.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433122446446592[0;39m ==> Parameters: 
2022-04-30 10:28:36.594 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433122446446592[0;39m <==    Updates: 0
2022-04-30 10:28:36.596 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433122446446592[0;39m 生成今日电子书快照结束，耗时：815毫秒
2022-04-30 10:28:39.596 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:28:39.596 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:28:39.597 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:28:39.606 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:28:39.607 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:28:39.611 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:28:39.611 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:28:39.611 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:28:39.611 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:28:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433140146409472[0;39m 生成今日电子书快照开始
2022-04-30 10:28:40.248 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433140146409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:40.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433140146409472[0;39m ==> Parameters: 
2022-04-30 10:28:40.764 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433140146409472[0;39m <==    Updates: 0
2022-04-30 10:28:40.765 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433140146409472[0;39m 生成今日电子书快照结束，耗时：763毫秒
2022-04-30 10:28:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433161134706688[0;39m 生成今日电子书快照开始
2022-04-30 10:28:45.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433161134706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:45.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433161134706688[0;39m ==> Parameters: 
2022-04-30 10:28:45.736 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433161134706688[0;39m <==    Updates: 0
2022-04-30 10:28:45.738 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433161134706688[0;39m 生成今日电子书快照结束，耗时：732毫秒
2022-04-30 10:28:46.742 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:28:46.745 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：2 ms -------------
2022-04-30 10:28:46.746 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:28:46.747 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:28:46.747 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:28:46.748 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:28:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433182089449472[0;39m 生成今日电子书快照开始
2022-04-30 10:28:50.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433182089449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:50.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433182089449472[0;39m ==> Parameters: 
2022-04-30 10:28:50.776 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433182089449472[0;39m <==    Updates: 0
2022-04-30 10:28:50.777 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433182089449472[0;39m 生成今日电子书快照结束，耗时：773毫秒
2022-04-30 10:28:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433203077746688[0;39m 生成今日电子书快照开始
2022-04-30 10:28:55.289 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433203077746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:28:55.290 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433203077746688[0;39m ==> Parameters: 
2022-04-30 10:28:55.865 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433203077746688[0;39m <==    Updates: 0
2022-04-30 10:28:55.867 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433203077746688[0;39m 生成今日电子书快照结束，耗时：861毫秒
2022-04-30 10:29:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433224045072384[0;39m 生成今日电子书快照开始
2022-04-30 10:29:00.317 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433224045072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:00.319 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433224045072384[0;39m ==> Parameters: 
2022-04-30 10:29:00.916 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433224045072384[0;39m <==    Updates: 0
2022-04-30 10:29:00.918 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433224045072384[0;39m 生成今日电子书快照结束，耗时：912毫秒
2022-04-30 10:29:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433245016592384[0;39m start updating Ebook doc
2022-04-30 10:29:05.318 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433245016592384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:29:05.319 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433245016592384[0;39m ==> Parameters: 
2022-04-30 10:29:05.820 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433245016592384[0;39m <==    Updates: 1
2022-04-30 10:29:05.820 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433245016592384[0;39m update ends, take 814 millisecs
2022-04-30 10:29:05.820 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433248439144448[0;39m 生成今日电子书快照开始
2022-04-30 10:29:06.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433248439144448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:06.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433248439144448[0;39m ==> Parameters: 
2022-04-30 10:29:06.602 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433248439144448[0;39m <==    Updates: 0
2022-04-30 10:29:06.602 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433248439144448[0;39m 生成今日电子书快照结束，耗时：782毫秒
2022-04-30 10:29:08.893 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:29:08.894 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:29:08.895 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:29:08.900 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:29:10.688 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:29:10.691 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 64840 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:29:10.692 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:29:10.713 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:29:10.713 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:29:10.983 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:29:10.984 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:29:10.992 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:29:11.304 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:29:11.308 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:29:11.308 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:29:11.308 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:29:11.331 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:29:11.331 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 617 ms
2022-04-30 10:29:11.810 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:29:11.858 INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping     :54   [32m                  [0;39m Adding welcome page: class path resource [static/index.html]
2022-04-30 10:29:12.023 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:29:12.050 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:29:12.066 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:29:12.076 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:29:12.085 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.581 seconds (JVM running for 2.013)
2022-04-30 10:29:12.086 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:29:12.086 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:29:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433286963826688[0;39m 生成今日电子书快照开始
2022-04-30 10:29:15.015 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175433286963826688[0;39m HikariPool-1 - Starting...
2022-04-30 10:29:17.631 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175433286963826688[0;39m HikariPool-1 - Start completed.
2022-04-30 10:29:17.655 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433286963826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:17.682 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433286963826688[0;39m ==> Parameters: 
2022-04-30 10:29:17.957 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:29:17.957 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:29:17.958 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:29:17.967 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:29:17.968 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:29:17.972 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:29:17.973 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:29:17.973 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:29:17.973 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:29:18.176 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433286963826688[0;39m <==    Updates: 0
2022-04-30 10:29:18.179 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433286963826688[0;39m 生成今日电子书快照结束，耗时：3173毫秒
2022-04-30 10:29:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433307939540992[0;39m 生成今日电子书快照开始
2022-04-30 10:29:20.746 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433307939540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:20.749 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433307939540992[0;39m ==> Parameters: 
2022-04-30 10:29:21.339 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:29:21.341 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:29:21.343 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:29:21.343 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:29:21.344 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:29:21.344 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:29:21.677 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433307939540992[0;39m <==    Updates: 0
2022-04-30 10:29:21.678 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433307939540992[0;39m 生成今日电子书快照结束，耗时：1671毫秒
2022-04-30 10:29:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433328902672384[0;39m 生成今日电子书快照开始
2022-04-30 10:29:25.222 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433328902672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:25.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433328902672384[0;39m ==> Parameters: 
2022-04-30 10:29:25.698 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433328902672384[0;39m <==    Updates: 0
2022-04-30 10:29:25.701 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433328902672384[0;39m 生成今日电子书快照结束，耗时：696毫秒
2022-04-30 10:29:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433349890969600[0;39m 生成今日电子书快照开始
2022-04-30 10:29:30.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433349890969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:30.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433349890969600[0;39m ==> Parameters: 
2022-04-30 10:29:30.686 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433349890969600[0;39m <==    Updates: 0
2022-04-30 10:29:30.688 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433349890969600[0;39m 生成今日电子书快照结束，耗时：678毫秒
2022-04-30 10:29:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433370849906688[0;39m start updating Ebook doc
2022-04-30 10:29:35.246 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433370849906688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:29:35.248 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433370849906688[0;39m ==> Parameters: 
2022-04-30 10:29:35.704 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433370849906688[0;39m <==    Updates: 1
2022-04-30 10:29:35.706 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433370849906688[0;39m update ends, take 699 millisecs
2022-04-30 10:29:35.706 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433373790113792[0;39m 生成今日电子书快照开始
2022-04-30 10:29:35.707 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433373790113792[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:35.708 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433373790113792[0;39m ==> Parameters: 
2022-04-30 10:29:36.222 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433373790113792[0;39m <==    Updates: 0
2022-04-30 10:29:36.223 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433373790113792[0;39m 生成今日电子书快照结束，耗时：517毫秒
2022-04-30 10:29:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433391821426688[0;39m 生成今日电子书快照开始
2022-04-30 10:29:40.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433391821426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:40.243 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433391821426688[0;39m ==> Parameters: 
2022-04-30 10:29:40.750 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433391821426688[0;39m <==    Updates: 0
2022-04-30 10:29:40.752 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433391821426688[0;39m 生成今日电子书快照结束，耗时：745毫秒
2022-04-30 10:29:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433412792946688[0;39m 生成今日电子书快照开始
2022-04-30 10:29:45.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433412792946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:45.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433412792946688[0;39m ==> Parameters: 
2022-04-30 10:29:45.653 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433412792946688[0;39m <==    Updates: 0
2022-04-30 10:29:45.656 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433412792946688[0;39m 生成今日电子书快照结束，耗时：651毫秒
2022-04-30 10:29:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433433764466688[0;39m 生成今日电子书快照开始
2022-04-30 10:29:50.272 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433433764466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:50.274 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433433764466688[0;39m ==> Parameters: 
2022-04-30 10:29:50.724 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433433764466688[0;39m <==    Updates: 0
2022-04-30 10:29:50.726 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433433764466688[0;39m 生成今日电子书快照结束，耗时：720毫秒
2022-04-30 10:29:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433454735986688[0;39m 生成今日电子书快照开始
2022-04-30 10:29:55.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433454735986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:29:55.215 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433454735986688[0;39m ==> Parameters: 
2022-04-30 10:29:55.660 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433454735986688[0;39m <==    Updates: 0
2022-04-30 10:29:55.662 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433454735986688[0;39m 生成今日电子书快照结束，耗时：656毫秒
2022-04-30 10:30:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433475711700992[0;39m 生成今日电子书快照开始
2022-04-30 10:30:00.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433475711700992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:00.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433475711700992[0;39m ==> Parameters: 
2022-04-30 10:30:01.143 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433475711700992[0;39m <==    Updates: 0
2022-04-30 10:30:01.143 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433475711700992[0;39m 生成今日电子书快照结束，耗时：1133毫秒
2022-04-30 10:30:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433496679026688[0;39m 生成今日电子书快照开始
2022-04-30 10:30:05.280 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433496679026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:05.281 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433496679026688[0;39m ==> Parameters: 
2022-04-30 10:30:05.740 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433496679026688[0;39m <==    Updates: 0
2022-04-30 10:30:05.742 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433496679026688[0;39m 生成今日电子书快照结束，耗时：737毫秒
2022-04-30 10:30:05.743 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433499774423040[0;39m start updating Ebook doc
2022-04-30 10:30:05.744 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433499774423040[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:30:05.745 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433499774423040[0;39m ==> Parameters: 
2022-04-30 10:30:06.170 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433499774423040[0;39m <==    Updates: 1
2022-04-30 10:30:06.171 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433499774423040[0;39m update ends, take 428 millisecs
2022-04-30 10:30:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433517629575168[0;39m 生成今日电子书快照开始
2022-04-30 10:30:10.447 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433517629575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:10.449 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433517629575168[0;39m ==> Parameters: 
2022-04-30 10:30:10.882 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433517629575168[0;39m <==    Updates: 0
2022-04-30 10:30:10.885 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433517629575168[0;39m 生成今日电子书快照结束，耗时：884毫秒
2022-04-30 10:30:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433538622066688[0;39m 生成今日电子书快照开始
2022-04-30 10:30:15.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433538622066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:15.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433538622066688[0;39m ==> Parameters: 
2022-04-30 10:30:15.659 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433538622066688[0;39m <==    Updates: 0
2022-04-30 10:30:15.660 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433538622066688[0;39m 生成今日电子书快照结束，耗时：653毫秒
2022-04-30 10:30:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433559593586688[0;39m 生成今日电子书快照开始
2022-04-30 10:30:20.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433559593586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:20.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433559593586688[0;39m ==> Parameters: 
2022-04-30 10:30:20.659 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433559593586688[0;39m <==    Updates: 0
2022-04-30 10:30:20.662 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433559593586688[0;39m 生成今日电子书快照结束，耗时：656毫秒
2022-04-30 10:30:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433580569300992[0;39m 生成今日电子书快照开始
2022-04-30 10:30:25.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433580569300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:25.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433580569300992[0;39m ==> Parameters: 
2022-04-30 10:30:25.730 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433580569300992[0;39m <==    Updates: 0
2022-04-30 10:30:25.733 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433580569300992[0;39m 生成今日电子书快照结束，耗时：726毫秒
2022-04-30 10:30:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433601545015296[0;39m 生成今日电子书快照开始
2022-04-30 10:30:30.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433601545015296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:30.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433601545015296[0;39m ==> Parameters: 
2022-04-30 10:30:31.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433601545015296[0;39m <==    Updates: 0
2022-04-30 10:30:31.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433601545015296[0;39m 生成今日电子书快照结束，耗时：1053毫秒
2022-04-30 10:30:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433622499758080[0;39m start updating Ebook doc
2022-04-30 10:30:35.243 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433622499758080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:30:35.244 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433622499758080[0;39m ==> Parameters: 
2022-04-30 10:30:35.700 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433622499758080[0;39m <==    Updates: 1
2022-04-30 10:30:35.701 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433622499758080[0;39m update ends, take 697 millisecs
2022-04-30 10:30:35.702 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433625431576576[0;39m 生成今日电子书快照开始
2022-04-30 10:30:35.703 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433625431576576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:35.704 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433625431576576[0;39m ==> Parameters: 
2022-04-30 10:30:36.181 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433625431576576[0;39m <==    Updates: 0
2022-04-30 10:30:36.181 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433625431576576[0;39m 生成今日电子书快照结束，耗时：478毫秒
2022-04-30 10:30:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433643479666688[0;39m 生成今日电子书快照开始
2022-04-30 10:30:40.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433643479666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:40.245 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433643479666688[0;39m ==> Parameters: 
2022-04-30 10:30:40.715 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433643479666688[0;39m <==    Updates: 0
2022-04-30 10:30:40.717 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433643479666688[0;39m 生成今日电子书快照结束，耗时：709毫秒
2022-04-30 10:30:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433664446992384[0;39m 生成今日电子书快照开始
2022-04-30 10:30:45.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433664446992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:45.236 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433664446992384[0;39m ==> Parameters: 
2022-04-30 10:30:45.671 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433664446992384[0;39m <==    Updates: 0
2022-04-30 10:30:45.673 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433664446992384[0;39m 生成今日电子书快照结束，耗时：669毫秒
2022-04-30 10:30:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433685418512384[0;39m 生成今日电子书快照开始
2022-04-30 10:30:50.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433685418512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:50.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433685418512384[0;39m ==> Parameters: 
2022-04-30 10:30:50.659 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433685418512384[0;39m <==    Updates: 0
2022-04-30 10:30:50.660 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433685418512384[0;39m 生成今日电子书快照结束，耗时：654毫秒
2022-04-30 10:30:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433706394226688[0;39m 生成今日电子书快照开始
2022-04-30 10:30:55.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433706394226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:30:55.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433706394226688[0;39m ==> Parameters: 
2022-04-30 10:30:55.648 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433706394226688[0;39m <==    Updates: 0
2022-04-30 10:30:55.649 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433706394226688[0;39m 生成今日电子书快照结束，耗时：643毫秒
2022-04-30 10:31:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433727369940992[0;39m 生成今日电子书快照开始
2022-04-30 10:31:00.336 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433727369940992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:00.336 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433727369940992[0;39m ==> Parameters: 
2022-04-30 10:31:00.870 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433727369940992[0;39m <==    Updates: 0
2022-04-30 10:31:00.871 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433727369940992[0;39m 生成今日电子书快照结束，耗时：859毫秒
2022-04-30 10:31:05.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433748328878080[0;39m start updating Ebook doc
2022-04-30 10:31:05.235 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433748328878080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:31:05.237 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433748328878080[0;39m ==> Parameters: 
2022-04-30 10:31:05.782 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433748328878080[0;39m <==    Updates: 1
2022-04-30 10:31:05.783 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433748328878080[0;39m update ends, take 780 millisecs
2022-04-30 10:31:05.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433751604629504[0;39m 生成今日电子书快照开始
2022-04-30 10:31:05.989 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433751604629504[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:05.993 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433751604629504[0;39m ==> Parameters: 
2022-04-30 10:31:07.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433751604629504[0;39m <==    Updates: 0
2022-04-30 10:31:07.023 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433751604629504[0;39m 生成今日电子书快照结束，耗时：1239毫秒
2022-04-30 10:31:07.052 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:31:07.053 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/index.html
2022-04-30 10:31:07.053 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:31:07.054 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:31:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433769312980992[0;39m 生成今日电子书快照开始
2022-04-30 10:31:10.964 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433769312980992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:10.966 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433769312980992[0;39m ==> Parameters: 
2022-04-30 10:31:11.633 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433769312980992[0;39m <==    Updates: 0
2022-04-30 10:31:11.634 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433769312980992[0;39m 生成今日电子书快照结束，耗时：1625毫秒
2022-04-30 10:31:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433790280306688[0;39m 生成今日电子书快照开始
2022-04-30 10:31:15.759 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433790280306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:15.759 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433790280306688[0;39m ==> Parameters: 
2022-04-30 10:31:16.432 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433790280306688[0;39m <==    Updates: 0
2022-04-30 10:31:16.433 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433790280306688[0;39m 生成今日电子书快照结束，耗时：1427毫秒
2022-04-30 10:31:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433811251826688[0;39m 生成今日电子书快照开始
2022-04-30 10:31:20.882 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433811251826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:20.883 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433811251826688[0;39m ==> Parameters: 
2022-04-30 10:31:21.338 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433811251826688[0;39m <==    Updates: 0
2022-04-30 10:31:21.339 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433811251826688[0;39m 生成今日电子书快照结束，耗时：1333毫秒
2022-04-30 10:31:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433832223346688[0;39m 生成今日电子书快照开始
2022-04-30 10:31:25.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433832223346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:25.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433832223346688[0;39m ==> Parameters: 
2022-04-30 10:31:25.711 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433832223346688[0;39m <==    Updates: 0
2022-04-30 10:31:25.712 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433832223346688[0;39m 生成今日电子书快照结束，耗时：705毫秒
2022-04-30 10:31:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433853194866688[0;39m 生成今日电子书快照开始
2022-04-30 10:31:30.215 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433853194866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:30.216 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433853194866688[0;39m ==> Parameters: 
2022-04-30 10:31:30.663 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433853194866688[0;39m <==    Updates: 0
2022-04-30 10:31:30.664 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433853194866688[0;39m 生成今日电子书快照结束，耗时：659毫秒
2022-04-30 10:31:35.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433874170580992[0;39m start updating Ebook doc
2022-04-30 10:31:35.237 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433874170580992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:31:35.239 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433874170580992[0;39m ==> Parameters: 
2022-04-30 10:31:35.692 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433874170580992[0;39m <==    Updates: 1
2022-04-30 10:31:35.693 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433874170580992[0;39m update ends, take 686 millisecs
2022-04-30 10:31:35.693 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433877052067840[0;39m 生成今日电子书快照开始
2022-04-30 10:31:35.693 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433877052067840[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:35.694 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433877052067840[0;39m ==> Parameters: 
2022-04-30 10:31:36.925 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433877052067840[0;39m <==    Updates: 0
2022-04-30 10:31:36.925 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433877052067840[0;39m 生成今日电子书快照结束，耗时：1232毫秒
2022-04-30 10:31:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433895137906688[0;39m 生成今日电子书快照开始
2022-04-30 10:31:40.865 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433895137906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:40.866 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433895137906688[0;39m ==> Parameters: 
2022-04-30 10:31:41.718 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433895137906688[0;39m <==    Updates: 0
2022-04-30 10:31:41.719 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433895137906688[0;39m 生成今日电子书快照结束，耗时：1714毫秒
2022-04-30 10:31:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433916109426688[0;39m 生成今日电子书快照开始
2022-04-30 10:31:45.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433916109426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:45.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433916109426688[0;39m ==> Parameters: 
2022-04-30 10:31:45.938 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433916109426688[0;39m <==    Updates: 0
2022-04-30 10:31:45.939 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433916109426688[0;39m 生成今日电子书快照结束，耗时：934毫秒
2022-04-30 10:31:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433937076752384[0;39m 生成今日电子书快照开始
2022-04-30 10:31:50.295 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433937076752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:50.296 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433937076752384[0;39m ==> Parameters: 
2022-04-30 10:31:50.968 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433937076752384[0;39m <==    Updates: 0
2022-04-30 10:31:50.968 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433937076752384[0;39m 生成今日电子书快照结束，耗时：963毫秒
2022-04-30 10:31:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433958052466688[0;39m 生成今日电子书快照开始
2022-04-30 10:31:55.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433958052466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:31:55.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433958052466688[0;39m ==> Parameters: 
2022-04-30 10:31:55.734 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433958052466688[0;39m <==    Updates: 0
2022-04-30 10:31:55.735 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433958052466688[0;39m 生成今日电子书快照结束，耗时：729毫秒
2022-04-30 10:32:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175433979007209472[0;39m 生成今日电子书快照开始
2022-04-30 10:32:00.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433979007209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:00.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433979007209472[0;39m ==> Parameters: 
2022-04-30 10:32:00.677 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175433979007209472[0;39m <==    Updates: 0
2022-04-30 10:32:00.678 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175433979007209472[0;39m 生成今日电子书快照结束，耗时：676毫秒
2022-04-30 10:32:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175433999995506688[0;39m start updating Ebook doc
2022-04-30 10:32:05.209 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433999995506688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:32:05.210 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433999995506688[0;39m ==> Parameters: 
2022-04-30 10:32:06.114 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175433999995506688[0;39m <==    Updates: 1
2022-04-30 10:32:06.114 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175433999995506688[0;39m update ends, take 1109 millisecs
2022-04-30 10:32:06.114 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434004646989824[0;39m 生成今日电子书快照开始
2022-04-30 10:32:08.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434004646989824[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:08.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434004646989824[0;39m ==> Parameters: 
2022-04-30 10:32:08.959 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434004646989824[0;39m <==    Updates: 0
2022-04-30 10:32:08.959 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434004646989824[0;39m 生成今日电子书快照结束，耗时：2845毫秒
2022-04-30 10:32:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434020958638080[0;39m 生成今日电子书快照开始
2022-04-30 10:32:10.245 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434020958638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:10.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434020958638080[0;39m ==> Parameters: 
2022-04-30 10:32:10.986 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434020958638080[0;39m <==    Updates: 0
2022-04-30 10:32:10.988 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434020958638080[0;39m 生成今日电子书快照结束，耗时：984毫秒
2022-04-30 10:32:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434041942740992[0;39m 生成今日电子书快照开始
2022-04-30 10:32:15.407 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434041942740992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:15.408 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434041942740992[0;39m ==> Parameters: 
2022-04-30 10:32:16.169 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434041942740992[0;39m <==    Updates: 0
2022-04-30 10:32:16.169 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434041942740992[0;39m 生成今日电子书快照结束，耗时：1162毫秒
2022-04-30 10:32:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434062910066688[0;39m 生成今日电子书快照开始
2022-04-30 10:32:20.376 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434062910066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:20.376 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434062910066688[0;39m ==> Parameters: 
2022-04-30 10:32:20.802 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434062910066688[0;39m <==    Updates: 0
2022-04-30 10:32:20.802 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434062910066688[0;39m 生成今日电子书快照结束，耗时：797毫秒
2022-04-30 10:32:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434083889975296[0;39m 生成今日电子书快照开始
2022-04-30 10:32:25.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434083889975296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:25.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434083889975296[0;39m ==> Parameters: 
2022-04-30 10:32:25.649 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434083889975296[0;39m <==    Updates: 0
2022-04-30 10:32:25.650 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434083889975296[0;39m 生成今日电子书快照结束，耗时：642毫秒
2022-04-30 10:32:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434104853106688[0;39m 生成今日电子书快照开始
2022-04-30 10:32:30.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434104853106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:30.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434104853106688[0;39m ==> Parameters: 
2022-04-30 10:32:30.812 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434104853106688[0;39m <==    Updates: 0
2022-04-30 10:32:30.812 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434104853106688[0;39m 生成今日电子书快照结束，耗时：806毫秒
2022-04-30 10:32:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434125820432384[0;39m 生成今日电子书快照开始
2022-04-30 10:32:35.343 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434125820432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:35.343 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434125820432384[0;39m ==> Parameters: 
2022-04-30 10:32:36.270 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434125820432384[0;39m <==    Updates: 0
2022-04-30 10:32:36.271 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434125820432384[0;39m 生成今日电子书快照结束，耗时：1267毫秒
2022-04-30 10:32:36.271 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175434131134615552[0;39m start updating Ebook doc
2022-04-30 10:32:36.531 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434131134615552[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:32:36.531 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434131134615552[0;39m ==> Parameters: 
2022-04-30 10:32:37.132 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434131134615552[0;39m <==    Updates: 1
2022-04-30 10:32:37.133 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175434131134615552[0;39m update ends, take 862 millisecs
2022-04-30 10:32:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434146796146688[0;39m 生成今日电子书快照开始
2022-04-30 10:32:40.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434146796146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:40.247 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434146796146688[0;39m ==> Parameters: 
2022-04-30 10:32:40.983 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434146796146688[0;39m <==    Updates: 0
2022-04-30 10:32:40.984 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434146796146688[0;39m 生成今日电子书快照结束，耗时：978毫秒
2022-04-30 10:32:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434167767666688[0;39m 生成今日电子书快照开始
2022-04-30 10:32:45.279 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434167767666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:45.279 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434167767666688[0;39m ==> Parameters: 
2022-04-30 10:32:45.709 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434167767666688[0;39m <==    Updates: 0
2022-04-30 10:32:45.709 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434167767666688[0;39m 生成今日电子书快照结束，耗时：703毫秒
2022-04-30 10:32:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434188739186688[0;39m 生成今日电子书快照开始
2022-04-30 10:32:50.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434188739186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:50.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434188739186688[0;39m ==> Parameters: 
2022-04-30 10:32:50.733 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434188739186688[0;39m <==    Updates: 0
2022-04-30 10:32:50.734 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434188739186688[0;39m 生成今日电子书快照结束，耗时：728毫秒
2022-04-30 10:32:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434209710706688[0;39m 生成今日电子书快照开始
2022-04-30 10:32:55.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434209710706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:32:55.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434209710706688[0;39m ==> Parameters: 
2022-04-30 10:32:55.654 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434209710706688[0;39m <==    Updates: 0
2022-04-30 10:32:55.654 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434209710706688[0;39m 生成今日电子书快照结束，耗时：648毫秒
2022-04-30 10:33:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434230686420992[0;39m 生成今日电子书快照开始
2022-04-30 10:33:00.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434230686420992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:00.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434230686420992[0;39m ==> Parameters: 
2022-04-30 10:33:00.678 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434230686420992[0;39m <==    Updates: 0
2022-04-30 10:33:00.678 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434230686420992[0;39m 生成今日电子书快照结束，耗时：672毫秒
2022-04-30 10:33:03.790 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:33:03.791 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:33:03.792 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:33:03.797 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:33:05.804 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:33:05.807 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 67539 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:33:05.808 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:33:05.830 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:33:05.830 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:33:06.095 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:33:06.096 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:33:06.104 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:33:06.423 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:33:06.428 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:33:06.428 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:33:06.428 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:33:06.450 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:33:06.450 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 620 ms
2022-04-30 10:33:06.897 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:33:06.945 INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping     :54   [32m                  [0;39m Adding welcome page: class path resource [static/index.html]
2022-04-30 10:33:07.109 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:33:07.135 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:33:07.150 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:33:07.160 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:33:07.168 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.555 seconds (JVM running for 1.915)
2022-04-30 10:33:07.170 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:33:07.170 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:33:09.619 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:33:09.619 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:33:09.620 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:33:09.627 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:09.632 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：5 ms -------------
2022-04-30 10:33:09.663 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:09.663 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:09.663 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/session-storage.js
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/md5.js
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:09.664 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:09.665 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:09.665 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:09.665 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:09.666 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:33:09.666 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:09.666 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:09.668 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:09.669 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:33:09.669 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:09.669 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434272612683776[0;39m 生成今日电子书快照开始
2022-04-30 10:33:10.038 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175434272612683776[0;39m HikariPool-1 - Starting...
2022-04-30 10:33:12.211 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:12.212 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:33:12.212 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:12.212 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:12.214 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:12.214 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:33:12.214 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:12.214 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:12.217 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:12.218 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:33:12.219 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:12.219 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:12.220 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:12.220 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:33:12.221 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:12.221 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:12.226 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:12.227 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:33:12.227 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:12.227 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:12.396 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:12.396 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2022-04-30 10:33:12.396 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:12.397 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:13.484 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175434272612683776[0;39m HikariPool-1 - Start completed.
2022-04-30 10:33:13.492 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434272612683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:13.506 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434272612683776[0;39m ==> Parameters: 
2022-04-30 10:33:14.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434272612683776[0;39m <==    Updates: 0
2022-04-30 10:33:14.029 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434272612683776[0;39m 生成今日电子书快照结束，耗时：4026毫秒
2022-04-30 10:33:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434293596786688[0;39m 生成今日电子书快照开始
2022-04-30 10:33:15.236 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434293596786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:15.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434293596786688[0;39m ==> Parameters: 
2022-04-30 10:33:16.168 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434293596786688[0;39m <==    Updates: 0
2022-04-30 10:33:16.169 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434293596786688[0;39m 生成今日电子书快照结束，耗时：1163毫秒
2022-04-30 10:33:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434314559918080[0;39m 生成今日电子书快照开始
2022-04-30 10:33:20.403 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434314559918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:20.406 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434314559918080[0;39m ==> Parameters: 
2022-04-30 10:33:20.845 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434314559918080[0;39m <==    Updates: 0
2022-04-30 10:33:20.847 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434314559918080[0;39m 生成今日电子书快照结束，耗时：842毫秒
2022-04-30 10:33:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434335531438080[0;39m 生成今日电子书快照开始
2022-04-30 10:33:25.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434335531438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:25.243 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434335531438080[0;39m ==> Parameters: 
2022-04-30 10:33:25.757 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434335531438080[0;39m <==    Updates: 0
2022-04-30 10:33:25.759 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434335531438080[0;39m 生成今日电子书快照结束，耗时：755毫秒
2022-04-30 10:33:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434356511346688[0;39m 生成今日电子书快照开始
2022-04-30 10:33:30.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434356511346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:30.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434356511346688[0;39m ==> Parameters: 
2022-04-30 10:33:30.661 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434356511346688[0;39m <==    Updates: 0
2022-04-30 10:33:30.662 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434356511346688[0;39m 生成今日电子书快照结束，耗时：656毫秒
2022-04-30 10:33:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434377482866688[0;39m 生成今日电子书快照开始
2022-04-30 10:33:35.256 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434377482866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:35.258 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434377482866688[0;39m ==> Parameters: 
2022-04-30 10:33:35.887 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434377482866688[0;39m <==    Updates: 0
2022-04-30 10:33:35.888 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434377482866688[0;39m 生成今日电子书快照结束，耗时：882毫秒
2022-04-30 10:33:35.889 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175434381190631424[0;39m start updating Ebook doc
2022-04-30 10:33:36.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434381190631424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:33:36.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434381190631424[0;39m ==> Parameters: 
2022-04-30 10:33:36.558 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434381190631424[0;39m <==    Updates: 1
2022-04-30 10:33:36.560 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175434381190631424[0;39m update ends, take 671 millisecs
2022-04-30 10:33:37.443 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:37.445 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：2 ms -------------
2022-04-30 10:33:37.453 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:37.454 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:33:37.454 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:37.454 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434398458580992[0;39m 生成今日电子书快照开始
2022-04-30 10:33:40.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434398458580992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:40.271 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434398458580992[0;39m ==> Parameters: 
2022-04-30 10:33:41.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434398458580992[0;39m <==    Updates: 0
2022-04-30 10:33:41.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434398458580992[0;39m 生成今日电子书快照结束，耗时：1078毫秒
2022-04-30 10:33:42.652 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:33:42.653 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/md5.js
2022-04-30 10:33:42.653 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:33:42.654 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:33:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434419425906688[0;39m 生成今日电子书快照开始
2022-04-30 10:33:45.286 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434419425906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:45.289 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434419425906688[0;39m ==> Parameters: 
2022-04-30 10:33:45.749 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434419425906688[0;39m <==    Updates: 0
2022-04-30 10:33:45.751 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434419425906688[0;39m 生成今日电子书快照结束，耗时：744毫秒
2022-04-30 10:33:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434440380649472[0;39m 生成今日电子书快照开始
2022-04-30 10:33:50.253 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434440380649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:50.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434440380649472[0;39m ==> Parameters: 
2022-04-30 10:33:50.732 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434440380649472[0;39m <==    Updates: 0
2022-04-30 10:33:50.733 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434440380649472[0;39m 生成今日电子书快照结束，耗时：730毫秒
2022-04-30 10:33:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434461368946688[0;39m 生成今日电子书快照开始
2022-04-30 10:33:55.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434461368946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:33:55.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434461368946688[0;39m ==> Parameters: 
2022-04-30 10:33:56.446 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434461368946688[0;39m <==    Updates: 0
2022-04-30 10:33:56.447 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434461368946688[0;39m 生成今日电子书快照结束，耗时：1440毫秒
2022-04-30 10:34:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434482344660992[0;39m 生成今日电子书快照开始
2022-04-30 10:34:00.337 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434482344660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:00.338 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434482344660992[0;39m ==> Parameters: 
2022-04-30 10:34:00.849 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434482344660992[0;39m <==    Updates: 0
2022-04-30 10:34:00.850 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434482344660992[0;39m 生成今日电子书快照结束，耗时：842毫秒
2022-04-30 10:34:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434503311986688[0;39m 生成今日电子书快照开始
2022-04-30 10:34:05.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434503311986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:05.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434503311986688[0;39m ==> Parameters: 
2022-04-30 10:34:05.660 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434503311986688[0;39m <==    Updates: 0
2022-04-30 10:34:05.661 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434503311986688[0;39m 生成今日电子书快照结束，耗时：655毫秒
2022-04-30 10:34:05.661 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175434506063450112[0;39m start updating Ebook doc
2022-04-30 10:34:05.662 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434506063450112[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:34:05.662 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434506063450112[0;39m ==> Parameters: 
2022-04-30 10:34:06.540 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434506063450112[0;39m <==    Updates: 1
2022-04-30 10:34:06.540 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175434506063450112[0;39m update ends, take 879 millisecs
2022-04-30 10:34:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434524283506688[0;39m 生成今日电子书快照开始
2022-04-30 10:34:10.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434524283506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:10.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434524283506688[0;39m ==> Parameters: 
2022-04-30 10:34:11.552 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434524283506688[0;39m <==    Updates: 0
2022-04-30 10:34:11.553 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434524283506688[0;39m 生成今日电子书快照结束，耗时：1547毫秒
2022-04-30 10:34:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434545255026688[0;39m 生成今日电子书快照开始
2022-04-30 10:34:15.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434545255026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:15.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434545255026688[0;39m ==> Parameters: 
2022-04-30 10:34:15.899 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434545255026688[0;39m <==    Updates: 0
2022-04-30 10:34:15.900 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434545255026688[0;39m 生成今日电子书快照结束，耗时：894毫秒
2022-04-30 10:34:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434566222352384[0;39m 生成今日电子书快照开始
2022-04-30 10:34:20.545 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434566222352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:20.545 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434566222352384[0;39m ==> Parameters: 
2022-04-30 10:34:20.974 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434566222352384[0;39m <==    Updates: 0
2022-04-30 10:34:20.975 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434566222352384[0;39m 生成今日电子书快照结束，耗时：971毫秒
2022-04-30 10:34:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434587198066688[0;39m 生成今日电子书快照开始
2022-04-30 10:34:25.834 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434587198066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:25.835 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434587198066688[0;39m ==> Parameters: 
2022-04-30 10:34:26.283 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434587198066688[0;39m <==    Updates: 0
2022-04-30 10:34:26.284 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434587198066688[0;39m 生成今日电子书快照结束，耗时：1278毫秒
2022-04-30 10:34:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434608165392384[0;39m 生成今日电子书快照开始
2022-04-30 10:34:30.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434608165392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:30.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434608165392384[0;39m ==> Parameters: 
2022-04-30 10:34:30.749 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434608165392384[0;39m <==    Updates: 0
2022-04-30 10:34:30.749 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434608165392384[0;39m 生成今日电子书快照结束，耗时：744毫秒
2022-04-30 10:34:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175434629128523776[0;39m start updating Ebook doc
2022-04-30 10:34:35.324 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434629128523776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:34:35.324 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434629128523776[0;39m ==> Parameters: 
2022-04-30 10:34:35.831 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434629128523776[0;39m <==    Updates: 1
2022-04-30 10:34:35.832 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175434629128523776[0;39m update ends, take 830 millisecs
2022-04-30 10:34:35.832 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434632609796096[0;39m 生成今日电子书快照开始
2022-04-30 10:34:36.186 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434632609796096[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:36.186 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434632609796096[0;39m ==> Parameters: 
2022-04-30 10:34:36.765 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434632609796096[0;39m <==    Updates: 0
2022-04-30 10:34:36.766 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434632609796096[0;39m 生成今日电子书快照结束，耗时：934毫秒
2022-04-30 10:34:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434650100043776[0;39m 生成今日电子书快照开始
2022-04-30 10:34:40.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434650100043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:40.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434650100043776[0;39m ==> Parameters: 
2022-04-30 10:34:40.886 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434650100043776[0;39m <==    Updates: 0
2022-04-30 10:34:40.886 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434650100043776[0;39m 生成今日电子书快照结束，耗时：884毫秒
2022-04-30 10:34:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434671084146688[0;39m 生成今日电子书快照开始
2022-04-30 10:34:45.290 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434671084146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:45.291 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434671084146688[0;39m ==> Parameters: 
2022-04-30 10:34:45.905 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434671084146688[0;39m <==    Updates: 0
2022-04-30 10:34:45.906 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434671084146688[0;39m 生成今日电子书快照结束，耗时：899毫秒
2022-04-30 10:34:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434692055666688[0;39m 生成今日电子书快照开始
2022-04-30 10:34:50.266 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434692055666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:50.267 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434692055666688[0;39m ==> Parameters: 
2022-04-30 10:34:50.922 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434692055666688[0;39m <==    Updates: 0
2022-04-30 10:34:50.923 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434692055666688[0;39m 生成今日电子书快照结束，耗时：917毫秒
2022-04-30 10:34:54.947 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434712779722752[0;39m 生成今日电子书快照开始
2022-04-30 10:34:55.186 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434712779722752[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:34:55.188 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434712779722752[0;39m ==> Parameters: 
2022-04-30 10:34:55.665 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:34:55.666 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:34:55.666 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:34:55.675 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:34:55.677 WARN  com.zaxxer.hikari.pool.ProxyConnection            :182  [32m175434712779722752[0;39m HikariPool-1 - Connection com.mysql.cj.jdbc.ConnectionImpl@a73dd69 marked as broken because of SQLSTATE(08S01), ErrorCode(0)
com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 224 milliseconds ago. The last packet sent successfully to the server was 483 milliseconds ago.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor63.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy131.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor61.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy129.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	at com.sun.proxy.$Proxy91.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy105.getSnapshot(Unknown Source)
	at com.ameliawiki.wiki.service.EbookSnapshotService.getSnapshot(EbookSnapshotService.java:17)
	at com.ameliawiki.wiki.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:35)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet successfully received from the server was 224 milliseconds ago. The last packet sent successfully to the server was 483 milliseconds ago.
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:544)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:708)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:647)
	at com.mysql.cj.protocol.a.NativeProtocol.sendQueryPacket(NativeProtocol.java:946)
	at com.mysql.cj.NativeSession.execSQL(NativeSession.java:1075)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:930)
	... 44 common frames omitted
Caused by: java.net.SocketException: Socket closed
	at java.base/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:140)
	at com.mysql.cj.protocol.ReadAheadInputStream.fill(ReadAheadInputStream.java:107)
	at com.mysql.cj.protocol.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:150)
	at com.mysql.cj.protocol.ReadAheadInputStream.read(ReadAheadInputStream.java:180)
	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:133)
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:52)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:41)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:54)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:44)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:538)
	... 49 common frames omitted
2022-04-30 10:34:57.381 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:34:57.385 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 68824 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:34:57.386 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:34:57.407 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:34:57.407 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:34:57.703 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:34:57.704 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:34:57.713 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:34:58.055 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:34:58.062 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:34:58.062 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:34:58.062 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:34:58.088 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:34:58.088 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 680 ms
2022-04-30 10:34:58.549 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:34:58.595 INFO  o.s.b.a.web.servlet.WelcomePageHandlerMapping     :54   [32m                  [0;39m Adding welcome page: class path resource [static/index.html]
2022-04-30 10:34:58.743 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:34:58.771 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:34:58.786 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:34:58.797 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:34:58.806 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.639 seconds (JVM running for 2.03)
2022-04-30 10:34:58.808 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:34:58.808 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:35:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434733998706688[0;39m 生成今日电子书快照开始
2022-04-30 10:35:00.018 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175434733998706688[0;39m HikariPool-1 - Starting...
2022-04-30 10:35:02.783 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:35:02.783 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:35:02.784 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:35:02.793 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:02.794 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/md5.js
2022-04-30 10:35:02.794 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:02.794 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:03.102 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175434733998706688[0;39m HikariPool-1 - Start completed.
2022-04-30 10:35:03.108 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434733998706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:03.121 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434733998706688[0;39m ==> Parameters: 
2022-04-30 10:35:03.651 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434733998706688[0;39m <==    Updates: 0
2022-04-30 10:35:03.660 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434733998706688[0;39m 生成今日电子书快照结束，耗时：3654毫秒
2022-04-30 10:35:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175434754966032384[0;39m start updating Ebook doc
2022-04-30 10:35:05.278 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434754966032384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:35:05.283 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434754966032384[0;39m ==> Parameters: 
2022-04-30 10:35:05.781 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434754966032384[0;39m <==    Updates: 1
2022-04-30 10:35:05.783 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175434754966032384[0;39m update ends, take 778 millisecs
2022-04-30 10:35:05.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434758237589504[0;39m 生成今日电子书快照开始
2022-04-30 10:35:05.785 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434758237589504[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:05.787 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434758237589504[0;39m ==> Parameters: 
2022-04-30 10:35:06.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434758237589504[0;39m <==    Updates: 0
2022-04-30 10:35:06.270 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434758237589504[0;39m 生成今日电子书快照结束，耗时：485毫秒
2022-04-30 10:35:06.898 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:06.898 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/static.js/md5.js
2022-04-30 10:35:06.899 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:06.899 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434775937552384[0;39m 生成今日电子书快照开始
2022-04-30 10:35:10.286 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434775937552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:10.288 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434775937552384[0;39m ==> Parameters: 
2022-04-30 10:35:10.473 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:10.490 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：17 ms -------------
2022-04-30 10:35:10.711 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:10.711 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2022-04-30 10:35:10.711 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:10.711 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:10.809 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434775937552384[0;39m <==    Updates: 0
2022-04-30 10:35:10.809 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434775937552384[0;39m 生成今日电子书快照结束，耗时：804毫秒
2022-04-30 10:35:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434796921655296[0;39m 生成今日电子书快照开始
2022-04-30 10:35:15.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434796921655296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:15.262 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434796921655296[0;39m ==> Parameters: 
2022-04-30 10:35:15.782 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434796921655296[0;39m <==    Updates: 0
2022-04-30 10:35:15.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434796921655296[0;39m 生成今日电子书快照结束，耗时：776毫秒
2022-04-30 10:35:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434817872203776[0;39m 生成今日电子书快照开始
2022-04-30 10:35:20.161 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:20.163 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：2 ms -------------
2022-04-30 10:35:20.172 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:20.173 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:35:20.173 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:20.173 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:20.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434817872203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:20.256 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434817872203776[0;39m ==> Parameters: 
2022-04-30 10:35:20.782 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434817872203776[0;39m <==    Updates: 0
2022-04-30 10:35:20.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434817872203776[0;39m 生成今日电子书快照结束，耗时：781毫秒
2022-04-30 10:35:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434838856306688[0;39m 生成今日电子书快照开始
2022-04-30 10:35:25.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434838856306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:25.270 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434838856306688[0;39m ==> Parameters: 
2022-04-30 10:35:25.861 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434838856306688[0;39m <==    Updates: 0
2022-04-30 10:35:25.863 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434838856306688[0;39m 生成今日电子书快照结束，耗时：855毫秒
2022-04-30 10:35:26.717 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.720 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：2 ms -------------
2022-04-30 10:35:26.762 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.763 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/md5.js
2022-04-30 10:35:26.763 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.764 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.773 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.773 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/session-storage.js
2022-04-30 10:35:26.774 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.775 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:35:26.775 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.775 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.775 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.776 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:35:26.776 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.776 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.777 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.777 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:26.777 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.777 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.778 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.778 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:35:26.778 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.778 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.779 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.780 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.804 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.805 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:35:26.805 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.805 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.807 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.810 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.810 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:26.811 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.811 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:26.967 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:26.967 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2022-04-30 10:35:26.967 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:26.967 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434859823632384[0;39m 生成今日电子书快照开始
2022-04-30 10:35:30.308 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434859823632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:30.309 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434859823632384[0;39m ==> Parameters: 
2022-04-30 10:35:30.826 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434859823632384[0;39m <==    Updates: 0
2022-04-30 10:35:30.827 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434859823632384[0;39m 生成今日电子书快照结束，耗时：822毫秒
2022-04-30 10:35:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175434880782569472[0;39m start updating Ebook doc
2022-04-30 10:35:35.294 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434880782569472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:35:35.294 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434880782569472[0;39m ==> Parameters: 
2022-04-30 10:35:35.818 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175434880782569472[0;39m <==    Updates: 1
2022-04-30 10:35:35.818 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175434880782569472[0;39m update ends, take 817 millisecs
2022-04-30 10:35:35.818 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434884209315840[0;39m 生成今日电子书快照开始
2022-04-30 10:35:36.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434884209315840[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:36.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434884209315840[0;39m ==> Parameters: 
2022-04-30 10:35:36.796 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434884209315840[0;39m <==    Updates: 0
2022-04-30 10:35:36.797 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434884209315840[0;39m 生成今日电子书快照结束，耗时：979毫秒
2022-04-30 10:35:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434901770866688[0;39m 生成今日电子书快照开始
2022-04-30 10:35:40.284 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434901770866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:40.285 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434901770866688[0;39m ==> Parameters: 
2022-04-30 10:35:40.817 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434901770866688[0;39m <==    Updates: 0
2022-04-30 10:35:40.818 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434901770866688[0;39m 生成今日电子书快照结束，耗时：812毫秒
2022-04-30 10:35:41.518 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.525 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：6 ms -------------
2022-04-30 10:35:41.554 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.558 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/md5.js
2022-04-30 10:35:41.559 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.559 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:41.561 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.561 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.561 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:35:41.561 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/session-storage.js
2022-04-30 10:35:41.562 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.562 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:41.563 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.564 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:35:41.561 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.566 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:35:41.566 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.566 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:41.562 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.567 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.567 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:41.567 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:41.567 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.567 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:41.566 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.568 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:41.571 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.571 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:41.571 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.571 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:41.620 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:41.622 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2022-04-30 10:35:41.622 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:41.623 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434922733998080[0;39m 生成今日电子书快照开始
2022-04-30 10:35:45.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434922733998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:45.266 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434922733998080[0;39m ==> Parameters: 
2022-04-30 10:35:45.798 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434922733998080[0;39m <==    Updates: 0
2022-04-30 10:35:45.800 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434922733998080[0;39m 生成今日电子书快照结束，耗时：795毫秒
2022-04-30 10:35:49.715 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:49.721 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：6 ms -------------
2022-04-30 10:35:49.724 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:49.725 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:35:49.726 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:49.726 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434943709712384[0;39m 生成今日电子书快照开始
2022-04-30 10:35:50.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434943709712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:35:50.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434943709712384[0;39m ==> Parameters: 
2022-04-30 10:35:50.781 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434943709712384[0;39m <==    Updates: 0
2022-04-30 10:35:50.782 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434943709712384[0;39m 生成今日电子书快照结束，耗时：778毫秒
2022-04-30 10:35:53.677 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:35:53.678 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:35:53.679 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:35:53.685 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:35:55.352 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:35:55.354 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 69423 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:35:55.355 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:35:55.375 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:35:55.376 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:35:55.661 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:35:55.662 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:35:55.670 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:35:55.990 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:35:55.994 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:35:55.994 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:35:55.994 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:35:56.022 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:35:56.023 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 647 ms
2022-04-30 10:35:56.498 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:35:56.702 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:35:56.729 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:35:56.745 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:35:56.756 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:35:56.764 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.598 seconds (JVM running for 1.955)
2022-04-30 10:35:56.766 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:35:56.766 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:35:58.192 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:35:58.192 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:35:58.193 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:35:58.202 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.210 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：8 ms -------------
2022-04-30 10:35:58.231 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.231 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.231 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/md5.js
2022-04-30 10:35:58.231 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.231 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/session-storage.js
2022-04-30 10:35:58.231 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.232 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.232 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:35:58.232 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.232 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.233 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.234 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:58.234 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.234 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:35:58.234 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.234 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.234 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.261 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.261 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.261 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.261 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.260 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.261 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.264 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.264 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:35:58.264 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.264 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:35:58.427 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:35:58.427 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2022-04-30 10:35:58.427 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:35:58.427 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175434985661140992[0;39m 生成今日电子书快照开始
2022-04-30 10:36:00.031 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175434985661140992[0;39m HikariPool-1 - Starting...
2022-04-30 10:36:03.363 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175434985661140992[0;39m HikariPool-1 - Start completed.
2022-04-30 10:36:03.413 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434985661140992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:03.435 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434985661140992[0;39m ==> Parameters: 
2022-04-30 10:36:03.986 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175434985661140992[0;39m <==    Updates: 0
2022-04-30 10:36:03.991 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175434985661140992[0;39m 生成今日电子书快照结束，耗时：3982毫秒
2022-04-30 10:36:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435006624272384[0;39m 生成今日电子书快照开始
2022-04-30 10:36:05.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435006624272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:05.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435006624272384[0;39m ==> Parameters: 
2022-04-30 10:36:05.716 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435006624272384[0;39m <==    Updates: 0
2022-04-30 10:36:05.717 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435006624272384[0;39m 生成今日电子书快照结束，耗时：712毫秒
2022-04-30 10:36:05.718 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175435009619005440[0;39m start updating Ebook doc
2022-04-30 10:36:05.727 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175435009619005440[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:36:05.727 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175435009619005440[0;39m ==> Parameters: 
2022-04-30 10:36:06.256 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175435009619005440[0;39m <==    Updates: 1
2022-04-30 10:36:06.258 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175435009619005440[0;39m update ends, take 540 millisecs
2022-04-30 10:36:06.667 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.668 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:36:06.694 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.695 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/md5.js
2022-04-30 10:36:06.695 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.695 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.696 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.697 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:36:06.697 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.697 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.694 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.698 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/session-storage.js
2022-04-30 10:36:06.698 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.698 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.700 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.700 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/chunk-vendors.02b71d52.js
2022-04-30 10:36:06.701 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.701 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.697 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.702 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/chunk-vendors.095d1b89.css
2022-04-30 10:36:06.702 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.703 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.706 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.707 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:36:06.707 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.707 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.717 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.717 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/css/app.a1745acb.css
2022-04-30 10:36:06.717 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.717 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.721 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.722 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/js/app.ab8233d6.js
2022-04-30 10:36:06.722 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.722 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:06.848 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:36:06.849 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/favicon.ico
2022-04-30 10:36:06.849 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :48   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:36:06.850 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :50   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:36:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435027599986688[0;39m 生成今日电子书快照开始
2022-04-30 10:36:10.306 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435027599986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:10.308 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435027599986688[0;39m ==> Parameters: 
2022-04-30 10:36:10.855 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435027599986688[0;39m <==    Updates: 0
2022-04-30 10:36:10.856 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435027599986688[0;39m 生成今日电子书快照结束，耗时：848毫秒
2022-04-30 10:36:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435048571506688[0;39m 生成今日电子书快照开始
2022-04-30 10:36:15.247 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435048571506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:15.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435048571506688[0;39m ==> Parameters: 
2022-04-30 10:36:15.765 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435048571506688[0;39m <==    Updates: 0
2022-04-30 10:36:15.767 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435048571506688[0;39m 生成今日电子书快照结束，耗时：760毫秒
2022-04-30 10:36:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435069547220992[0;39m 生成今日电子书快照开始
2022-04-30 10:36:20.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435069547220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:20.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435069547220992[0;39m ==> Parameters: 
2022-04-30 10:36:20.752 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435069547220992[0;39m <==    Updates: 0
2022-04-30 10:36:20.752 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435069547220992[0;39m 生成今日电子书快照结束，耗时：745毫秒
2022-04-30 10:36:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435090497769472[0;39m 生成今日电子书快照开始
2022-04-30 10:36:25.260 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435090497769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:25.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435090497769472[0;39m ==> Parameters: 
2022-04-30 10:36:25.907 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435090497769472[0;39m <==    Updates: 0
2022-04-30 10:36:25.908 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435090497769472[0;39m 生成今日电子书快照结束，耗时：906毫秒
2022-04-30 10:36:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435111486066688[0;39m 生成今日电子书快照开始
2022-04-30 10:36:30.293 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435111486066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:30.295 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435111486066688[0;39m ==> Parameters: 
2022-04-30 10:36:30.958 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435111486066688[0;39m <==    Updates: 0
2022-04-30 10:36:30.959 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435111486066688[0;39m 生成今日电子书快照结束，耗时：953毫秒
2022-04-30 10:36:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435132457586688[0;39m 生成今日电子书快照开始
2022-04-30 10:36:35.342 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435132457586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:35.343 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435132457586688[0;39m ==> Parameters: 
2022-04-30 10:36:35.924 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435132457586688[0;39m <==    Updates: 0
2022-04-30 10:36:35.924 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435132457586688[0;39m 生成今日电子书快照结束，耗时：917毫秒
2022-04-30 10:36:35.925 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175435136316346368[0;39m start updating Ebook doc
2022-04-30 10:36:36.138 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175435136316346368[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:36:36.139 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175435136316346368[0;39m ==> Parameters: 
2022-04-30 10:36:36.798 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175435136316346368[0;39m <==    Updates: 1
2022-04-30 10:36:36.799 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175435136316346368[0;39m update ends, take 874 millisecs
2022-04-30 10:36:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435153429106688[0;39m 生成今日电子书快照开始
2022-04-30 10:36:40.328 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435153429106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:40.329 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435153429106688[0;39m ==> Parameters: 
2022-04-30 10:36:40.894 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435153429106688[0;39m <==    Updates: 0
2022-04-30 10:36:40.896 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435153429106688[0;39m 生成今日电子书快照结束，耗时：891毫秒
2022-04-30 10:36:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435174392238080[0;39m 生成今日电子书快照开始
2022-04-30 10:36:45.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435174392238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:45.266 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435174392238080[0;39m ==> Parameters: 
2022-04-30 10:36:45.809 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435174392238080[0;39m <==    Updates: 0
2022-04-30 10:36:45.810 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435174392238080[0;39m 生成今日电子书快照结束，耗时：806毫秒
2022-04-30 10:36:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435195363758080[0;39m 生成今日电子书快照开始
2022-04-30 10:36:50.283 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435195363758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:36:50.283 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435195363758080[0;39m ==> Parameters: 
2022-04-30 10:36:50.805 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435195363758080[0;39m <==    Updates: 0
2022-04-30 10:36:50.806 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435195363758080[0;39m 生成今日电子书快照结束，耗时：803毫秒
2022-04-30 10:36:52.595 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:36:52.596 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:36:52.597 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:36:52.601 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:39:40.393 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 71732 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:39:40.392 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:39:40.395 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:39:40.416 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:39:40.417 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:39:40.710 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:39:40.710 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:39:40.719 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:39:41.081 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:39:41.086 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:39:41.086 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:39:41.086 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:39:41.114 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:39:41.114 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 697 ms
2022-04-30 10:39:41.584 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:39:41.799 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:39:41.830 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:39:41.848 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:39:41.877 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:39:41.889 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.694 seconds (JVM running for 2.018)
2022-04-30 10:39:41.891 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:39:41.891 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:39:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435929379540992[0;39m 生成今日电子书快照开始
2022-04-30 10:39:45.033 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175435929379540992[0;39m HikariPool-1 - Starting...
2022-04-30 10:39:45.443 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:39:45.443 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:39:45.444 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:39:45.454 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.462 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：7 ms -------------
2022-04-30 10:39:45.504 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.506 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.507 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.507 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：3 ms -------------
2022-04-30 10:39:45.508 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：2 ms -------------
2022-04-30 10:39:45.508 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:39:45.509 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.512 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.512 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：3 ms -------------
2022-04-30 10:39:45.513 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.513 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:39:45.518 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.518 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.519 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:39:45.519 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:39:45.518 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.521 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:39:45.537 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：24 ms -------------
2022-04-30 10:39:45.591 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.601 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：10 ms -------------
2022-04-30 10:39:45.694 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.694 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.704 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：10 ms -------------
2022-04-30 10:39:45.718 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：24 ms -------------
2022-04-30 10:39:45.904 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:39:45.910 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：6 ms -------------
2022-04-30 10:39:48.342 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175435929379540992[0;39m HikariPool-1 - Start completed.
2022-04-30 10:39:48.362 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435929379540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:39:48.387 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435929379540992[0;39m ==> Parameters: 
2022-04-30 10:39:49.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435929379540992[0;39m <==    Updates: 0
2022-04-30 10:39:49.044 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435929379540992[0;39m 生成今日电子书快照结束，耗时：4036毫秒
2022-04-30 10:39:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435950346866688[0;39m 生成今日电子书快照开始
2022-04-30 10:39:50.339 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435950346866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:39:50.342 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435950346866688[0;39m ==> Parameters: 
2022-04-30 10:39:50.857 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435950346866688[0;39m <==    Updates: 0
2022-04-30 10:39:50.858 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435950346866688[0;39m 生成今日电子书快照结束，耗时：851毫秒
2022-04-30 10:39:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435971314192384[0;39m 生成今日电子书快照开始
2022-04-30 10:39:55.332 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435971314192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:39:55.333 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435971314192384[0;39m ==> Parameters: 
2022-04-30 10:39:55.855 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435971314192384[0;39m <==    Updates: 0
2022-04-30 10:39:55.856 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435971314192384[0;39m 生成今日电子书快照结束，耗时：851毫秒
2022-04-30 10:40:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175435992289906688[0;39m 生成今日电子书快照开始
2022-04-30 10:40:00.285 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435992289906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:00.285 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435992289906688[0;39m ==> Parameters: 
2022-04-30 10:40:00.837 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175435992289906688[0;39m <==    Updates: 0
2022-04-30 10:40:00.838 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175435992289906688[0;39m 生成今日电子书快照结束，耗时：832毫秒
2022-04-30 10:40:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436013261426688[0;39m start updating Ebook doc
2022-04-30 10:40:05.269 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436013261426688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:40:05.270 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436013261426688[0;39m ==> Parameters: 
2022-04-30 10:40:05.833 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436013261426688[0;39m <==    Updates: 1
2022-04-30 10:40:05.834 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436013261426688[0;39m update ends, take 828 millisecs
2022-04-30 10:40:05.834 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436016738504704[0;39m 生成今日电子书快照开始
2022-04-30 10:40:06.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436016738504704[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:06.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436016738504704[0;39m ==> Parameters: 
2022-04-30 10:40:06.620 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436016738504704[0;39m <==    Updates: 0
2022-04-30 10:40:06.621 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436016738504704[0;39m 生成今日电子书快照结束，耗时：787毫秒
2022-04-30 10:40:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436034245529600[0;39m 生成今日电子书快照开始
2022-04-30 10:40:10.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436034245529600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:10.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436034245529600[0;39m ==> Parameters: 
2022-04-30 10:40:10.764 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436034245529600[0;39m <==    Updates: 0
2022-04-30 10:40:10.765 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436034245529600[0;39m 生成今日电子书快照结束，耗时：756毫秒
2022-04-30 10:40:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436055200272384[0;39m 生成今日电子书快照开始
2022-04-30 10:40:15.256 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436055200272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:15.258 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436055200272384[0;39m ==> Parameters: 
2022-04-30 10:40:15.776 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436055200272384[0;39m <==    Updates: 0
2022-04-30 10:40:15.777 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436055200272384[0;39m 生成今日电子书快照结束，耗时：772毫秒
2022-04-30 10:40:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436076175986688[0;39m 生成今日电子书快照开始
2022-04-30 10:40:20.274 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436076175986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:20.275 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436076175986688[0;39m ==> Parameters: 
2022-04-30 10:40:20.817 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436076175986688[0;39m <==    Updates: 0
2022-04-30 10:40:20.818 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436076175986688[0;39m 生成今日电子书快照结束，耗时：812毫秒
2022-04-30 10:40:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436097147506688[0;39m 生成今日电子书快照开始
2022-04-30 10:40:25.259 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436097147506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:25.260 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436097147506688[0;39m ==> Parameters: 
2022-04-30 10:40:25.869 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436097147506688[0;39m <==    Updates: 0
2022-04-30 10:40:25.871 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436097147506688[0;39m 生成今日电子书快照结束，耗时：864毫秒
2022-04-30 10:40:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436118119026688[0;39m 生成今日电子书快照开始
2022-04-30 10:40:30.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436118119026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:30.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436118119026688[0;39m ==> Parameters: 
2022-04-30 10:40:30.832 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436118119026688[0;39m <==    Updates: 0
2022-04-30 10:40:30.834 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436118119026688[0;39m 生成今日电子书快照结束，耗时：827毫秒
2022-04-30 10:40:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436139073769472[0;39m start updating Ebook doc
2022-04-30 10:40:35.256 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436139073769472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:40:35.258 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436139073769472[0;39m ==> Parameters: 
2022-04-30 10:40:35.794 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436139073769472[0;39m <==    Updates: 1
2022-04-30 10:40:35.795 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436139073769472[0;39m update ends, take 792 millisecs
2022-04-30 10:40:35.796 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436142408241152[0;39m 生成今日电子书快照开始
2022-04-30 10:40:36.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436142408241152[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:36.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436142408241152[0;39m ==> Parameters: 
2022-04-30 10:40:36.618 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436142408241152[0;39m <==    Updates: 0
2022-04-30 10:40:36.619 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436142408241152[0;39m 生成今日电子书快照结束，耗时：823毫秒
2022-04-30 10:40:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436160057872384[0;39m 生成今日电子书快照开始
2022-04-30 10:40:40.483 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436160057872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:40.486 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436160057872384[0;39m ==> Parameters: 
2022-04-30 10:40:40.983 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436160057872384[0;39m <==    Updates: 0
2022-04-30 10:40:40.984 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436160057872384[0;39m 生成今日电子书快照结束，耗时：979毫秒
2022-04-30 10:40:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436181033586688[0;39m 生成今日电子书快照开始
2022-04-30 10:40:45.287 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436181033586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:45.291 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436181033586688[0;39m ==> Parameters: 
2022-04-30 10:40:45.985 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436181033586688[0;39m <==    Updates: 0
2022-04-30 10:40:45.987 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436181033586688[0;39m 生成今日电子书快照结束，耗时：980毫秒
2022-04-30 10:40:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436201996718080[0;39m 生成今日电子书快照开始
2022-04-30 10:40:50.248 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436201996718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:50.251 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436201996718080[0;39m ==> Parameters: 
2022-04-30 10:40:50.696 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436201996718080[0;39m <==    Updates: 0
2022-04-30 10:40:50.697 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436201996718080[0;39m 生成今日电子书快照结束，耗时：692毫秒
2022-04-30 10:40:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436222959849472[0;39m 生成今日电子书快照开始
2022-04-30 10:40:55.406 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436222959849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:40:55.407 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436222959849472[0;39m ==> Parameters: 
2022-04-30 10:40:55.920 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436222959849472[0;39m <==    Updates: 0
2022-04-30 10:40:55.922 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436222959849472[0;39m 生成今日电子书快照结束，耗时：917毫秒
2022-04-30 10:41:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436243956535296[0;39m 生成今日电子书快照开始
2022-04-30 10:41:00.425 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436243956535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:00.427 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436243956535296[0;39m ==> Parameters: 
2022-04-30 10:41:00.908 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436243956535296[0;39m <==    Updates: 0
2022-04-30 10:41:00.912 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436243956535296[0;39m 生成今日电子书快照结束，耗时：904毫秒
2022-04-30 10:41:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436264902889472[0;39m start updating Ebook doc
2022-04-30 10:41:05.260 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436264902889472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:41:05.262 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436264902889472[0;39m ==> Parameters: 
2022-04-30 10:41:05.868 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436264902889472[0;39m <==    Updates: 1
2022-04-30 10:41:05.869 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436264902889472[0;39m update ends, take 867 millisecs
2022-04-30 10:41:05.870 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436268547739648[0;39m 生成今日电子书快照开始
2022-04-30 10:41:06.129 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436268547739648[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:06.131 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436268547739648[0;39m ==> Parameters: 
2022-04-30 10:41:06.726 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436268547739648[0;39m <==    Updates: 0
2022-04-30 10:41:06.726 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436268547739648[0;39m 生成今日电子书快照结束，耗时：855毫秒
2022-04-30 10:41:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436285882798080[0;39m 生成今日电子书快照开始
2022-04-30 10:41:10.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436285882798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:10.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436285882798080[0;39m ==> Parameters: 
2022-04-30 10:41:10.827 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436285882798080[0;39m <==    Updates: 0
2022-04-30 10:41:10.829 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436285882798080[0;39m 生成今日电子书快照结束，耗时：825毫秒
2022-04-30 10:41:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436306858512384[0;39m 生成今日电子书快照开始
2022-04-30 10:41:15.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436306858512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:15.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436306858512384[0;39m ==> Parameters: 
2022-04-30 10:41:15.684 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436306858512384[0;39m <==    Updates: 0
2022-04-30 10:41:15.687 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436306858512384[0;39m 生成今日电子书快照结束，耗时：682毫秒
2022-04-30 10:41:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436327830032384[0;39m 生成今日电子书快照开始
2022-04-30 10:41:20.277 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436327830032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:20.278 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436327830032384[0;39m ==> Parameters: 
2022-04-30 10:41:20.785 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436327830032384[0;39m <==    Updates: 0
2022-04-30 10:41:20.788 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436327830032384[0;39m 生成今日电子书快照结束，耗时：783毫秒
2022-04-30 10:41:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436348805746688[0;39m 生成今日电子书快照开始
2022-04-30 10:41:25.268 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436348805746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:25.270 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436348805746688[0;39m ==> Parameters: 
2022-04-30 10:41:25.782 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436348805746688[0;39m <==    Updates: 0
2022-04-30 10:41:25.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436348805746688[0;39m 生成今日电子书快照结束，耗时：775毫秒
2022-04-30 10:41:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436369773072384[0;39m 生成今日电子书快照开始
2022-04-30 10:41:30.243 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436369773072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:30.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436369773072384[0;39m ==> Parameters: 
2022-04-30 10:41:30.752 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436369773072384[0;39m <==    Updates: 0
2022-04-30 10:41:30.754 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436369773072384[0;39m 生成今日电子书快照结束，耗时：749毫秒
2022-04-30 10:41:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436390740398080[0;39m start updating Ebook doc
2022-04-30 10:41:35.261 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436390740398080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:41:35.262 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436390740398080[0;39m ==> Parameters: 
2022-04-30 10:41:35.784 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436390740398080[0;39m <==    Updates: 1
2022-04-30 10:41:35.786 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436390740398080[0;39m update ends, take 782 millisecs
2022-04-30 10:41:35.786 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436394024538112[0;39m 生成今日电子书快照开始
2022-04-30 10:41:36.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436394024538112[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:36.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436394024538112[0;39m ==> Parameters: 
2022-04-30 10:41:36.521 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436394024538112[0;39m <==    Updates: 0
2022-04-30 10:41:36.523 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436394024538112[0;39m 生成今日电子书快照结束，耗时：737毫秒
2022-04-30 10:41:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436411720306688[0;39m 生成今日电子书快照开始
2022-04-30 10:41:40.284 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436411720306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:40.286 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436411720306688[0;39m ==> Parameters: 
2022-04-30 10:41:40.784 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436411720306688[0;39m <==    Updates: 0
2022-04-30 10:41:40.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436411720306688[0;39m 生成今日电子书快照结束，耗时：779毫秒
2022-04-30 10:41:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436432687632384[0;39m 生成今日电子书快照开始
2022-04-30 10:41:45.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436432687632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:45.262 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436432687632384[0;39m ==> Parameters: 
2022-04-30 10:41:45.781 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436432687632384[0;39m <==    Updates: 0
2022-04-30 10:41:45.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436432687632384[0;39m 生成今日电子书快照结束，耗时：780毫秒
2022-04-30 10:41:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436453646569472[0;39m 生成今日电子书快照开始
2022-04-30 10:41:50.260 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436453646569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:50.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436453646569472[0;39m ==> Parameters: 
2022-04-30 10:41:50.908 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436453646569472[0;39m <==    Updates: 0
2022-04-30 10:41:50.910 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436453646569472[0;39m 生成今日电子书快照结束，耗时：908毫秒
2022-04-30 10:41:55.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436474643255296[0;39m 生成今日电子书快照开始
2022-04-30 10:41:55.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436474643255296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:41:55.263 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436474643255296[0;39m ==> Parameters: 
2022-04-30 10:41:55.803 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436474643255296[0;39m <==    Updates: 0
2022-04-30 10:41:55.812 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436474643255296[0;39m 生成今日电子书快照结束，耗时：803毫秒
2022-04-30 10:42:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436495602192384[0;39m 生成今日电子书快照开始
2022-04-30 10:42:00.278 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436495602192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:00.281 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436495602192384[0;39m ==> Parameters: 
2022-04-30 10:42:00.825 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436495602192384[0;39m <==    Updates: 0
2022-04-30 10:42:00.827 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436495602192384[0;39m 生成今日电子书快照结束，耗时：821毫秒
2022-04-30 10:42:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436516577906688[0;39m start updating Ebook doc
2022-04-30 10:42:05.242 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436516577906688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:42:05.242 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436516577906688[0;39m ==> Parameters: 
2022-04-30 10:42:05.736 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436516577906688[0;39m <==    Updates: 1
2022-04-30 10:42:05.736 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436516577906688[0;39m update ends, take 730 millisecs
2022-04-30 10:42:05.736 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436519643942912[0;39m 生成今日电子书快照开始
2022-04-30 10:42:05.736 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436519643942912[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:05.736 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436519643942912[0;39m ==> Parameters: 
2022-04-30 10:42:06.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436519643942912[0;39m <==    Updates: 0
2022-04-30 10:42:06.246 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436519643942912[0;39m 生成今日电子书快照结束，耗时：510毫秒
2022-04-30 10:42:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436537549426688[0;39m 生成今日电子书快照开始
2022-04-30 10:42:10.283 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436537549426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:10.284 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436537549426688[0;39m ==> Parameters: 
2022-04-30 10:42:10.926 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436537549426688[0;39m <==    Updates: 0
2022-04-30 10:42:10.928 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436537549426688[0;39m 生成今日电子书快照结束，耗时：922毫秒
2022-04-30 10:42:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436558520946688[0;39m 生成今日电子书快照开始
2022-04-30 10:42:15.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436558520946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:15.267 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436558520946688[0;39m ==> Parameters: 
2022-04-30 10:42:15.709 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436558520946688[0;39m <==    Updates: 0
2022-04-30 10:42:15.709 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436558520946688[0;39m 生成今日电子书快照结束，耗时：703毫秒
2022-04-30 10:42:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436579484078080[0;39m 生成今日电子书快照开始
2022-04-30 10:42:20.295 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436579484078080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:20.296 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436579484078080[0;39m ==> Parameters: 
2022-04-30 10:42:20.844 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436579484078080[0;39m <==    Updates: 0
2022-04-30 10:42:20.844 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436579484078080[0;39m 生成今日电子书快照结束，耗时：840毫秒
2022-04-30 10:42:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436600459792384[0;39m 生成今日电子书快照开始
2022-04-30 10:42:25.276 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436600459792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:25.277 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436600459792384[0;39m ==> Parameters: 
2022-04-30 10:42:25.840 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436600459792384[0;39m <==    Updates: 0
2022-04-30 10:42:25.841 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436600459792384[0;39m 生成今日电子书快照结束，耗时：837毫秒
2022-04-30 10:42:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436621439700992[0;39m 生成今日电子书快照开始
2022-04-30 10:42:30.316 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436621439700992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:30.317 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436621439700992[0;39m ==> Parameters: 
2022-04-30 10:42:30.842 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436621439700992[0;39m <==    Updates: 0
2022-04-30 10:42:30.844 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436621439700992[0;39m 生成今日电子书快照结束，耗时：836毫秒
2022-04-30 10:42:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436642394443776[0;39m start updating Ebook doc
2022-04-30 10:42:35.260 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436642394443776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:42:35.261 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436642394443776[0;39m ==> Parameters: 
2022-04-30 10:42:35.780 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436642394443776[0;39m <==    Updates: 1
2022-04-30 10:42:35.781 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436642394443776[0;39m update ends, take 779 millisecs
2022-04-30 10:42:35.781 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436645661806592[0;39m 生成今日电子书快照开始
2022-04-30 10:42:36.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436645661806592[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:36.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436645661806592[0;39m ==> Parameters: 
2022-04-30 10:42:36.632 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436645661806592[0;39m <==    Updates: 0
2022-04-30 10:42:36.635 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436645661806592[0;39m 生成今日电子书快照结束，耗时：854毫秒
2022-04-30 10:42:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436663382740992[0;39m 生成今日电子书快照开始
2022-04-30 10:42:40.263 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436663382740992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:40.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436663382740992[0;39m ==> Parameters: 
2022-04-30 10:42:40.775 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436663382740992[0;39m <==    Updates: 0
2022-04-30 10:42:40.776 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436663382740992[0;39m 生成今日电子书快照结束，耗时：768毫秒
2022-04-30 10:42:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436684350066688[0;39m 生成今日电子书快照开始
2022-04-30 10:42:45.267 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436684350066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:45.269 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436684350066688[0;39m ==> Parameters: 
2022-04-30 10:42:45.765 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436684350066688[0;39m <==    Updates: 0
2022-04-30 10:42:45.767 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436684350066688[0;39m 生成今日电子书快照结束，耗时：761毫秒
2022-04-30 10:42:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436705317392384[0;39m 生成今日电子书快照开始
2022-04-30 10:42:50.299 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436705317392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:50.301 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436705317392384[0;39m ==> Parameters: 
2022-04-30 10:42:50.965 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436705317392384[0;39m <==    Updates: 0
2022-04-30 10:42:50.966 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436705317392384[0;39m 生成今日电子书快照结束，耗时：961毫秒
2022-04-30 10:42:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436726276329472[0;39m 生成今日电子书快照开始
2022-04-30 10:42:55.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436726276329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:42:55.266 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436726276329472[0;39m ==> Parameters: 
2022-04-30 10:42:55.782 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436726276329472[0;39m <==    Updates: 0
2022-04-30 10:42:55.782 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436726276329472[0;39m 生成今日电子书快照结束，耗时：779毫秒
2022-04-30 10:43:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436747264626688[0;39m 生成今日电子书快照开始
2022-04-30 10:43:00.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436747264626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:00.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436747264626688[0;39m ==> Parameters: 
2022-04-30 10:43:00.760 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436747264626688[0;39m <==    Updates: 0
2022-04-30 10:43:00.760 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436747264626688[0;39m 生成今日电子书快照结束，耗时：755毫秒
2022-04-30 10:43:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436768231952384[0;39m 生成今日电子书快照开始
2022-04-30 10:43:05.257 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436768231952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:05.257 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436768231952384[0;39m ==> Parameters: 
2022-04-30 10:43:05.864 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436768231952384[0;39m <==    Updates: 0
2022-04-30 10:43:05.864 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436768231952384[0;39m 生成今日电子书快照结束，耗时：859毫秒
2022-04-30 10:43:05.864 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436771839053824[0;39m start updating Ebook doc
2022-04-30 10:43:06.163 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436771839053824[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:43:06.164 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436771839053824[0;39m ==> Parameters: 
2022-04-30 10:43:06.750 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436771839053824[0;39m <==    Updates: 1
2022-04-30 10:43:06.751 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436771839053824[0;39m update ends, take 887 millisecs
2022-04-30 10:43:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436789199278080[0;39m 生成今日电子书快照开始
2022-04-30 10:43:10.266 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436789199278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:10.267 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436789199278080[0;39m ==> Parameters: 
2022-04-30 10:43:10.767 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436789199278080[0;39m <==    Updates: 0
2022-04-30 10:43:10.768 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436789199278080[0;39m 生成今日电子书快照结束，耗时：765毫秒
2022-04-30 10:43:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436810179186688[0;39m 生成今日电子书快照开始
2022-04-30 10:43:15.300 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436810179186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:15.302 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436810179186688[0;39m ==> Parameters: 
2022-04-30 10:43:15.855 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436810179186688[0;39m <==    Updates: 0
2022-04-30 10:43:15.856 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436810179186688[0;39m 生成今日电子书快照结束，耗时：848毫秒
2022-04-30 10:43:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436831133929472[0;39m 生成今日电子书快照开始
2022-04-30 10:43:20.302 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436831133929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:20.302 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436831133929472[0;39m ==> Parameters: 
2022-04-30 10:43:20.843 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436831133929472[0;39m <==    Updates: 0
2022-04-30 10:43:20.843 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436831133929472[0;39m 生成今日电子书快照结束，耗时：841毫秒
2022-04-30 10:43:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436852122226688[0;39m 生成今日电子书快照开始
2022-04-30 10:43:25.292 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436852122226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:25.292 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436852122226688[0;39m ==> Parameters: 
2022-04-30 10:43:25.810 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436852122226688[0;39m <==    Updates: 0
2022-04-30 10:43:25.810 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436852122226688[0;39m 生成今日电子书快照结束，耗时：803毫秒
2022-04-30 10:43:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436873085358080[0;39m 生成今日电子书快照开始
2022-04-30 10:43:30.763 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436873085358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:30.765 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436873085358080[0;39m ==> Parameters: 
2022-04-30 10:43:31.374 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436873085358080[0;39m <==    Updates: 0
2022-04-30 10:43:31.376 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436873085358080[0;39m 生成今日电子书快照结束，耗时：1372毫秒
2022-04-30 10:43:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175436894065266688[0;39m start updating Ebook doc
2022-04-30 10:43:35.260 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436894065266688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:43:35.260 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436894065266688[0;39m ==> Parameters: 
2022-04-30 10:43:35.781 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175436894065266688[0;39m <==    Updates: 1
2022-04-30 10:43:35.782 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175436894065266688[0;39m update ends, take 777 millisecs
2022-04-30 10:43:35.782 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436897324240896[0;39m 生成今日电子书快照开始
2022-04-30 10:43:36.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436897324240896[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:36.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436897324240896[0;39m ==> Parameters: 
2022-04-30 10:43:36.569 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436897324240896[0;39m <==    Updates: 0
2022-04-30 10:43:36.571 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436897324240896[0;39m 生成今日电子书快照结束，耗时：789毫秒
2022-04-30 10:43:37.875 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:43:37.876 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:43:37.877 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:43:37.890 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:43:39.633 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74122 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:43:39.633 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:43:39.635 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:43:39.671 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:43:39.672 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:43:40.025 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:43:40.026 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:43:40.036 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2022-04-30 10:43:40.409 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:43:40.415 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:43:40.415 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:43:40.415 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:43:40.447 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:43:40.447 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 773 ms
2022-04-30 10:43:40.940 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:43:41.151 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:43:41.180 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:43:41.197 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:43:41.207 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:43:41.217 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.833 seconds (JVM running for 2.197)
2022-04-30 10:43:41.219 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:43:41.219 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:43:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436936008306688[0;39m 生成今日电子书快照开始
2022-04-30 10:43:45.019 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175436936008306688[0;39m HikariPool-1 - Starting...
2022-04-30 10:43:47.375 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:43:47.375 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:43:47.376 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:43:47.384 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:47.384 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/static/
2022-04-30 10:43:47.384 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:43:47.384 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:43:48.166 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175436936008306688[0;39m HikariPool-1 - Start completed.
2022-04-30 10:43:48.185 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436936008306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:48.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436936008306688[0;39m ==> Parameters: 
2022-04-30 10:43:48.703 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436936008306688[0;39m <==    Updates: 0
2022-04-30 10:43:48.711 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436936008306688[0;39m 生成今日电子书快照结束，耗时：3705毫秒
2022-04-30 10:43:49.900 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:49.903 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：2 ms -------------
2022-04-30 10:43:49.915 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:49.915 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:43:49.916 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:43:49.916 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:43:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436956967243776[0;39m 生成今日电子书快照开始
2022-04-30 10:43:50.258 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436956967243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:50.262 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436956967243776[0;39m ==> Parameters: 
2022-04-30 10:43:50.808 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436956967243776[0;39m <==    Updates: 0
2022-04-30 10:43:50.811 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436956967243776[0;39m 生成今日电子书快照结束，耗时：808毫秒
2022-04-30 10:43:54.954 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:54.956 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:43:54.959 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:54.959 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:43:54.959 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:43:54.959 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:43:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436977942958080[0;39m 生成今日电子书快照开始
2022-04-30 10:43:55.289 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436977942958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:43:55.292 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436977942958080[0;39m ==> Parameters: 
2022-04-30 10:43:55.817 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436977942958080[0;39m <==    Updates: 0
2022-04-30 10:43:55.819 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436977942958080[0;39m 生成今日电子书快照结束，耗时：816毫秒
2022-04-30 10:43:56.409 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:56.410 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:43:56.411 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:56.411 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:43:56.412 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:43:56.412 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:43:59.595 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:59.597 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:43:59.598 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:43:59.599 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/error
2022-04-30 10:43:59.599 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:43:59.599 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:44:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175436998914478080[0;39m 生成今日电子书快照开始
2022-04-30 10:44:00.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436998914478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:00.267 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436998914478080[0;39m ==> Parameters: 
2022-04-30 10:44:00.775 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175436998914478080[0;39m <==    Updates: 0
2022-04-30 10:44:00.776 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175436998914478080[0;39m 生成今日电子书快照结束，耗时：772毫秒
2022-04-30 10:44:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437019890192384[0;39m start updating Ebook doc
2022-04-30 10:44:05.267 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437019890192384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:44:05.269 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437019890192384[0;39m ==> Parameters: 
2022-04-30 10:44:05.791 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437019890192384[0;39m <==    Updates: 1
2022-04-30 10:44:05.791 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437019890192384[0;39m update ends, take 785 millisecs
2022-04-30 10:44:05.791 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437023191109632[0;39m 生成今日电子书快照开始
2022-04-30 10:44:06.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437023191109632[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:06.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437023191109632[0;39m ==> Parameters: 
2022-04-30 10:44:06.565 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437023191109632[0;39m <==    Updates: 0
2022-04-30 10:44:06.567 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437023191109632[0;39m 生成今日电子书快照结束，耗时：776毫秒
2022-04-30 10:44:08.628 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:44:08.629 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:44:08.630 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:44:10.723 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:44:20.622 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-30 10:44:20.625 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:44:20.626 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:44:20.646 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-30 10:44:20.647 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-30 10:44:20.918 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:44:20.919 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:44:20.929 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2022-04-30 10:44:21.212 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:44:21.216 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:44:21.217 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:44:21.217 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:44:21.240 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:44:21.241 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 594 ms
2022-04-30 10:44:21.692 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:44:21.904 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:44:21.931 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:44:21.945 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:44:21.956 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:44:21.965 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 1.509 seconds (JVM running for 1.794)
2022-04-30 10:44:21.967 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:44:21.967 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:44:24.989 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-30 10:44:24.990 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-30 10:44:24.991 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-30 10:44:25.001 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437103767883776[0;39m 生成今日电子书快照开始
2022-04-30 10:44:25.008 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：7 ms -------------
2022-04-30 10:44:25.011 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175437103767883776[0;39m HikariPool-1 - Starting...
2022-04-30 10:44:25.040 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.040 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.042 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.043 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.043 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：3 ms -------------
2022-04-30 10:44:25.043 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:44:25.043 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：3 ms -------------
2022-04-30 10:44:25.045 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.046 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.047 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:44:25.052 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：7 ms -------------
2022-04-30 10:44:25.061 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.063 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：2 ms -------------
2022-04-30 10:44:25.068 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：25 ms -------------
2022-04-30 10:44:25.110 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:25.122 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：12 ms -------------
2022-04-30 10:44:28.170 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175437103767883776[0;39m HikariPool-1 - Start completed.
2022-04-30 10:44:28.190 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437103767883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:28.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437103767883776[0;39m ==> Parameters: 
2022-04-30 10:44:28.685 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437103767883776[0;39m <==    Updates: 0
2022-04-30 10:44:28.694 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437103767883776[0;39m 生成今日电子书快照结束，耗时：3692毫秒
2022-04-30 10:44:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437124739403776[0;39m 生成今日电子书快照开始
2022-04-30 10:44:30.279 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437124739403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:30.280 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437124739403776[0;39m ==> Parameters: 
2022-04-30 10:44:30.422 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:30.422 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:30.449 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：26 ms -------------
2022-04-30 10:44:30.459 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：37 ms -------------
2022-04-30 10:44:30.687 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:30.688 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :67   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-30 10:44:30.735 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437124739403776[0;39m <==    Updates: 0
2022-04-30 10:44:30.736 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437124739403776[0;39m 生成今日电子书快照结束，耗时：731毫秒
2022-04-30 10:44:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437145723506688[0;39m 生成今日电子书快照开始
2022-04-30 10:44:35.288 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437145723506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:35.289 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437145723506688[0;39m ==> Parameters: 
2022-04-30 10:44:35.707 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437145723506688[0;39m <==    Updates: 0
2022-04-30 10:44:35.709 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437145723506688[0;39m 生成今日电子书快照结束，耗时：703毫秒
2022-04-30 10:44:35.710 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437148680491008[0;39m start updating Ebook doc
2022-04-30 10:44:35.723 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437148680491008[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:44:35.725 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437148680491008[0;39m ==> Parameters: 
2022-04-30 10:44:36.337 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437148680491008[0;39m <==    Updates: 1
2022-04-30 10:44:36.338 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437148680491008[0;39m update ends, take 628 millisecs
2022-04-30 10:44:36.817 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175437153319391232[0;39m ------------- 开始 -------------
2022-04-30 10:44:36.817 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175437153319391232[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-30 10:44:36.817 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175437153319391232[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-30 10:44:36.818 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175437153319391232[0;39m 远程地址: 127.0.0.1
2022-04-30 10:44:36.842 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175437153319391232[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-30 10:44:37.126 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175437153319391232[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-30 10:44:37.129 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175437153319391232[0;39m ==> Parameters: test1(String)
2022-04-30 10:44:37.418 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175437153319391232[0;39m <==    Columns: id, login_name, name, password
2022-04-30 10:44:37.419 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175437153319391232[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-30 10:44:37.420 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175437153319391232[0;39m <==      Total: 1
2022-04-30 10:44:37.429 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175437153319391232[0;39m generate single sign-on token：175437155890499584，and put it into redis
2022-04-30 10:44:37.750 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175437153319391232[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175437155890499584"},"success":true}
2022-04-30 10:44:37.750 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175437153319391232[0;39m ------------- 结束 耗时：934 ms -------------
2022-04-30 10:44:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437166678249472[0;39m 生成今日电子书快照开始
2022-04-30 10:44:40.644 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437166678249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:40.647 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437166678249472[0;39m ==> Parameters: 
2022-04-30 10:44:41.118 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437166678249472[0;39m <==    Updates: 0
2022-04-30 10:44:41.119 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437166678249472[0;39m 生成今日电子书快照结束，耗时：1115毫秒
2022-04-30 10:44:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437187662352384[0;39m 生成今日电子书快照开始
2022-04-30 10:44:45.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437187662352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:45.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437187662352384[0;39m ==> Parameters: 
2022-04-30 10:44:45.635 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437187662352384[0;39m <==    Updates: 0
2022-04-30 10:44:45.636 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437187662352384[0;39m 生成今日电子书快照结束，耗时：629毫秒
2022-04-30 10:44:45.815 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175437191063932928[0;39m ------------- 开始 -------------
2022-04-30 10:44:45.815 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175437191063932928[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-30 10:44:45.816 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175437191063932928[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-30 10:44:45.816 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175437191063932928[0;39m 远程地址: 127.0.0.1
2022-04-30 10:44:45.816 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175437191063932928[0;39m 请求参数: []
2022-04-30 10:44:45.832 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:45.833 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/admin/favicon.ico
2022-04-30 10:44:45.833 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:44:45.834 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:44:46.453 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175437191063932928[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-30 10:44:46.454 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175437191063932928[0;39m ==> Parameters: 
2022-04-30 10:44:46.674 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==    Columns: id, parent, name, sort
2022-04-30 10:44:46.675 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-30 10:44:46.676 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 175294069419937792, 0, test, 100
2022-04-30 10:44:46.676 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 101, 100, Vue, 101
2022-04-30 10:44:46.676 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-30 10:44:46.676 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 200, 0, Java, 200
2022-04-30 10:44:46.677 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 201, 200, Basics, 201
2022-04-30 10:44:46.677 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-30 10:44:46.677 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 175304625627467776, 200, JAVAtest, 203
2022-04-30 10:44:46.678 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 300, 0, Python, 300
2022-04-30 10:44:46.679 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-30 10:44:46.679 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-30 10:44:46.679 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 400, 0, Database, 400
2022-04-30 10:44:46.679 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 175285021429600256, 0, testNew, 400
2022-04-30 10:44:46.680 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-30 10:44:46.680 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 500, 0, Others, 500
2022-04-30 10:44:46.680 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 501, 500, Servers, 501
2022-04-30 10:44:46.682 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 502, 500, Tools, 502
2022-04-30 10:44:46.682 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175437191063932928[0;39m <==        Row: 503, 500, Languages, 503
2022-04-30 10:44:46.682 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175437191063932928[0;39m <==      Total: 18
2022-04-30 10:44:46.690 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175437191063932928[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":175294069419937792,"name":"test","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":175304625627467776,"name":"JAVAtest","parent":200,"sort":203},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":175285021429600256,"name":"testNew","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-30 10:44:46.690 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175437191063932928[0;39m ------------- 结束 耗时：875 ms -------------
2022-04-30 10:44:46.726 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175437194884943872[0;39m ------------- 开始 -------------
2022-04-30 10:44:46.726 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175437194884943872[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-30 10:44:46.727 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175437194884943872[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-30 10:44:46.727 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175437194884943872[0;39m 远程地址: 127.0.0.1
2022-04-30 10:44:46.728 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175437194884943872[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-30 10:44:46.747 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175437194884943872[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-30 10:44:46.747 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175437194884943872[0;39m ==> Parameters: 
2022-04-30 10:44:47.052 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175437194884943872[0;39m <==    Columns: count(0)
2022-04-30 10:44:47.052 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175437194884943872[0;39m <==        Row: 8
2022-04-30 10:44:47.053 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175437194884943872[0;39m <==      Total: 1
2022-04-30 10:44:47.059 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175437194884943872[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-30 10:44:47.060 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175437194884943872[0;39m ==> Parameters: 10(Integer)
2022-04-30 10:44:47.291 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-30 10:44:47.292 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 109, 10
2022-04-30 10:44:47.293 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 2, Vue Tutorial, 100, 175294069419937800, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-30 10:44:47.294 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 3, Python Tutorial, 300, 301, Introduction to programming with Python, null, 10, 75, 10
2022-04-30 10:44:47.294 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-30 10:44:47.294 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 5, Oracle Tutorial222, 200, 175304625627467776, Introduction to Oracle, null, 11, 1123, 2
2022-04-30 10:44:47.295 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 175424435505991680, 1, 175294069419937792, null, 1, 1, 0, 0, 0
2022-04-30 10:44:47.295 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 175425037875154944, Spring Intro, 200, 201, null, null, 0, 0, 0
2022-04-30 10:44:47.298 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175437194884943872[0;39m <==        Row: 175433650039558144, Algorithms, 175285021429600256, null, CLRS book, null, 0, 0, 0
2022-04-30 10:44:47.299 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175437194884943872[0;39m <==      Total: 8
2022-04-30 10:44:47.302 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175437194884943872[0;39m total rows：8
2022-04-30 10:44:47.302 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175437194884943872[0;39m total pages：1
2022-04-30 10:44:47.317 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175437194884943872[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":109,"voteCount":10},{"category1Id":100,"category2Id":175294069419937800,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"category1Id":300,"category2Id":301,"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"category1Id":200,"category2Id":175304625627467776,"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial222","viewCount":1123,"voteCount":2},{"category1Id":175294069419937792,"cover":"1","description":"1","docCount":0,"id":175424435505991680,"name":"1","viewCount":0,"voteCount":0},{"category1Id":200,"category2Id":201,"docCount":0,"id":175425037875154944,"name":"Spring Intro","viewCount":0,"voteCount":0},{"category1Id":175285021429600256,"description":"CLRS book","docCount":0,"id":175433650039558144,"name":"Algorithms","viewCount":0,"voteCount":0}],"total":8},"success":true}
2022-04-30 10:44:47.317 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175437194884943872[0;39m ------------- 结束 耗时：591 ms -------------
2022-04-30 10:44:47.372 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m                  [0;39m ------------- LoginInterceptor start -------------
2022-04-30 10:44:47.372 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8080/admin/1
2022-04-30 10:44:47.373 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :47   [32m                  [0;39m 登录校验开始，token：null
2022-04-30 10:44:47.373 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :49   [32m                  [0;39m token为空，请求被拦截
2022-04-30 10:44:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437208638066688[0;39m 生成今日电子书快照开始
2022-04-30 10:44:50.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437208638066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:50.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437208638066688[0;39m ==> Parameters: 
2022-04-30 10:44:51.278 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437208638066688[0;39m <==    Updates: 0
2022-04-30 10:44:51.278 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437208638066688[0;39m 生成今日电子书快照结束，耗时：1271毫秒
2022-04-30 10:44:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437229609586688[0;39m 生成今日电子书快照开始
2022-04-30 10:44:55.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437229609586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:44:55.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437229609586688[0;39m ==> Parameters: 
2022-04-30 10:44:55.930 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437229609586688[0;39m <==    Updates: 0
2022-04-30 10:44:55.931 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437229609586688[0;39m 生成今日电子书快照结束，耗时：926毫秒
2022-04-30 10:45:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437250581106688[0;39m 生成今日电子书快照开始
2022-04-30 10:45:00.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437250581106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:00.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437250581106688[0;39m ==> Parameters: 
2022-04-30 10:45:01.300 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437250581106688[0;39m <==    Updates: 0
2022-04-30 10:45:01.302 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437250581106688[0;39m 生成今日电子书快照结束，耗时：1296毫秒
2022-04-30 10:45:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437271548432384[0;39m 生成今日电子书快照开始
2022-04-30 10:45:05.243 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437271548432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:05.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437271548432384[0;39m ==> Parameters: 
2022-04-30 10:45:05.965 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437271548432384[0;39m <==    Updates: 0
2022-04-30 10:45:05.967 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437271548432384[0;39m 生成今日电子书快照结束，耗时：962毫秒
2022-04-30 10:45:05.967 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437275587547136[0;39m start updating Ebook doc
2022-04-30 10:45:06.648 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437275587547136[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:45:06.648 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437275587547136[0;39m ==> Parameters: 
2022-04-30 10:45:07.085 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437275587547136[0;39m <==    Updates: 1
2022-04-30 10:45:07.085 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437275587547136[0;39m update ends, take 1117 millisecs
2022-04-30 10:45:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437292507369472[0;39m 生成今日电子书快照开始
2022-04-30 10:45:10.280 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437292507369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:10.281 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437292507369472[0;39m ==> Parameters: 
2022-04-30 10:45:10.996 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437292507369472[0;39m <==    Updates: 0
2022-04-30 10:45:10.997 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437292507369472[0;39m 生成今日电子书快照结束，耗时：995毫秒
2022-04-30 10:45:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437313495666688[0;39m 生成今日电子书快照开始
2022-04-30 10:45:15.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437313495666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:15.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437313495666688[0;39m ==> Parameters: 
2022-04-30 10:45:15.664 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437313495666688[0;39m <==    Updates: 0
2022-04-30 10:45:15.665 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437313495666688[0;39m 生成今日电子书快照结束，耗时：659毫秒
2022-04-30 10:45:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437334467186688[0;39m 生成今日电子书快照开始
2022-04-30 10:45:20.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437334467186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:20.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437334467186688[0;39m ==> Parameters: 
2022-04-30 10:45:20.654 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437334467186688[0;39m <==    Updates: 0
2022-04-30 10:45:20.655 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437334467186688[0;39m 生成今日电子书快照结束，耗时：649毫秒
2022-04-30 10:45:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437355442900992[0;39m 生成今日电子书快照开始
2022-04-30 10:45:25.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437355442900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:25.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437355442900992[0;39m ==> Parameters: 
2022-04-30 10:45:25.644 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437355442900992[0;39m <==    Updates: 0
2022-04-30 10:45:25.645 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437355442900992[0;39m 生成今日电子书快照结束，耗时：638毫秒
2022-04-30 10:45:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437376410226688[0;39m 生成今日电子书快照开始
2022-04-30 10:45:30.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437376410226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:30.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437376410226688[0;39m ==> Parameters: 
2022-04-30 10:45:31.298 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437376410226688[0;39m <==    Updates: 0
2022-04-30 10:45:31.299 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437376410226688[0;39m 生成今日电子书快照结束，耗时：1293毫秒
2022-04-30 10:45:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437397364969472[0;39m start updating Ebook doc
2022-04-30 10:45:35.280 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437397364969472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:45:35.280 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437397364969472[0;39m ==> Parameters: 
2022-04-30 10:45:36.122 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437397364969472[0;39m <==    Updates: 1
2022-04-30 10:45:36.122 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437397364969472[0;39m update ends, take 1120 millisecs
2022-04-30 10:45:36.122 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437402066784256[0;39m 生成今日电子书快照开始
2022-04-30 10:45:36.347 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437402066784256[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:36.348 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437402066784256[0;39m ==> Parameters: 
2022-04-30 10:45:36.973 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437402066784256[0;39m <==    Updates: 0
2022-04-30 10:45:36.973 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437402066784256[0;39m 生成今日电子书快照结束，耗时：851毫秒
2022-04-30 10:45:37.493 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:45:37.494 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:45:37.495 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-30 10:45:37.501 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2022-04-30 10:45:37.672 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:45:37.672 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:45:37.740 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:45:37.741 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:45:37.741 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 10:45:37.803 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:45:37.804 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:45:37.804 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:45:37.804 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:45:37.810 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:45:37.810 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 136 ms
2022-04-30 10:45:37.976 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:45:38.082 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 10:45:38.096 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 10:45:38.104 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-30 10:45:38.105 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 10:45:38.108 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 0.458 seconds (JVM running for 77.936)
2022-04-30 10:45:38.109 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-30 10:45:38.109 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 10:45:38.109 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 10:45:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437418357460992[0;39m 生成今日电子书快照开始
2022-04-30 10:45:40.007 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175437418357460992[0;39m HikariPool-2 - Starting...
2022-04-30 10:45:43.841 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175437418357460992[0;39m HikariPool-2 - Start completed.
2022-04-30 10:45:43.842 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437418357460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:43.842 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437418357460992[0;39m ==> Parameters: 
2022-04-30 10:45:44.296 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437418357460992[0;39m <==    Updates: 0
2022-04-30 10:45:44.300 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437418357460992[0;39m 生成今日电子书快照结束，耗时：4293毫秒
2022-04-30 10:45:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437439320592384[0;39m 生成今日电子书快照开始
2022-04-30 10:45:45.247 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437439320592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:45.247 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437439320592384[0;39m ==> Parameters: 
2022-04-30 10:45:45.779 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437439320592384[0;39m <==    Updates: 0
2022-04-30 10:45:45.781 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437439320592384[0;39m 生成今日电子书快照结束，耗时：775毫秒
2022-04-30 10:45:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437460283723776[0;39m 生成今日电子书快照开始
2022-04-30 10:45:50.403 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437460283723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:50.404 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437460283723776[0;39m ==> Parameters: 
2022-04-30 10:45:50.850 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437460283723776[0;39m <==    Updates: 0
2022-04-30 10:45:50.850 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437460283723776[0;39m 生成今日电子书快照结束，耗时：847毫秒
2022-04-30 10:45:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437481267826688[0;39m 生成今日电子书快照开始
2022-04-30 10:45:55.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437481267826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:45:55.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437481267826688[0;39m ==> Parameters: 
2022-04-30 10:45:55.682 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437481267826688[0;39m <==    Updates: 0
2022-04-30 10:45:55.682 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437481267826688[0;39m 生成今日电子书快照结束，耗时：677毫秒
2022-04-30 10:46:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437502243540992[0;39m 生成今日电子书快照开始
2022-04-30 10:46:00.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437502243540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:00.220 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437502243540992[0;39m ==> Parameters: 
2022-04-30 10:46:00.685 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437502243540992[0;39m <==    Updates: 0
2022-04-30 10:46:00.688 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437502243540992[0;39m 生成今日电子书快照结束，耗时：681毫秒
2022-04-30 10:46:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437523210866688[0;39m start updating Ebook doc
2022-04-30 10:46:05.224 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437523210866688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:46:05.226 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437523210866688[0;39m ==> Parameters: 
2022-04-30 10:46:06.114 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437523210866688[0;39m <==    Updates: 1
2022-04-30 10:46:06.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437523210866688[0;39m update ends, take 1108 millisecs
2022-04-30 10:46:06.115 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437527866544128[0;39m 生成今日电子书快照开始
2022-04-30 10:46:06.337 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437527866544128[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:06.339 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437527866544128[0;39m ==> Parameters: 
2022-04-30 10:46:06.786 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437527866544128[0;39m <==    Updates: 0
2022-04-30 10:46:06.788 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437527866544128[0;39m 生成今日电子书快照结束，耗时：672毫秒
2022-04-30 10:46:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437544173998080[0;39m 生成今日电子书快照开始
2022-04-30 10:46:10.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437544173998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:10.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437544173998080[0;39m ==> Parameters: 
2022-04-30 10:46:10.710 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437544173998080[0;39m <==    Updates: 0
2022-04-30 10:46:10.712 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437544173998080[0;39m 生成今日电子书快照结束，耗时：709毫秒
2022-04-30 10:46:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437565153906688[0;39m 生成今日电子书快照开始
2022-04-30 10:46:15.305 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437565153906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:15.307 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437565153906688[0;39m ==> Parameters: 
2022-04-30 10:46:15.736 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437565153906688[0;39m <==    Updates: 0
2022-04-30 10:46:15.739 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437565153906688[0;39m 生成今日电子书快照结束，耗时：730毫秒
2022-04-30 10:46:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437586129620992[0;39m 生成今日电子书快照开始
2022-04-30 10:46:20.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437586129620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:20.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437586129620992[0;39m ==> Parameters: 
2022-04-30 10:46:20.658 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437586129620992[0;39m <==    Updates: 0
2022-04-30 10:46:20.658 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437586129620992[0;39m 生成今日电子书快照结束，耗时：651毫秒
2022-04-30 10:46:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437607092752384[0;39m 生成今日电子书快照开始
2022-04-30 10:46:25.442 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437607092752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:25.445 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437607092752384[0;39m ==> Parameters: 
2022-04-30 10:46:25.979 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437607092752384[0;39m <==    Updates: 0
2022-04-30 10:46:25.981 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437607092752384[0;39m 生成今日电子书快照结束，耗时：977毫秒
2022-04-30 10:46:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437628064272384[0;39m 生成今日电子书快照开始
2022-04-30 10:46:30.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437628064272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:30.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437628064272384[0;39m ==> Parameters: 
2022-04-30 10:46:30.686 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437628064272384[0;39m <==    Updates: 0
2022-04-30 10:46:30.688 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437628064272384[0;39m 生成今日电子书快照结束，耗时：683毫秒
2022-04-30 10:46:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437649023209472[0;39m 生成今日电子书快照开始
2022-04-30 10:46:35.215 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437649023209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:35.216 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437649023209472[0;39m ==> Parameters: 
2022-04-30 10:46:35.668 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437649023209472[0;39m <==    Updates: 0
2022-04-30 10:46:35.669 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437649023209472[0;39m 生成今日电子书快照结束，耗时：660毫秒
2022-04-30 10:46:35.670 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437651829198848[0;39m start updating Ebook doc
2022-04-30 10:46:35.670 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437651829198848[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:46:35.670 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437651829198848[0;39m ==> Parameters: 
2022-04-30 10:46:36.119 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437651829198848[0;39m <==    Updates: 1
2022-04-30 10:46:36.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437651829198848[0;39m update ends, take 450 millisecs
2022-04-30 10:46:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437670011506688[0;39m 生成今日电子书快照开始
2022-04-30 10:46:40.288 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437670011506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:40.289 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437670011506688[0;39m ==> Parameters: 
2022-04-30 10:46:40.756 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437670011506688[0;39m <==    Updates: 0
2022-04-30 10:46:40.757 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437670011506688[0;39m 生成今日电子书快照结束，耗时：752毫秒
2022-04-30 10:46:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437690987220992[0;39m 生成今日电子书快照开始
2022-04-30 10:46:45.309 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437690987220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:45.317 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437690987220992[0;39m ==> Parameters: 
2022-04-30 10:46:45.776 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437690987220992[0;39m <==    Updates: 0
2022-04-30 10:46:45.777 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437690987220992[0;39m 生成今日电子书快照结束，耗时：771毫秒
2022-04-30 10:46:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437711950352384[0;39m 生成今日电子书快照开始
2022-04-30 10:46:50.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437711950352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:50.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437711950352384[0;39m ==> Parameters: 
2022-04-30 10:46:50.754 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437711950352384[0;39m <==    Updates: 0
2022-04-30 10:46:50.754 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437711950352384[0;39m 生成今日电子书快照结束，耗时：750毫秒
2022-04-30 10:46:55.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437732934455296[0;39m 生成今日电子书快照开始
2022-04-30 10:46:55.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437732934455296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:46:55.252 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437732934455296[0;39m ==> Parameters: 
2022-04-30 10:46:55.676 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437732934455296[0;39m <==    Updates: 0
2022-04-30 10:46:55.678 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437732934455296[0;39m 生成今日电子书快照结束，耗时：670毫秒
2022-04-30 10:47:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437753889198080[0;39m 生成今日电子书快照开始
2022-04-30 10:47:00.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437753889198080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:00.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437753889198080[0;39m ==> Parameters: 
2022-04-30 10:47:01.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437753889198080[0;39m <==    Updates: 0
2022-04-30 10:47:01.262 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437753889198080[0;39m 生成今日电子书快照结束，耗时：1259毫秒
2022-04-30 10:47:05.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437774885883904[0;39m start updating Ebook doc
2022-04-30 10:47:05.256 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437774885883904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:47:05.257 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437774885883904[0;39m ==> Parameters: 
2022-04-30 10:47:05.699 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437774885883904[0;39m <==    Updates: 1
2022-04-30 10:47:05.699 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437774885883904[0;39m update ends, take 689 millisecs
2022-04-30 10:47:05.700 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437777784147968[0;39m 生成今日电子书快照开始
2022-04-30 10:47:05.700 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437777784147968[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:05.701 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437777784147968[0;39m ==> Parameters: 
2022-04-30 10:47:06.152 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437777784147968[0;39m <==    Updates: 0
2022-04-30 10:47:06.153 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437777784147968[0;39m 生成今日电子书快照结束，耗时：453毫秒
2022-04-30 10:47:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437795823849472[0;39m 生成今日电子书快照开始
2022-04-30 10:47:10.294 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437795823849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:10.295 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437795823849472[0;39m ==> Parameters: 
2022-04-30 10:47:10.729 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437795823849472[0;39m <==    Updates: 0
2022-04-30 10:47:10.730 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437795823849472[0;39m 生成今日电子书快照结束，耗时：728毫秒
2022-04-30 10:47:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437816807952384[0;39m 生成今日电子书快照开始
2022-04-30 10:47:15.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437816807952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:15.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437816807952384[0;39m ==> Parameters: 
2022-04-30 10:47:15.720 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437816807952384[0;39m <==    Updates: 0
2022-04-30 10:47:15.722 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437816807952384[0;39m 生成今日电子书快照结束，耗时：717毫秒
2022-04-30 10:47:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437837783666688[0;39m 生成今日电子书快照开始
2022-04-30 10:47:20.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437837783666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:20.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437837783666688[0;39m ==> Parameters: 
2022-04-30 10:47:20.757 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437837783666688[0;39m <==    Updates: 0
2022-04-30 10:47:20.757 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437837783666688[0;39m 生成今日电子书快照结束，耗时：752毫秒
2022-04-30 10:47:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437858755186688[0;39m 生成今日电子书快照开始
2022-04-30 10:47:25.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437858755186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:25.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437858755186688[0;39m ==> Parameters: 
2022-04-30 10:47:25.677 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437858755186688[0;39m <==    Updates: 0
2022-04-30 10:47:25.678 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437858755186688[0;39m 生成今日电子书快照结束，耗时：671毫秒
2022-04-30 10:47:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437879726706688[0;39m 生成今日电子书快照开始
2022-04-30 10:47:30.236 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437879726706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:30.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437879726706688[0;39m ==> Parameters: 
2022-04-30 10:47:30.727 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437879726706688[0;39m <==    Updates: 0
2022-04-30 10:47:30.727 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437879726706688[0;39m 生成今日电子书快照结束，耗时：721毫秒
2022-04-30 10:47:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175437900698226688[0;39m start updating Ebook doc
2022-04-30 10:47:35.232 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437900698226688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:47:35.235 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437900698226688[0;39m ==> Parameters: 
2022-04-30 10:47:35.688 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175437900698226688[0;39m <==    Updates: 1
2022-04-30 10:47:35.690 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175437900698226688[0;39m update ends, take 684 millisecs
2022-04-30 10:47:35.692 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437903579713536[0;39m 生成今日电子书快照开始
2022-04-30 10:47:35.694 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437903579713536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:35.695 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437903579713536[0;39m ==> Parameters: 
2022-04-30 10:47:36.691 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437903579713536[0;39m <==    Updates: 0
2022-04-30 10:47:36.692 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437903579713536[0;39m 生成今日电子书快照结束，耗时：999毫秒
2022-04-30 10:47:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437921669746688[0;39m 生成今日电子书快照开始
2022-04-30 10:47:40.383 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437921669746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:40.385 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437921669746688[0;39m ==> Parameters: 
2022-04-30 10:47:40.878 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437921669746688[0;39m <==    Updates: 0
2022-04-30 10:47:40.887 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437921669746688[0;39m 生成今日电子书快照结束，耗时：880毫秒
2022-04-30 10:47:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437942628683776[0;39m 生成今日电子书快照开始
2022-04-30 10:47:45.322 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437942628683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:45.324 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437942628683776[0;39m ==> Parameters: 
2022-04-30 10:47:45.767 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437942628683776[0;39m <==    Updates: 0
2022-04-30 10:47:45.768 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437942628683776[0;39m 生成今日电子书快照结束，耗时：766毫秒
2022-04-30 10:47:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437963612786688[0;39m 生成今日电子书快照开始
2022-04-30 10:47:50.314 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437963612786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:50.315 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437963612786688[0;39m ==> Parameters: 
2022-04-30 10:47:51.770 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437963612786688[0;39m <==    Updates: 0
2022-04-30 10:47:51.771 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437963612786688[0;39m 生成今日电子书快照结束，耗时：1765毫秒
2022-04-30 10:47:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175437984584306688[0;39m 生成今日电子书快照开始
2022-04-30 10:47:55.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437984584306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:47:55.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437984584306688[0;39m ==> Parameters: 
2022-04-30 10:47:57.092 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175437984584306688[0;39m <==    Updates: 0
2022-04-30 10:47:57.093 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175437984584306688[0;39m 生成今日电子书快照结束，耗时：2086毫秒
2022-04-30 10:48:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438005534855168[0;39m 生成今日电子书快照开始
2022-04-30 10:48:00.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438005534855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:00.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438005534855168[0;39m ==> Parameters: 
2022-04-30 10:48:00.898 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438005534855168[0;39m <==    Updates: 0
2022-04-30 10:48:00.898 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438005534855168[0;39m 生成今日电子书快照结束，耗时：896毫秒
2022-04-30 10:48:05.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438026518958080[0;39m start updating Ebook doc
2022-04-30 10:48:05.228 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438026518958080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:48:05.228 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438026518958080[0;39m ==> Parameters: 
2022-04-30 10:48:05.671 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438026518958080[0;39m <==    Updates: 1
2022-04-30 10:48:05.672 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438026518958080[0;39m update ends, take 668 millisecs
2022-04-30 10:48:05.673 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438029329141760[0;39m 生成今日电子书快照开始
2022-04-30 10:48:05.674 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438029329141760[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:05.675 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438029329141760[0;39m ==> Parameters: 
2022-04-30 10:48:06.100 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438029329141760[0;39m <==    Updates: 0
2022-04-30 10:48:06.101 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438029329141760[0;39m 生成今日电子书快照结束，耗时：428毫秒
2022-04-30 10:48:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438047494672384[0;39m 生成今日电子书快照开始
2022-04-30 10:48:10.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438047494672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:10.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438047494672384[0;39m ==> Parameters: 
2022-04-30 10:48:10.669 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438047494672384[0;39m <==    Updates: 0
2022-04-30 10:48:10.670 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438047494672384[0;39m 生成今日电子书快照结束，耗时：665毫秒
2022-04-30 10:48:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438068457803776[0;39m 生成今日电子书快照开始
2022-04-30 10:48:15.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438068457803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:15.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438068457803776[0;39m ==> Parameters: 
2022-04-30 10:48:15.744 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438068457803776[0;39m <==    Updates: 0
2022-04-30 10:48:15.745 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438068457803776[0;39m 生成今日电子书快照结束，耗时：741毫秒
2022-04-30 10:48:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438089441906688[0;39m 生成今日电子书快照开始
2022-04-30 10:48:20.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438089441906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:20.251 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438089441906688[0;39m ==> Parameters: 
2022-04-30 10:48:20.745 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438089441906688[0;39m <==    Updates: 0
2022-04-30 10:48:20.747 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438089441906688[0;39m 生成今日电子书快照结束，耗时：741毫秒
2022-04-30 10:48:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438110409232384[0;39m 生成今日电子书快照开始
2022-04-30 10:48:25.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438110409232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:25.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438110409232384[0;39m ==> Parameters: 
2022-04-30 10:48:26.335 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438110409232384[0;39m <==    Updates: 0
2022-04-30 10:48:26.336 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438110409232384[0;39m 生成今日电子书快照结束，耗时：1331毫秒
2022-04-30 10:48:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438131376558080[0;39m 生成今日电子书快照开始
2022-04-30 10:48:30.207 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438131376558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:30.208 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438131376558080[0;39m ==> Parameters: 
2022-04-30 10:48:31.522 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438131376558080[0;39m <==    Updates: 0
2022-04-30 10:48:31.522 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438131376558080[0;39m 生成今日电子书快照结束，耗时：1519毫秒
2022-04-30 10:48:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438152356466688[0;39m start updating Ebook doc
2022-04-30 10:48:35.285 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438152356466688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:48:35.287 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438152356466688[0;39m ==> Parameters: 
2022-04-30 10:48:35.742 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438152356466688[0;39m <==    Updates: 1
2022-04-30 10:48:35.745 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438152356466688[0;39m update ends, take 740 millisecs
2022-04-30 10:48:35.747 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438155468640256[0;39m 生成今日电子书快照开始
2022-04-30 10:48:35.749 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438155468640256[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:35.750 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438155468640256[0;39m ==> Parameters: 
2022-04-30 10:48:36.668 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438155468640256[0;39m <==    Updates: 0
2022-04-30 10:48:36.668 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438155468640256[0;39m 生成今日电子书快照结束，耗时：920毫秒
2022-04-30 10:48:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438173323792384[0;39m 生成今日电子书快照开始
2022-04-30 10:48:40.303 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438173323792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:40.304 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438173323792384[0;39m ==> Parameters: 
2022-04-30 10:48:40.733 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438173323792384[0;39m <==    Updates: 0
2022-04-30 10:48:40.733 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438173323792384[0;39m 生成今日电子书快照结束，耗时：714毫秒
2022-04-30 10:48:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438194299506688[0;39m 生成今日电子书快照开始
2022-04-30 10:48:45.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438194299506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:45.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438194299506688[0;39m ==> Parameters: 
2022-04-30 10:48:45.664 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438194299506688[0;39m <==    Updates: 0
2022-04-30 10:48:45.665 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438194299506688[0;39m 生成今日电子书快照结束，耗时：660毫秒
2022-04-30 10:48:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438215271026688[0;39m 生成今日电子书快照开始
2022-04-30 10:48:50.301 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438215271026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:50.301 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438215271026688[0;39m ==> Parameters: 
2022-04-30 10:48:50.716 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438215271026688[0;39m <==    Updates: 0
2022-04-30 10:48:50.717 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438215271026688[0;39m 生成今日电子书快照结束，耗时：711毫秒
2022-04-30 10:48:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438236225769472[0;39m 生成今日电子书快照开始
2022-04-30 10:48:55.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438236225769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:48:55.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438236225769472[0;39m ==> Parameters: 
2022-04-30 10:48:55.648 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438236225769472[0;39m <==    Updates: 0
2022-04-30 10:48:55.648 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438236225769472[0;39m 生成今日电子书快照结束，耗时：646毫秒
2022-04-30 10:49:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438257201483776[0;39m 生成今日电子书快照开始
2022-04-30 10:49:00.791 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438257201483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:00.791 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438257201483776[0;39m ==> Parameters: 
2022-04-30 10:49:01.256 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438257201483776[0;39m <==    Updates: 0
2022-04-30 10:49:01.258 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438257201483776[0;39m 生成今日电子书快照结束，耗时：1256毫秒
2022-04-30 10:49:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438278181392384[0;39m start updating Ebook doc
2022-04-30 10:49:05.241 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438278181392384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:49:05.243 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438278181392384[0;39m ==> Parameters: 
2022-04-30 10:49:05.810 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438278181392384[0;39m <==    Updates: 1
2022-04-30 10:49:05.811 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438278181392384[0;39m update ends, take 805 millisecs
2022-04-30 10:49:05.812 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438281570390016[0;39m 生成今日电子书快照开始
2022-04-30 10:49:06.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438281570390016[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:06.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438281570390016[0;39m ==> Parameters: 
2022-04-30 10:49:06.475 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438281570390016[0;39m <==    Updates: 0
2022-04-30 10:49:06.475 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438281570390016[0;39m 生成今日电子书快照结束，耗时：663毫秒
2022-04-30 10:49:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438299148718080[0;39m 生成今日电子书快照开始
2022-04-30 10:49:10.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438299148718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:10.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438299148718080[0;39m ==> Parameters: 
2022-04-30 10:49:10.692 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438299148718080[0;39m <==    Updates: 0
2022-04-30 10:49:10.695 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438299148718080[0;39m 生成今日电子书快照结束，耗时：692毫秒
2022-04-30 10:49:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438320124432384[0;39m 生成今日电子书快照开始
2022-04-30 10:49:15.243 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438320124432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:15.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438320124432384[0;39m ==> Parameters: 
2022-04-30 10:49:16.183 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438320124432384[0;39m <==    Updates: 0
2022-04-30 10:49:16.184 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438320124432384[0;39m 生成今日电子书快照结束，耗时：1177毫秒
2022-04-30 10:49:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438341091758080[0;39m 生成今日电子书快照开始
2022-04-30 10:49:20.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438341091758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:20.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438341091758080[0;39m ==> Parameters: 
2022-04-30 10:49:20.694 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438341091758080[0;39m <==    Updates: 0
2022-04-30 10:49:20.715 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438341091758080[0;39m 生成今日电子书快照结束，耗时：712毫秒
2022-04-30 10:49:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438362063278080[0;39m 生成今日电子书快照开始
2022-04-30 10:49:25.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438362063278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:25.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438362063278080[0;39m ==> Parameters: 
2022-04-30 10:49:25.731 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438362063278080[0;39m <==    Updates: 0
2022-04-30 10:49:25.731 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438362063278080[0;39m 生成今日电子书快照结束，耗时：728毫秒
2022-04-30 10:49:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438383026409472[0;39m 生成今日电子书快照开始
2022-04-30 10:49:30.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438383026409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:30.221 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438383026409472[0;39m ==> Parameters: 
2022-04-30 10:49:30.645 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438383026409472[0;39m <==    Updates: 0
2022-04-30 10:49:30.645 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438383026409472[0;39m 生成今日电子书快照结束，耗时：641毫秒
2022-04-30 10:49:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438404014706688[0;39m start updating Ebook doc
2022-04-30 10:49:35.211 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438404014706688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:49:35.212 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438404014706688[0;39m ==> Parameters: 
2022-04-30 10:49:36.085 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438404014706688[0;39m <==    Updates: 1
2022-04-30 10:49:36.085 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438404014706688[0;39m update ends, take 1080 millisecs
2022-04-30 10:49:36.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438408544555008[0;39m 生成今日电子书快照开始
2022-04-30 10:49:36.326 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438408544555008[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:36.326 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438408544555008[0;39m ==> Parameters: 
2022-04-30 10:49:36.796 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438408544555008[0;39m <==    Updates: 0
2022-04-30 10:49:36.797 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438408544555008[0;39m 生成今日电子书快照结束，耗时：712毫秒
2022-04-30 10:49:40.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438424994615296[0;39m 生成今日电子书快照开始
2022-04-30 10:49:40.272 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438424994615296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:40.274 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438424994615296[0;39m ==> Parameters: 
2022-04-30 10:49:40.725 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438424994615296[0;39m <==    Updates: 0
2022-04-30 10:49:40.726 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438424994615296[0;39m 生成今日电子书快照结束，耗时：717毫秒
2022-04-30 10:49:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438445953552384[0;39m 生成今日电子书快照开始
2022-04-30 10:49:45.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438445953552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:45.248 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438445953552384[0;39m ==> Parameters: 
2022-04-30 10:49:45.685 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438445953552384[0;39m <==    Updates: 0
2022-04-30 10:49:45.685 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438445953552384[0;39m 生成今日电子书快照结束，耗时：681毫秒
2022-04-30 10:49:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438466916683776[0;39m 生成今日电子书快照开始
2022-04-30 10:49:50.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438466916683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:50.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438466916683776[0;39m ==> Parameters: 
2022-04-30 10:49:50.677 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438466916683776[0;39m <==    Updates: 0
2022-04-30 10:49:50.681 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438466916683776[0;39m 生成今日电子书快照结束，耗时：677毫秒
2022-04-30 10:49:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438487900786688[0;39m 生成今日电子书快照开始
2022-04-30 10:49:55.307 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438487900786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:49:55.309 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438487900786688[0;39m ==> Parameters: 
2022-04-30 10:49:55.743 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438487900786688[0;39m <==    Updates: 0
2022-04-30 10:49:55.744 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438487900786688[0;39m 生成今日电子书快照结束，耗时：739毫秒
2022-04-30 10:50:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438508859723776[0;39m 生成今日电子书快照开始
2022-04-30 10:50:00.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438508859723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:00.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438508859723776[0;39m ==> Parameters: 
2022-04-30 10:50:00.699 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438508859723776[0;39m <==    Updates: 0
2022-04-30 10:50:00.700 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438508859723776[0;39m 生成今日电子书快照结束，耗时：697毫秒
2022-04-30 10:50:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438529843826688[0;39m start updating Ebook doc
2022-04-30 10:50:05.211 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438529843826688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:50:05.211 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438529843826688[0;39m ==> Parameters: 
2022-04-30 10:50:05.655 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438529843826688[0;39m <==    Updates: 1
2022-04-30 10:50:05.655 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438529843826688[0;39m update ends, take 650 millisecs
2022-04-30 10:50:05.656 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438532574318592[0;39m 生成今日电子书快照开始
2022-04-30 10:50:05.656 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438532574318592[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:05.656 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438532574318592[0;39m ==> Parameters: 
2022-04-30 10:50:06.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438532574318592[0;39m <==    Updates: 0
2022-04-30 10:50:06.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438532574318592[0;39m 生成今日电子书快照结束，耗时：432毫秒
2022-04-30 10:50:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438550819540992[0;39m 生成今日电子书快照开始
2022-04-30 10:50:10.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438550819540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:10.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438550819540992[0;39m ==> Parameters: 
2022-04-30 10:50:10.661 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438550819540992[0;39m <==    Updates: 0
2022-04-30 10:50:10.662 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438550819540992[0;39m 生成今日电子书快照结束，耗时：654毫秒
2022-04-30 10:50:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438571791060992[0;39m 生成今日电子书快照开始
2022-04-30 10:50:15.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438571791060992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:15.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438571791060992[0;39m ==> Parameters: 
2022-04-30 10:50:15.700 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438571791060992[0;39m <==    Updates: 0
2022-04-30 10:50:15.700 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438571791060992[0;39m 生成今日电子书快照结束，耗时：693毫秒
2022-04-30 10:50:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438592758386688[0;39m 生成今日电子书快照开始
2022-04-30 10:50:20.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438592758386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:20.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438592758386688[0;39m ==> Parameters: 
2022-04-30 10:50:20.691 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438592758386688[0;39m <==    Updates: 0
2022-04-30 10:50:20.694 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438592758386688[0;39m 生成今日电子书快照结束，耗时：687毫秒
2022-04-30 10:50:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438613734100992[0;39m 生成今日电子书快照开始
2022-04-30 10:50:25.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438613734100992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:25.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438613734100992[0;39m ==> Parameters: 
2022-04-30 10:50:25.725 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438613734100992[0;39m <==    Updates: 0
2022-04-30 10:50:25.726 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438613734100992[0;39m 生成今日电子书快照结束，耗时：719毫秒
2022-04-30 10:50:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438634705620992[0;39m 生成今日电子书快照开始
2022-04-30 10:50:30.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438634705620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:30.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438634705620992[0;39m ==> Parameters: 
2022-04-30 10:50:30.761 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438634705620992[0;39m <==    Updates: 0
2022-04-30 10:50:30.763 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438634705620992[0;39m 生成今日电子书快照结束，耗时：755毫秒
2022-04-30 10:50:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438655664558080[0;39m start updating Ebook doc
2022-04-30 10:50:35.218 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438655664558080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:50:35.220 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438655664558080[0;39m ==> Parameters: 
2022-04-30 10:50:35.645 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438655664558080[0;39m <==    Updates: 1
2022-04-30 10:50:35.646 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438655664558080[0;39m update ends, take 643 millisecs
2022-04-30 10:50:35.647 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438658365689856[0;39m 生成今日电子书快照开始
2022-04-30 10:50:35.648 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438658365689856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:35.649 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438658365689856[0;39m ==> Parameters: 
2022-04-30 10:50:36.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438658365689856[0;39m <==    Updates: 0
2022-04-30 10:50:36.097 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438658365689856[0;39m 生成今日电子书快照结束，耗时：450毫秒
2022-04-30 10:50:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438676644466688[0;39m 生成今日电子书快照开始
2022-04-30 10:50:40.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438676644466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:40.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438676644466688[0;39m ==> Parameters: 
2022-04-30 10:50:40.686 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438676644466688[0;39m <==    Updates: 0
2022-04-30 10:50:40.688 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438676644466688[0;39m 生成今日电子书快照结束，耗时：683毫秒
2022-04-30 10:50:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438697607598080[0;39m 生成今日电子书快照开始
2022-04-30 10:50:45.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438697607598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:45.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438697607598080[0;39m ==> Parameters: 
2022-04-30 10:50:46.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438697607598080[0;39m <==    Updates: 0
2022-04-30 10:50:46.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438697607598080[0;39m 生成今日电子书快照结束，耗时：1066毫秒
2022-04-30 10:50:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438718570729472[0;39m 生成今日电子书快照开始
2022-04-30 10:50:50.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438718570729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:50.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438718570729472[0;39m ==> Parameters: 
2022-04-30 10:50:50.688 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438718570729472[0;39m <==    Updates: 0
2022-04-30 10:50:50.690 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438718570729472[0;39m 生成今日电子书快照结束，耗时：689毫秒
2022-04-30 10:50:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438739554832384[0;39m 生成今日电子书快照开始
2022-04-30 10:50:55.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438739554832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:50:55.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438739554832384[0;39m ==> Parameters: 
2022-04-30 10:50:55.718 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438739554832384[0;39m <==    Updates: 0
2022-04-30 10:50:55.720 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438739554832384[0;39m 生成今日电子书快照结束，耗时：714毫秒
2022-04-30 10:51:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438760526352384[0;39m 生成今日电子书快照开始
2022-04-30 10:51:00.321 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438760526352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:00.323 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438760526352384[0;39m ==> Parameters: 
2022-04-30 10:51:00.735 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438760526352384[0;39m <==    Updates: 0
2022-04-30 10:51:00.737 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438760526352384[0;39m 生成今日电子书快照结束，耗时：730毫秒
2022-04-30 10:51:05.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438781489483776[0;39m start updating Ebook doc
2022-04-30 10:51:05.216 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438781489483776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:51:05.218 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438781489483776[0;39m ==> Parameters: 
2022-04-30 10:51:05.666 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438781489483776[0;39m <==    Updates: 1
2022-04-30 10:51:05.668 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438781489483776[0;39m update ends, take 666 millisecs
2022-04-30 10:51:05.668 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438784282890240[0;39m 生成今日电子书快照开始
2022-04-30 10:51:05.669 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438784282890240[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:05.670 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438784282890240[0;39m ==> Parameters: 
2022-04-30 10:51:06.137 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438784282890240[0;39m <==    Updates: 0
2022-04-30 10:51:06.138 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438784282890240[0;39m 生成今日电子书快照结束，耗时：470毫秒
2022-04-30 10:51:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438802465198080[0;39m 生成今日电子书快照开始
2022-04-30 10:51:10.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438802465198080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:10.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438802465198080[0;39m ==> Parameters: 
2022-04-30 10:51:11.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438802465198080[0;39m <==    Updates: 0
2022-04-30 10:51:11.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438802465198080[0;39m 生成今日电子书快照结束，耗时：1067毫秒
2022-04-30 10:51:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438823436718080[0;39m 生成今日电子书快照开始
2022-04-30 10:51:15.208 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438823436718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:15.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438823436718080[0;39m ==> Parameters: 
2022-04-30 10:51:15.882 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438823436718080[0;39m <==    Updates: 0
2022-04-30 10:51:15.883 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438823436718080[0;39m 生成今日电子书快照结束，耗时：879毫秒
2022-04-30 10:51:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438844412432384[0;39m 生成今日电子书快照开始
2022-04-30 10:51:20.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438844412432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:20.251 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438844412432384[0;39m ==> Parameters: 
2022-04-30 10:51:20.680 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438844412432384[0;39m <==    Updates: 0
2022-04-30 10:51:20.680 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438844412432384[0;39m 生成今日电子书快照结束，耗时：675毫秒
2022-04-30 10:51:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438865367175168[0;39m 生成今日电子书快照开始
2022-04-30 10:51:25.293 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438865367175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:25.295 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438865367175168[0;39m ==> Parameters: 
2022-04-30 10:51:25.731 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438865367175168[0;39m <==    Updates: 0
2022-04-30 10:51:25.734 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438865367175168[0;39m 生成今日电子书快照结束，耗时：732毫秒
2022-04-30 10:51:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438886351278080[0;39m 生成今日电子书快照开始
2022-04-30 10:51:30.221 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438886351278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:30.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438886351278080[0;39m ==> Parameters: 
2022-04-30 10:51:30.761 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438886351278080[0;39m <==    Updates: 0
2022-04-30 10:51:30.761 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438886351278080[0;39m 生成今日电子书快照结束，耗时：756毫秒
2022-04-30 10:51:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438907322798080[0;39m 生成今日电子书快照开始
2022-04-30 10:51:35.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438907322798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:35.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438907322798080[0;39m ==> Parameters: 
2022-04-30 10:51:35.664 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438907322798080[0;39m <==    Updates: 0
2022-04-30 10:51:35.664 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438907322798080[0;39m 生成今日电子书快照结束，耗时：661毫秒
2022-04-30 10:51:35.664 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175438910095233024[0;39m start updating Ebook doc
2022-04-30 10:51:35.664 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438910095233024[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:51:35.664 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438910095233024[0;39m ==> Parameters: 
2022-04-30 10:51:36.087 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175438910095233024[0;39m <==    Updates: 1
2022-04-30 10:51:36.087 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175438910095233024[0;39m update ends, take 423 millisecs
2022-04-30 10:51:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438928302706688[0;39m 生成今日电子书快照开始
2022-04-30 10:51:40.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438928302706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:40.251 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438928302706688[0;39m ==> Parameters: 
2022-04-30 10:51:41.105 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438928302706688[0;39m <==    Updates: 0
2022-04-30 10:51:41.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438928302706688[0;39m 生成今日电子书快照结束，耗时：1099毫秒
2022-04-30 10:51:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438949278420992[0;39m 生成今日电子书快照开始
2022-04-30 10:51:45.236 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438949278420992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:45.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438949278420992[0;39m ==> Parameters: 
2022-04-30 10:51:45.881 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438949278420992[0;39m <==    Updates: 0
2022-04-30 10:51:45.882 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438949278420992[0;39m 生成今日电子书快照结束，耗时：875毫秒
2022-04-30 10:51:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438970228969472[0;39m 生成今日电子书快照开始
2022-04-30 10:51:50.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438970228969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:50.259 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438970228969472[0;39m ==> Parameters: 
2022-04-30 10:51:50.688 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438970228969472[0;39m <==    Updates: 0
2022-04-30 10:51:50.688 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438970228969472[0;39m 生成今日电子书快照结束，耗时：684毫秒
2022-04-30 10:51:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175438991217266688[0;39m 生成今日电子书快照开始
2022-04-30 10:51:55.284 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438991217266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:51:55.285 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438991217266688[0;39m ==> Parameters: 
2022-04-30 10:51:55.774 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175438991217266688[0;39m <==    Updates: 0
2022-04-30 10:51:55.776 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175438991217266688[0;39m 生成今日电子书快照结束，耗时：771毫秒
2022-04-30 10:52:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439012176203776[0;39m 生成今日电子书快照开始
2022-04-30 10:52:00.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439012176203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:00.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439012176203776[0;39m ==> Parameters: 
2022-04-30 10:52:00.643 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439012176203776[0;39m <==    Updates: 0
2022-04-30 10:52:00.644 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439012176203776[0;39m 生成今日电子书快照结束，耗时：640毫秒
2022-04-30 10:52:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439033156112384[0;39m start updating Ebook doc
2022-04-30 10:52:05.282 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439033156112384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:52:05.283 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439033156112384[0;39m ==> Parameters: 
2022-04-30 10:52:05.731 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439033156112384[0;39m <==    Updates: 1
2022-04-30 10:52:05.731 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439033156112384[0;39m update ends, take 727 millisecs
2022-04-30 10:52:05.731 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439036205371392[0;39m 生成今日电子书快照开始
2022-04-30 10:52:05.732 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439036205371392[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:05.732 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439036205371392[0;39m ==> Parameters: 
2022-04-30 10:52:06.160 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439036205371392[0;39m <==    Updates: 0
2022-04-30 10:52:06.160 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439036205371392[0;39m 生成今日电子书快照结束，耗时：428毫秒
2022-04-30 10:52:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439054131826688[0;39m 生成今日电子书快照开始
2022-04-30 10:52:10.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439054131826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:10.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439054131826688[0;39m ==> Parameters: 
2022-04-30 10:52:10.776 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439054131826688[0;39m <==    Updates: 0
2022-04-30 10:52:10.776 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439054131826688[0;39m 生成今日电子书快照结束，耗时：771毫秒
2022-04-30 10:52:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439075103346688[0;39m 生成今日电子书快照开始
2022-04-30 10:52:15.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439075103346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:15.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439075103346688[0;39m ==> Parameters: 
2022-04-30 10:52:15.669 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439075103346688[0;39m <==    Updates: 0
2022-04-30 10:52:15.669 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439075103346688[0;39m 生成今日电子书快照结束，耗时：664毫秒
2022-04-30 10:52:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439096062283776[0;39m 生成今日电子书快照开始
2022-04-30 10:52:20.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439096062283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:20.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439096062283776[0;39m ==> Parameters: 
2022-04-30 10:52:20.677 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439096062283776[0;39m <==    Updates: 0
2022-04-30 10:52:20.679 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439096062283776[0;39m 生成今日电子书快照结束，耗时：677毫秒
2022-04-30 10:52:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439117042192384[0;39m 生成今日电子书快照开始
2022-04-30 10:52:25.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439117042192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:25.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439117042192384[0;39m ==> Parameters: 
2022-04-30 10:52:25.695 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439117042192384[0;39m <==    Updates: 0
2022-04-30 10:52:25.695 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439117042192384[0;39m 生成今日电子书快照结束，耗时：691毫秒
2022-04-30 10:52:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439138017906688[0;39m 生成今日电子书快照开始
2022-04-30 10:52:30.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439138017906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:30.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439138017906688[0;39m ==> Parameters: 
2022-04-30 10:52:30.648 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439138017906688[0;39m <==    Updates: 0
2022-04-30 10:52:30.649 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439138017906688[0;39m 生成今日电子书快照结束，耗时：643毫秒
2022-04-30 10:52:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439158972649472[0;39m 生成今日电子书快照开始
2022-04-30 10:52:35.221 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439158972649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:35.222 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439158972649472[0;39m ==> Parameters: 
2022-04-30 10:52:35.638 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439158972649472[0;39m <==    Updates: 0
2022-04-30 10:52:35.639 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439158972649472[0;39m 生成今日电子书快照结束，耗时：637毫秒
2022-04-30 10:52:35.639 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439161648615424[0;39m start updating Ebook doc
2022-04-30 10:52:35.639 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439161648615424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:52:35.639 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439161648615424[0;39m ==> Parameters: 
2022-04-30 10:52:36.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439161648615424[0;39m <==    Updates: 1
2022-04-30 10:52:36.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439161648615424[0;39m update ends, take 465 millisecs
2022-04-30 10:52:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439179952558080[0;39m 生成今日电子书快照开始
2022-04-30 10:52:40.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439179952558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:40.214 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439179952558080[0;39m ==> Parameters: 
2022-04-30 10:52:41.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439179952558080[0;39m <==    Updates: 0
2022-04-30 10:52:41.047 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439179952558080[0;39m 生成今日电子书快照结束，耗时：1044毫秒
2022-04-30 10:52:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439200932466688[0;39m 生成今日电子书快照开始
2022-04-30 10:52:45.319 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439200932466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:45.320 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439200932466688[0;39m ==> Parameters: 
2022-04-30 10:52:46.000 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439200932466688[0;39m <==    Updates: 0
2022-04-30 10:52:46.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439200932466688[0;39m 生成今日电子书快照结束，耗时：994毫秒
2022-04-30 10:52:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439221899792384[0;39m 生成今日电子书快照开始
2022-04-30 10:52:50.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439221899792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:50.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439221899792384[0;39m ==> Parameters: 
2022-04-30 10:52:50.680 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439221899792384[0;39m <==    Updates: 0
2022-04-30 10:52:50.681 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439221899792384[0;39m 生成今日电子书快照结束，耗时：676毫秒
2022-04-30 10:52:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439242871312384[0;39m 生成今日电子书快照开始
2022-04-30 10:52:55.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439242871312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:52:55.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439242871312384[0;39m ==> Parameters: 
2022-04-30 10:52:56.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439242871312384[0;39m <==    Updates: 0
2022-04-30 10:52:56.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439242871312384[0;39m 生成今日电子书快照结束，耗时：1060毫秒
2022-04-30 10:53:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439263847026688[0;39m 生成今日电子书快照开始
2022-04-30 10:53:00.668 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439263847026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:00.669 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439263847026688[0;39m ==> Parameters: 
2022-04-30 10:53:01.331 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439263847026688[0;39m <==    Updates: 0
2022-04-30 10:53:01.332 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439263847026688[0;39m 生成今日电子书快照结束，耗时：1326毫秒
2022-04-30 10:53:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439284814352384[0;39m start updating Ebook doc
2022-04-30 10:53:05.628 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439284814352384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:53:05.631 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439284814352384[0;39m ==> Parameters: 
2022-04-30 10:53:06.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439284814352384[0;39m <==    Updates: 1
2022-04-30 10:53:06.073 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439284814352384[0;39m update ends, take 1069 millisecs
2022-04-30 10:53:06.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439289298063360[0;39m 生成今日电子书快照开始
2022-04-30 10:53:06.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439289298063360[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:06.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439289298063360[0;39m ==> Parameters: 
2022-04-30 10:53:06.704 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439289298063360[0;39m <==    Updates: 0
2022-04-30 10:53:06.705 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439289298063360[0;39m 生成今日电子书快照结束，耗时：632毫秒
2022-04-30 10:53:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439305773289472[0;39m 生成今日电子书快照开始
2022-04-30 10:53:10.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439305773289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:10.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439305773289472[0;39m ==> Parameters: 
2022-04-30 10:53:10.869 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439305773289472[0;39m <==    Updates: 0
2022-04-30 10:53:10.870 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439305773289472[0;39m 生成今日电子书快照结束，耗时：866毫秒
2022-04-30 10:53:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439326757392384[0;39m 生成今日电子书快照开始
2022-04-30 10:53:15.220 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439326757392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:15.220 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439326757392384[0;39m ==> Parameters: 
2022-04-30 10:53:15.641 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439326757392384[0;39m <==    Updates: 0
2022-04-30 10:53:15.642 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439326757392384[0;39m 生成今日电子书快照结束，耗时：636毫秒
2022-04-30 10:53:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439347733106688[0;39m 生成今日电子书快照开始
2022-04-30 10:53:20.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439347733106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:20.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439347733106688[0;39m ==> Parameters: 
2022-04-30 10:53:20.645 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439347733106688[0;39m <==    Updates: 0
2022-04-30 10:53:20.647 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439347733106688[0;39m 生成今日电子书快照结束，耗时：641毫秒
2022-04-30 10:53:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439368700432384[0;39m 生成今日电子书快照开始
2022-04-30 10:53:25.207 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439368700432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:25.208 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439368700432384[0;39m ==> Parameters: 
2022-04-30 10:53:26.306 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439368700432384[0;39m <==    Updates: 0
2022-04-30 10:53:26.308 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439368700432384[0;39m 生成今日电子书快照结束，耗时：1303毫秒
2022-04-30 10:53:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439389671952384[0;39m 生成今日电子书快照开始
2022-04-30 10:53:30.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439389671952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:30.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439389671952384[0;39m ==> Parameters: 
2022-04-30 10:53:30.901 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439389671952384[0;39m <==    Updates: 0
2022-04-30 10:53:30.903 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439389671952384[0;39m 生成今日电子书快照结束，耗时：898毫秒
2022-04-30 10:53:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439410639278080[0;39m start updating Ebook doc
2022-04-30 10:53:35.230 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439410639278080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:53:35.232 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439410639278080[0;39m ==> Parameters: 
2022-04-30 10:53:35.668 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439410639278080[0;39m <==    Updates: 1
2022-04-30 10:53:35.670 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439410639278080[0;39m update ends, take 667 millisecs
2022-04-30 10:53:35.671 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439413441073152[0;39m 生成今日电子书快照开始
2022-04-30 10:53:35.671 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439413441073152[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:35.672 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439413441073152[0;39m ==> Parameters: 
2022-04-30 10:53:36.134 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439413441073152[0;39m <==    Updates: 0
2022-04-30 10:53:36.136 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439413441073152[0;39m 生成今日电子书快照结束，耗时：465毫秒
2022-04-30 10:53:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439431619186688[0;39m 生成今日电子书快照开始
2022-04-30 10:53:40.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439431619186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:40.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439431619186688[0;39m ==> Parameters: 
2022-04-30 10:53:40.654 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439431619186688[0;39m <==    Updates: 0
2022-04-30 10:53:40.655 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439431619186688[0;39m 生成今日电子书快照结束，耗时：648毫秒
2022-04-30 10:53:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439452590706688[0;39m 生成今日电子书快照开始
2022-04-30 10:53:45.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439452590706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:45.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439452590706688[0;39m ==> Parameters: 
2022-04-30 10:53:45.639 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439452590706688[0;39m <==    Updates: 0
2022-04-30 10:53:45.641 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439452590706688[0;39m 生成今日电子书快照结束，耗时：635毫秒
2022-04-30 10:53:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439473562226688[0;39m 生成今日电子书快照开始
2022-04-30 10:53:50.216 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439473562226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:50.217 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439473562226688[0;39m ==> Parameters: 
2022-04-30 10:53:50.646 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439473562226688[0;39m <==    Updates: 0
2022-04-30 10:53:50.648 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439473562226688[0;39m 生成今日电子书快照结束，耗时：643毫秒
2022-04-30 10:53:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439494529552384[0;39m 生成今日电子书快照开始
2022-04-30 10:53:55.221 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439494529552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:53:55.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439494529552384[0;39m ==> Parameters: 
2022-04-30 10:53:56.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439494529552384[0;39m <==    Updates: 0
2022-04-30 10:53:56.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439494529552384[0;39m 生成今日电子书快照结束，耗时：1070毫秒
2022-04-30 10:54:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439515509460992[0;39m 生成今日电子书快照开始
2022-04-30 10:54:00.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439515509460992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:00.220 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439515509460992[0;39m ==> Parameters: 
2022-04-30 10:54:00.878 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439515509460992[0;39m <==    Updates: 0
2022-04-30 10:54:00.880 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439515509460992[0;39m 生成今日电子书快照结束，耗时：871毫秒
2022-04-30 10:54:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439536472592384[0;39m 生成今日电子书快照开始
2022-04-30 10:54:05.636 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439536472592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:05.637 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439536472592384[0;39m ==> Parameters: 
2022-04-30 10:54:06.280 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439536472592384[0;39m <==    Updates: 0
2022-04-30 10:54:06.280 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439536472592384[0;39m 生成今日电子书快照结束，耗时：1276毫秒
2022-04-30 10:54:06.280 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439541824524288[0;39m start updating Ebook doc
2022-04-30 10:54:06.502 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439541824524288[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:54:06.503 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439541824524288[0;39m ==> Parameters: 
2022-04-30 10:54:07.366 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439541824524288[0;39m <==    Updates: 1
2022-04-30 10:54:07.368 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439541824524288[0;39m update ends, take 1088 millisecs
2022-04-30 10:54:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439557439918080[0;39m 生成今日电子书快照开始
2022-04-30 10:54:10.246 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439557439918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:10.248 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439557439918080[0;39m ==> Parameters: 
2022-04-30 10:54:10.952 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439557439918080[0;39m <==    Updates: 0
2022-04-30 10:54:10.954 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439557439918080[0;39m 生成今日电子书快照结束，耗时：951毫秒
2022-04-30 10:54:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439578415632384[0;39m 生成今日电子书快照开始
2022-04-30 10:54:15.252 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439578415632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:15.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439578415632384[0;39m ==> Parameters: 
2022-04-30 10:54:15.888 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439578415632384[0;39m <==    Updates: 0
2022-04-30 10:54:15.889 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439578415632384[0;39m 生成今日电子书快照结束，耗时：884毫秒
2022-04-30 10:54:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439599374569472[0;39m 生成今日电子书快照开始
2022-04-30 10:54:20.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439599374569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:20.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439599374569472[0;39m ==> Parameters: 
2022-04-30 10:54:20.653 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439599374569472[0;39m <==    Updates: 0
2022-04-30 10:54:20.654 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439599374569472[0;39m 生成今日电子书快照结束，耗时：652毫秒
2022-04-30 10:54:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439620354478080[0;39m 生成今日电子书快照开始
2022-04-30 10:54:25.206 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439620354478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:25.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439620354478080[0;39m ==> Parameters: 
2022-04-30 10:54:26.299 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439620354478080[0;39m <==    Updates: 0
2022-04-30 10:54:26.299 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439620354478080[0;39m 生成今日电子书快照结束，耗时：1295毫秒
2022-04-30 10:54:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439641334386688[0;39m 生成今日电子书快照开始
2022-04-30 10:54:30.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439641334386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:30.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439641334386688[0;39m ==> Parameters: 
2022-04-30 10:54:30.879 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439641334386688[0;39m <==    Updates: 0
2022-04-30 10:54:30.881 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439641334386688[0;39m 生成今日电子书快照结束，耗时：876毫秒
2022-04-30 10:54:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439662297518080[0;39m start updating Ebook doc
2022-04-30 10:54:35.230 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439662297518080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:54:35.231 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439662297518080[0;39m ==> Parameters: 
2022-04-30 10:54:35.672 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439662297518080[0;39m <==    Updates: 1
2022-04-30 10:54:35.672 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439662297518080[0;39m update ends, take 668 millisecs
2022-04-30 10:54:35.673 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439665107701760[0;39m 生成今日电子书快照开始
2022-04-30 10:54:35.673 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439665107701760[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:35.673 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439665107701760[0;39m ==> Parameters: 
2022-04-30 10:54:36.105 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439665107701760[0;39m <==    Updates: 0
2022-04-30 10:54:36.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439665107701760[0;39m 生成今日电子书快照结束，耗时：432毫秒
2022-04-30 10:54:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439683277426688[0;39m 生成今日电子书快照开始
2022-04-30 10:54:40.253 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439683277426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:40.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439683277426688[0;39m ==> Parameters: 
2022-04-30 10:54:40.700 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439683277426688[0;39m <==    Updates: 0
2022-04-30 10:54:40.700 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439683277426688[0;39m 生成今日电子书快照结束，耗时：694毫秒
2022-04-30 10:54:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439704248946688[0;39m 生成今日电子书快照开始
2022-04-30 10:54:45.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439704248946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:45.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439704248946688[0;39m ==> Parameters: 
2022-04-30 10:54:45.639 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439704248946688[0;39m <==    Updates: 0
2022-04-30 10:54:45.640 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439704248946688[0;39m 生成今日电子书快照结束，耗时：634毫秒
2022-04-30 10:54:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439725220466688[0;39m 生成今日电子书快照开始
2022-04-30 10:54:50.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439725220466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:50.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439725220466688[0;39m ==> Parameters: 
2022-04-30 10:54:50.647 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439725220466688[0;39m <==    Updates: 0
2022-04-30 10:54:50.648 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439725220466688[0;39m 生成今日电子书快照结束，耗时：643毫秒
2022-04-30 10:54:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439746191986688[0;39m 生成今日电子书快照开始
2022-04-30 10:54:55.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439746191986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:54:55.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439746191986688[0;39m ==> Parameters: 
2022-04-30 10:54:55.645 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439746191986688[0;39m <==    Updates: 0
2022-04-30 10:54:55.646 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439746191986688[0;39m 生成今日电子书快照结束，耗时：640毫秒
2022-04-30 10:55:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439767159312384[0;39m 生成今日电子书快照开始
2022-04-30 10:55:00.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439767159312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:00.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439767159312384[0;39m ==> Parameters: 
2022-04-30 10:55:01.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439767159312384[0;39m <==    Updates: 0
2022-04-30 10:55:01.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439767159312384[0;39m 生成今日电子书快照结束，耗时：1049毫秒
2022-04-30 10:55:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439788130832384[0;39m start updating Ebook doc
2022-04-30 10:55:05.222 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439788130832384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:55:05.222 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439788130832384[0;39m ==> Parameters: 
2022-04-30 10:55:06.048 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439788130832384[0;39m <==    Updates: 1
2022-04-30 10:55:06.049 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439788130832384[0;39m update ends, take 1044 millisecs
2022-04-30 10:55:06.049 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439792513880064[0;39m 生成今日电子书快照开始
2022-04-30 10:55:06.302 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439792513880064[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:06.303 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439792513880064[0;39m ==> Parameters: 
2022-04-30 10:55:07.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439792513880064[0;39m <==    Updates: 0
2022-04-30 10:55:07.021 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439792513880064[0;39m 生成今日电子书快照结束，耗时：972毫秒
2022-04-30 10:55:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439809106546688[0;39m 生成今日电子书快照开始
2022-04-30 10:55:10.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439809106546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:10.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439809106546688[0;39m ==> Parameters: 
2022-04-30 10:55:10.875 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439809106546688[0;39m <==    Updates: 0
2022-04-30 10:55:10.876 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439809106546688[0;39m 生成今日电子书快照结束，耗时：871毫秒
2022-04-30 10:55:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439830061289472[0;39m 生成今日电子书快照开始
2022-04-30 10:55:15.634 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439830061289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:15.634 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439830061289472[0;39m ==> Parameters: 
2022-04-30 10:55:16.999 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439830061289472[0;39m <==    Updates: 0
2022-04-30 10:55:17.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439830061289472[0;39m 生成今日电子书快照结束，耗时：2000毫秒
2022-04-30 10:55:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439851037003776[0;39m 生成今日电子书快照开始
2022-04-30 10:55:20.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439851037003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:20.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439851037003776[0;39m ==> Parameters: 
2022-04-30 10:55:20.653 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439851037003776[0;39m <==    Updates: 0
2022-04-30 10:55:20.653 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439851037003776[0;39m 生成今日电子书快照结束，耗时：650毫秒
2022-04-30 10:55:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439872012718080[0;39m 生成今日电子书快照开始
2022-04-30 10:55:25.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439872012718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:25.218 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439872012718080[0;39m ==> Parameters: 
2022-04-30 10:55:25.640 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439872012718080[0;39m <==    Updates: 0
2022-04-30 10:55:25.641 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439872012718080[0;39m 生成今日电子书快照结束，耗时：637毫秒
2022-04-30 10:55:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439892992626688[0;39m 生成今日电子书快照开始
2022-04-30 10:55:30.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439892992626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:30.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439892992626688[0;39m ==> Parameters: 
2022-04-30 10:55:31.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439892992626688[0;39m <==    Updates: 0
2022-04-30 10:55:31.039 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439892992626688[0;39m 生成今日电子书快照结束，耗时：1034毫秒
2022-04-30 10:55:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175439913955758080[0;39m start updating Ebook doc
2022-04-30 10:55:35.207 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439913955758080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:55:35.208 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439913955758080[0;39m ==> Parameters: 
2022-04-30 10:55:35.658 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175439913955758080[0;39m <==    Updates: 1
2022-04-30 10:55:35.659 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175439913955758080[0;39m update ends, take 655 millisecs
2022-04-30 10:55:35.659 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439916707221504[0;39m 生成今日电子书快照开始
2022-04-30 10:55:35.659 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439916707221504[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:35.659 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439916707221504[0;39m ==> Parameters: 
2022-04-30 10:55:36.338 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439916707221504[0;39m <==    Updates: 0
2022-04-30 10:55:36.338 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439916707221504[0;39m 生成今日电子书快照结束，耗时：679毫秒
2022-04-30 10:55:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439934923083776[0;39m 生成今日电子书快照开始
2022-04-30 10:55:40.257 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439934923083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:40.258 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439934923083776[0;39m ==> Parameters: 
2022-04-30 10:55:40.727 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439934923083776[0;39m <==    Updates: 0
2022-04-30 10:55:40.727 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439934923083776[0;39m 生成今日电子书快照结束，耗时：724毫秒
2022-04-30 10:55:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439955907186688[0;39m 生成今日电子书快照开始
2022-04-30 10:55:45.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439955907186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:45.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439955907186688[0;39m ==> Parameters: 
2022-04-30 10:55:45.672 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439955907186688[0;39m <==    Updates: 0
2022-04-30 10:55:45.673 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439955907186688[0;39m 生成今日电子书快照结束，耗时：668毫秒
2022-04-30 10:55:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439976878706688[0;39m 生成今日电子书快照开始
2022-04-30 10:55:50.643 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439976878706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:50.645 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439976878706688[0;39m ==> Parameters: 
2022-04-30 10:55:51.332 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439976878706688[0;39m <==    Updates: 0
2022-04-30 10:55:51.333 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439976878706688[0;39m 生成今日电子书快照结束，耗时：1328毫秒
2022-04-30 10:55:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175439997850226688[0;39m 生成今日电子书快照开始
2022-04-30 10:55:55.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439997850226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:55:55.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439997850226688[0;39m ==> Parameters: 
2022-04-30 10:55:55.657 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175439997850226688[0;39m <==    Updates: 0
2022-04-30 10:55:55.657 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175439997850226688[0;39m 生成今日电子书快照结束，耗时：652毫秒
2022-04-30 10:56:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440018817552384[0;39m 生成今日电子书快照开始
2022-04-30 10:56:00.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440018817552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:00.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440018817552384[0;39m ==> Parameters: 
2022-04-30 10:56:00.642 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440018817552384[0;39m <==    Updates: 0
2022-04-30 10:56:00.643 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440018817552384[0;39m 生成今日电子书快照结束，耗时：638毫秒
2022-04-30 10:56:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175440039793266688[0;39m start updating Ebook doc
2022-04-30 10:56:05.218 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440039793266688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:56:05.218 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440039793266688[0;39m ==> Parameters: 
2022-04-30 10:56:05.659 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440039793266688[0;39m <==    Updates: 1
2022-04-30 10:56:05.660 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175440039793266688[0;39m update ends, take 655 millisecs
2022-04-30 10:56:05.660 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440042540535808[0;39m 生成今日电子书快照开始
2022-04-30 10:56:05.660 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440042540535808[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:05.660 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440042540535808[0;39m ==> Parameters: 
2022-04-30 10:56:06.091 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440042540535808[0;39m <==    Updates: 0
2022-04-30 10:56:06.091 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440042540535808[0;39m 生成今日电子书快照结束，耗时：431毫秒
2022-04-30 10:56:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440060764786688[0;39m 生成今日电子书快照开始
2022-04-30 10:56:10.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440060764786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:10.221 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440060764786688[0;39m ==> Parameters: 
2022-04-30 10:56:10.681 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440060764786688[0;39m <==    Updates: 0
2022-04-30 10:56:10.682 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440060764786688[0;39m 生成今日电子书快照结束，耗时：676毫秒
2022-04-30 10:56:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440081736306688[0;39m 生成今日电子书快照开始
2022-04-30 10:56:15.221 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440081736306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:15.222 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440081736306688[0;39m ==> Parameters: 
2022-04-30 10:56:15.674 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440081736306688[0;39m <==    Updates: 0
2022-04-30 10:56:15.674 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440081736306688[0;39m 生成今日电子书快照结束，耗时：669毫秒
2022-04-30 10:56:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440102707826688[0;39m 生成今日电子书快照开始
2022-04-30 10:56:20.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440102707826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:20.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440102707826688[0;39m ==> Parameters: 
2022-04-30 10:56:20.665 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440102707826688[0;39m <==    Updates: 0
2022-04-30 10:56:20.666 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440102707826688[0;39m 生成今日电子书快照结束，耗时：660毫秒
2022-04-30 10:56:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440123679346688[0;39m 生成今日电子书快照开始
2022-04-30 10:56:25.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440123679346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:25.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440123679346688[0;39m ==> Parameters: 
2022-04-30 10:56:25.648 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440123679346688[0;39m <==    Updates: 0
2022-04-30 10:56:25.648 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440123679346688[0;39m 生成今日电子书快照结束，耗时：642毫秒
2022-04-30 10:56:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440144650866688[0;39m 生成今日电子书快照开始
2022-04-30 10:56:30.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440144650866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:30.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440144650866688[0;39m ==> Parameters: 
2022-04-30 10:56:30.660 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440144650866688[0;39m <==    Updates: 0
2022-04-30 10:56:30.662 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440144650866688[0;39m 生成今日电子书快照结束，耗时：656毫秒
2022-04-30 10:56:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175440165622386688[0;39m start updating Ebook doc
2022-04-30 10:56:35.211 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440165622386688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:56:35.211 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440165622386688[0;39m ==> Parameters: 
2022-04-30 10:56:35.633 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440165622386688[0;39m <==    Updates: 1
2022-04-30 10:56:35.634 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175440165622386688[0;39m update ends, take 629 millisecs
2022-04-30 10:56:35.634 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440168260603904[0;39m 生成今日电子书快照开始
2022-04-30 10:56:35.634 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440168260603904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:35.635 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440168260603904[0;39m ==> Parameters: 
2022-04-30 10:56:36.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440168260603904[0;39m <==    Updates: 0
2022-04-30 10:56:36.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440168260603904[0;39m 生成今日电子书快照结束，耗时：452毫秒
2022-04-30 10:56:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440186585518080[0;39m 生成今日电子书快照开始
2022-04-30 10:56:40.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440186585518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:40.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440186585518080[0;39m ==> Parameters: 
2022-04-30 10:56:40.680 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440186585518080[0;39m <==    Updates: 0
2022-04-30 10:56:40.681 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440186585518080[0;39m 生成今日电子书快照结束，耗时：677毫秒
2022-04-30 10:56:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440207565426688[0;39m 生成今日电子书快照开始
2022-04-30 10:56:45.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440207565426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:45.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440207565426688[0;39m ==> Parameters: 
2022-04-30 10:56:45.662 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440207565426688[0;39m <==    Updates: 0
2022-04-30 10:56:45.662 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440207565426688[0;39m 生成今日电子书快照结束，耗时：657毫秒
2022-04-30 10:56:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440228536946688[0;39m 生成今日电子书快照开始
2022-04-30 10:56:50.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440228536946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:50.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440228536946688[0;39m ==> Parameters: 
2022-04-30 10:56:50.675 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440228536946688[0;39m <==    Updates: 0
2022-04-30 10:56:50.675 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440228536946688[0;39m 生成今日电子书快照结束，耗时：669毫秒
2022-04-30 10:56:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440249500078080[0;39m 生成今日电子书快照开始
2022-04-30 10:56:55.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440249500078080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:56:55.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440249500078080[0;39m ==> Parameters: 
2022-04-30 10:56:55.659 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440249500078080[0;39m <==    Updates: 0
2022-04-30 10:56:55.659 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440249500078080[0;39m 生成今日电子书快照结束，耗时：654毫秒
2022-04-30 10:57:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440270459015168[0;39m 生成今日电子书快照开始
2022-04-30 10:57:00.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440270459015168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:00.227 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440270459015168[0;39m ==> Parameters: 
2022-04-30 10:57:00.647 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440270459015168[0;39m <==    Updates: 0
2022-04-30 10:57:00.647 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440270459015168[0;39m 生成今日电子书快照结束，耗时：647毫秒
2022-04-30 10:57:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175440291451506688[0;39m start updating Ebook doc
2022-04-30 10:57:05.223 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440291451506688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:57:05.223 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440291451506688[0;39m ==> Parameters: 
2022-04-30 10:57:05.669 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440291451506688[0;39m <==    Updates: 1
2022-04-30 10:57:05.672 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175440291451506688[0;39m update ends, take 666 millisecs
2022-04-30 10:57:05.672 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440294249107456[0;39m 生成今日电子书快照开始
2022-04-30 10:57:05.673 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440294249107456[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:05.674 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440294249107456[0;39m ==> Parameters: 
2022-04-30 10:57:06.125 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440294249107456[0;39m <==    Updates: 0
2022-04-30 10:57:06.125 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440294249107456[0;39m 生成今日电子书快照结束，耗时：452毫秒
2022-04-30 10:57:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440312423026688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:10.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440312423026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:10.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440312423026688[0;39m ==> Parameters: 
2022-04-30 10:57:10.645 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440312423026688[0;39m <==    Updates: 0
2022-04-30 10:57:10.645 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440312423026688[0;39m 生成今日电子书快照结束，耗时：640毫秒
2022-04-30 10:57:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440333398740992[0;39m 生成今日电子书快照开始
2022-04-30 10:57:15.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440333398740992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:15.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440333398740992[0;39m ==> Parameters: 
2022-04-30 10:57:16.502 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440333398740992[0;39m <==    Updates: 0
2022-04-30 10:57:16.503 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440333398740992[0;39m 生成今日电子书快照结束，耗时：1497毫秒
2022-04-30 10:57:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440354366066688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:20.214 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440354366066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:20.215 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440354366066688[0;39m ==> Parameters: 
2022-04-30 10:57:20.867 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440354366066688[0;39m <==    Updates: 0
2022-04-30 10:57:20.868 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440354366066688[0;39m 生成今日电子书快照结束，耗时：863毫秒
2022-04-30 10:57:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440375337586688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:25.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440375337586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:25.255 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440375337586688[0;39m ==> Parameters: 
2022-04-30 10:57:25.684 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440375337586688[0;39m <==    Updates: 0
2022-04-30 10:57:25.685 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440375337586688[0;39m 生成今日电子书快照结束，耗时：679毫秒
2022-04-30 10:57:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440396304912384[0;39m 生成今日电子书快照开始
2022-04-30 10:57:30.657 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440396304912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:30.658 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440396304912384[0;39m ==> Parameters: 
2022-04-30 10:57:31.338 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440396304912384[0;39m <==    Updates: 0
2022-04-30 10:57:31.338 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440396304912384[0;39m 生成今日电子书快照结束，耗时：1333毫秒
2022-04-30 10:57:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440417280626688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:35.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440417280626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:35.241 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440417280626688[0;39m ==> Parameters: 
2022-04-30 10:57:35.650 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440417280626688[0;39m <==    Updates: 0
2022-04-30 10:57:35.650 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440417280626688[0;39m 生成今日电子书快照结束，耗时：645毫秒
2022-04-30 10:57:35.650 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175440419985952768[0;39m start updating Ebook doc
2022-04-30 10:57:35.651 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440419985952768[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:57:35.651 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440419985952768[0;39m ==> Parameters: 
2022-04-30 10:57:36.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440419985952768[0;39m <==    Updates: 1
2022-04-30 10:57:36.101 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175440419985952768[0;39m update ends, take 451 millisecs
2022-04-30 10:57:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440438252146688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:40.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440438252146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:40.220 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440438252146688[0;39m ==> Parameters: 
2022-04-30 10:57:40.650 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440438252146688[0;39m <==    Updates: 0
2022-04-30 10:57:40.650 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440438252146688[0;39m 生成今日电子书快照结束，耗时：644毫秒
2022-04-30 10:57:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440459223666688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:45.221 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440459223666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:45.222 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440459223666688[0;39m ==> Parameters: 
2022-04-30 10:57:45.668 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440459223666688[0;39m <==    Updates: 0
2022-04-30 10:57:45.668 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440459223666688[0;39m 生成今日电子书快照结束，耗时：663毫秒
2022-04-30 10:57:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440480195186688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:50.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440480195186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:50.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440480195186688[0;39m ==> Parameters: 
2022-04-30 10:57:50.677 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440480195186688[0;39m <==    Updates: 0
2022-04-30 10:57:50.677 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440480195186688[0;39m 生成今日电子书快照结束，耗时：668毫秒
2022-04-30 10:57:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440501166706688[0;39m 生成今日电子书快照开始
2022-04-30 10:57:55.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440501166706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:57:55.233 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440501166706688[0;39m ==> Parameters: 
2022-04-30 10:57:55.678 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440501166706688[0;39m <==    Updates: 0
2022-04-30 10:57:55.678 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440501166706688[0;39m 生成今日电子书快照结束，耗时：673毫秒
2022-04-30 10:58:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440522125643776[0;39m 生成今日电子书快照开始
2022-04-30 10:58:00.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440522125643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:00.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440522125643776[0;39m ==> Parameters: 
2022-04-30 10:58:00.645 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440522125643776[0;39m <==    Updates: 0
2022-04-30 10:58:00.646 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440522125643776[0;39m 生成今日电子书快照结束，耗时：643毫秒
2022-04-30 10:58:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440543109746688[0;39m 生成今日电子书快照开始
2022-04-30 10:58:05.223 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440543109746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:05.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440543109746688[0;39m ==> Parameters: 
2022-04-30 10:58:05.650 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440543109746688[0;39m <==    Updates: 0
2022-04-30 10:58:05.650 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440543109746688[0;39m 生成今日电子书快照结束，耗时：644毫秒
2022-04-30 10:58:05.650 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175440545815072768[0;39m start updating Ebook doc
2022-04-30 10:58:05.651 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440545815072768[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:58:05.651 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440545815072768[0;39m ==> Parameters: 
2022-04-30 10:58:06.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440545815072768[0;39m <==    Updates: 1
2022-04-30 10:58:06.103 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175440545815072768[0;39m update ends, take 453 millisecs
2022-04-30 10:58:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440564081266688[0;39m 生成今日电子书快照开始
2022-04-30 10:58:10.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440564081266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:10.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440564081266688[0;39m ==> Parameters: 
2022-04-30 10:58:10.668 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440564081266688[0;39m <==    Updates: 0
2022-04-30 10:58:10.669 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440564081266688[0;39m 生成今日电子书快照结束，耗时：663毫秒
2022-04-30 10:58:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440585052786688[0;39m 生成今日电子书快照开始
2022-04-30 10:58:15.208 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440585052786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:15.208 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440585052786688[0;39m ==> Parameters: 
2022-04-30 10:58:16.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440585052786688[0;39m <==    Updates: 0
2022-04-30 10:58:16.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440585052786688[0;39m 生成今日电子书快照结束，耗时：1061毫秒
2022-04-30 10:58:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440606024306688[0;39m 生成今日电子书快照开始
2022-04-30 10:58:20.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440606024306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:20.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440606024306688[0;39m ==> Parameters: 
2022-04-30 10:58:20.879 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440606024306688[0;39m <==    Updates: 0
2022-04-30 10:58:20.881 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440606024306688[0;39m 生成今日电子书快照结束，耗时：876毫秒
2022-04-30 10:58:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440626987438080[0;39m 生成今日电子书快照开始
2022-04-30 10:58:25.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440626987438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:25.232 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440626987438080[0;39m ==> Parameters: 
2022-04-30 10:58:25.672 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440626987438080[0;39m <==    Updates: 0
2022-04-30 10:58:25.672 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440626987438080[0;39m 生成今日电子书快照结束，耗时：668毫秒
2022-04-30 10:58:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440647958958080[0;39m 生成今日电子书快照开始
2022-04-30 10:58:30.625 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440647958958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:30.626 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440647958958080[0;39m ==> Parameters: 
2022-04-30 10:58:31.901 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440647958958080[0;39m <==    Updates: 0
2022-04-30 10:58:31.901 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440647958958080[0;39m 生成今日电子书快照结束，耗时：1897毫秒
2022-04-30 10:58:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440668934672384[0;39m 生成今日电子书快照开始
2022-04-30 10:58:35.224 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440668934672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:35.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440668934672384[0;39m ==> Parameters: 
2022-04-30 10:58:35.872 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440668934672384[0;39m <==    Updates: 0
2022-04-30 10:58:35.873 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440668934672384[0;39m 生成今日电子书快照结束，耗时：869毫秒
2022-04-30 10:58:35.873 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175440672579522560[0;39m start updating Ebook doc
2022-04-30 10:58:36.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440672579522560[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 10:58:36.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440672579522560[0;39m ==> Parameters: 
2022-04-30 10:58:36.529 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175440672579522560[0;39m <==    Updates: 1
2022-04-30 10:58:36.531 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175440672579522560[0;39m update ends, take 658 millisecs
2022-04-30 10:58:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440689910386688[0;39m 生成今日电子书快照开始
2022-04-30 10:58:40.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440689910386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:40.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440689910386688[0;39m ==> Parameters: 
2022-04-30 10:58:40.875 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440689910386688[0;39m <==    Updates: 0
2022-04-30 10:58:40.876 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440689910386688[0;39m 生成今日电子书快照结束，耗时：870毫秒
2022-04-30 10:58:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175440710881906688[0;39m 生成今日电子书快照开始
2022-04-30 10:58:45.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440710881906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 10:58:45.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440710881906688[0;39m ==> Parameters: 
2022-04-30 10:58:46.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175440710881906688[0;39m <==    Updates: 0
2022-04-30 10:58:46.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175440710881906688[0;39m 生成今日电子书快照结束，耗时：1076毫秒
2022-04-30 10:58:48.093 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 10:58:48.094 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:58:48.095 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-2 - Shutdown initiated...
2022-04-30 10:58:48.102 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-2 - Shutdown completed.
2022-04-30 10:58:48.190 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:58:48.191 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:58:48.253 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:58:48.253 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:58:48.253 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 10:58:48.267 WARN  org.mybatis.spring.mapper.ClassPathMapperScanner  :44   [32m                  [0;39m No MyBatis mapper was found in '[com.ameliawiki.wiki.mapper]' package. Please check your configuration.
2022-04-30 10:58:48.303 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:58:48.303 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-30 10:58:48.303 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:58:48.303 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:58:48.307 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:58:48.307 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 115 ms
2022-04-30 10:58:48.353 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:58:48.407 WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext:596  [32m                  [0;39m Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
2022-04-30 10:58:48.407 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:58:48.407 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Stopping service [Tomcat]
2022-04-30 10:58:48.410 INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener:136  [32m                  [0;39m 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-04-30 10:58:48.419 ERROR org.springframework.boot.SpringApplication        :856  [32m                  [0;39m Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:656)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:636)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1179)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:571)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:531)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:944)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:925)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:588)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:144)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:767)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:759)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:426)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:326)
	at com.ameliawiki.wiki.config.WikiApplication.main(WikiApplication.java:25)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 23 common frames omitted
Caused by: org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.mybatis.spring.SqlSessionFactoryBean.buildSqlSessionFactory(SqlSessionFactoryBean.java:612)
	at org.mybatis.spring.SqlSessionFactoryBean.afterPropertiesSet(SqlSessionFactoryBean.java:490)
	at org.mybatis.spring.SqlSessionFactoryBean.getObject(SqlSessionFactoryBean.java:632)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration.sqlSessionFactory(MybatisAutoConfiguration.java:180)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8.CGLIB$sqlSessionFactory$2(<generated>)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8$$FastClassBySpringCGLIB$$1152f41c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8.sqlSessionFactory(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	... 24 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:123)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:95)
	at org.mybatis.spring.SqlSessionFactoryBean.buildSqlSessionFactory(SqlSessionFactoryBean.java:610)
	... 37 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:263)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:254)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElements(XMLMapperBuilder.java:246)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:119)
	... 39 common frames omitted
Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:120)
	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:149)
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116)
	... 43 common frames omitted
Caused by: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:200)
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:89)
	at org.apache.ibatis.io.Resources.classForName(Resources.java:261)
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:116)
	... 45 common frames omitted
2022-04-30 10:59:42.956 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:59:42.956 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:59:43.004 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:59:43.004 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:59:43.005 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 10:59:43.014 WARN  org.mybatis.spring.mapper.ClassPathMapperScanner  :44   [32m                  [0;39m No MyBatis mapper was found in '[com.ameliawiki.wiki.mapper]' package. Please check your configuration.
2022-04-30 10:59:43.079 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:59:43.079 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:59:43.079 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:59:43.083 INFO  o.a.c.c.ContainerBase.[Tomcat-2].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:59:43.083 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 126 ms
2022-04-30 10:59:43.132 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:59:43.169 WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext:596  [32m                  [0;39m Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
2022-04-30 10:59:43.169 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:59:43.172 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Stopping service [Tomcat]
2022-04-30 10:59:43.174 INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener:136  [32m                  [0;39m 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-04-30 10:59:43.175 ERROR org.springframework.boot.SpringApplication        :856  [32m                  [0;39m Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:656)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:636)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1179)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:571)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:531)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:944)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:925)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:588)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:144)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:767)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:759)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:426)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:326)
	at com.ameliawiki.wiki.config.WikiApplication.main(WikiApplication.java:25)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 23 common frames omitted
Caused by: org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.mybatis.spring.SqlSessionFactoryBean.buildSqlSessionFactory(SqlSessionFactoryBean.java:612)
	at org.mybatis.spring.SqlSessionFactoryBean.afterPropertiesSet(SqlSessionFactoryBean.java:490)
	at org.mybatis.spring.SqlSessionFactoryBean.getObject(SqlSessionFactoryBean.java:632)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration.sqlSessionFactory(MybatisAutoConfiguration.java:180)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8.CGLIB$sqlSessionFactory$2(<generated>)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8$$FastClassBySpringCGLIB$$1152f41c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8.sqlSessionFactory(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	... 24 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:123)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:95)
	at org.mybatis.spring.SqlSessionFactoryBean.buildSqlSessionFactory(SqlSessionFactoryBean.java:610)
	... 37 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:263)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:254)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElements(XMLMapperBuilder.java:246)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:119)
	... 39 common frames omitted
Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:120)
	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:149)
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116)
	... 43 common frames omitted
Caused by: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:200)
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:89)
	at org.apache.ibatis.io.Resources.classForName(Resources.java:261)
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:116)
	... 45 common frames omitted
2022-04-30 10:59:44.613 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 10:59:44.613 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 10:59:44.674 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 10:59:44.674 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 10:59:44.675 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 10:59:44.686 WARN  org.mybatis.spring.mapper.ClassPathMapperScanner  :44   [32m                  [0;39m No MyBatis mapper was found in '[com.ameliawiki.wiki.mapper]' package. Please check your configuration.
2022-04-30 10:59:44.726 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 10:59:44.727 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 10:59:44.727 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 10:59:44.731 INFO  o.a.c.c.ContainerBase.[Tomcat-3].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 10:59:44.731 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 117 ms
2022-04-30 10:59:44.780 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 10:59:44.818 WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext:596  [32m                  [0;39m Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
2022-04-30 10:59:44.818 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 10:59:44.820 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Stopping service [Tomcat]
2022-04-30 10:59:44.822 INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener:136  [32m                  [0;39m 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-04-30 10:59:44.823 ERROR org.springframework.boot.SpringApplication        :856  [32m                  [0;39m Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:656)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:636)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1336)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1179)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:571)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:531)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:944)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:925)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:588)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:144)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:767)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:759)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:426)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:326)
	at com.ameliawiki.wiki.config.WikiApplication.main(WikiApplication.java:25)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651)
	... 23 common frames omitted
Caused by: org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.mybatis.spring.SqlSessionFactoryBean.buildSqlSessionFactory(SqlSessionFactoryBean.java:612)
	at org.mybatis.spring.SqlSessionFactoryBean.afterPropertiesSet(SqlSessionFactoryBean.java:490)
	at org.mybatis.spring.SqlSessionFactoryBean.getObject(SqlSessionFactoryBean.java:632)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration.sqlSessionFactory(MybatisAutoConfiguration.java:180)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8.CGLIB$sqlSessionFactory$2(<generated>)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8$$FastClassBySpringCGLIB$$1152f41c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331)
	at org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$8eedce8.sqlSessionFactory(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	... 24 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is 'file [/Users/xurui/IdeaProjects/wiki-project/target/classes/mapper/CategoryMapper.xml]'. Cause: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:123)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:95)
	at org.mybatis.spring.SqlSessionFactoryBean.buildSqlSessionFactory(SqlSessionFactoryBean.java:610)
	... 37 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error resolving class. Cause: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:118)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:263)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:254)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElements(XMLMapperBuilder.java:246)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:119)
	... 39 common frames omitted
Caused by: org.apache.ibatis.type.TypeException: Could not resolve type alias 'com.ameliawiki.wiki.domain.Category'.  Cause: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:120)
	at org.apache.ibatis.builder.BaseBuilder.resolveAlias(BaseBuilder.java:149)
	at org.apache.ibatis.builder.BaseBuilder.resolveClass(BaseBuilder.java:116)
	... 43 common frames omitted
Caused by: java.lang.ClassNotFoundException: Cannot find class: com.ameliawiki.wiki.domain.Category
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:200)
	at org.apache.ibatis.io.ClassLoaderWrapper.classForName(ClassLoaderWrapper.java:89)
	at org.apache.ibatis.io.Resources.classForName(Resources.java:261)
	at org.apache.ibatis.type.TypeAliasRegistry.resolveAlias(TypeAliasRegistry.java:116)
	... 45 common frames omitted
2022-04-30 11:00:13.130 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 11:00:13.130 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 11:00:13.185 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 11:00:13.185 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 11:00:13.186 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 11:00:13.238 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 11:00:13.239 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 11:00:13.239 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 11:00:13.244 INFO  o.a.c.c.ContainerBase.[Tomcat-5].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 11:00:13.244 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 113 ms
2022-04-30 11:00:13.410 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 11:00:13.514 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 11:00:13.530 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 11:00:13.538 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 11:00:13.540 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 0.423 seconds (JVM running for 953.374)
2022-04-30 11:00:13.541 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-30 11:00:13.541 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 11:00:13.541 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 11:00:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441088369266688[0;39m 生成今日电子书快照开始
2022-04-30 11:00:15.007 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 11:00:15.007 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175441088369266688[0;39m HikariPool-3 - Starting...
2022-04-30 11:00:15.007 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 11:00:15.052 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 11:00:15.052 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 11:00:15.110 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 11:00:15.111 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 11:00:15.111 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 11:00:15.162 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 11:00:15.162 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 11:00:15.162 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 11:00:15.165 INFO  o.a.c.c.ContainerBase.[Tomcat-5].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 11:00:15.166 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 113 ms
2022-04-30 11:00:15.322 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 11:00:15.423 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 11:00:15.435 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 11:00:15.443 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 11:00:15.445 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 0.403 seconds (JVM running for 955.279)
2022-04-30 11:00:15.446 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-30 11:00:15.446 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 11:00:15.446 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 11:00:17.807 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175441088369266688[0;39m HikariPool-3 - Start completed.
2022-04-30 11:00:17.809 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441088369266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:17.809 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441088369266688[0;39m ==> Parameters: 
2022-04-30 11:00:18.300 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441088369266688[0;39m <==    Updates: 0
2022-04-30 11:00:18.301 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441088369266688[0;39m 生成今日电子书快照结束，耗时：3294毫秒
2022-04-30 11:00:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441109340786688[0;39m 生成今日电子书快照开始
2022-04-30 11:00:20.006 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175441109340786688[0;39m HikariPool-4 - Starting...
2022-04-30 11:00:22.742 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175441109340786688[0;39m HikariPool-4 - Start completed.
2022-04-30 11:00:22.743 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441109340786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:22.743 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441109340786688[0;39m ==> Parameters: 
2022-04-30 11:00:23.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441109340786688[0;39m <==    Updates: 0
2022-04-30 11:00:23.255 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441109340786688[0;39m 生成今日电子书快照结束，耗时：3250毫秒
2022-04-30 11:00:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441130312306688[0;39m 生成今日电子书快照开始
2022-04-30 11:00:25.207 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441130312306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:25.207 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441130312306688[0;39m ==> Parameters: 
2022-04-30 11:00:25.652 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441130312306688[0;39m <==    Updates: 0
2022-04-30 11:00:25.652 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441130312306688[0;39m 生成今日电子书快照结束，耗时：647毫秒
2022-04-30 11:00:26.004 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 11:00:26.006 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 11:00:26.006 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-4 - Shutdown initiated...
2022-04-30 11:00:27.690 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-4 - Shutdown completed.
2022-04-30 11:00:27.747 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 11:00:27.747 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 11:00:27.802 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 11:00:27.802 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 11:00:27.803 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 11:00:27.852 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 11:00:27.852 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 11:00:27.852 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 11:00:27.855 INFO  o.a.c.c.ContainerBase.[Tomcat-5].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 11:00:27.855 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 107 ms
2022-04-30 11:00:28.002 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 11:00:28.107 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 11:00:28.120 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 11:00:28.127 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 11:00:28.129 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 0.401 seconds (JVM running for 967.963)
2022-04-30 11:00:28.130 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-30 11:00:28.130 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 11:00:28.130 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 11:00:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441151288020992[0;39m 生成今日电子书快照开始
2022-04-30 11:00:30.010 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175441151288020992[0;39m HikariPool-5 - Starting...
2022-04-30 11:00:32.514 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175441151288020992[0;39m HikariPool-5 - Start completed.
2022-04-30 11:00:32.514 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441151288020992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:32.515 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441151288020992[0;39m ==> Parameters: 
2022-04-30 11:00:32.981 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441151288020992[0;39m <==    Updates: 0
2022-04-30 11:00:32.981 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441151288020992[0;39m 生成今日电子书快照结束，耗时：2972毫秒
2022-04-30 11:00:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175441172255346688[0;39m start updating Ebook doc
2022-04-30 11:00:35.221 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441172255346688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:00:35.222 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441172255346688[0;39m ==> Parameters: 
2022-04-30 11:00:36.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441172255346688[0;39m <==    Updates: 1
2022-04-30 11:00:36.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175441172255346688[0;39m update ends, take 1099 millisecs
2022-04-30 11:00:36.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441176869081088[0;39m 生成今日电子书快照开始
2022-04-30 11:00:36.317 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441176869081088[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:36.317 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441176869081088[0;39m ==> Parameters: 
2022-04-30 11:00:36.780 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441176869081088[0;39m <==    Updates: 0
2022-04-30 11:00:36.781 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441176869081088[0;39m 生成今日电子书快照结束，耗时：676毫秒
2022-04-30 11:00:38.687 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 11:00:38.688 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 11:00:38.688 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-5 - Shutdown initiated...
2022-04-30 11:00:39.807 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-5 - Shutdown completed.
2022-04-30 11:00:39.876 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 11:00:39.876 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 11:00:39.955 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 11:00:39.955 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 11:00:39.956 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 11:00:40.029 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 11:00:40.029 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 11:00:40.029 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 11:00:40.034 INFO  o.a.c.c.ContainerBase.[Tomcat-5].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 11:00:40.034 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 157 ms
2022-04-30 11:00:40.336 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 11:00:40.464 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 11:00:40.508 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 11:00:40.525 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 11:00:40.537 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 0.68 seconds (JVM running for 980.374)
2022-04-30 11:00:40.538 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-30 11:00:40.538 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 11:00:40.538 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 11:00:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441214181609472[0;39m 生成今日电子书快照开始
2022-04-30 11:00:45.002 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175441214181609472[0;39m HikariPool-6 - Starting...
2022-04-30 11:00:47.675 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175441214181609472[0;39m HikariPool-6 - Start completed.
2022-04-30 11:00:47.675 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441214181609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:47.676 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441214181609472[0;39m ==> Parameters: 
2022-04-30 11:00:48.188 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441214181609472[0;39m <==    Updates: 0
2022-04-30 11:00:48.188 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441214181609472[0;39m 生成今日电子书快照结束，耗时：3186毫秒
2022-04-30 11:00:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441235165712384[0;39m 生成今日电子书快照开始
2022-04-30 11:00:50.260 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441235165712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:50.260 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441235165712384[0;39m ==> Parameters: 
2022-04-30 11:00:50.765 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441235165712384[0;39m <==    Updates: 0
2022-04-30 11:00:50.765 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441235165712384[0;39m 生成今日电子书快照结束，耗时：760毫秒
2022-04-30 11:00:54.998 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441256112066560[0;39m 生成今日电子书快照开始
2022-04-30 11:00:55.263 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441256112066560[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:00:55.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441256112066560[0;39m ==> Parameters: 
2022-04-30 11:00:55.771 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441256112066560[0;39m <==    Updates: 0
2022-04-30 11:00:55.772 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441256112066560[0;39m 生成今日电子书快照结束，耗时：773毫秒
2022-04-30 11:01:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441277104558080[0;39m 生成今日电子书快照开始
2022-04-30 11:01:00.258 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441277104558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:00.258 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441277104558080[0;39m ==> Parameters: 
2022-04-30 11:01:00.756 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441277104558080[0;39m <==    Updates: 0
2022-04-30 11:01:00.757 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441277104558080[0;39m 生成今日电子书快照结束，耗时：751毫秒
2022-04-30 11:01:04.993 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175441298034135040[0;39m start updating Ebook doc
2022-04-30 11:01:05.245 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441298034135040[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:01:05.249 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441298034135040[0;39m ==> Parameters: 
2022-04-30 11:01:05.746 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441298034135040[0;39m <==    Updates: 1
2022-04-30 11:01:05.747 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175441298034135040[0;39m update ends, take 754 millisecs
2022-04-30 11:01:05.747 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441301196640256[0;39m 生成今日电子书快照开始
2022-04-30 11:01:05.747 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441301196640256[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:05.747 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441301196640256[0;39m ==> Parameters: 
2022-04-30 11:01:06.243 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441301196640256[0;39m <==    Updates: 0
2022-04-30 11:01:06.245 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441301196640256[0;39m 生成今日电子书快照结束，耗时：498毫秒
2022-04-30 11:01:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441319055986688[0;39m 生成今日电子书快照开始
2022-04-30 11:01:10.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441319055986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:10.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441319055986688[0;39m ==> Parameters: 
2022-04-30 11:01:10.751 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441319055986688[0;39m <==    Updates: 0
2022-04-30 11:01:10.751 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441319055986688[0;39m 生成今日电子书快照结束，耗时：746毫秒
2022-04-30 11:01:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441340023312384[0;39m 生成今日电子书快照开始
2022-04-30 11:01:15.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441340023312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:15.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441340023312384[0;39m ==> Parameters: 
2022-04-30 11:01:15.757 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441340023312384[0;39m <==    Updates: 0
2022-04-30 11:01:15.758 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441340023312384[0;39m 生成今日电子书快照结束，耗时：754毫秒
2022-04-30 11:01:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441360994832384[0;39m 生成今日电子书快照开始
2022-04-30 11:01:20.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441360994832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:20.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441360994832384[0;39m ==> Parameters: 
2022-04-30 11:01:20.740 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441360994832384[0;39m <==    Updates: 0
2022-04-30 11:01:20.740 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441360994832384[0;39m 生成今日电子书快照结束，耗时：736毫秒
2022-04-30 11:01:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441381966352384[0;39m 生成今日电子书快照开始
2022-04-30 11:01:25.252 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441381966352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:25.253 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441381966352384[0;39m ==> Parameters: 
2022-04-30 11:01:25.751 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441381966352384[0;39m <==    Updates: 0
2022-04-30 11:01:25.751 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441381966352384[0;39m 生成今日电子书快照结束，耗时：746毫秒
2022-04-30 11:01:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441402942066688[0;39m 生成今日电子书快照开始
2022-04-30 11:01:30.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441402942066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:30.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441402942066688[0;39m ==> Parameters: 
2022-04-30 11:01:30.767 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441402942066688[0;39m <==    Updates: 0
2022-04-30 11:01:30.768 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441402942066688[0;39m 生成今日电子书快照结束，耗时：763毫秒
2022-04-30 11:01:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175441423901003776[0;39m start updating Ebook doc
2022-04-30 11:01:35.246 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441423901003776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:01:35.247 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441423901003776[0;39m ==> Parameters: 
2022-04-30 11:01:35.745 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441423901003776[0;39m <==    Updates: 1
2022-04-30 11:01:35.745 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175441423901003776[0;39m update ends, take 742 millisecs
2022-04-30 11:01:35.745 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441427017371648[0;39m 生成今日电子书快照开始
2022-04-30 11:01:35.746 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441427017371648[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:35.746 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441427017371648[0;39m ==> Parameters: 
2022-04-30 11:01:36.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441427017371648[0;39m <==    Updates: 0
2022-04-30 11:01:36.244 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441427017371648[0;39m 生成今日电子书快照结束，耗时：499毫秒
2022-04-30 11:01:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441444872523776[0;39m 生成今日电子书快照开始
2022-04-30 11:01:40.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441444872523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:40.229 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441444872523776[0;39m ==> Parameters: 
2022-04-30 11:01:40.708 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441444872523776[0;39m <==    Updates: 0
2022-04-30 11:01:40.709 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441444872523776[0;39m 生成今日电子书快照结束，耗时：707毫秒
2022-04-30 11:01:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441465856626688[0;39m 生成今日电子书快照开始
2022-04-30 11:01:45.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441465856626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:45.242 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441465856626688[0;39m ==> Parameters: 
2022-04-30 11:01:45.744 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441465856626688[0;39m <==    Updates: 0
2022-04-30 11:01:45.744 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441465856626688[0;39m 生成今日电子书快照结束，耗时：739毫秒
2022-04-30 11:01:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441486815563776[0;39m 生成今日电子书快照开始
2022-04-30 11:01:50.234 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441486815563776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:50.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441486815563776[0;39m ==> Parameters: 
2022-04-30 11:01:51.665 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441486815563776[0;39m <==    Updates: 0
2022-04-30 11:01:51.665 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441486815563776[0;39m 生成今日电子书快照结束，耗时：1663毫秒
2022-04-30 11:01:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441507799666688[0;39m 生成今日电子书快照开始
2022-04-30 11:01:55.258 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441507799666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:01:55.259 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441507799666688[0;39m ==> Parameters: 
2022-04-30 11:01:55.758 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441507799666688[0;39m <==    Updates: 0
2022-04-30 11:01:55.759 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441507799666688[0;39m 生成今日电子书快照结束，耗时：753毫秒
2022-04-30 11:02:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441528775380992[0;39m 生成今日电子书快照开始
2022-04-30 11:02:00.253 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441528775380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:00.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441528775380992[0;39m ==> Parameters: 
2022-04-30 11:02:00.756 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441528775380992[0;39m <==    Updates: 0
2022-04-30 11:02:00.756 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441528775380992[0;39m 生成今日电子书快照结束，耗时：750毫秒
2022-04-30 11:02:05.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441549742706688[0;39m 生成今日电子书快照开始
2022-04-30 11:02:05.259 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441549742706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:05.261 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441549742706688[0;39m ==> Parameters: 
2022-04-30 11:02:05.752 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441549742706688[0;39m <==    Updates: 0
2022-04-30 11:02:05.754 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441549742706688[0;39m 生成今日电子书快照结束，耗时：748毫秒
2022-04-30 11:02:05.754 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175441552884240384[0;39m start updating Ebook doc
2022-04-30 11:02:05.755 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441552884240384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:02:05.756 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441552884240384[0;39m ==> Parameters: 
2022-04-30 11:02:06.248 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441552884240384[0;39m <==    Updates: 1
2022-04-30 11:02:06.248 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175441552884240384[0;39m update ends, take 494 millisecs
2022-04-30 11:02:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441570714226688[0;39m 生成今日电子书快照开始
2022-04-30 11:02:10.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441570714226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:10.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441570714226688[0;39m ==> Parameters: 
2022-04-30 11:02:10.729 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441570714226688[0;39m <==    Updates: 0
2022-04-30 11:02:10.730 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441570714226688[0;39m 生成今日电子书快照结束，耗时：725毫秒
2022-04-30 11:02:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441591681552384[0;39m 生成今日电子书快照开始
2022-04-30 11:02:15.290 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441591681552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:15.290 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441591681552384[0;39m ==> Parameters: 
2022-04-30 11:02:15.798 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441591681552384[0;39m <==    Updates: 0
2022-04-30 11:02:15.798 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441591681552384[0;39m 生成今日电子书快照结束，耗时：793毫秒
2022-04-30 11:02:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441612636295168[0;39m 生成今日电子书快照开始
2022-04-30 11:02:20.272 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441612636295168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:20.273 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441612636295168[0;39m ==> Parameters: 
2022-04-30 11:02:20.762 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441612636295168[0;39m <==    Updates: 0
2022-04-30 11:02:20.763 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441612636295168[0;39m 生成今日电子书快照结束，耗时：763毫秒
2022-04-30 11:02:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441633628786688[0;39m 生成今日电子书快照开始
2022-04-30 11:02:25.256 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441633628786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:25.257 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441633628786688[0;39m ==> Parameters: 
2022-04-30 11:02:25.752 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441633628786688[0;39m <==    Updates: 0
2022-04-30 11:02:25.753 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441633628786688[0;39m 生成今日电子书快照结束，耗时：748毫秒
2022-04-30 11:02:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441654600306688[0;39m 生成今日电子书快照开始
2022-04-30 11:02:30.273 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441654600306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:30.277 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441654600306688[0;39m ==> Parameters: 
2022-04-30 11:02:30.787 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441654600306688[0;39m <==    Updates: 0
2022-04-30 11:02:30.789 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441654600306688[0;39m 生成今日电子书快照结束，耗时：783毫秒
2022-04-30 11:02:35.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441675559243776[0;39m 生成今日电子书快照开始
2022-04-30 11:02:35.252 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441675559243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:35.253 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441675559243776[0;39m ==> Parameters: 
2022-04-30 11:02:35.748 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441675559243776[0;39m <==    Updates: 0
2022-04-30 11:02:35.748 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441675559243776[0;39m 生成今日电子书快照结束，耗时：745毫秒
2022-04-30 11:02:35.749 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175441678692388864[0;39m start updating Ebook doc
2022-04-30 11:02:35.749 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441678692388864[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:02:35.749 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441678692388864[0;39m ==> Parameters: 
2022-04-30 11:02:36.840 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441678692388864[0;39m <==    Updates: 1
2022-04-30 11:02:36.840 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175441678692388864[0;39m update ends, take 1091 millisecs
2022-04-30 11:02:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441696543346688[0;39m 生成今日电子书快照开始
2022-04-30 11:02:40.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441696543346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:40.251 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441696543346688[0;39m ==> Parameters: 
2022-04-30 11:02:40.738 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441696543346688[0;39m <==    Updates: 0
2022-04-30 11:02:40.739 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441696543346688[0;39m 生成今日电子书快照结束，耗时：734毫秒
2022-04-30 11:02:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441717514866688[0;39m 生成今日电子书快照开始
2022-04-30 11:02:45.248 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441717514866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:45.249 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441717514866688[0;39m ==> Parameters: 
2022-04-30 11:02:45.736 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441717514866688[0;39m <==    Updates: 0
2022-04-30 11:02:45.736 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441717514866688[0;39m 生成今日电子书快照结束，耗时：730毫秒
2022-04-30 11:02:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441738477998080[0;39m 生成今日电子书快照开始
2022-04-30 11:02:50.264 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441738477998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:50.265 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441738477998080[0;39m ==> Parameters: 
2022-04-30 11:02:50.782 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441738477998080[0;39m <==    Updates: 0
2022-04-30 11:02:50.784 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441738477998080[0;39m 生成今日电子书快照结束，耗时：781毫秒
2022-04-30 11:02:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441759457906688[0;39m 生成今日电子书快照开始
2022-04-30 11:02:55.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441759457906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:02:55.236 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441759457906688[0;39m ==> Parameters: 
2022-04-30 11:02:55.715 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441759457906688[0;39m <==    Updates: 0
2022-04-30 11:02:55.715 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441759457906688[0;39m 生成今日电子书快照结束，耗时：710毫秒
2022-04-30 11:03:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441780433620992[0;39m 生成今日电子书快照开始
2022-04-30 11:03:00.276 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441780433620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:00.277 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441780433620992[0;39m ==> Parameters: 
2022-04-30 11:03:00.763 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441780433620992[0;39m <==    Updates: 0
2022-04-30 11:03:00.764 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441780433620992[0;39m 生成今日电子书快照结束，耗时：757毫秒
2022-04-30 11:03:04.392 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 11:03:04.393 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 11:03:04.393 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-6 - Shutdown initiated...
2022-04-30 11:03:04.396 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-6 - Shutdown completed.
2022-04-30 11:03:04.485 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 11.0.14.1 on Felix-Mac with PID 74554 (/Users/xurui/IdeaProjects/wiki-project/target/classes started by xurui in /Users/xurui/IdeaProjects/wiki-project)
2022-04-30 11:03:04.485 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-30 11:03:04.541 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-30 11:03:04.541 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-30 11:03:04.542 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 0 ms. Found 0 Redis repository interfaces.
2022-04-30 11:03:04.593 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-30 11:03:04.594 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-30 11:03:04.594 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-30 11:03:04.597 INFO  o.a.c.c.ContainerBase.[Tomcat-5].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-30 11:03:04.597 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 111 ms
2022-04-30 11:03:04.752 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-30 11:03:04.853 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-30 11:03:04.867 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-30 11:03:04.874 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-30 11:03:04.877 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 0.411 seconds (JVM running for 1124.73)
2022-04-30 11:03:04.877 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2022-04-30 11:03:04.877 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-30 11:03:04.877 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-30 11:03:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175441801400946688[0;39m start updating Ebook doc
2022-04-30 11:03:05.008 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175441801400946688[0;39m HikariPool-7 - Starting...
2022-04-30 11:03:07.514 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175441801400946688[0;39m HikariPool-7 - Start completed.
2022-04-30 11:03:07.515 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441801400946688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:03:07.515 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441801400946688[0;39m ==> Parameters: 
2022-04-30 11:03:07.928 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441801400946688[0;39m <==    Updates: 1
2022-04-30 11:03:07.929 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175441801400946688[0;39m update ends, take 2923 millisecs
2022-04-30 11:03:07.929 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441813665091584[0;39m 生成今日电子书快照开始
2022-04-30 11:03:07.929 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441813665091584[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:07.929 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441813665091584[0;39m ==> Parameters: 
2022-04-30 11:03:08.817 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441813665091584[0;39m <==    Updates: 0
2022-04-30 11:03:08.817 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441813665091584[0;39m 生成今日电子书快照结束，耗时：888毫秒
2022-04-30 11:03:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441822376660992[0;39m 生成今日电子书快照开始
2022-04-30 11:03:10.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441822376660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:10.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441822376660992[0;39m ==> Parameters: 
2022-04-30 11:03:10.682 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441822376660992[0;39m <==    Updates: 0
2022-04-30 11:03:10.684 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441822376660992[0;39m 生成今日电子书快照结束，耗时：677毫秒
2022-04-30 11:03:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441843348180992[0;39m 生成今日电子书快照开始
2022-04-30 11:03:15.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441843348180992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:15.238 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441843348180992[0;39m ==> Parameters: 
2022-04-30 11:03:15.655 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441843348180992[0;39m <==    Updates: 0
2022-04-30 11:03:15.656 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441843348180992[0;39m 生成今日电子书快照结束，耗时：650毫秒
2022-04-30 11:03:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441864298729472[0;39m 生成今日电子书快照开始
2022-04-30 11:03:20.219 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441864298729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:20.220 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441864298729472[0;39m ==> Parameters: 
2022-04-30 11:03:20.673 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441864298729472[0;39m <==    Updates: 0
2022-04-30 11:03:20.674 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441864298729472[0;39m 生成今日电子书快照结束，耗时：672毫秒
2022-04-30 11:03:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441885287026688[0;39m 生成今日电子书快照开始
2022-04-30 11:03:25.210 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441885287026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:25.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441885287026688[0;39m ==> Parameters: 
2022-04-30 11:03:25.652 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441885287026688[0;39m <==    Updates: 0
2022-04-30 11:03:25.654 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441885287026688[0;39m 生成今日电子书快照结束，耗时：648毫秒
2022-04-30 11:03:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441906250158080[0;39m 生成今日电子书快照开始
2022-04-30 11:03:30.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441906250158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:30.212 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441906250158080[0;39m ==> Parameters: 
2022-04-30 11:03:31.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441906250158080[0;39m <==    Updates: 0
2022-04-30 11:03:31.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441906250158080[0;39m 生成今日电子书快照结束，耗时：1058毫秒
2022-04-30 11:03:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175441927221678080[0;39m start updating Ebook doc
2022-04-30 11:03:35.231 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441927221678080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:03:35.232 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441927221678080[0;39m ==> Parameters: 
2022-04-30 11:03:35.674 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175441927221678080[0;39m <==    Updates: 1
2022-04-30 11:03:35.674 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175441927221678080[0;39m update ends, take 670 millisecs
2022-04-30 11:03:35.674 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441930036056064[0;39m 生成今日电子书快照开始
2022-04-30 11:03:35.675 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441930036056064[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:35.675 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441930036056064[0;39m ==> Parameters: 
2022-04-30 11:03:36.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441930036056064[0;39m <==    Updates: 0
2022-04-30 11:03:36.102 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441930036056064[0;39m 生成今日电子书快照结束，耗时：428毫秒
2022-04-30 11:03:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441948205780992[0;39m 生成今日电子书快照开始
2022-04-30 11:03:40.235 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441948205780992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:40.236 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441948205780992[0;39m ==> Parameters: 
2022-04-30 11:03:40.663 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441948205780992[0;39m <==    Updates: 0
2022-04-30 11:03:40.664 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441948205780992[0;39m 生成今日电子书快照结束，耗时：658毫秒
2022-04-30 11:03:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441969160523776[0;39m 生成今日电子书快照开始
2022-04-30 11:03:45.226 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441969160523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:45.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441969160523776[0;39m ==> Parameters: 
2022-04-30 11:03:45.649 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441969160523776[0;39m <==    Updates: 0
2022-04-30 11:03:45.650 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441969160523776[0;39m 生成今日电子书快照结束，耗时：648毫秒
2022-04-30 11:03:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175441990140432384[0;39m 生成今日电子书快照开始
2022-04-30 11:03:50.209 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441990140432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:50.211 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441990140432384[0;39m ==> Parameters: 
2022-04-30 11:03:50.936 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175441990140432384[0;39m <==    Updates: 0
2022-04-30 11:03:50.937 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175441990140432384[0;39m 生成今日电子书快照结束，耗时：933毫秒
2022-04-30 11:03:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175442011111952384[0;39m 生成今日电子书快照开始
2022-04-30 11:03:55.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442011111952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:03:55.240 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442011111952384[0;39m ==> Parameters: 
2022-04-30 11:03:55.903 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442011111952384[0;39m <==    Updates: 0
2022-04-30 11:03:55.903 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175442011111952384[0;39m 生成今日电子书快照结束，耗时：898毫秒
2022-04-30 11:04:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175442032087666688[0;39m 生成今日电子书快照开始
2022-04-30 11:04:00.236 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442032087666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:04:00.237 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442032087666688[0;39m ==> Parameters: 
2022-04-30 11:04:00.685 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442032087666688[0;39m <==    Updates: 0
2022-04-30 11:04:00.686 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175442032087666688[0;39m 生成今日电子书快照结束，耗时：680毫秒
2022-04-30 11:04:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175442053050798080[0;39m 生成今日电子书快照开始
2022-04-30 11:04:05.230 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442053050798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:04:05.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442053050798080[0;39m ==> Parameters: 
2022-04-30 11:04:05.685 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442053050798080[0;39m <==    Updates: 0
2022-04-30 11:04:05.686 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175442053050798080[0;39m 生成今日电子书快照结束，耗时：682毫秒
2022-04-30 11:04:05.686 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175442055915507712[0;39m start updating Ebook doc
2022-04-30 11:04:05.687 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175442055915507712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-30 11:04:05.687 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175442055915507712[0;39m ==> Parameters: 
2022-04-30 11:04:06.142 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175442055915507712[0;39m <==    Updates: 1
2022-04-30 11:04:06.142 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175442055915507712[0;39m update ends, take 456 millisecs
2022-04-30 11:04:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175442074030706688[0;39m 生成今日电子书快照开始
2022-04-30 11:04:10.228 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442074030706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:04:10.231 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442074030706688[0;39m ==> Parameters: 
2022-04-30 11:04:10.660 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442074030706688[0;39m <==    Updates: 0
2022-04-30 11:04:10.662 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175442074030706688[0;39m 生成今日电子书快照结束，耗时：656毫秒
2022-04-30 11:04:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175442095002226688[0;39m 生成今日电子书快照开始
2022-04-30 11:04:15.213 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442095002226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-30 11:04:15.214 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442095002226688[0;39m ==> Parameters: 
2022-04-30 11:04:16.276 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175442095002226688[0;39m <==    Updates: 0
2022-04-30 11:04:16.276 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175442095002226688[0;39m 生成今日电子书快照结束，耗时：1270毫秒
2022-04-30 11:04:19.182 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-30 11:04:19.182 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-30 11:04:19.183 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-7 - Shutdown initiated...
2022-04-30 11:04:19.186 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-7 - Shutdown completed.
