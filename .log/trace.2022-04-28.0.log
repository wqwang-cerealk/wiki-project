2022-04-28 15:00:55.863 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2022-04-28 15:00:55.871 INFO  com.ameliawiki.wiki.config.WikiApplication        :55   [32m                  [0;39m Starting WikiApplication using Java 1.8.0_322 on sunarkedeMacBook-Pro.local with PID 15104 (/Users/sunarke/Downloads/wiki 5/target/classes started by sunarke in /Users/sunarke/Downloads/wiki 5)
2022-04-28 15:00:55.872 INFO  com.ameliawiki.wiki.config.WikiApplication        :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2022-04-28 15:00:55.917 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2022-04-28 15:00:55.917 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2022-04-28 15:00:56.612 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2022-04-28 15:00:56.615 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2022-04-28 15:00:56.636 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2022-04-28 15:00:57.304 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8080 (http)
2022-04-28 15:00:57.312 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8080"]
2022-04-28 15:00:57.312 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2022-04-28 15:00:57.313 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2022-04-28 15:00:57.358 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2022-04-28 15:00:57.358 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1440 ms
2022-04-28 15:00:58.318 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2022-04-28 15:00:58.744 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2022-04-28 15:00:58.795 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2022-04-28 15:00:58.814 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8080"]
2022-04-28 15:00:58.837 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8080 (http) with context path ''
2022-04-28 15:00:58.851 INFO  com.ameliawiki.wiki.config.WikiApplication        :61   [32m                  [0;39m Started WikiApplication in 3.468 seconds (JVM running for 4.035)
2022-04-28 15:00:58.853 INFO  com.ameliawiki.wiki.config.WikiApplication        :26   [32m                  [0;39m launch success!!!!!!!!YEA!!!
2022-04-28 15:00:58.854 INFO  com.ameliawiki.wiki.config.WikiApplication        :27   [32m                  [0;39m address: 	http://127.0.0.1:8080
2022-04-28 15:01:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003391758569472[0;39m 生成今日电子书快照开始
2022-04-28 15:01:00.021 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m175003391758569472[0;39m HikariPool-1 - Starting...
2022-04-28 15:01:00.543 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m175003391758569472[0;39m HikariPool-1 - Start completed.
2022-04-28 15:01:00.550 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003391758569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:00.570 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003391758569472[0;39m ==> Parameters: 
2022-04-28 15:01:00.604 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003391758569472[0;39m <==    Updates: 5
2022-04-28 15:01:00.607 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003391758569472[0;39m 生成今日电子书快照结束，耗时：605毫秒
2022-04-28 15:01:05.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175003412738478080[0;39m start updating Ebook doc
2022-04-28 15:01:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003412738478080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:01:05.034 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003412738478080[0;39m ==> Parameters: 
2022-04-28 15:01:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003412738478080[0;39m <==    Updates: 1
2022-04-28 15:01:05.072 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175003412738478080[0;39m update ends, take 68 millisecs
2022-04-28 15:01:05.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003413032079360[0;39m 生成今日电子书快照开始
2022-04-28 15:01:05.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003413032079360[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:05.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003413032079360[0;39m ==> Parameters: 
2022-04-28 15:01:05.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003413032079360[0;39m <==    Updates: 0
2022-04-28 15:01:05.113 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003413032079360[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-28 15:01:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003433701609472[0;39m 生成今日电子书快照开始
2022-04-28 15:01:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003433701609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003433701609472[0;39m ==> Parameters: 
2022-04-28 15:01:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003433701609472[0;39m <==    Updates: 0
2022-04-28 15:01:10.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003433701609472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-28 15:01:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003454668935168[0;39m 生成今日电子书快照开始
2022-04-28 15:01:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003454668935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003454668935168[0;39m ==> Parameters: 
2022-04-28 15:01:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003454668935168[0;39m <==    Updates: 0
2022-04-28 15:01:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003454668935168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:01:19.808 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-28 15:01:19.808 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2022-04-28 15:01:19.810 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2022-04-28 15:01:19.853 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175003475019698178[0;39m ------------- 开始 -------------
2022-04-28 15:01:19.853 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175003475019698176[0;39m ------------- 开始 -------------
2022-04-28 15:01:19.853 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175003475019698177[0;39m ------------- 开始 -------------
2022-04-28 15:01:19.855 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175003475019698176[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:01:19.855 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175003475019698178[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:01:19.855 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175003475019698177[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:01:19.856 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175003475019698177[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:01:19.856 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175003475019698178[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:01:19.856 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175003475019698176[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:01:19.856 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175003475019698177[0;39m 远程地址: 127.0.0.1
2022-04-28 15:01:19.856 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175003475019698178[0;39m 远程地址: 127.0.0.1
2022-04-28 15:01:19.856 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175003475019698176[0;39m 远程地址: 127.0.0.1
2022-04-28 15:01:19.893 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m                  [0;39m 有新连接：token：wDodd4egQB，session id：0，当前连接数：1
2022-04-28 15:01:19.906 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175003475019698177[0;39m 请求参数: []
2022-04-28 15:01:19.906 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175003475019698176[0;39m 请求参数: []
2022-04-28 15:01:19.906 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175003475019698178[0;39m 请求参数: []
2022-04-28 15:01:19.933 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175003475019698176[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:01:19.935 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175003475019698176[0;39m ==> Parameters: 
2022-04-28 15:01:19.936 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175003475019698178[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:01:19.936 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175003475019698178[0;39m ==> Parameters: 
2022-04-28 15:01:19.955 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175003475019698177[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:01:19.956 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175003475019698177[0;39m ==> Parameters: 
2022-04-28 15:01:19.973 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:01:19.973 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175003475019698178[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:01:19.973 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:01:19.974 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:01:19.975 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175003475019698178[0;39m <==        Row: 2022-04-28, 1726, 59, 1726, 59
2022-04-28 15:01:19.975 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:01:19.976 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:01:19.977 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175003475019698178[0;39m <==      Total: 1
2022-04-28 15:01:19.977 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:01:19.977 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:01:19.978 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:01:19.978 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:01:19.978 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:01:19.978 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:01:19.979 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:01:19.979 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:01:19.980 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:01:19.980 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:01:19.981 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:01:19.981 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:01:19.982 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:01:19.982 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:01:19.982 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:01:19.982 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:01:19.983 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:01:19.983 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:01:19.983 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:01:19.984 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:01:19.984 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:01:19.984 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:01:19.985 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175003475019698176[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:01:19.985 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175003475019698177[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:01:19.985 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175003475019698176[0;39m <==      Total: 12
2022-04-28 15:01:19.986 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175003475019698177[0;39m <==      Total: 15
2022-04-28 15:01:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003475653038080[0;39m 生成今日电子书快照开始
2022-04-28 15:01:20.004 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003475653038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:20.005 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003475653038080[0;39m ==> Parameters: 
2022-04-28 15:01:20.018 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175003475019698177[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:01:20.019 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175003475019698177[0;39m ------------- 结束 耗时：168 ms -------------
2022-04-28 15:01:20.019 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175003475019698178[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1726,"viewIncrease":1726,"voteCount":59,"voteIncrease":59}],"success":true}
2022-04-28 15:01:20.019 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175003475019698176[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:01:20.019 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175003475019698178[0;39m ------------- 结束 耗时：168 ms -------------
2022-04-28 15:01:20.020 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175003475019698176[0;39m ------------- 结束 耗时：169 ms -------------
2022-04-28 15:01:20.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003475653038080[0;39m <==    Updates: 0
2022-04-28 15:01:20.042 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003475653038080[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-28 15:01:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003496620363776[0;39m 生成今日电子书快照开始
2022-04-28 15:01:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003496620363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003496620363776[0;39m ==> Parameters: 
2022-04-28 15:01:25.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003496620363776[0;39m <==    Updates: 0
2022-04-28 15:01:25.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003496620363776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-28 15:01:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003517583495168[0;39m 生成今日电子书快照开始
2022-04-28 15:01:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003517583495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003517583495168[0;39m ==> Parameters: 
2022-04-28 15:01:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003517583495168[0;39m <==    Updates: 0
2022-04-28 15:01:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003517583495168[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:01:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003538575986688[0;39m 生成今日电子书快照开始
2022-04-28 15:01:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003538575986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003538575986688[0;39m ==> Parameters: 
2022-04-28 15:01:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003538575986688[0;39m <==    Updates: 0
2022-04-28 15:01:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003538575986688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:01:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175003538831839232[0;39m start updating Ebook doc
2022-04-28 15:01:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003538831839232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:01:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003538831839232[0;39m ==> Parameters: 
2022-04-28 15:01:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003538831839232[0;39m <==    Updates: 1
2022-04-28 15:01:35.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175003538831839232[0;39m update ends, take 36 millisecs
2022-04-28 15:01:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003559539118080[0;39m 生成今日电子书快照开始
2022-04-28 15:01:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003559539118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003559539118080[0;39m ==> Parameters: 
2022-04-28 15:01:40.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003559539118080[0;39m <==    Updates: 0
2022-04-28 15:01:40.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003559539118080[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-28 15:01:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003580498055168[0;39m 生成今日电子书快照开始
2022-04-28 15:01:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003580498055168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003580498055168[0;39m ==> Parameters: 
2022-04-28 15:01:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003580498055168[0;39m <==    Updates: 0
2022-04-28 15:01:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003580498055168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:01:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003601473769472[0;39m 生成今日电子书快照开始
2022-04-28 15:01:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003601473769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003601473769472[0;39m ==> Parameters: 
2022-04-28 15:01:50.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003601473769472[0;39m <==    Updates: 0
2022-04-28 15:01:50.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003601473769472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:01:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003622449483776[0;39m 生成今日电子书快照开始
2022-04-28 15:01:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003622449483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:01:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003622449483776[0;39m ==> Parameters: 
2022-04-28 15:01:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003622449483776[0;39m <==    Updates: 0
2022-04-28 15:01:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003622449483776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-28 15:02:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003643421003776[0;39m 生成今日电子书快照开始
2022-04-28 15:02:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003643421003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003643421003776[0;39m ==> Parameters: 
2022-04-28 15:02:00.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003643421003776[0;39m <==    Updates: 0
2022-04-28 15:02:00.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003643421003776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:02:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003664392523776[0;39m 生成今日电子书快照开始
2022-04-28 15:02:05.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003664392523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003664392523776[0;39m ==> Parameters: 
2022-04-28 15:02:05.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003664392523776[0;39m <==    Updates: 0
2022-04-28 15:02:05.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003664392523776[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-28 15:02:05.055 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175003664614821888[0;39m start updating Ebook doc
2022-04-28 15:02:05.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003664614821888[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:02:05.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003664614821888[0;39m ==> Parameters: 
2022-04-28 15:02:05.091 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003664614821888[0;39m <==    Updates: 1
2022-04-28 15:02:05.091 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175003664614821888[0;39m update ends, take 36 millisecs
2022-04-28 15:02:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003685364043776[0;39m 生成今日电子书快照开始
2022-04-28 15:02:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003685364043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003685364043776[0;39m ==> Parameters: 
2022-04-28 15:02:10.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003685364043776[0;39m <==    Updates: 0
2022-04-28 15:02:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003685364043776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:02:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003706348146688[0;39m 生成今日电子书快照开始
2022-04-28 15:02:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003706348146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003706348146688[0;39m ==> Parameters: 
2022-04-28 15:02:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003706348146688[0;39m <==    Updates: 0
2022-04-28 15:02:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003706348146688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:02:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003727302889472[0;39m 生成今日电子书快照开始
2022-04-28 15:02:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003727302889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003727302889472[0;39m ==> Parameters: 
2022-04-28 15:02:20.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003727302889472[0;39m <==    Updates: 0
2022-04-28 15:02:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003727302889472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:02:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003748278603776[0;39m 生成今日电子书快照开始
2022-04-28 15:02:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003748278603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003748278603776[0;39m ==> Parameters: 
2022-04-28 15:02:25.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003748278603776[0;39m <==    Updates: 0
2022-04-28 15:02:25.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003748278603776[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-28 15:02:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003769250123776[0;39m 生成今日电子书快照开始
2022-04-28 15:02:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003769250123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003769250123776[0;39m ==> Parameters: 
2022-04-28 15:02:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003769250123776[0;39m <==    Updates: 0
2022-04-28 15:02:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003769250123776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:02:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175003790217449472[0;39m start updating Ebook doc
2022-04-28 15:02:35.035 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003790217449472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:02:35.035 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003790217449472[0;39m ==> Parameters: 
2022-04-28 15:02:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003790217449472[0;39m <==    Updates: 1
2022-04-28 15:02:35.076 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175003790217449472[0;39m update ends, take 74 millisecs
2022-04-28 15:02:35.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003790536216576[0;39m 生成今日电子书快照开始
2022-04-28 15:02:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003790536216576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003790536216576[0;39m ==> Parameters: 
2022-04-28 15:02:35.113 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003790536216576[0;39m <==    Updates: 0
2022-04-28 15:02:35.114 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003790536216576[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-28 15:02:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003811188969472[0;39m 生成今日电子书快照开始
2022-04-28 15:02:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003811188969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003811188969472[0;39m ==> Parameters: 
2022-04-28 15:02:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003811188969472[0;39m <==    Updates: 0
2022-04-28 15:02:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003811188969472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:02:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003832164683776[0;39m 生成今日电子书快照开始
2022-04-28 15:02:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003832164683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003832164683776[0;39m ==> Parameters: 
2022-04-28 15:02:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003832164683776[0;39m <==    Updates: 0
2022-04-28 15:02:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003832164683776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:02:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003853136203776[0;39m 生成今日电子书快照开始
2022-04-28 15:02:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003853136203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003853136203776[0;39m ==> Parameters: 
2022-04-28 15:02:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003853136203776[0;39m <==    Updates: 0
2022-04-28 15:02:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003853136203776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:02:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003874099335168[0;39m 生成今日电子书快照开始
2022-04-28 15:02:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003874099335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:02:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003874099335168[0;39m ==> Parameters: 
2022-04-28 15:02:55.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003874099335168[0;39m <==    Updates: 0
2022-04-28 15:02:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003874099335168[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:03:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003895087632384[0;39m 生成今日电子书快照开始
2022-04-28 15:03:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003895087632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003895087632384[0;39m ==> Parameters: 
2022-04-28 15:03:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003895087632384[0;39m <==    Updates: 0
2022-04-28 15:03:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003895087632384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-28 15:03:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175003916046569472[0;39m start updating Ebook doc
2022-04-28 15:03:05.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003916046569472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:03:05.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003916046569472[0;39m ==> Parameters: 
2022-04-28 15:03:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175003916046569472[0;39m <==    Updates: 1
2022-04-28 15:03:05.068 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175003916046569472[0;39m update ends, take 67 millisecs
2022-04-28 15:03:05.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003916327587840[0;39m 生成今日电子书快照开始
2022-04-28 15:03:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003916327587840[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003916327587840[0;39m ==> Parameters: 
2022-04-28 15:03:05.107 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003916327587840[0;39m <==    Updates: 0
2022-04-28 15:03:05.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003916327587840[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-28 15:03:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003937030672384[0;39m 生成今日电子书快照开始
2022-04-28 15:03:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003937030672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003937030672384[0;39m ==> Parameters: 
2022-04-28 15:03:10.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003937030672384[0;39m <==    Updates: 0
2022-04-28 15:03:10.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003937030672384[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-28 15:03:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003958006386688[0;39m 生成今日电子书快照开始
2022-04-28 15:03:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003958006386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003958006386688[0;39m ==> Parameters: 
2022-04-28 15:03:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003958006386688[0;39m <==    Updates: 0
2022-04-28 15:03:15.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003958006386688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-28 15:03:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003978969518080[0;39m 生成今日电子书快照开始
2022-04-28 15:03:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003978969518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003978969518080[0;39m ==> Parameters: 
2022-04-28 15:03:20.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003978969518080[0;39m <==    Updates: 0
2022-04-28 15:03:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003978969518080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:03:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175003999932649472[0;39m 生成今日电子书快照开始
2022-04-28 15:03:25.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003999932649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003999932649472[0;39m ==> Parameters: 
2022-04-28 15:03:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175003999932649472[0;39m <==    Updates: 0
2022-04-28 15:03:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175003999932649472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:03:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004020912558080[0;39m 生成今日电子书快照开始
2022-04-28 15:03:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004020912558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004020912558080[0;39m ==> Parameters: 
2022-04-28 15:03:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004020912558080[0;39m <==    Updates: 0
2022-04-28 15:03:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004020912558080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:03:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004041875689472[0;39m start updating Ebook doc
2022-04-28 15:03:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004041875689472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:03:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004041875689472[0;39m ==> Parameters: 
2022-04-28 15:03:35.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004041875689472[0;39m <==    Updates: 1
2022-04-28 15:03:35.059 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004041875689472[0;39m update ends, take 58 millisecs
2022-04-28 15:03:35.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004042123153408[0;39m 生成今日电子书快照开始
2022-04-28 15:03:35.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004042123153408[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004042123153408[0;39m ==> Parameters: 
2022-04-28 15:03:35.097 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004042123153408[0;39m <==    Updates: 0
2022-04-28 15:03:35.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004042123153408[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-28 15:03:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004062851403776[0;39m 生成今日电子书快照开始
2022-04-28 15:03:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004062851403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004062851403776[0;39m ==> Parameters: 
2022-04-28 15:03:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004062851403776[0;39m <==    Updates: 0
2022-04-28 15:03:40.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004062851403776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:03:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004083831312384[0;39m 生成今日电子书快照开始
2022-04-28 15:03:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004083831312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004083831312384[0;39m ==> Parameters: 
2022-04-28 15:03:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004083831312384[0;39m <==    Updates: 0
2022-04-28 15:03:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004083831312384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-28 15:03:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004104794443776[0;39m 生成今日电子书快照开始
2022-04-28 15:03:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004104794443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004104794443776[0;39m ==> Parameters: 
2022-04-28 15:03:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004104794443776[0;39m <==    Updates: 0
2022-04-28 15:03:50.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004104794443776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:03:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004125774352384[0;39m 生成今日电子书快照开始
2022-04-28 15:03:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004125774352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:03:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004125774352384[0;39m ==> Parameters: 
2022-04-28 15:03:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004125774352384[0;39m <==    Updates: 0
2022-04-28 15:03:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004125774352384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:04:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004146745872384[0;39m 生成今日电子书快照开始
2022-04-28 15:04:00.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004146745872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004146745872384[0;39m ==> Parameters: 
2022-04-28 15:04:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004146745872384[0;39m <==    Updates: 0
2022-04-28 15:04:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004146745872384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-28 15:04:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004167717392384[0;39m start updating Ebook doc
2022-04-28 15:04:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004167717392384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:04:05.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004167717392384[0;39m ==> Parameters: 
2022-04-28 15:04:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004167717392384[0;39m <==    Updates: 1
2022-04-28 15:04:05.056 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004167717392384[0;39m update ends, take 51 millisecs
2022-04-28 15:04:05.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004167939690496[0;39m 生成今日电子书快照开始
2022-04-28 15:04:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004167939690496[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004167939690496[0;39m ==> Parameters: 
2022-04-28 15:04:05.098 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004167939690496[0;39m <==    Updates: 0
2022-04-28 15:04:05.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004167939690496[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-28 15:04:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004188676329472[0;39m 生成今日电子书快照开始
2022-04-28 15:04:10.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004188676329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:10.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004188676329472[0;39m ==> Parameters: 
2022-04-28 15:04:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004188676329472[0;39m <==    Updates: 0
2022-04-28 15:04:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004188676329472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:04:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004209652043776[0;39m 生成今日电子书快照开始
2022-04-28 15:04:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004209652043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004209652043776[0;39m ==> Parameters: 
2022-04-28 15:04:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004209652043776[0;39m <==    Updates: 0
2022-04-28 15:04:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004209652043776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:04:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004230623563776[0;39m 生成今日电子书快照开始
2022-04-28 15:04:20.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004230623563776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004230623563776[0;39m ==> Parameters: 
2022-04-28 15:04:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004230623563776[0;39m <==    Updates: 0
2022-04-28 15:04:20.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004230623563776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:04:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004251590889472[0;39m 生成今日电子书快照开始
2022-04-28 15:04:25.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004251590889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:25.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004251590889472[0;39m ==> Parameters: 
2022-04-28 15:04:25.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004251590889472[0;39m <==    Updates: 0
2022-04-28 15:04:25.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004251590889472[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-28 15:04:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004272574992384[0;39m 生成今日电子书快照开始
2022-04-28 15:04:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004272574992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004272574992384[0;39m ==> Parameters: 
2022-04-28 15:04:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004272574992384[0;39m <==    Updates: 0
2022-04-28 15:04:30.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004272574992384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-28 15:04:35.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004293529735168[0;39m start updating Ebook doc
2022-04-28 15:04:35.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004293529735168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:04:35.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004293529735168[0;39m ==> Parameters: 
2022-04-28 15:04:35.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004293529735168[0;39m <==    Updates: 1
2022-04-28 15:04:35.059 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004293529735168[0;39m update ends, take 58 millisecs
2022-04-28 15:04:35.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004293781393408[0;39m 生成今日电子书快照开始
2022-04-28 15:04:35.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004293781393408[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004293781393408[0;39m ==> Parameters: 
2022-04-28 15:04:35.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004293781393408[0;39m <==    Updates: 0
2022-04-28 15:04:35.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004293781393408[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-28 15:04:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004314513838080[0;39m 生成今日电子书快照开始
2022-04-28 15:04:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004314513838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004314513838080[0;39m ==> Parameters: 
2022-04-28 15:04:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004314513838080[0;39m <==    Updates: 0
2022-04-28 15:04:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004314513838080[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:04:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004335485358080[0;39m 生成今日电子书快照开始
2022-04-28 15:04:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004335485358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004335485358080[0;39m ==> Parameters: 
2022-04-28 15:04:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004335485358080[0;39m <==    Updates: 0
2022-04-28 15:04:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004335485358080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:04:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004356448489472[0;39m 生成今日电子书快照开始
2022-04-28 15:04:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004356448489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004356448489472[0;39m ==> Parameters: 
2022-04-28 15:04:50.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004356448489472[0;39m <==    Updates: 0
2022-04-28 15:04:50.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004356448489472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:04:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004377424203776[0;39m 生成今日电子书快照开始
2022-04-28 15:04:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004377424203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:04:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004377424203776[0;39m ==> Parameters: 
2022-04-28 15:04:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004377424203776[0;39m <==    Updates: 0
2022-04-28 15:04:55.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004377424203776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:05:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004398391529472[0;39m 生成今日电子书快照开始
2022-04-28 15:05:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004398391529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004398391529472[0;39m ==> Parameters: 
2022-04-28 15:05:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004398391529472[0;39m <==    Updates: 0
2022-04-28 15:05:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004398391529472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:05:05.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004419367243776[0;39m start updating Ebook doc
2022-04-28 15:05:05.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004419367243776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:05:05.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004419367243776[0;39m ==> Parameters: 
2022-04-28 15:05:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004419367243776[0;39m <==    Updates: 1
2022-04-28 15:05:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004419367243776[0;39m update ends, take 57 millisecs
2022-04-28 15:05:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004419606319104[0;39m 生成今日电子书快照开始
2022-04-28 15:05:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004419606319104[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004419606319104[0;39m ==> Parameters: 
2022-04-28 15:05:05.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004419606319104[0;39m <==    Updates: 0
2022-04-28 15:05:05.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004419606319104[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-28 15:05:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004440334569472[0;39m 生成今日电子书快照开始
2022-04-28 15:05:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004440334569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004440334569472[0;39m ==> Parameters: 
2022-04-28 15:05:10.095 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004440334569472[0;39m <==    Updates: 0
2022-04-28 15:05:10.095 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004440334569472[0;39m 生成今日电子书快照结束，耗时：94毫秒
2022-04-28 15:05:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004461306089472[0;39m 生成今日电子书快照开始
2022-04-28 15:05:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004461306089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004461306089472[0;39m ==> Parameters: 
2022-04-28 15:05:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004461306089472[0;39m <==    Updates: 0
2022-04-28 15:05:15.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004461306089472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:05:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004482277609472[0;39m 生成今日电子书快照开始
2022-04-28 15:05:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004482277609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004482277609472[0;39m ==> Parameters: 
2022-04-28 15:05:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004482277609472[0;39m <==    Updates: 0
2022-04-28 15:05:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004482277609472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:05:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004503249129472[0;39m 生成今日电子书快照开始
2022-04-28 15:05:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004503249129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004503249129472[0;39m ==> Parameters: 
2022-04-28 15:05:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004503249129472[0;39m <==    Updates: 0
2022-04-28 15:05:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004503249129472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:05:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004524220649472[0;39m 生成今日电子书快照开始
2022-04-28 15:05:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004524220649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004524220649472[0;39m ==> Parameters: 
2022-04-28 15:05:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004524220649472[0;39m <==    Updates: 0
2022-04-28 15:05:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004524220649472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-28 15:05:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004545204752384[0;39m 生成今日电子书快照开始
2022-04-28 15:05:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004545204752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:35.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004545204752384[0;39m ==> Parameters: 
2022-04-28 15:05:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004545204752384[0;39m <==    Updates: 0
2022-04-28 15:05:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004545204752384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:05:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004545464799232[0;39m start updating Ebook doc
2022-04-28 15:05:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004545464799232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:05:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004545464799232[0;39m ==> Parameters: 
2022-04-28 15:05:35.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004545464799232[0;39m <==    Updates: 1
2022-04-28 15:05:35.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004545464799232[0;39m update ends, take 36 millisecs
2022-04-28 15:05:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004566159495168[0;39m 生成今日电子书快照开始
2022-04-28 15:05:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004566159495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004566159495168[0;39m ==> Parameters: 
2022-04-28 15:05:40.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004566159495168[0;39m <==    Updates: 0
2022-04-28 15:05:40.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004566159495168[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-28 15:05:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004587135209472[0;39m 生成今日电子书快照开始
2022-04-28 15:05:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004587135209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004587135209472[0;39m ==> Parameters: 
2022-04-28 15:05:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004587135209472[0;39m <==    Updates: 0
2022-04-28 15:05:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004587135209472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:05:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004608115118080[0;39m 生成今日电子书快照开始
2022-04-28 15:05:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004608115118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004608115118080[0;39m ==> Parameters: 
2022-04-28 15:05:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004608115118080[0;39m <==    Updates: 0
2022-04-28 15:05:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004608115118080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:05:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004629086638080[0;39m 生成今日电子书快照开始
2022-04-28 15:05:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004629086638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:05:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004629086638080[0;39m ==> Parameters: 
2022-04-28 15:05:55.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004629086638080[0;39m <==    Updates: 0
2022-04-28 15:05:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004629086638080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:06:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004650049769472[0;39m 生成今日电子书快照开始
2022-04-28 15:06:00.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004650049769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:00.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004650049769472[0;39m ==> Parameters: 
2022-04-28 15:06:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004650049769472[0;39m <==    Updates: 0
2022-04-28 15:06:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004650049769472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-28 15:06:05.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004671029678080[0;39m start updating Ebook doc
2022-04-28 15:06:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004671029678080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:06:05.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004671029678080[0;39m ==> Parameters: 
2022-04-28 15:06:05.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004671029678080[0;39m <==    Updates: 1
2022-04-28 15:06:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004671029678080[0;39m update ends, take 55 millisecs
2022-04-28 15:06:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004671264559104[0;39m 生成今日电子书快照开始
2022-04-28 15:06:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004671264559104[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004671264559104[0;39m ==> Parameters: 
2022-04-28 15:06:05.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004671264559104[0;39m <==    Updates: 0
2022-04-28 15:06:05.096 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004671264559104[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-28 15:06:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004692005392384[0;39m 生成今日电子书快照开始
2022-04-28 15:06:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004692005392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004692005392384[0;39m ==> Parameters: 
2022-04-28 15:06:10.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004692005392384[0;39m <==    Updates: 0
2022-04-28 15:06:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004692005392384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-28 15:06:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004712964329472[0;39m 生成今日电子书快照开始
2022-04-28 15:06:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004712964329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004712964329472[0;39m ==> Parameters: 
2022-04-28 15:06:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004712964329472[0;39m <==    Updates: 0
2022-04-28 15:06:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004712964329472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-28 15:06:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004733931655168[0;39m 生成今日电子书快照开始
2022-04-28 15:06:20.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004733931655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:20.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004733931655168[0;39m ==> Parameters: 
2022-04-28 15:06:20.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004733931655168[0;39m <==    Updates: 0
2022-04-28 15:06:20.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004733931655168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:06:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004754903175168[0;39m 生成今日电子书快照开始
2022-04-28 15:06:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004754903175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004754903175168[0;39m ==> Parameters: 
2022-04-28 15:06:25.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004754903175168[0;39m <==    Updates: 0
2022-04-28 15:06:25.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004754903175168[0;39m 生成今日电子书快照结束，耗时：81毫秒
2022-04-28 15:06:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004775878889472[0;39m 生成今日电子书快照开始
2022-04-28 15:06:30.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004775878889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:30.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004775878889472[0;39m ==> Parameters: 
2022-04-28 15:06:30.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004775878889472[0;39m <==    Updates: 0
2022-04-28 15:06:30.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004775878889472[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-28 15:06:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004796854603776[0;39m start updating Ebook doc
2022-04-28 15:06:35.016 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004796854603776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:06:35.017 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004796854603776[0;39m ==> Parameters: 
2022-04-28 15:06:35.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004796854603776[0;39m <==    Updates: 1
2022-04-28 15:06:35.058 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004796854603776[0;39m update ends, take 56 millisecs
2022-04-28 15:06:35.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004797089484800[0;39m 生成今日电子书快照开始
2022-04-28 15:06:35.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004797089484800[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:35.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004797089484800[0;39m ==> Parameters: 
2022-04-28 15:06:35.113 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004797089484800[0;39m <==    Updates: 0
2022-04-28 15:06:35.113 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004797089484800[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:06:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004817830318080[0;39m 生成今日电子书快照开始
2022-04-28 15:06:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004817830318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004817830318080[0;39m ==> Parameters: 
2022-04-28 15:06:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004817830318080[0;39m <==    Updates: 0
2022-04-28 15:06:40.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004817830318080[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-28 15:06:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004838789255168[0;39m 生成今日电子书快照开始
2022-04-28 15:06:45.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004838789255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:45.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004838789255168[0;39m ==> Parameters: 
2022-04-28 15:06:45.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004838789255168[0;39m <==    Updates: 0
2022-04-28 15:06:45.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004838789255168[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-28 15:06:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004859781746688[0;39m 生成今日电子书快照开始
2022-04-28 15:06:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004859781746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004859781746688[0;39m ==> Parameters: 
2022-04-28 15:06:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004859781746688[0;39m <==    Updates: 0
2022-04-28 15:06:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004859781746688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:06:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004880732295168[0;39m 生成今日电子书快照开始
2022-04-28 15:06:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004880732295168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:06:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004880732295168[0;39m ==> Parameters: 
2022-04-28 15:06:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004880732295168[0;39m <==    Updates: 0
2022-04-28 15:06:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004880732295168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:07:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004901703815168[0;39m 生成今日电子书快照开始
2022-04-28 15:07:00.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004901703815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:00.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004901703815168[0;39m ==> Parameters: 
2022-04-28 15:07:00.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004901703815168[0;39m <==    Updates: 0
2022-04-28 15:07:00.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004901703815168[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:07:05.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175004922675335168[0;39m start updating Ebook doc
2022-04-28 15:07:05.016 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004922675335168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:07:05.016 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004922675335168[0;39m ==> Parameters: 
2022-04-28 15:07:05.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175004922675335168[0;39m <==    Updates: 1
2022-04-28 15:07:05.055 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175004922675335168[0;39m update ends, take 54 millisecs
2022-04-28 15:07:05.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004922906021888[0;39m 生成今日电子书快照开始
2022-04-28 15:07:05.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004922906021888[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:05.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004922906021888[0;39m ==> Parameters: 
2022-04-28 15:07:05.093 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004922906021888[0;39m <==    Updates: 0
2022-04-28 15:07:05.094 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004922906021888[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-28 15:07:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004943646855168[0;39m 生成今日电子书快照开始
2022-04-28 15:07:10.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004943646855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:10.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004943646855168[0;39m ==> Parameters: 
2022-04-28 15:07:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004943646855168[0;39m <==    Updates: 0
2022-04-28 15:07:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004943646855168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-28 15:07:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004964639346688[0;39m 生成今日电子书快照开始
2022-04-28 15:07:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004964639346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004964639346688[0;39m ==> Parameters: 
2022-04-28 15:07:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004964639346688[0;39m <==    Updates: 0
2022-04-28 15:07:15.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004964639346688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:07:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175004985602478080[0;39m 生成今日电子书快照开始
2022-04-28 15:07:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004985602478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004985602478080[0;39m ==> Parameters: 
2022-04-28 15:07:20.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175004985602478080[0;39m <==    Updates: 0
2022-04-28 15:07:20.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175004985602478080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-28 15:07:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005006565609472[0;39m 生成今日电子书快照开始
2022-04-28 15:07:25.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005006565609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:25.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005006565609472[0;39m ==> Parameters: 
2022-04-28 15:07:25.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005006565609472[0;39m <==    Updates: 0
2022-04-28 15:07:25.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005006565609472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:07:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005027566489600[0;39m 生成今日电子书快照开始
2022-04-28 15:07:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005027566489600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005027566489600[0;39m ==> Parameters: 
2022-04-28 15:07:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005027566489600[0;39m <==    Updates: 0
2022-04-28 15:07:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005027566489600[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:07:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005048508649472[0;39m 生成今日电子书快照开始
2022-04-28 15:07:35.014 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005048508649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:35.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005048508649472[0;39m ==> Parameters: 
2022-04-28 15:07:35.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005048508649472[0;39m <==    Updates: 0
2022-04-28 15:07:35.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005048508649472[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-28 15:07:35.054 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005048730947584[0;39m start updating Ebook doc
2022-04-28 15:07:35.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005048730947584[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:07:35.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005048730947584[0;39m ==> Parameters: 
2022-04-28 15:07:35.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005048730947584[0;39m <==    Updates: 1
2022-04-28 15:07:35.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005048730947584[0;39m update ends, take 38 millisecs
2022-04-28 15:07:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005069480169472[0;39m 生成今日电子书快照开始
2022-04-28 15:07:40.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005069480169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005069480169472[0;39m ==> Parameters: 
2022-04-28 15:07:40.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005069480169472[0;39m <==    Updates: 0
2022-04-28 15:07:40.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005069480169472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:07:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005090447495168[0;39m 生成今日电子书快照开始
2022-04-28 15:07:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005090447495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005090447495168[0;39m ==> Parameters: 
2022-04-28 15:07:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005090447495168[0;39m <==    Updates: 0
2022-04-28 15:07:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005090447495168[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-28 15:07:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005111423209472[0;39m 生成今日电子书快照开始
2022-04-28 15:07:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005111423209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005111423209472[0;39m ==> Parameters: 
2022-04-28 15:07:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005111423209472[0;39m <==    Updates: 0
2022-04-28 15:07:50.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005111423209472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:07:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005132390535168[0;39m 生成今日电子书快照开始
2022-04-28 15:07:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005132390535168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:07:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005132390535168[0;39m ==> Parameters: 
2022-04-28 15:07:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005132390535168[0;39m <==    Updates: 0
2022-04-28 15:07:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005132390535168[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-28 15:08:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005153366249472[0;39m 生成今日电子书快照开始
2022-04-28 15:08:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005153366249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005153366249472[0;39m ==> Parameters: 
2022-04-28 15:08:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005153366249472[0;39m <==    Updates: 0
2022-04-28 15:08:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005153366249472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:08:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005174337769472[0;39m 生成今日电子书快照开始
2022-04-28 15:08:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005174337769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:05.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005174337769472[0;39m ==> Parameters: 
2022-04-28 15:08:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005174337769472[0;39m <==    Updates: 0
2022-04-28 15:08:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005174337769472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:08:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005174614593536[0;39m start updating Ebook doc
2022-04-28 15:08:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005174614593536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:08:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005174614593536[0;39m ==> Parameters: 
2022-04-28 15:08:05.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005174614593536[0;39m <==    Updates: 1
2022-04-28 15:08:05.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005174614593536[0;39m update ends, take 37 millisecs
2022-04-28 15:08:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005195317678080[0;39m 生成今日电子书快照开始
2022-04-28 15:08:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005195317678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005195317678080[0;39m ==> Parameters: 
2022-04-28 15:08:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005195317678080[0;39m <==    Updates: 0
2022-04-28 15:08:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005195317678080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:08:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005216285003776[0;39m 生成今日电子书快照开始
2022-04-28 15:08:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005216285003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005216285003776[0;39m ==> Parameters: 
2022-04-28 15:08:15.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005216285003776[0;39m <==    Updates: 0
2022-04-28 15:08:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005216285003776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-28 15:08:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005237269106688[0;39m 生成今日电子书快照开始
2022-04-28 15:08:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005237269106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005237269106688[0;39m ==> Parameters: 
2022-04-28 15:08:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005237269106688[0;39m <==    Updates: 0
2022-04-28 15:08:20.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005237269106688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-28 15:08:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005258240626688[0;39m 生成今日电子书快照开始
2022-04-28 15:08:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005258240626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005258240626688[0;39m ==> Parameters: 
2022-04-28 15:08:25.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005258240626688[0;39m <==    Updates: 0
2022-04-28 15:08:25.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005258240626688[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-28 15:08:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005279195369472[0;39m 生成今日电子书快照开始
2022-04-28 15:08:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005279195369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005279195369472[0;39m ==> Parameters: 
2022-04-28 15:08:30.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005279195369472[0;39m <==    Updates: 0
2022-04-28 15:08:30.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005279195369472[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-28 15:08:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005300175278080[0;39m start updating Ebook doc
2022-04-28 15:08:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005300175278080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:08:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005300175278080[0;39m ==> Parameters: 
2022-04-28 15:08:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005300175278080[0;39m <==    Updates: 1
2022-04-28 15:08:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005300175278080[0;39m update ends, take 62 millisecs
2022-04-28 15:08:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005300435324928[0;39m 生成今日电子书快照开始
2022-04-28 15:08:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005300435324928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005300435324928[0;39m ==> Parameters: 
2022-04-28 15:08:35.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005300435324928[0;39m <==    Updates: 0
2022-04-28 15:08:35.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005300435324928[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-28 15:08:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005321150992384[0;39m 生成今日电子书快照开始
2022-04-28 15:08:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005321150992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005321150992384[0;39m ==> Parameters: 
2022-04-28 15:08:40.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005321150992384[0;39m <==    Updates: 0
2022-04-28 15:08:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005321150992384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-28 15:08:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005342122512384[0;39m 生成今日电子书快照开始
2022-04-28 15:08:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005342122512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:45.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005342122512384[0;39m ==> Parameters: 
2022-04-28 15:08:45.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005342122512384[0;39m <==    Updates: 0
2022-04-28 15:08:45.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005342122512384[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:08:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005363085643776[0;39m 生成今日电子书快照开始
2022-04-28 15:08:50.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005363085643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:50.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005363085643776[0;39m ==> Parameters: 
2022-04-28 15:08:50.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005363085643776[0;39m <==    Updates: 0
2022-04-28 15:08:50.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005363085643776[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-28 15:08:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005384048775168[0;39m 生成今日电子书快照开始
2022-04-28 15:08:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005384048775168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:08:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005384048775168[0;39m ==> Parameters: 
2022-04-28 15:08:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005384048775168[0;39m <==    Updates: 0
2022-04-28 15:08:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005384048775168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:09:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005405028683776[0;39m 生成今日电子书快照开始
2022-04-28 15:09:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005405028683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005405028683776[0;39m ==> Parameters: 
2022-04-28 15:09:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005405028683776[0;39m <==    Updates: 0
2022-04-28 15:09:00.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005405028683776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:09:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005426008592384[0;39m 生成今日电子书快照开始
2022-04-28 15:09:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005426008592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005426008592384[0;39m ==> Parameters: 
2022-04-28 15:09:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005426008592384[0;39m <==    Updates: 0
2022-04-28 15:09:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005426008592384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-28 15:09:05.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005426285416448[0;39m start updating Ebook doc
2022-04-28 15:09:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005426285416448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:09:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005426285416448[0;39m ==> Parameters: 
2022-04-28 15:09:05.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005426285416448[0;39m <==    Updates: 1
2022-04-28 15:09:05.109 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005426285416448[0;39m update ends, take 39 millisecs
2022-04-28 15:09:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005446971723776[0;39m 生成今日电子书快照开始
2022-04-28 15:09:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005446971723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005446971723776[0;39m ==> Parameters: 
2022-04-28 15:09:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005446971723776[0;39m <==    Updates: 0
2022-04-28 15:09:10.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005446971723776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-28 15:09:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005467955826688[0;39m 生成今日电子书快照开始
2022-04-28 15:09:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005467955826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005467955826688[0;39m ==> Parameters: 
2022-04-28 15:09:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005467955826688[0;39m <==    Updates: 0
2022-04-28 15:09:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005467955826688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:09:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005488918958080[0;39m 生成今日电子书快照开始
2022-04-28 15:09:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005488918958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005488918958080[0;39m ==> Parameters: 
2022-04-28 15:09:20.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005488918958080[0;39m <==    Updates: 0
2022-04-28 15:09:20.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005488918958080[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-28 15:09:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005509882089472[0;39m 生成今日电子书快照开始
2022-04-28 15:09:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005509882089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005509882089472[0;39m ==> Parameters: 
2022-04-28 15:09:25.094 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005509882089472[0;39m <==    Updates: 0
2022-04-28 15:09:25.095 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005509882089472[0;39m 生成今日电子书快照结束，耗时：94毫秒
2022-04-28 15:09:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005530866192384[0;39m 生成今日电子书快照开始
2022-04-28 15:09:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005530866192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005530866192384[0;39m ==> Parameters: 
2022-04-28 15:09:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005530866192384[0;39m <==    Updates: 0
2022-04-28 15:09:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005530866192384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:09:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005551841906688[0;39m 生成今日电子书快照开始
2022-04-28 15:09:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005551841906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005551841906688[0;39m ==> Parameters: 
2022-04-28 15:09:35.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005551841906688[0;39m <==    Updates: 0
2022-04-28 15:09:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005551841906688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:09:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005552114536448[0;39m start updating Ebook doc
2022-04-28 15:09:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005552114536448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:09:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005552114536448[0;39m ==> Parameters: 
2022-04-28 15:09:35.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005552114536448[0;39m <==    Updates: 1
2022-04-28 15:09:35.111 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005552114536448[0;39m update ends, take 41 millisecs
2022-04-28 15:09:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005572809232384[0;39m 生成今日电子书快照开始
2022-04-28 15:09:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005572809232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005572809232384[0;39m ==> Parameters: 
2022-04-28 15:09:40.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005572809232384[0;39m <==    Updates: 0
2022-04-28 15:09:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005572809232384[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-28 15:09:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005593768169472[0;39m 生成今日电子书快照开始
2022-04-28 15:09:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005593768169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005593768169472[0;39m ==> Parameters: 
2022-04-28 15:09:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005593768169472[0;39m <==    Updates: 0
2022-04-28 15:09:45.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005593768169472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:09:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005614752272384[0;39m 生成今日电子书快照开始
2022-04-28 15:09:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005614752272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005614752272384[0;39m ==> Parameters: 
2022-04-28 15:09:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005614752272384[0;39m <==    Updates: 0
2022-04-28 15:09:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005614752272384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:09:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005635711209472[0;39m 生成今日电子书快照开始
2022-04-28 15:09:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005635711209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:09:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005635711209472[0;39m ==> Parameters: 
2022-04-28 15:09:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005635711209472[0;39m <==    Updates: 0
2022-04-28 15:09:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005635711209472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:10:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005656691118080[0;39m 生成今日电子书快照开始
2022-04-28 15:10:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005656691118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005656691118080[0;39m ==> Parameters: 
2022-04-28 15:10:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005656691118080[0;39m <==    Updates: 0
2022-04-28 15:10:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005656691118080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:10:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005677654249472[0;39m start updating Ebook doc
2022-04-28 15:10:05.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005677654249472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:10:05.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005677654249472[0;39m ==> Parameters: 
2022-04-28 15:10:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005677654249472[0;39m <==    Updates: 1
2022-04-28 15:10:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005677654249472[0;39m update ends, take 65 millisecs
2022-04-28 15:10:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005677926879232[0;39m 生成今日电子书快照开始
2022-04-28 15:10:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005677926879232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005677926879232[0;39m ==> Parameters: 
2022-04-28 15:10:05.101 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005677926879232[0;39m <==    Updates: 0
2022-04-28 15:10:05.101 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005677926879232[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-28 15:10:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005698638352384[0;39m 生成今日电子书快照开始
2022-04-28 15:10:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005698638352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005698638352384[0;39m ==> Parameters: 
2022-04-28 15:10:10.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005698638352384[0;39m <==    Updates: 0
2022-04-28 15:10:10.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005698638352384[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-28 15:10:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005719605678080[0;39m 生成今日电子书快照开始
2022-04-28 15:10:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005719605678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005719605678080[0;39m ==> Parameters: 
2022-04-28 15:10:15.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005719605678080[0;39m <==    Updates: 0
2022-04-28 15:10:15.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005719605678080[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-28 15:10:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005740568809472[0;39m 生成今日电子书快照开始
2022-04-28 15:10:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005740568809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005740568809472[0;39m ==> Parameters: 
2022-04-28 15:10:20.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005740568809472[0;39m <==    Updates: 0
2022-04-28 15:10:20.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005740568809472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-28 15:10:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005761540329472[0;39m 生成今日电子书快照开始
2022-04-28 15:10:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005761540329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005761540329472[0;39m ==> Parameters: 
2022-04-28 15:10:25.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005761540329472[0;39m <==    Updates: 0
2022-04-28 15:10:25.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005761540329472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:10:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005782511849472[0;39m 生成今日电子书快照开始
2022-04-28 15:10:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005782511849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005782511849472[0;39m ==> Parameters: 
2022-04-28 15:10:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005782511849472[0;39m <==    Updates: 0
2022-04-28 15:10:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005782511849472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:10:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005803483369472[0;39m 生成今日电子书快照开始
2022-04-28 15:10:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005803483369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005803483369472[0;39m ==> Parameters: 
2022-04-28 15:10:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005803483369472[0;39m <==    Updates: 0
2022-04-28 15:10:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005803483369472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:10:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005803751804928[0;39m start updating Ebook doc
2022-04-28 15:10:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005803751804928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:10:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005803751804928[0;39m ==> Parameters: 
2022-04-28 15:10:35.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005803751804928[0;39m <==    Updates: 1
2022-04-28 15:10:35.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005803751804928[0;39m update ends, take 37 millisecs
2022-04-28 15:10:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005824454889472[0;39m 生成今日电子书快照开始
2022-04-28 15:10:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005824454889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005824454889472[0;39m ==> Parameters: 
2022-04-28 15:10:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005824454889472[0;39m <==    Updates: 0
2022-04-28 15:10:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005824454889472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-28 15:10:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005845422215168[0;39m 生成今日电子书快照开始
2022-04-28 15:10:45.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005845422215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:45.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005845422215168[0;39m ==> Parameters: 
2022-04-28 15:10:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005845422215168[0;39m <==    Updates: 0
2022-04-28 15:10:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005845422215168[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-28 15:10:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005866393735168[0;39m 生成今日电子书快照开始
2022-04-28 15:10:50.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005866393735168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:50.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005866393735168[0;39m ==> Parameters: 
2022-04-28 15:10:50.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005866393735168[0;39m <==    Updates: 0
2022-04-28 15:10:50.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005866393735168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:10:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005887365255168[0;39m 生成今日电子书快照开始
2022-04-28 15:10:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005887365255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:10:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005887365255168[0;39m ==> Parameters: 
2022-04-28 15:10:55.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005887365255168[0;39m <==    Updates: 0
2022-04-28 15:10:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005887365255168[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:11:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005908345163776[0;39m 生成今日电子书快照开始
2022-04-28 15:11:00.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005908345163776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:00.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005908345163776[0;39m ==> Parameters: 
2022-04-28 15:11:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005908345163776[0;39m <==    Updates: 0
2022-04-28 15:11:00.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005908345163776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:11:05.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005929308295168[0;39m 生成今日电子书快照开始
2022-04-28 15:11:05.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005929308295168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005929308295168[0;39m ==> Parameters: 
2022-04-28 15:11:05.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005929308295168[0;39m <==    Updates: 0
2022-04-28 15:11:05.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005929308295168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-28 15:11:05.056 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175005929538981888[0;39m start updating Ebook doc
2022-04-28 15:11:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005929538981888[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:11:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005929538981888[0;39m ==> Parameters: 
2022-04-28 15:11:05.091 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175005929538981888[0;39m <==    Updates: 1
2022-04-28 15:11:05.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175005929538981888[0;39m update ends, take 36 millisecs
2022-04-28 15:11:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005950292398080[0;39m 生成今日电子书快照开始
2022-04-28 15:11:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005950292398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005950292398080[0;39m ==> Parameters: 
2022-04-28 15:11:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005950292398080[0;39m <==    Updates: 0
2022-04-28 15:11:10.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005950292398080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:11:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005971255529472[0;39m 生成今日电子书快照开始
2022-04-28 15:11:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005971255529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005971255529472[0;39m ==> Parameters: 
2022-04-28 15:11:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005971255529472[0;39m <==    Updates: 0
2022-04-28 15:11:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005971255529472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:11:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175005992239632384[0;39m 生成今日电子书快照开始
2022-04-28 15:11:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005992239632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005992239632384[0;39m ==> Parameters: 
2022-04-28 15:11:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175005992239632384[0;39m <==    Updates: 0
2022-04-28 15:11:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175005992239632384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-28 15:11:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006013211152384[0;39m 生成今日电子书快照开始
2022-04-28 15:11:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006013211152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006013211152384[0;39m ==> Parameters: 
2022-04-28 15:11:25.093 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006013211152384[0;39m <==    Updates: 0
2022-04-28 15:11:25.094 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006013211152384[0;39m 生成今日电子书快照结束，耗时：89毫秒
2022-04-28 15:11:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006034174283776[0;39m 生成今日电子书快照开始
2022-04-28 15:11:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006034174283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006034174283776[0;39m ==> Parameters: 
2022-04-28 15:11:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006034174283776[0;39m <==    Updates: 0
2022-04-28 15:11:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006034174283776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-28 15:11:35.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006055137415168[0;39m start updating Ebook doc
2022-04-28 15:11:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006055137415168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:11:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006055137415168[0;39m ==> Parameters: 
2022-04-28 15:11:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006055137415168[0;39m <==    Updates: 1
2022-04-28 15:11:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006055137415168[0;39m update ends, take 63 millisecs
2022-04-28 15:11:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006055401656320[0;39m 生成今日电子书快照开始
2022-04-28 15:11:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006055401656320[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006055401656320[0;39m ==> Parameters: 
2022-04-28 15:11:35.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006055401656320[0;39m <==    Updates: 0
2022-04-28 15:11:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006055401656320[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-28 15:11:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006076113129472[0;39m 生成今日电子书快照开始
2022-04-28 15:11:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006076113129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006076113129472[0;39m ==> Parameters: 
2022-04-28 15:11:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006076113129472[0;39m <==    Updates: 0
2022-04-28 15:11:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006076113129472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:11:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006097088843776[0;39m 生成今日电子书快照开始
2022-04-28 15:11:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006097088843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006097088843776[0;39m ==> Parameters: 
2022-04-28 15:11:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006097088843776[0;39m <==    Updates: 0
2022-04-28 15:11:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006097088843776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:11:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006118056169472[0;39m 生成今日电子书快照开始
2022-04-28 15:11:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006118056169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006118056169472[0;39m ==> Parameters: 
2022-04-28 15:11:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006118056169472[0;39m <==    Updates: 0
2022-04-28 15:11:50.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006118056169472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-28 15:11:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006139031883776[0;39m 生成今日电子书快照开始
2022-04-28 15:11:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006139031883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:11:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006139031883776[0;39m ==> Parameters: 
2022-04-28 15:11:55.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006139031883776[0;39m <==    Updates: 0
2022-04-28 15:11:55.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006139031883776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:12:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006160003403776[0;39m 生成今日电子书快照开始
2022-04-28 15:12:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006160003403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006160003403776[0;39m ==> Parameters: 
2022-04-28 15:12:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006160003403776[0;39m <==    Updates: 0
2022-04-28 15:12:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006160003403776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:12:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006180970729472[0;39m start updating Ebook doc
2022-04-28 15:12:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006180970729472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:12:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006180970729472[0;39m ==> Parameters: 
2022-04-28 15:12:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006180970729472[0;39m <==    Updates: 1
2022-04-28 15:12:05.061 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006180970729472[0;39m update ends, take 60 millisecs
2022-04-28 15:12:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006181226582016[0;39m 生成今日电子书快照开始
2022-04-28 15:12:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006181226582016[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:05.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006181226582016[0;39m ==> Parameters: 
2022-04-28 15:12:05.098 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006181226582016[0;39m <==    Updates: 0
2022-04-28 15:12:05.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006181226582016[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-28 15:12:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006201942249472[0;39m 生成今日电子书快照开始
2022-04-28 15:12:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006201942249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006201942249472[0;39m ==> Parameters: 
2022-04-28 15:12:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006201942249472[0;39m <==    Updates: 0
2022-04-28 15:12:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006201942249472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:12:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006222930546688[0;39m 生成今日电子书快照开始
2022-04-28 15:12:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006222930546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006222930546688[0;39m ==> Parameters: 
2022-04-28 15:12:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006222930546688[0;39m <==    Updates: 0
2022-04-28 15:12:15.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006222930546688[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-28 15:12:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006243897872384[0;39m 生成今日电子书快照开始
2022-04-28 15:12:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006243897872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006243897872384[0;39m ==> Parameters: 
2022-04-28 15:12:20.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006243897872384[0;39m <==    Updates: 0
2022-04-28 15:12:20.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006243897872384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-28 15:12:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006264852615168[0;39m 生成今日电子书快照开始
2022-04-28 15:12:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006264852615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006264852615168[0;39m ==> Parameters: 
2022-04-28 15:12:25.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006264852615168[0;39m <==    Updates: 0
2022-04-28 15:12:25.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006264852615168[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-28 15:12:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006285828329472[0;39m 生成今日电子书快照开始
2022-04-28 15:12:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006285828329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006285828329472[0;39m ==> Parameters: 
2022-04-28 15:12:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006285828329472[0;39m <==    Updates: 0
2022-04-28 15:12:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006285828329472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:12:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006306816626688[0;39m start updating Ebook doc
2022-04-28 15:12:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006306816626688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:12:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006306816626688[0;39m ==> Parameters: 
2022-04-28 15:12:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006306816626688[0;39m <==    Updates: 1
2022-04-28 15:12:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006306816626688[0;39m update ends, take 63 millisecs
2022-04-28 15:12:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006307085062144[0;39m 生成今日电子书快照开始
2022-04-28 15:12:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006307085062144[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006307085062144[0;39m ==> Parameters: 
2022-04-28 15:12:35.109 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006307085062144[0;39m <==    Updates: 0
2022-04-28 15:12:35.110 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006307085062144[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-28 15:12:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006327771369472[0;39m 生成今日电子书快照开始
2022-04-28 15:12:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006327771369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006327771369472[0;39m ==> Parameters: 
2022-04-28 15:12:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006327771369472[0;39m <==    Updates: 0
2022-04-28 15:12:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006327771369472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:12:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006348742889472[0;39m 生成今日电子书快照开始
2022-04-28 15:12:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006348742889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006348742889472[0;39m ==> Parameters: 
2022-04-28 15:12:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006348742889472[0;39m <==    Updates: 0
2022-04-28 15:12:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006348742889472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:12:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006369722798080[0;39m 生成今日电子书快照开始
2022-04-28 15:12:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006369722798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006369722798080[0;39m ==> Parameters: 
2022-04-28 15:12:50.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006369722798080[0;39m <==    Updates: 0
2022-04-28 15:12:50.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006369722798080[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-28 15:12:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006390690123776[0;39m 生成今日电子书快照开始
2022-04-28 15:12:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006390690123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:12:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006390690123776[0;39m ==> Parameters: 
2022-04-28 15:12:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006390690123776[0;39m <==    Updates: 0
2022-04-28 15:12:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006390690123776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-28 15:13:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006411665838080[0;39m 生成今日电子书快照开始
2022-04-28 15:13:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006411665838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006411665838080[0;39m ==> Parameters: 
2022-04-28 15:13:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006411665838080[0;39m <==    Updates: 0
2022-04-28 15:13:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006411665838080[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:13:05.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006432624775168[0;39m start updating Ebook doc
2022-04-28 15:13:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006432624775168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:13:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006432624775168[0;39m ==> Parameters: 
2022-04-28 15:13:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006432624775168[0;39m <==    Updates: 1
2022-04-28 15:13:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006432624775168[0;39m update ends, take 58 millisecs
2022-04-28 15:13:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006432876433408[0;39m 生成今日电子书快照开始
2022-04-28 15:13:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006432876433408[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006432876433408[0;39m ==> Parameters: 
2022-04-28 15:13:05.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006432876433408[0;39m <==    Updates: 0
2022-04-28 15:13:05.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006432876433408[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-28 15:13:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006453596295168[0;39m 生成今日电子书快照开始
2022-04-28 15:13:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006453596295168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006453596295168[0;39m ==> Parameters: 
2022-04-28 15:13:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006453596295168[0;39m <==    Updates: 0
2022-04-28 15:13:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006453596295168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:13:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006474588786688[0;39m 生成今日电子书快照开始
2022-04-28 15:13:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006474588786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006474588786688[0;39m ==> Parameters: 
2022-04-28 15:13:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006474588786688[0;39m <==    Updates: 0
2022-04-28 15:13:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006474588786688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-28 15:13:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006495539335168[0;39m 生成今日电子书快照开始
2022-04-28 15:13:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006495539335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006495539335168[0;39m ==> Parameters: 
2022-04-28 15:13:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006495539335168[0;39m <==    Updates: 0
2022-04-28 15:13:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006495539335168[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:13:25.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006516510855168[0;39m 生成今日电子书快照开始
2022-04-28 15:13:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006516510855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006516510855168[0;39m ==> Parameters: 
2022-04-28 15:13:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006516510855168[0;39m <==    Updates: 0
2022-04-28 15:13:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006516510855168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:13:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006537499152384[0;39m 生成今日电子书快照开始
2022-04-28 15:13:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006537499152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006537499152384[0;39m ==> Parameters: 
2022-04-28 15:13:30.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006537499152384[0;39m <==    Updates: 0
2022-04-28 15:13:30.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006537499152384[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-28 15:13:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006558474866688[0;39m start updating Ebook doc
2022-04-28 15:13:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006558474866688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:13:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006558474866688[0;39m ==> Parameters: 
2022-04-28 15:13:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006558474866688[0;39m <==    Updates: 1
2022-04-28 15:13:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006558474866688[0;39m update ends, take 63 millisecs
2022-04-28 15:13:35.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006558743302144[0;39m 生成今日电子书快照开始
2022-04-28 15:13:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006558743302144[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006558743302144[0;39m ==> Parameters: 
2022-04-28 15:13:35.108 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006558743302144[0;39m <==    Updates: 0
2022-04-28 15:13:35.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006558743302144[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-28 15:13:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006579437998080[0;39m 生成今日电子书快照开始
2022-04-28 15:13:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006579437998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006579437998080[0;39m ==> Parameters: 
2022-04-28 15:13:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006579437998080[0;39m <==    Updates: 0
2022-04-28 15:13:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006579437998080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:13:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006600401129472[0;39m 生成今日电子书快照开始
2022-04-28 15:13:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006600401129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006600401129472[0;39m ==> Parameters: 
2022-04-28 15:13:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006600401129472[0;39m <==    Updates: 0
2022-04-28 15:13:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006600401129472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:13:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006621381038080[0;39m 生成今日电子书快照开始
2022-04-28 15:13:50.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006621381038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:50.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006621381038080[0;39m ==> Parameters: 
2022-04-28 15:13:50.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006621381038080[0;39m <==    Updates: 0
2022-04-28 15:13:50.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006621381038080[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-28 15:13:50.696 ERROR com.ameliawiki.wiki.websocket.WebSocketServer     :57   [32m                  [0;39m 发生错误
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1231)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1141)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:72)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:171)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:151)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:148)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:54)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
2022-04-28 15:13:50.703 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：wDodd4egQB，session id：0！当前连接数：0
2022-04-28 15:13:51.540 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006627827683328[0;39m ------------- 开始 -------------
2022-04-28 15:13:51.540 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006627827683328[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:13:51.541 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006627827683328[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:13:51.541 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006627827683328[0;39m 远程地址: 127.0.0.1
2022-04-28 15:13:51.541 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006627827683328[0;39m 请求参数: []
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006627836071937[0;39m ------------- 开始 -------------
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006627836071936[0;39m ------------- 开始 -------------
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006627836071937[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006627836071936[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006627836071937[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006627836071936[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006627836071937[0;39m 远程地址: 127.0.0.1
2022-04-28 15:13:51.542 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006627836071936[0;39m 远程地址: 127.0.0.1
2022-04-28 15:13:51.543 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006627836071937[0;39m 请求参数: []
2022-04-28 15:13:51.543 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006627836071936[0;39m 请求参数: []
2022-04-28 15:13:51.561 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006627827683328[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:13:51.561 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006627827683328[0;39m ==> Parameters: 
2022-04-28 15:13:51.570 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006627836071936[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:13:51.570 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006627836071937[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:13:51.570 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006627836071936[0;39m ==> Parameters: 
2022-04-28 15:13:51.570 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006627836071937[0;39m ==> Parameters: 
2022-04-28 15:13:51.582 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006627827683328[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:13:51.583 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006627827683328[0;39m <==        Row: 2022-04-28, 1726, 59, 1726, 59
2022-04-28 15:13:51.583 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006627827683328[0;39m <==      Total: 1
2022-04-28 15:13:51.584 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006627827683328[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1726,"viewIncrease":1726,"voteCount":59,"voteIncrease":59}],"success":true}
2022-04-28 15:13:51.584 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006627827683328[0;39m ------------- 结束 耗时：44 ms -------------
2022-04-28 15:13:51.589 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:13:51.589 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:13:51.590 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:13:51.590 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:13:51.590 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:13:51.591 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:13:51.591 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:13:51.592 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:13:51.592 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:13:51.592 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:13:51.592 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:13:51.592 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:13:51.593 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:13:51.593 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:13:51.593 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:13:51.593 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:13:51.593 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:13:51.593 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:13:51.593 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:13:51.594 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:13:51.594 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:13:51.594 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:13:51.594 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:13:51.594 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:13:51.594 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:13:51.595 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:13:51.595 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006627836071936[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:13:51.595 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:13:51.595 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006627836071936[0;39m <==      Total: 12
2022-04-28 15:13:51.595 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006627836071937[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:13:51.595 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006627836071937[0;39m <==      Total: 15
2022-04-28 15:13:51.595 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006627836071936[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:13:51.595 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006627836071936[0;39m ------------- 结束 耗时：53 ms -------------
2022-04-28 15:13:51.598 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006627836071937[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:13:51.598 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006627836071937[0;39m ------------- 结束 耗时：56 ms -------------
2022-04-28 15:13:51.640 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m175003475019698178[0;39m 有新连接：token：7dEemTM3KJ，session id：1，当前连接数：1
2022-04-28 15:13:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006642352558080[0;39m 生成今日电子书快照开始
2022-04-28 15:13:55.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006642352558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:13:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006642352558080[0;39m ==> Parameters: 
2022-04-28 15:13:55.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006642352558080[0;39m <==    Updates: 0
2022-04-28 15:13:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006642352558080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:13:55.420 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006644101582848[0;39m ------------- 开始 -------------
2022-04-28 15:13:55.420 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006644101582848[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:13:55.420 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006644101582848[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:13:55.420 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006644101582848[0;39m 远程地址: 127.0.0.1
2022-04-28 15:13:55.422 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006644101582848[0;39m 请求参数: [{"categoryId2":101,"page":1,"size":1000}]
2022-04-28 15:13:55.481 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006644101582848[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:13:55.482 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006644101582848[0;39m ==> Parameters: 101(Long)
2022-04-28 15:13:55.500 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006644101582848[0;39m <==    Columns: count(0)
2022-04-28 15:13:55.500 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006644101582848[0;39m <==        Row: 0
2022-04-28 15:13:55.501 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006644101582848[0;39m <==      Total: 1
2022-04-28 15:13:55.503 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006644101582848[0;39m total rows：0
2022-04-28 15:13:55.503 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006644101582848[0;39m total pages：0
2022-04-28 15:13:55.506 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006644101582848[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:13:55.506 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006644101582848[0;39m ------------- 结束 耗时：87 ms -------------
2022-04-28 15:13:56.364 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006648061005824[0;39m ------------- 开始 -------------
2022-04-28 15:13:56.364 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006648061005824[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:13:56.364 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006648061005824[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:13:56.365 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006648061005824[0;39m 远程地址: 127.0.0.1
2022-04-28 15:13:56.365 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006648061005824[0;39m 请求参数: [{"categoryId2":102,"page":1,"size":1000}]
2022-04-28 15:13:56.390 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006648061005824[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:13:56.391 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006648061005824[0;39m ==> Parameters: 102(Long)
2022-04-28 15:13:56.411 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006648061005824[0;39m <==    Columns: count(0)
2022-04-28 15:13:56.412 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006648061005824[0;39m <==        Row: 0
2022-04-28 15:13:56.412 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006648061005824[0;39m <==      Total: 1
2022-04-28 15:13:56.413 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006648061005824[0;39m total rows：0
2022-04-28 15:13:56.413 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006648061005824[0;39m total pages：0
2022-04-28 15:13:56.413 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006648061005824[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:13:56.414 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006648061005824[0;39m ------------- 结束 耗时：50 ms -------------
2022-04-28 15:13:57.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006654100803584[0;39m ------------- 开始 -------------
2022-04-28 15:13:57.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006654100803584[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:13:57.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006654100803584[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:13:57.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006654100803584[0;39m 远程地址: 127.0.0.1
2022-04-28 15:13:57.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006654100803584[0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2022-04-28 15:13:57.828 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006654100803584[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:13:57.829 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006654100803584[0;39m ==> Parameters: 201(Long)
2022-04-28 15:13:57.848 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006654100803584[0;39m <==    Columns: count(0)
2022-04-28 15:13:57.848 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006654100803584[0;39m <==        Row: 1
2022-04-28 15:13:57.849 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006654100803584[0;39m <==      Total: 1
2022-04-28 15:13:57.851 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006654100803584[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:13:57.851 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006654100803584[0;39m ==> Parameters: 201(Long), 1000(Integer)
2022-04-28 15:13:57.869 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006654100803584[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:13:57.869 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006654100803584[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:13:57.870 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006654100803584[0;39m <==      Total: 1
2022-04-28 15:13:57.871 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006654100803584[0;39m total rows：1
2022-04-28 15:13:57.871 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006654100803584[0;39m total pages：1
2022-04-28 15:13:57.879 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006654100803584[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20}],"total":1},"success":true}
2022-04-28 15:13:57.879 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006654100803584[0;39m ------------- 结束 耗时：75 ms -------------
2022-04-28 15:13:59.379 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006660706832384[0;39m ------------- 开始 -------------
2022-04-28 15:13:59.379 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006660706832384[0;39m 请求地址: http://127.0.0.1:8080/doc/all/2 GET
2022-04-28 15:13:59.379 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006660706832384[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.all
2022-04-28 15:13:59.380 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006660706832384[0;39m 远程地址: 127.0.0.1
2022-04-28 15:13:59.380 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006660706832384[0;39m 请求参数: [2]
2022-04-28 15:13:59.408 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006660706832384[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-04-28 15:13:59.408 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006660706832384[0;39m ==> Parameters: 2(Long)
2022-04-28 15:13:59.426 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006660706832384[0;39m <==      Total: 0
2022-04-28 15:13:59.427 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006660706832384[0;39m 返回结果: {"content":[],"success":true}
2022-04-28 15:13:59.427 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006660706832384[0;39m ------------- 结束 耗时：48 ms -------------
2022-04-28 15:14:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006663324078080[0;39m 生成今日电子书快照开始
2022-04-28 15:14:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006663324078080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006663324078080[0;39m ==> Parameters: 
2022-04-28 15:14:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006663324078080[0;39m <==    Updates: 0
2022-04-28 15:14:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006663324078080[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:14:01.694 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m                  [0;39m 系统异常：
org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:133)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:121)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:170)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:137)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:626)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.NumberFormatException: For input string: "undefined"
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
	at java.lang.Long.parseLong(Long.java:589)
	at java.lang.Long.valueOf(Long.java:803)
	at org.springframework.util.NumberUtils.parseNumber(NumberUtils.java:214)
	at org.springframework.beans.propertyeditors.CustomNumberEditor.setAsText(CustomNumberEditor.java:115)
	at org.springframework.beans.TypeConverterDelegate.doConvertTextValue(TypeConverterDelegate.java:429)
	at org.springframework.beans.TypeConverterDelegate.doConvertValue(TypeConverterDelegate.java:402)
	at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:155)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:73)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:53)
	at org.springframework.validation.DataBinder.convertIfNecessary(DataBinder.java:696)
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:125)
	... 47 common frames omitted
2022-04-28 15:14:01.698 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m                  [0;39m Resolved [org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"]
2022-04-28 15:14:05.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006684291403776[0;39m start updating Ebook doc
2022-04-28 15:14:05.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006684291403776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:14:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006684291403776[0;39m ==> Parameters: 
2022-04-28 15:14:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006684291403776[0;39m <==    Updates: 1
2022-04-28 15:14:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006684291403776[0;39m update ends, take 64 millisecs
2022-04-28 15:14:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006684559839232[0;39m 生成今日电子书快照开始
2022-04-28 15:14:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006684559839232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006684559839232[0;39m ==> Parameters: 
2022-04-28 15:14:05.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006684559839232[0;39m <==    Updates: 0
2022-04-28 15:14:05.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006684559839232[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-28 15:14:05.278 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006685449031680[0;39m ------------- 开始 -------------
2022-04-28 15:14:05.278 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006685449031680[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-28 15:14:05.278 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006685449031680[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-28 15:14:05.278 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006685449031680[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:05.279 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006685449031680[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-28 15:14:05.285 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006685449031680[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-28 15:14:05.286 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006685449031680[0;39m ==> Parameters: test1(String)
2022-04-28 15:14:05.300 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175006685449031680[0;39m <==    Columns: id, login_name, name, password
2022-04-28 15:14:05.301 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175006685449031680[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-28 15:14:05.301 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006685449031680[0;39m <==      Total: 1
2022-04-28 15:14:05.306 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175006685449031680[0;39m generate single sign-on token：175006685566472192，and put it into redis
2022-04-28 15:14:06.601 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006685449031680[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175006685566472192"},"success":true}
2022-04-28 15:14:06.601 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006685449031680[0;39m ------------- 结束 耗时：1323 ms -------------
2022-04-28 15:14:08.460 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175006627836071937[0;39m 系统异常：
org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:133)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:121)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:170)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:137)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:626)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.NumberFormatException: For input string: "undefined"
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
	at java.lang.Long.parseLong(Long.java:589)
	at java.lang.Long.valueOf(Long.java:803)
	at org.springframework.util.NumberUtils.parseNumber(NumberUtils.java:214)
	at org.springframework.beans.propertyeditors.CustomNumberEditor.setAsText(CustomNumberEditor.java:115)
	at org.springframework.beans.TypeConverterDelegate.doConvertTextValue(TypeConverterDelegate.java:429)
	at org.springframework.beans.TypeConverterDelegate.doConvertValue(TypeConverterDelegate.java:402)
	at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:155)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:73)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:53)
	at org.springframework.validation.DataBinder.convertIfNecessary(DataBinder.java:696)
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:125)
	... 47 common frames omitted
2022-04-28 15:14:08.461 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175006627836071937[0;39m Resolved [org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"]
2022-04-28 15:14:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006705258729472[0;39m 生成今日电子书快照开始
2022-04-28 15:14:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006705258729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006705258729472[0;39m ==> Parameters: 
2022-04-28 15:14:10.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006705258729472[0;39m <==    Updates: 0
2022-04-28 15:14:10.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006705258729472[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006706466689024[0;39m ------------- 开始 -------------
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006706466689025[0;39m ------------- 开始 -------------
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006706466689026[0;39m ------------- 开始 -------------
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006706466689024[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006706466689025[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006706466689026[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006706466689025[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006706466689024[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006706466689026[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006706466689025[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006706466689024[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006706466689026[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006706466689025[0;39m 请求参数: []
2022-04-28 15:14:10.289 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006706466689024[0;39m 请求参数: []
2022-04-28 15:14:10.290 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006706466689026[0;39m 请求参数: []
2022-04-28 15:14:10.290 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006706466689024[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:14:10.290 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006706466689024[0;39m ==> Parameters: 
2022-04-28 15:14:10.308 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006706466689025[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:14:10.308 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006706466689025[0;39m ==> Parameters: 
2022-04-28 15:14:10.310 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006706466689024[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:14:10.311 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006706466689024[0;39m <==        Row: 2022-04-28, 1726, 59, 1726, 59
2022-04-28 15:14:10.311 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006706466689024[0;39m <==      Total: 1
2022-04-28 15:14:10.311 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006706466689024[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1726,"viewIncrease":1726,"voteCount":59,"voteIncrease":59}],"success":true}
2022-04-28 15:14:10.312 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006706466689024[0;39m ------------- 结束 耗时：23 ms -------------
2022-04-28 15:14:10.316 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006706466689026[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:14:10.316 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006706466689026[0;39m ==> Parameters: 
2022-04-28 15:14:10.338 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:14:10.338 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:14:10.338 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:14:10.338 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:14:10.339 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:14:10.339 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:14:10.339 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:14:10.339 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:14:10.339 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:14:10.339 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:14:10.339 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:14:10.340 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:14:10.340 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:14:10.340 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:14:10.340 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:14:10.340 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:14:10.340 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:14:10.341 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:14:10.341 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:14:10.341 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:14:10.341 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:14:10.341 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:14:10.341 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:14:10.341 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:14:10.342 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:14:10.342 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:14:10.342 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:14:10.342 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006706466689025[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:14:10.342 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006706466689025[0;39m <==      Total: 15
2022-04-28 15:14:10.342 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006706466689026[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:14:10.342 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006706466689026[0;39m <==      Total: 12
2022-04-28 15:14:10.343 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006706466689026[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:14:10.343 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006706466689025[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:14:10.343 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006706466689026[0;39m ------------- 结束 耗时：54 ms -------------
2022-04-28 15:14:10.343 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006706466689025[0;39m ------------- 结束 耗时：54 ms -------------
2022-04-28 15:14:12.990 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006717795504128[0;39m ------------- 开始 -------------
2022-04-28 15:14:12.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006717795504128[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:14:12.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006717795504128[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:14:12.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006717795504128[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:12.991 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006717795504128[0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2022-04-28 15:14:13.014 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006717795504128[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:14:13.015 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006717795504128[0;39m ==> Parameters: 201(Long)
2022-04-28 15:14:13.039 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006717795504128[0;39m <==    Columns: count(0)
2022-04-28 15:14:13.039 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006717795504128[0;39m <==        Row: 1
2022-04-28 15:14:13.040 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006717795504128[0;39m <==      Total: 1
2022-04-28 15:14:13.041 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006717795504128[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:14:13.041 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006717795504128[0;39m ==> Parameters: 201(Long), 1000(Integer)
2022-04-28 15:14:13.059 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006717795504128[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:14:13.060 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006717795504128[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:14:13.060 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006717795504128[0;39m <==      Total: 1
2022-04-28 15:14:13.061 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006717795504128[0;39m total rows：1
2022-04-28 15:14:13.061 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006717795504128[0;39m total pages：1
2022-04-28 15:14:13.062 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006717795504128[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20}],"total":1},"success":true}
2022-04-28 15:14:13.062 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006717795504128[0;39m ------------- 结束 耗时：72 ms -------------
2022-04-28 15:14:13.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006721696206848[0;39m ------------- 开始 -------------
2022-04-28 15:14:13.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006721696206848[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:14:13.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006721696206848[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:14:13.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006721696206848[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:13.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006721696206848[0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2022-04-28 15:14:13.945 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006721696206848[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:14:13.946 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006721696206848[0;39m ==> Parameters: 202(Long)
2022-04-28 15:14:13.966 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006721696206848[0;39m <==    Columns: count(0)
2022-04-28 15:14:13.966 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006721696206848[0;39m <==        Row: 1
2022-04-28 15:14:13.967 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006721696206848[0;39m <==      Total: 1
2022-04-28 15:14:13.967 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006721696206848[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:14:13.968 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006721696206848[0;39m ==> Parameters: 202(Long), 1000(Integer)
2022-04-28 15:14:13.984 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006721696206848[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:14:13.984 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006721696206848[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 71, 6
2022-04-28 15:14:13.985 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006721696206848[0;39m <==      Total: 1
2022-04-28 15:14:13.985 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006721696206848[0;39m total rows：1
2022-04-28 15:14:13.985 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006721696206848[0;39m total pages：1
2022-04-28 15:14:13.986 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006721696206848[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":71,"voteCount":6}],"total":1},"success":true}
2022-04-28 15:14:13.986 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006721696206848[0;39m ------------- 结束 耗时：66 ms -------------
2022-04-28 15:14:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006726230249472[0;39m 生成今日电子书快照开始
2022-04-28 15:14:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006726230249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006726230249472[0;39m ==> Parameters: 
2022-04-28 15:14:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006726230249472[0;39m <==    Updates: 0
2022-04-28 15:14:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006726230249472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:14:15.374 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006727794724864[0;39m ------------- 开始 -------------
2022-04-28 15:14:15.374 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006727794724864[0;39m 请求地址: http://127.0.0.1:8080/doc/all/1 GET
2022-04-28 15:14:15.375 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006727794724864[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.all
2022-04-28 15:14:15.375 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006727794724864[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:15.375 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006727794724864[0;39m 请求参数: [1]
2022-04-28 15:14:15.399 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006727794724864[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-04-28 15:14:15.400 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006727794724864[0;39m ==> Parameters: 1(Long)
2022-04-28 15:14:15.419 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006727794724864[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-04-28 15:14:15.420 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006727794724864[0;39m <==        Row: 1, 1, 0, Spring Boot, 1, 21, 2
2022-04-28 15:14:15.420 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006727794724864[0;39m <==        Row: 2, 1, 1, Introduction, 1, 18, 1
2022-04-28 15:14:15.421 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006727794724864[0;39m <==        Row: 4, 1, 3, Spring Cloud, 1, 14, 1
2022-04-28 15:14:15.421 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006727794724864[0;39m <==        Row: 6, 1, 5, video, 1, 11, 1
2022-04-28 15:14:15.422 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006727794724864[0;39m <==        Row: 3, 1, 0, Learn, 2, 3, 0
2022-04-28 15:14:15.422 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006727794724864[0;39m <==        Row: 5, 1, 3, Video, 2, 4, 1
2022-04-28 15:14:15.423 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006727794724864[0;39m <==      Total: 6
2022-04-28 15:14:15.429 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006727794724864[0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Spring Boot","parent":0,"sort":1,"viewCount":21,"voteCount":2},{"ebookId":1,"id":2,"name":"Introduction","parent":1,"sort":1,"viewCount":18,"voteCount":1},{"ebookId":1,"id":4,"name":"Spring Cloud","parent":3,"sort":1,"viewCount":14,"voteCount":1},{"ebookId":1,"id":6,"name":"video","parent":5,"sort":1,"viewCount":11,"voteCount":1},{"ebookId":1,"id":3,"name":"Learn","parent":0,"sort":2,"viewCount":3,"voteCount":0},{"ebookId":1,"id":5,"name":"Video","parent":3,"sort":2,"viewCount":4,"voteCount":1}],"success":true}
2022-04-28 15:14:15.429 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006727794724864[0;39m ------------- 结束 耗时：55 ms -------------
2022-04-28 15:14:15.462 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006728163823616[0;39m ------------- 开始 -------------
2022-04-28 15:14:15.462 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006728163823616[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/1 GET
2022-04-28 15:14:15.463 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006728163823616[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:14:15.463 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006728163823616[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:15.463 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006728163823616[0;39m 请求参数: [1]
2022-04-28 15:14:15.463 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006728163823616[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:14:15.464 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006728163823616[0;39m ==> Parameters: 1(Long)
2022-04-28 15:14:15.483 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006728163823616[0;39m <==    Columns: id, content
2022-04-28 15:14:15.484 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006728163823616[0;39m <==        Row: 1, <<BLOB>>
2022-04-28 15:14:15.484 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006728163823616[0;39m <==      Total: 1
2022-04-28 15:14:15.486 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006728163823616[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:14:15.486 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006728163823616[0;39m ==> Parameters: 1(Long)
2022-04-28 15:14:15.519 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006728163823616[0;39m <==    Updates: 1
2022-04-28 15:14:15.520 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006728163823616[0;39m 返回结果: {"content":"","success":true}
2022-04-28 15:14:15.520 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006728163823616[0;39m ------------- 结束 耗时：58 ms -------------
2022-04-28 15:14:16.746 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006733549309952[0;39m ------------- 开始 -------------
2022-04-28 15:14:16.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006733549309952[0;39m 请求地址: http://127.0.0.1:8080/doc/vote/1 GET
2022-04-28 15:14:16.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006733549309952[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.vote
2022-04-28 15:14:16.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006733549309952[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:16.747 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006733549309952[0;39m 请求参数: [1]
2022-04-28 15:14:16.931 INFO  com.ameliawiki.wiki.util.RedisUtil                :30   [32m175006733549309952[0;39m key not exist，put：DOC_VOTE1_127.0.0.1，outdated 86400 secs
2022-04-28 15:14:17.127 DEBUG c.a.wiki.mapper.DocMapperCust.increaseVoteCount   :137  [32m175006733549309952[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2022-04-28 15:14:17.127 DEBUG c.a.wiki.mapper.DocMapperCust.increaseVoteCount   :137  [32m175006733549309952[0;39m ==> Parameters: 1(Long)
2022-04-28 15:14:17.165 DEBUG c.a.wiki.mapper.DocMapperCust.increaseVoteCount   :137  [32m175006733549309952[0;39m <==    Updates: 1
2022-04-28 15:14:17.165 DEBUG c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :137  [32m175006733549309952[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2022-04-28 15:14:17.166 DEBUG c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :137  [32m175006733549309952[0;39m ==> Parameters: 1(Long)
2022-04-28 15:14:17.180 TRACE c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :143  [32m175006733549309952[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-04-28 15:14:17.181 TRACE c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :143  [32m175006733549309952[0;39m <==        Row: 1, 1, 0, Spring Boot, 1, 22, 3
2022-04-28 15:14:17.181 DEBUG c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :137  [32m175006733549309952[0;39m <==      Total: 1
2022-04-28 15:14:17.183 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006733549309952[0;39m 返回结果: {"success":true}
2022-04-28 15:14:17.183 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006733549309952[0;39m ------------- 结束 耗时：437 ms -------------
2022-04-28 15:14:17.185 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :71   [32m175006733549309952[0;39m 推送消息：7dEemTM3KJ，内容：Spring Boot is liked!
2022-04-28 15:14:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006747201769472[0;39m 生成今日电子书快照开始
2022-04-28 15:14:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006747201769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006747201769472[0;39m ==> Parameters: 
2022-04-28 15:14:20.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006747201769472[0;39m <==    Updates: 0
2022-04-28 15:14:20.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006747201769472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-28 15:14:20.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006750490103808[0;39m ------------- 开始 -------------
2022-04-28 15:14:20.785 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006750490103808[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/4 GET
2022-04-28 15:14:20.786 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006750490103808[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:14:20.786 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006750490103808[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:20.786 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006750490103808[0;39m 请求参数: [4]
2022-04-28 15:14:20.801 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006750490103808[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:14:20.801 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006750490103808[0;39m ==> Parameters: 4(Long)
2022-04-28 15:14:20.821 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006750490103808[0;39m <==    Columns: id, content
2022-04-28 15:14:20.822 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006750490103808[0;39m <==        Row: 4, <<BLOB>>
2022-04-28 15:14:20.822 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006750490103808[0;39m <==      Total: 1
2022-04-28 15:14:20.823 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006750490103808[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:14:20.823 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006750490103808[0;39m ==> Parameters: 4(Long)
2022-04-28 15:14:20.859 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006750490103808[0;39m <==    Updates: 1
2022-04-28 15:14:20.860 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006750490103808[0;39m 返回结果: {"content":"<p>Spring Cloud provides tools for developers to quickly build some of the common patterns in distributed systems (e.g. configuration management, service discovery, circuit breakers, intelligent routing, micro-proxy, control bus, one-time tokens, global locks, leadership election, distributed sessions, cluster state). Coordination of distributed systems leads to boiler plate patterns, and using Spring Cloud developers can quickly stand up services and applications that implement those patterns. They will work well in any distributed environment, including the developer’s own laptop, bare metal data centres, and managed platforms such as Cloud Foundry.</p><h2>Features</h2><p>Spring Cloud focuses on providing good out of box experience for typical use cases and extensibility mechanism to cover others.</p><ul><li><p>Distributed/versioned configuration</p></li><li><p>Service registration and discovery</p></li><li><p>Routing</p></li><li><p>Service-to-service calls</p></li><li><p>Load balancing</p></li><li><p>Circuit Breakers</p></li><li><p>Global locks</p></li><li><p>Leadership election and cluster state</p></li><li><p>Distributed messaging</p></li></ul><h2>Getting Started</h2><h3>Generating A New Spring Cloud Project</h3><p>The easiest way to get started is visit&nbsp;<a href=\"https://start.spring.io/\">start.spring.io</a>, select your Spring Boot version and the Spring Cloud projects you want to use. This will add the corresponding Spring Cloud BOM version to your Maven/Gradle file when you generate the project.</p><h3>Adding Spring Cloud To An Existing Spring Boot Application</h3><p>If you an existing Spring Boot app you want to add Spring Cloud to that app, the first step is to determine the version of Spring Cloud you should use. The version you use in your app will depend on the version of Spring Boot you are using.</p><p></p><p>The table below outlines which version of Spring Cloud maps to which version of Spring Boot.</p>","success":true}
2022-04-28 15:14:20.860 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006750490103808[0;39m ------------- 结束 耗时：75 ms -------------
2022-04-28 15:14:22.592 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006758069211136[0;39m ------------- 开始 -------------
2022-04-28 15:14:22.592 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006758069211136[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/6 GET
2022-04-28 15:14:22.592 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006758069211136[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:14:22.592 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006758069211136[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:22.593 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006758069211136[0;39m 请求参数: [6]
2022-04-28 15:14:22.619 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006758069211136[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:14:22.620 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006758069211136[0;39m ==> Parameters: 6(Long)
2022-04-28 15:14:22.638 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006758069211136[0;39m <==    Columns: id, content
2022-04-28 15:14:22.639 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006758069211136[0;39m <==        Row: 6, <<BLOB>>
2022-04-28 15:14:22.639 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006758069211136[0;39m <==      Total: 1
2022-04-28 15:14:22.640 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006758069211136[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:14:22.640 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006758069211136[0;39m ==> Parameters: 6(Long)
2022-04-28 15:14:22.682 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006758069211136[0;39m <==    Updates: 1
2022-04-28 15:14:22.683 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006758069211136[0;39m 返回结果: {"content":"<p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/9SGDpanrc8U\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\"></iframe></p>","success":true}
2022-04-28 15:14:22.683 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006758069211136[0;39m ------------- 结束 耗时：91 ms -------------
2022-04-28 15:14:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006768173289472[0;39m 生成今日电子书快照开始
2022-04-28 15:14:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006768173289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006768173289472[0;39m ==> Parameters: 
2022-04-28 15:14:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006768173289472[0;39m <==    Updates: 0
2022-04-28 15:14:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006768173289472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-28 15:14:25.747 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175003475019698178[0;39m ------------- LoginInterceptor start -------------
2022-04-28 15:14:25.748 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175003475019698178[0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2022-04-28 15:14:25.750 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175006727794724864[0;39m ------------- LoginInterceptor start -------------
2022-04-28 15:14:25.750 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175006727794724864[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/user/list
2022-04-28 15:14:25.750 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175006727794724864[0;39m 登录校验开始，token：175006685566472192
2022-04-28 15:14:25.931 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175006727794724864[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175006685566472192"}
2022-04-28 15:14:25.937 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006772099158016[0;39m ------------- 开始 -------------
2022-04-28 15:14:25.937 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006772099158016[0;39m 请求地址: http://127.0.0.1:8080/user/list GET
2022-04-28 15:14:25.937 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006772099158016[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.list
2022-04-28 15:14:25.937 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006772099158016[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:25.939 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006772099158016[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-28 15:14:25.954 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175006772099158016[0;39m ==>  Preparing: SELECT count(0) FROM user
2022-04-28 15:14:25.955 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175006772099158016[0;39m ==> Parameters: 
2022-04-28 15:14:25.975 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175006772099158016[0;39m <==    Columns: count(0)
2022-04-28 15:14:25.975 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175006772099158016[0;39m <==        Row: 1
2022-04-28 15:14:25.975 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175006772099158016[0;39m <==      Total: 1
2022-04-28 15:14:25.976 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006772099158016[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2022-04-28 15:14:25.976 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006772099158016[0;39m ==> Parameters: 10(Integer)
2022-04-28 15:14:25.997 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175006772099158016[0;39m <==    Columns: id, login_name, name, password
2022-04-28 15:14:25.997 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175006772099158016[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-28 15:14:25.997 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006772099158016[0;39m <==      Total: 1
2022-04-28 15:14:25.998 INFO  com.ameliawiki.wiki.service.UserService           :49   [32m175006772099158016[0;39m 总行数：1
2022-04-28 15:14:25.998 INFO  com.ameliawiki.wiki.service.UserService           :50   [32m175006772099158016[0;39m 总页数：1
2022-04-28 15:14:26.001 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006772099158016[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test1","name":"test1"}],"total":1},"success":true}
2022-04-28 15:14:26.002 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006772099158016[0;39m ------------- 结束 耗时：65 ms -------------
2022-04-28 15:14:26.003 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175006772099158016[0;39m ------------- LoginInterceptor 结束 耗时：253 ms -------------
2022-04-28 15:14:27.740 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006779661488128[0;39m ------------- 开始 -------------
2022-04-28 15:14:27.741 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006779661488128[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:14:27.741 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006779661488128[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:14:27.741 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006779661488128[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:27.741 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006779661488128[0;39m 请求参数: []
2022-04-28 15:14:27.765 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006779661488128[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:14:27.765 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006779661488128[0;39m ==> Parameters: 
2022-04-28 15:14:27.785 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:14:27.785 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:14:27.786 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:14:27.786 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:14:27.786 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:14:27.787 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:14:27.787 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:14:27.787 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:14:27.787 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:14:27.788 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:14:27.788 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:14:27.788 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:14:27.788 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:14:27.789 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:14:27.789 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:14:27.789 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006779661488128[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:14:27.789 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006779661488128[0;39m <==      Total: 15
2022-04-28 15:14:27.790 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006779661488128[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:14:27.790 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006779661488128[0;39m ------------- 结束 耗时：50 ms -------------
2022-04-28 15:14:27.810 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006779955089408[0;39m ------------- 开始 -------------
2022-04-28 15:14:27.811 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006779955089408[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:14:27.811 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006779955089408[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:14:27.811 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006779955089408[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:27.811 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006779955089408[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-28 15:14:27.812 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006779955089408[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-28 15:14:27.812 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006779955089408[0;39m ==> Parameters: 
2022-04-28 15:14:27.830 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006779955089408[0;39m <==    Columns: count(0)
2022-04-28 15:14:27.831 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006779955089408[0;39m <==        Row: 5
2022-04-28 15:14:27.831 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006779955089408[0;39m <==      Total: 1
2022-04-28 15:14:27.832 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006779955089408[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-28 15:14:27.832 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006779955089408[0;39m ==> Parameters: 10(Integer)
2022-04-28 15:14:27.850 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006779955089408[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:14:27.850 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006779955089408[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 71, 6
2022-04-28 15:14:27.851 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006779955089408[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:14:27.851 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006779955089408[0;39m <==        Row: 3, Python Tutorial, null, null, Introduction to programming with Python, null, 10, 75, 10
2022-04-28 15:14:27.852 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006779955089408[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-28 15:14:27.852 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006779955089408[0;39m <==        Row: 5, Oracle Tutorial, null, null, Introduction to Oracle, null, 11, 1123, 2
2022-04-28 15:14:27.853 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006779955089408[0;39m <==      Total: 5
2022-04-28 15:14:27.853 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006779955089408[0;39m total rows：5
2022-04-28 15:14:27.853 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006779955089408[0;39m total pages：1
2022-04-28 15:14:27.854 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006779955089408[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":71,"voteCount":6},{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-28 15:14:27.854 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006779955089408[0;39m ------------- 结束 耗时：44 ms -------------
2022-04-28 15:14:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006789149003776[0;39m 生成今日电子书快照开始
2022-04-28 15:14:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006789149003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006789149003776[0;39m ==> Parameters: 
2022-04-28 15:14:30.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006789149003776[0;39m <==    Updates: 0
2022-04-28 15:14:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006789149003776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:14:32.022 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006797621497856[0;39m ------------- 开始 -------------
2022-04-28 15:14:32.022 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006797621497856[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:14:32.022 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006797621497856[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:14:32.022 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006797621497856[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:32.022 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006797621497856[0;39m 请求参数: []
2022-04-28 15:14:32.045 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006797621497856[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:14:32.046 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006797621497856[0;39m ==> Parameters: 
2022-04-28 15:14:32.065 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:14:32.065 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:14:32.065 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:14:32.066 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:14:32.066 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:14:32.066 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:14:32.067 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:14:32.067 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:14:32.067 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:14:32.067 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:14:32.067 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:14:32.068 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:14:32.068 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:14:32.068 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:14:32.068 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:14:32.069 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006797621497856[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:14:32.069 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006797621497856[0;39m <==      Total: 15
2022-04-28 15:14:32.069 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006797621497856[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:14:32.070 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006797621497856[0;39m ------------- 结束 耗时：48 ms -------------
2022-04-28 15:14:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006810133106688[0;39m start updating Ebook doc
2022-04-28 15:14:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006810133106688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:14:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006810133106688[0;39m ==> Parameters: 
2022-04-28 15:14:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006810133106688[0;39m <==    Updates: 1
2022-04-28 15:14:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006810133106688[0;39m update ends, take 57 millisecs
2022-04-28 15:14:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006810380570624[0;39m 生成今日电子书快照开始
2022-04-28 15:14:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006810380570624[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006810380570624[0;39m ==> Parameters: 
2022-04-28 15:14:35.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006810380570624[0;39m <==    Updates: 0
2022-04-28 15:14:35.102 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006810380570624[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-28 15:14:35.824 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006813568241664[0;39m ------------- 开始 -------------
2022-04-28 15:14:35.824 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006813568241664[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:14:35.825 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006813568241664[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:14:35.825 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006813568241664[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:35.825 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006813568241664[0;39m 请求参数: []
2022-04-28 15:14:35.838 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006813568241664[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:14:35.839 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006813568241664[0;39m ==> Parameters: 
2022-04-28 15:14:35.857 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:14:35.857 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:14:35.857 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:14:35.857 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:14:35.858 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:14:35.858 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:14:35.858 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:14:35.858 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:14:35.859 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:14:35.859 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:14:35.859 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:14:35.859 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:14:35.859 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:14:35.860 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:14:35.860 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:14:35.860 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006813568241664[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:14:35.860 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006813568241664[0;39m <==      Total: 15
2022-04-28 15:14:35.861 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006813568241664[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:14:35.861 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006813568241664[0;39m ------------- 结束 耗时：37 ms -------------
2022-04-28 15:14:35.879 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006813798928384[0;39m ------------- 开始 -------------
2022-04-28 15:14:35.879 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006813798928384[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:14:35.879 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006813798928384[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:14:35.880 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006813798928384[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:35.880 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006813798928384[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-28 15:14:35.884 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006813798928384[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-28 15:14:35.884 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006813798928384[0;39m ==> Parameters: 
2022-04-28 15:14:35.899 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006813798928384[0;39m <==    Columns: count(0)
2022-04-28 15:14:35.900 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006813798928384[0;39m <==        Row: 5
2022-04-28 15:14:35.900 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006813798928384[0;39m <==      Total: 1
2022-04-28 15:14:35.901 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006813798928384[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-28 15:14:35.901 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006813798928384[0;39m ==> Parameters: 10(Integer)
2022-04-28 15:14:35.917 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006813798928384[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:14:35.917 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006813798928384[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 74, 7
2022-04-28 15:14:35.918 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006813798928384[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:14:35.918 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006813798928384[0;39m <==        Row: 3, Python Tutorial, null, null, Introduction to programming with Python, null, 10, 75, 10
2022-04-28 15:14:35.919 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006813798928384[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-28 15:14:35.919 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006813798928384[0;39m <==        Row: 5, Oracle Tutorial, null, null, Introduction to Oracle, null, 11, 1123, 2
2022-04-28 15:14:35.919 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006813798928384[0;39m <==      Total: 5
2022-04-28 15:14:35.920 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006813798928384[0;39m total rows：5
2022-04-28 15:14:35.920 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006813798928384[0;39m total pages：1
2022-04-28 15:14:35.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006813798928384[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":74,"voteCount":7},{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-28 15:14:35.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006813798928384[0;39m ------------- 结束 耗时：42 ms -------------
2022-04-28 15:14:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006831104626688[0;39m 生成今日电子书快照开始
2022-04-28 15:14:40.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006831104626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:40.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006831104626688[0;39m ==> Parameters: 
2022-04-28 15:14:40.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006831104626688[0;39m <==    Updates: 0
2022-04-28 15:14:40.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006831104626688[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-28 15:14:41.920 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175006627836071936[0;39m ------------- LoginInterceptor start -------------
2022-04-28 15:14:41.920 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175006627836071936[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/user/list
2022-04-28 15:14:41.920 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175006627836071936[0;39m 登录校验开始，token：175006685566472192
2022-04-28 15:14:42.096 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175006627836071936[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175006685566472192"}
2022-04-28 15:14:42.097 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006839879110656[0;39m ------------- 开始 -------------
2022-04-28 15:14:42.097 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006839879110656[0;39m 请求地址: http://127.0.0.1:8080/user/list GET
2022-04-28 15:14:42.097 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006839879110656[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.list
2022-04-28 15:14:42.097 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006839879110656[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:42.098 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006839879110656[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-28 15:14:42.118 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175006839879110656[0;39m ==>  Preparing: SELECT count(0) FROM user
2022-04-28 15:14:42.119 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175006839879110656[0;39m ==> Parameters: 
2022-04-28 15:14:42.137 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175006839879110656[0;39m <==    Columns: count(0)
2022-04-28 15:14:42.137 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175006839879110656[0;39m <==        Row: 1
2022-04-28 15:14:42.137 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175006839879110656[0;39m <==      Total: 1
2022-04-28 15:14:42.138 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006839879110656[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2022-04-28 15:14:42.138 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006839879110656[0;39m ==> Parameters: 10(Integer)
2022-04-28 15:14:42.159 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175006839879110656[0;39m <==    Columns: id, login_name, name, password
2022-04-28 15:14:42.160 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175006839879110656[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-28 15:14:42.160 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175006839879110656[0;39m <==      Total: 1
2022-04-28 15:14:42.160 INFO  com.ameliawiki.wiki.service.UserService           :49   [32m175006839879110656[0;39m 总行数：1
2022-04-28 15:14:42.160 INFO  com.ameliawiki.wiki.service.UserService           :50   [32m175006839879110656[0;39m 总页数：1
2022-04-28 15:14:42.161 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006839879110656[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test1","name":"test1"}],"total":1},"success":true}
2022-04-28 15:14:42.161 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006839879110656[0;39m ------------- 结束 耗时：64 ms -------------
2022-04-28 15:14:42.161 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175006839879110656[0;39m ------------- LoginInterceptor 结束 耗时：241 ms -------------
2022-04-28 15:14:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006852059369472[0;39m 生成今日电子书快照开始
2022-04-28 15:14:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006852059369472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006852059369472[0;39m ==> Parameters: 
2022-04-28 15:14:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006852059369472[0;39m <==    Updates: 0
2022-04-28 15:14:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006852059369472[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006853187637249[0;39m ------------- 开始 -------------
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006853187637250[0;39m ------------- 开始 -------------
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006853187637248[0;39m ------------- 开始 -------------
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006853187637249[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006853187637250[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006853187637248[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006853187637249[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006853187637248[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006853187637250[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006853187637249[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006853187637248[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006853187637250[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006853187637249[0;39m 请求参数: []
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006853187637248[0;39m 请求参数: []
2022-04-28 15:14:45.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006853187637250[0;39m 请求参数: []
2022-04-28 15:14:45.271 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006853187637249[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:14:45.271 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006853187637249[0;39m ==> Parameters: 
2022-04-28 15:14:45.288 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006853187637248[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:14:45.288 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006853187637248[0;39m ==> Parameters: 
2022-04-28 15:14:45.291 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:14:45.292 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:14:45.292 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:14:45.292 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006853187637250[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:14:45.292 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:14:45.292 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006853187637250[0;39m ==> Parameters: 
2022-04-28 15:14:45.293 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:14:45.293 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:14:45.293 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:14:45.293 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:14:45.294 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:14:45.294 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:14:45.294 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:14:45.294 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:14:45.295 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006853187637249[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:14:45.295 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006853187637249[0;39m <==      Total: 12
2022-04-28 15:14:45.295 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006853187637249[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:14:45.296 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006853187637249[0;39m ------------- 结束 耗时：26 ms -------------
2022-04-28 15:14:45.311 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:14:45.311 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006853187637248[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:14:45.311 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:14:45.311 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006853187637248[0;39m <==        Row: 2022-04-28, 1729, 60, 1729, 60
2022-04-28 15:14:45.312 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:14:45.312 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006853187637248[0;39m <==      Total: 1
2022-04-28 15:14:45.312 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:14:45.312 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:14:45.312 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006853187637248[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1729,"viewIncrease":1729,"voteCount":60,"voteIncrease":60}],"success":true}
2022-04-28 15:14:45.312 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006853187637248[0;39m ------------- 结束 耗时：42 ms -------------
2022-04-28 15:14:45.312 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:14:45.313 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:14:45.313 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:14:45.313 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:14:45.313 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:14:45.313 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:14:45.314 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:14:45.314 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:14:45.314 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:14:45.314 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:14:45.314 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006853187637250[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:14:45.315 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006853187637250[0;39m <==      Total: 15
2022-04-28 15:14:45.315 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006853187637250[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:14:45.315 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006853187637250[0;39m ------------- 结束 耗时：45 ms -------------
2022-04-28 15:14:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006873047666688[0;39m 生成今日电子书快照开始
2022-04-28 15:14:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006873047666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006873047666688[0;39m ==> Parameters: 
2022-04-28 15:14:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006873047666688[0;39m <==    Updates: 0
2022-04-28 15:14:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006873047666688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-28 15:14:52.472 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006883395014658[0;39m ------------- 开始 -------------
2022-04-28 15:14:52.472 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006883395014656[0;39m ------------- 开始 -------------
2022-04-28 15:14:52.472 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006883395014657[0;39m ------------- 开始 -------------
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006883395014658[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006883395014656[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006883395014657[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006883395014658[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006883395014656[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006883395014657[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006883395014656[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006883395014658[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006883395014657[0;39m 远程地址: 127.0.0.1
2022-04-28 15:14:52.473 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006883395014656[0;39m 请求参数: []
2022-04-28 15:14:52.474 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006883395014657[0;39m 请求参数: []
2022-04-28 15:14:52.474 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006883395014658[0;39m 请求参数: []
2022-04-28 15:14:52.490 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006883395014656[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:14:52.490 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006883395014656[0;39m ==> Parameters: 
2022-04-28 15:14:52.497 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006883395014658[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:14:52.497 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006883395014657[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:14:52.497 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006883395014658[0;39m ==> Parameters: 
2022-04-28 15:14:52.497 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006883395014657[0;39m ==> Parameters: 
2022-04-28 15:14:52.508 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:14:52.508 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:14:52.509 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:14:52.509 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:14:52.509 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:14:52.509 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:14:52.510 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:14:52.510 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:14:52.510 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:14:52.511 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:14:52.511 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:14:52.511 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:14:52.511 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006883395014656[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:14:52.512 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006883395014656[0;39m <==      Total: 12
2022-04-28 15:14:52.512 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006883395014656[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:14:52.512 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006883395014656[0;39m ------------- 结束 耗时：40 ms -------------
2022-04-28 15:14:52.517 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006883395014657[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:14:52.517 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006883395014657[0;39m <==        Row: 2022-04-28, 1729, 60, 1729, 60
2022-04-28 15:14:52.518 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006883395014657[0;39m <==      Total: 1
2022-04-28 15:14:52.518 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006883395014657[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1729,"viewIncrease":1729,"voteCount":60,"voteIncrease":60}],"success":true}
2022-04-28 15:14:52.518 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:14:52.518 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006883395014657[0;39m ------------- 结束 耗时：46 ms -------------
2022-04-28 15:14:52.518 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:14:52.519 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:14:52.519 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:14:52.519 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:14:52.519 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:14:52.519 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:14:52.520 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:14:52.520 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:14:52.520 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:14:52.520 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:14:52.520 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:14:52.521 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:14:52.521 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:14:52.521 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:14:52.521 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006883395014658[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:14:52.521 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006883395014658[0;39m <==      Total: 15
2022-04-28 15:14:52.522 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006883395014658[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:14:52.522 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006883395014658[0;39m ------------- 结束 耗时：50 ms -------------
2022-04-28 15:14:52.560 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :32   [32m175006797621497856[0;39m 有新连接：token：2GdcVGKMck，session id：2，当前连接数：2
2022-04-28 15:14:52.774 ERROR com.ameliawiki.wiki.websocket.WebSocketServer     :57   [32m175006813568241664[0;39m 发生错误
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1231)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1141)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:72)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:171)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:151)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:148)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:54)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
2022-04-28 15:14:52.775 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m175006813568241664[0;39m 连接关闭，token：7dEemTM3KJ，session id：1！当前连接数：1
2022-04-28 15:14:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006894002409472[0;39m 生成今日电子书快照开始
2022-04-28 15:14:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006894002409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:14:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006894002409472[0;39m ==> Parameters: 
2022-04-28 15:14:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006894002409472[0;39m <==    Updates: 0
2022-04-28 15:14:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006894002409472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:15:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006914986512384[0;39m 生成今日电子书快照开始
2022-04-28 15:15:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006914986512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006914986512384[0;39m ==> Parameters: 
2022-04-28 15:15:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006914986512384[0;39m <==    Updates: 0
2022-04-28 15:15:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006914986512384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-28 15:15:03.567 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006929930817536[0;39m ------------- 开始 -------------
2022-04-28 15:15:03.568 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006929930817536[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:03.568 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006929930817536[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:03.568 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006929930817536[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:03.568 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006929930817536[0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2022-04-28 15:15:03.593 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006929930817536[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:03.593 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006929930817536[0;39m ==> Parameters: 201(Long)
2022-04-28 15:15:03.610 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006929930817536[0;39m <==    Columns: count(0)
2022-04-28 15:15:03.610 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006929930817536[0;39m <==        Row: 1
2022-04-28 15:15:03.610 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006929930817536[0;39m <==      Total: 1
2022-04-28 15:15:03.611 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006929930817536[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:15:03.611 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006929930817536[0;39m ==> Parameters: 201(Long), 1000(Integer)
2022-04-28 15:15:03.632 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006929930817536[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:15:03.633 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006929930817536[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:15:03.633 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006929930817536[0;39m <==      Total: 1
2022-04-28 15:15:03.634 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006929930817536[0;39m total rows：1
2022-04-28 15:15:03.634 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006929930817536[0;39m total pages：1
2022-04-28 15:15:03.634 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006929930817536[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20}],"total":1},"success":true}
2022-04-28 15:15:03.635 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006929930817536[0;39m ------------- 结束 耗时：68 ms -------------
2022-04-28 15:15:04.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006935605710848[0;39m ------------- 开始 -------------
2022-04-28 15:15:04.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006935605710848[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:04.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006935605710848[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:04.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006935605710848[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:04.920 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006935605710848[0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2022-04-28 15:15:04.946 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006935605710848[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:04.947 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006935605710848[0;39m ==> Parameters: 202(Long)
2022-04-28 15:15:04.965 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006935605710848[0;39m <==    Columns: count(0)
2022-04-28 15:15:04.965 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006935605710848[0;39m <==        Row: 1
2022-04-28 15:15:04.966 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006935605710848[0;39m <==      Total: 1
2022-04-28 15:15:04.967 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006935605710848[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:15:04.967 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006935605710848[0;39m ==> Parameters: 202(Long), 1000(Integer)
2022-04-28 15:15:04.987 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006935605710848[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:15:04.988 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006935605710848[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 74, 7
2022-04-28 15:15:04.988 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006935605710848[0;39m <==      Total: 1
2022-04-28 15:15:04.989 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006935605710848[0;39m total rows：1
2022-04-28 15:15:04.989 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006935605710848[0;39m total pages：1
2022-04-28 15:15:04.989 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006935605710848[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":74,"voteCount":7}],"total":1},"success":true}
2022-04-28 15:15:04.989 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006935605710848[0;39m ------------- 结束 耗时：69 ms -------------
2022-04-28 15:15:05.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175006935953838080[0;39m start updating Ebook doc
2022-04-28 15:15:05.017 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006935953838080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:15:05.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006935953838080[0;39m ==> Parameters: 
2022-04-28 15:15:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175006935953838080[0;39m <==    Updates: 1
2022-04-28 15:15:05.057 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175006935953838080[0;39m update ends, take 53 millisecs
2022-04-28 15:15:05.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006936180330496[0;39m 生成今日电子书快照开始
2022-04-28 15:15:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006936180330496[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006936180330496[0;39m ==> Parameters: 
2022-04-28 15:15:05.098 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006936180330496[0;39m <==    Updates: 0
2022-04-28 15:15:05.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006936180330496[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-28 15:15:06.255 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006941205106688[0;39m ------------- 开始 -------------
2022-04-28 15:15:06.255 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006941205106688[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:06.256 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006941205106688[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:06.256 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006941205106688[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:06.256 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006941205106688[0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2022-04-28 15:15:06.280 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006941205106688[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:06.281 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006941205106688[0;39m ==> Parameters: 201(Long)
2022-04-28 15:15:06.298 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006941205106688[0;39m <==    Columns: count(0)
2022-04-28 15:15:06.299 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006941205106688[0;39m <==        Row: 1
2022-04-28 15:15:06.299 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006941205106688[0;39m <==      Total: 1
2022-04-28 15:15:06.300 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006941205106688[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:15:06.301 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006941205106688[0;39m ==> Parameters: 201(Long), 1000(Integer)
2022-04-28 15:15:06.317 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006941205106688[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:15:06.318 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006941205106688[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:15:06.319 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006941205106688[0;39m <==      Total: 1
2022-04-28 15:15:06.320 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006941205106688[0;39m total rows：1
2022-04-28 15:15:06.320 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006941205106688[0;39m total pages：1
2022-04-28 15:15:06.323 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006941205106688[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20}],"total":1},"success":true}
2022-04-28 15:15:06.323 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006941205106688[0;39m ------------- 结束 耗时：68 ms -------------
2022-04-28 15:15:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006956929552384[0;39m 生成今日电子书快照开始
2022-04-28 15:15:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006956929552384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006956929552384[0;39m ==> Parameters: 
2022-04-28 15:15:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006956929552384[0;39m <==    Updates: 0
2022-04-28 15:15:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006956929552384[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-28 15:15:10.453 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006958812794880[0;39m ------------- 开始 -------------
2022-04-28 15:15:10.453 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006958812794880[0;39m 请求地址: http://127.0.0.1:8080/doc/all/2 GET
2022-04-28 15:15:10.453 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006958812794880[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.all
2022-04-28 15:15:10.454 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006958812794880[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:10.454 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006958812794880[0;39m 请求参数: [2]
2022-04-28 15:15:10.479 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006958812794880[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-04-28 15:15:10.480 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006958812794880[0;39m ==> Parameters: 2(Long)
2022-04-28 15:15:10.498 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006958812794880[0;39m <==      Total: 0
2022-04-28 15:15:10.499 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006958812794880[0;39m 返回结果: {"content":[],"success":true}
2022-04-28 15:15:10.500 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006958812794880[0;39m ------------- 结束 耗时：47 ms -------------
2022-04-28 15:15:11.969 ERROR c.a.wiki.controller.ControllerExceptionHandler    :59   [32m175006853187637250[0;39m 系统异常：
org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:133)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:121)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:170)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:137)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:893)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:807)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1061)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:961)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:626)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.lang.NumberFormatException: For input string: "undefined"
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
	at java.lang.Long.parseLong(Long.java:589)
	at java.lang.Long.valueOf(Long.java:803)
	at org.springframework.util.NumberUtils.parseNumber(NumberUtils.java:214)
	at org.springframework.beans.propertyeditors.CustomNumberEditor.setAsText(CustomNumberEditor.java:115)
	at org.springframework.beans.TypeConverterDelegate.doConvertTextValue(TypeConverterDelegate.java:429)
	at org.springframework.beans.TypeConverterDelegate.doConvertValue(TypeConverterDelegate.java:402)
	at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:155)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:73)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:53)
	at org.springframework.validation.DataBinder.convertIfNecessary(DataBinder.java:696)
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:125)
	... 47 common frames omitted
2022-04-28 15:15:11.970 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175006853187637250[0;39m Resolved [org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"]
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006975292215297[0;39m ------------- 开始 -------------
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006975292215296[0;39m ------------- 开始 -------------
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006975292215298[0;39m ------------- 开始 -------------
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006975292215297[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006975292215296[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006975292215298[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006975292215297[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006975292215296[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006975292215298[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006975292215297[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006975292215296[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:14.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006975292215298[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:14.383 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006975292215297[0;39m 请求参数: []
2022-04-28 15:15:14.383 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006975292215296[0;39m 请求参数: []
2022-04-28 15:15:14.383 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006975292215298[0;39m 请求参数: []
2022-04-28 15:15:14.528 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006975292215297[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:15:14.528 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006975292215296[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:15:14.528 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006975292215298[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:15:14.529 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006975292215297[0;39m ==> Parameters: 
2022-04-28 15:15:14.529 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006975292215296[0;39m ==> Parameters: 
2022-04-28 15:15:14.529 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006975292215298[0;39m ==> Parameters: 
2022-04-28 15:15:14.549 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:15:14.550 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006975292215298[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:15:14.550 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:15:14.550 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:15:14.550 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175006975292215298[0;39m <==        Row: 2022-04-28, 1729, 60, 1729, 60
2022-04-28 15:15:14.550 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:15:14.551 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:15:14.551 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175006975292215298[0;39m <==      Total: 1
2022-04-28 15:15:14.551 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:15:14.551 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:15:14.551 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006975292215298[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1729,"viewIncrease":1729,"voteCount":60,"voteIncrease":60}],"success":true}
2022-04-28 15:15:14.551 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:15:14.551 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006975292215298[0;39m ------------- 结束 耗时：169 ms -------------
2022-04-28 15:15:14.551 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:15:14.552 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:15:14.552 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:15:14.552 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:15:14.552 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:15:14.552 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:15:14.553 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:15:14.553 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:15:14.553 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:15:14.553 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:15:14.553 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:15:14.554 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:15:14.554 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:15:14.554 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:15:14.554 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:15:14.554 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:15:14.554 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:15:14.554 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:15:14.555 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:15:14.555 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175006975292215296[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:15:14.555 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175006975292215297[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:15:14.555 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175006975292215297[0;39m <==      Total: 15
2022-04-28 15:15:14.555 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175006975292215296[0;39m <==      Total: 12
2022-04-28 15:15:14.556 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006975292215296[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:15:14.556 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006975292215296[0;39m ------------- 结束 耗时：174 ms -------------
2022-04-28 15:15:14.556 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006975292215297[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:15:14.556 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006975292215297[0;39m ------------- 结束 耗时：174 ms -------------
2022-04-28 15:15:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006977896878080[0;39m 生成今日电子书快照开始
2022-04-28 15:15:15.004 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006977896878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:15.004 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006977896878080[0;39m ==> Parameters: 
2022-04-28 15:15:15.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006977896878080[0;39m <==    Updates: 0
2022-04-28 15:15:15.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006977896878080[0;39m 生成今日电子书快照结束，耗时：99毫秒
2022-04-28 15:15:18.051 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006990681116672[0;39m ------------- 开始 -------------
2022-04-28 15:15:18.051 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006990681116672[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:18.052 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006990681116672[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:18.052 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006990681116672[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:18.052 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006990681116672[0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2022-04-28 15:15:18.075 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006990681116672[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:18.075 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006990681116672[0;39m ==> Parameters: 202(Long)
2022-04-28 15:15:18.094 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006990681116672[0;39m <==    Columns: count(0)
2022-04-28 15:15:18.095 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175006990681116672[0;39m <==        Row: 1
2022-04-28 15:15:18.095 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175006990681116672[0;39m <==      Total: 1
2022-04-28 15:15:18.096 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006990681116672[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:15:18.096 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006990681116672[0;39m ==> Parameters: 202(Long), 1000(Integer)
2022-04-28 15:15:18.115 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006990681116672[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:15:18.116 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175006990681116672[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 74, 7
2022-04-28 15:15:18.116 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175006990681116672[0;39m <==      Total: 1
2022-04-28 15:15:18.117 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175006990681116672[0;39m total rows：1
2022-04-28 15:15:18.117 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175006990681116672[0;39m total pages：1
2022-04-28 15:15:18.117 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006990681116672[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":74,"voteCount":7}],"total":1},"success":true}
2022-04-28 15:15:18.118 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006990681116672[0;39m ------------- 结束 耗时：67 ms -------------
2022-04-28 15:15:19.281 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006995840110592[0;39m ------------- 开始 -------------
2022-04-28 15:15:19.282 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006995840110592[0;39m 请求地址: http://127.0.0.1:8080/doc/all/1 GET
2022-04-28 15:15:19.282 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006995840110592[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.all
2022-04-28 15:15:19.282 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006995840110592[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:19.282 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006995840110592[0;39m 请求参数: [1]
2022-04-28 15:15:19.300 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006995840110592[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-04-28 15:15:19.301 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006995840110592[0;39m ==> Parameters: 1(Long)
2022-04-28 15:15:19.321 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006995840110592[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-04-28 15:15:19.321 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006995840110592[0;39m <==        Row: 1, 1, 0, Spring Boot, 1, 22, 3
2022-04-28 15:15:19.322 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006995840110592[0;39m <==        Row: 2, 1, 1, Introduction, 1, 18, 1
2022-04-28 15:15:19.322 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006995840110592[0;39m <==        Row: 4, 1, 3, Spring Cloud, 1, 15, 1
2022-04-28 15:15:19.323 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006995840110592[0;39m <==        Row: 6, 1, 5, video, 1, 12, 1
2022-04-28 15:15:19.323 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006995840110592[0;39m <==        Row: 3, 1, 0, Learn, 2, 3, 0
2022-04-28 15:15:19.323 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175006995840110592[0;39m <==        Row: 5, 1, 3, Video, 2, 4, 1
2022-04-28 15:15:19.323 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175006995840110592[0;39m <==      Total: 6
2022-04-28 15:15:19.324 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006995840110592[0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Spring Boot","parent":0,"sort":1,"viewCount":22,"voteCount":3},{"ebookId":1,"id":2,"name":"Introduction","parent":1,"sort":1,"viewCount":18,"voteCount":1},{"ebookId":1,"id":4,"name":"Spring Cloud","parent":3,"sort":1,"viewCount":15,"voteCount":1},{"ebookId":1,"id":6,"name":"video","parent":5,"sort":1,"viewCount":12,"voteCount":1},{"ebookId":1,"id":3,"name":"Learn","parent":0,"sort":2,"viewCount":3,"voteCount":0},{"ebookId":1,"id":5,"name":"Video","parent":3,"sort":2,"viewCount":4,"voteCount":1}],"success":true}
2022-04-28 15:15:19.324 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006995840110592[0;39m ------------- 结束 耗时：43 ms -------------
2022-04-28 15:15:19.355 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175006996150489088[0;39m ------------- 开始 -------------
2022-04-28 15:15:19.355 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175006996150489088[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/1 GET
2022-04-28 15:15:19.355 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175006996150489088[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:15:19.355 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175006996150489088[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:19.355 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175006996150489088[0;39m 请求参数: [1]
2022-04-28 15:15:19.356 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006996150489088[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:15:19.356 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006996150489088[0;39m ==> Parameters: 1(Long)
2022-04-28 15:15:19.370 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006996150489088[0;39m <==    Columns: id, content
2022-04-28 15:15:19.370 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175006996150489088[0;39m <==        Row: 1, <<BLOB>>
2022-04-28 15:15:19.371 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175006996150489088[0;39m <==      Total: 1
2022-04-28 15:15:19.371 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006996150489088[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:15:19.372 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006996150489088[0;39m ==> Parameters: 1(Long)
2022-04-28 15:15:19.408 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175006996150489088[0;39m <==    Updates: 1
2022-04-28 15:15:19.409 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175006996150489088[0;39m 返回结果: {"content":"","success":true}
2022-04-28 15:15:19.409 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175006996150489088[0;39m ------------- 结束 耗时：54 ms -------------
2022-04-28 15:15:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175006998860009472[0;39m 生成今日电子书快照开始
2022-04-28 15:15:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006998860009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006998860009472[0;39m ==> Parameters: 
2022-04-28 15:15:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175006998860009472[0;39m <==    Updates: 0
2022-04-28 15:15:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175006998860009472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:15:20.516 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007001020076032[0;39m ------------- 开始 -------------
2022-04-28 15:15:20.517 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007001020076032[0;39m 请求地址: http://127.0.0.1:8080/doc/vote/1 GET
2022-04-28 15:15:20.517 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007001020076032[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.vote
2022-04-28 15:15:20.517 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007001020076032[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:20.517 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007001020076032[0;39m 请求参数: [1]
2022-04-28 15:15:20.687 INFO  com.ameliawiki.wiki.util.RedisUtil                :27   [32m175007001020076032[0;39m key already exist：DOC_VOTE1_127.0.0.1
2022-04-28 15:15:20.689 WARN  c.a.wiki.controller.ControllerExceptionHandler    :44   [32m175007001020076032[0;39m 业务异常：you already voted for this article
2022-04-28 15:15:20.690 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m175007001020076032[0;39m Resolved [com.ameliawiki.wiki.exception.BusinessException: you already voted for this article]
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007017826652160[0;39m ------------- 开始 -------------
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007017826652161[0;39m ------------- 开始 -------------
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007017826652162[0;39m ------------- 开始 -------------
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007017826652160[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007017826652161[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007017826652160[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007017826652162[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007017826652161[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007017826652160[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007017826652162[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:15:24.523 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007017826652161[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:24.524 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007017826652160[0;39m 请求参数: []
2022-04-28 15:15:24.524 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007017826652162[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:24.524 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007017826652161[0;39m 请求参数: []
2022-04-28 15:15:24.524 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007017826652162[0;39m 请求参数: []
2022-04-28 15:15:24.546 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007017826652161[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:15:24.547 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007017826652161[0;39m ==> Parameters: 
2022-04-28 15:15:24.552 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007017826652162[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:15:24.552 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007017826652160[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:15:24.553 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007017826652162[0;39m ==> Parameters: 
2022-04-28 15:15:24.553 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007017826652160[0;39m ==> Parameters: 
2022-04-28 15:15:24.566 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175007017826652161[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:15:24.566 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175007017826652161[0;39m <==        Row: 2022-04-28, 1729, 60, 1729, 60
2022-04-28 15:15:24.567 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007017826652161[0;39m <==      Total: 1
2022-04-28 15:15:24.567 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007017826652161[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1729,"viewIncrease":1729,"voteCount":60,"voteIncrease":60}],"success":true}
2022-04-28 15:15:24.567 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007017826652161[0;39m ------------- 结束 耗时：44 ms -------------
2022-04-28 15:15:24.573 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:15:24.573 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:15:24.573 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:15:24.573 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:15:24.574 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:15:24.574 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:15:24.574 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:15:24.574 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:15:24.574 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:15:24.575 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:15:24.575 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:15:24.575 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:15:24.575 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:15:24.575 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:15:24.575 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:15:24.575 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:15:24.575 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:15:24.576 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:15:24.576 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:15:24.576 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:15:24.576 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:15:24.576 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:15:24.576 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:15:24.576 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:15:24.576 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:15:24.577 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:15:24.577 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:15:24.577 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007017826652160[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:15:24.577 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007017826652162[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:15:24.577 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007017826652162[0;39m <==      Total: 15
2022-04-28 15:15:24.577 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007017826652160[0;39m <==      Total: 12
2022-04-28 15:15:24.577 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007017826652160[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:15:24.578 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007017826652160[0;39m ------------- 结束 耗时：55 ms -------------
2022-04-28 15:15:24.578 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007017826652162[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:15:24.578 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007017826652162[0;39m ------------- 结束 耗时：55 ms -------------
2022-04-28 15:15:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007019831529472[0;39m 生成今日电子书快照开始
2022-04-28 15:15:25.001 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007019831529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:25.002 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007019831529472[0;39m ==> Parameters: 
2022-04-28 15:15:25.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007019831529472[0;39m <==    Updates: 0
2022-04-28 15:15:25.039 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007019831529472[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-28 15:15:27.543 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007030493450240[0;39m ------------- 开始 -------------
2022-04-28 15:15:27.543 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007030493450240[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:27.543 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007030493450240[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:27.543 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007030493450240[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:27.544 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007030493450240[0;39m 请求参数: [{"categoryId2":302,"page":1,"size":1000}]
2022-04-28 15:15:27.567 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007030493450240[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:27.567 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007030493450240[0;39m ==> Parameters: 302(Long)
2022-04-28 15:15:27.585 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007030493450240[0;39m <==    Columns: count(0)
2022-04-28 15:15:27.585 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007030493450240[0;39m <==        Row: 0
2022-04-28 15:15:27.586 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007030493450240[0;39m <==      Total: 1
2022-04-28 15:15:27.586 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007030493450240[0;39m total rows：0
2022-04-28 15:15:27.586 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007030493450240[0;39m total pages：0
2022-04-28 15:15:27.586 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007030493450240[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:27.586 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007030493450240[0;39m ------------- 结束 耗时：43 ms -------------
2022-04-28 15:15:28.531 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007034637422592[0;39m ------------- 开始 -------------
2022-04-28 15:15:28.531 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007034637422592[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:28.531 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007034637422592[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:28.531 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007034637422592[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:28.532 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007034637422592[0;39m 请求参数: [{"categoryId2":301,"page":1,"size":1000}]
2022-04-28 15:15:28.554 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007034637422592[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:28.554 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007034637422592[0;39m ==> Parameters: 301(Long)
2022-04-28 15:15:28.573 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007034637422592[0;39m <==    Columns: count(0)
2022-04-28 15:15:28.573 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007034637422592[0;39m <==        Row: 0
2022-04-28 15:15:28.574 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007034637422592[0;39m <==      Total: 1
2022-04-28 15:15:28.574 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007034637422592[0;39m total rows：0
2022-04-28 15:15:28.574 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007034637422592[0;39m total pages：0
2022-04-28 15:15:28.575 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007034637422592[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:28.575 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007034637422592[0;39m ------------- 结束 耗时：44 ms -------------
2022-04-28 15:15:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007040803049472[0;39m 生成今日电子书快照开始
2022-04-28 15:15:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007040803049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007040803049472[0;39m ==> Parameters: 
2022-04-28 15:15:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007040803049472[0;39m <==    Updates: 0
2022-04-28 15:15:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007040803049472[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:15:30.651 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007043529347072[0;39m ------------- 开始 -------------
2022-04-28 15:15:30.651 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007043529347072[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:30.651 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007043529347072[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:30.651 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007043529347072[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:30.651 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007043529347072[0;39m 请求参数: [{"categoryId2":401,"page":1,"size":1000}]
2022-04-28 15:15:30.675 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007043529347072[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:30.676 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007043529347072[0;39m ==> Parameters: 401(Long)
2022-04-28 15:15:30.694 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007043529347072[0;39m <==    Columns: count(0)
2022-04-28 15:15:30.694 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007043529347072[0;39m <==        Row: 0
2022-04-28 15:15:30.694 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007043529347072[0;39m <==      Total: 1
2022-04-28 15:15:30.695 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007043529347072[0;39m total rows：0
2022-04-28 15:15:30.695 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007043529347072[0;39m total pages：0
2022-04-28 15:15:30.695 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007043529347072[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:30.696 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007043529347072[0;39m ------------- 结束 耗时：45 ms -------------
2022-04-28 15:15:32.464 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007051133620224[0;39m ------------- 开始 -------------
2022-04-28 15:15:32.465 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007051133620224[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:32.465 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007051133620224[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:32.465 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007051133620224[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:32.465 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007051133620224[0;39m 请求参数: [{"categoryId2":501,"page":1,"size":1000}]
2022-04-28 15:15:32.491 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007051133620224[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:32.492 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007051133620224[0;39m ==> Parameters: 501(Long)
2022-04-28 15:15:32.512 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007051133620224[0;39m <==    Columns: count(0)
2022-04-28 15:15:32.513 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007051133620224[0;39m <==        Row: 0
2022-04-28 15:15:32.513 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007051133620224[0;39m <==      Total: 1
2022-04-28 15:15:32.514 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007051133620224[0;39m total rows：0
2022-04-28 15:15:32.514 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007051133620224[0;39m total pages：0
2022-04-28 15:15:32.514 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007051133620224[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:32.515 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007051133620224[0;39m ------------- 结束 耗时：51 ms -------------
2022-04-28 15:15:33.381 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007054979796992[0;39m ------------- 开始 -------------
2022-04-28 15:15:33.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007054979796992[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:33.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007054979796992[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:33.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007054979796992[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:33.382 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007054979796992[0;39m 请求参数: [{"categoryId2":502,"page":1,"size":1000}]
2022-04-28 15:15:33.404 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007054979796992[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:33.405 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007054979796992[0;39m ==> Parameters: 502(Long)
2022-04-28 15:15:33.423 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007054979796992[0;39m <==    Columns: count(0)
2022-04-28 15:15:33.424 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007054979796992[0;39m <==        Row: 0
2022-04-28 15:15:33.424 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007054979796992[0;39m <==      Total: 1
2022-04-28 15:15:33.425 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007054979796992[0;39m total rows：0
2022-04-28 15:15:33.425 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007054979796992[0;39m total pages：0
2022-04-28 15:15:33.426 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007054979796992[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:33.426 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007054979796992[0;39m ------------- 结束 耗时：45 ms -------------
2022-04-28 15:15:34.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007057588654080[0;39m ------------- 开始 -------------
2022-04-28 15:15:34.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007057588654080[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:34.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007057588654080[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:34.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007057588654080[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:34.004 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007057588654080[0;39m 请求参数: [{"categoryId2":503,"page":1,"size":1000}]
2022-04-28 15:15:34.024 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007057588654080[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:34.025 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007057588654080[0;39m ==> Parameters: 503(Long)
2022-04-28 15:15:34.044 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007057588654080[0;39m <==    Columns: count(0)
2022-04-28 15:15:34.045 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007057588654080[0;39m <==        Row: 0
2022-04-28 15:15:34.045 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007057588654080[0;39m <==      Total: 1
2022-04-28 15:15:34.046 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007057588654080[0;39m total rows：0
2022-04-28 15:15:34.046 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007057588654080[0;39m total pages：0
2022-04-28 15:15:34.046 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007057588654080[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:34.046 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007057588654080[0;39m ------------- 结束 耗时：43 ms -------------
2022-04-28 15:15:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175007061774569472[0;39m start updating Ebook doc
2022-04-28 15:15:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007061774569472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:15:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007061774569472[0;39m ==> Parameters: 
2022-04-28 15:15:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007061774569472[0;39m <==    Updates: 1
2022-04-28 15:15:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175007061774569472[0;39m update ends, take 61 millisecs
2022-04-28 15:15:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007062034616320[0;39m 生成今日电子书快照开始
2022-04-28 15:15:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007062034616320[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007062034616320[0;39m ==> Parameters: 
2022-04-28 15:15:35.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007062034616320[0;39m <==    Updates: 0
2022-04-28 15:15:35.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007062034616320[0;39m 生成今日电子书快照结束，耗时：43毫秒
2022-04-28 15:15:38.304 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007075628355584[0;39m ------------- 开始 -------------
2022-04-28 15:15:38.304 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007075628355584[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:38.304 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007075628355584[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:38.304 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007075628355584[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:38.304 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007075628355584[0;39m 请求参数: [{"categoryId2":102,"page":1,"size":1000}]
2022-04-28 15:15:38.324 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007075628355584[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:38.325 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007075628355584[0;39m ==> Parameters: 102(Long)
2022-04-28 15:15:38.347 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007075628355584[0;39m <==    Columns: count(0)
2022-04-28 15:15:38.348 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007075628355584[0;39m <==        Row: 0
2022-04-28 15:15:38.348 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007075628355584[0;39m <==      Total: 1
2022-04-28 15:15:38.348 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007075628355584[0;39m total rows：0
2022-04-28 15:15:38.349 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007075628355584[0;39m total pages：0
2022-04-28 15:15:38.349 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007075628355584[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:38.349 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007075628355584[0;39m ------------- 结束 耗时：45 ms -------------
2022-04-28 15:15:38.998 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007078539202560[0;39m ------------- 开始 -------------
2022-04-28 15:15:38.998 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007078539202560[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:38.999 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007078539202560[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:38.999 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007078539202560[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:38.999 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007078539202560[0;39m 请求参数: [{"categoryId2":101,"page":1,"size":1000}]
2022-04-28 15:15:39.021 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007078539202560[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:39.022 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007078539202560[0;39m ==> Parameters: 101(Long)
2022-04-28 15:15:39.044 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007078539202560[0;39m <==    Columns: count(0)
2022-04-28 15:15:39.044 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007078539202560[0;39m <==        Row: 0
2022-04-28 15:15:39.045 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007078539202560[0;39m <==      Total: 1
2022-04-28 15:15:39.045 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007078539202560[0;39m total rows：0
2022-04-28 15:15:39.046 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007078539202560[0;39m total pages：0
2022-04-28 15:15:39.046 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007078539202560[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2022-04-28 15:15:39.046 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007078539202560[0;39m ------------- 结束 耗时：48 ms -------------
2022-04-28 15:15:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007082750283776[0;39m 生成今日电子书快照开始
2022-04-28 15:15:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007082750283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007082750283776[0;39m ==> Parameters: 
2022-04-28 15:15:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007082750283776[0;39m <==    Updates: 0
2022-04-28 15:15:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007082750283776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-28 15:15:41.374 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007088504868864[0;39m ------------- 开始 -------------
2022-04-28 15:15:41.374 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007088504868864[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:41.374 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007088504868864[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:41.375 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007088504868864[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:41.375 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007088504868864[0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2022-04-28 15:15:41.399 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007088504868864[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:41.400 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007088504868864[0;39m ==> Parameters: 201(Long)
2022-04-28 15:15:41.418 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007088504868864[0;39m <==    Columns: count(0)
2022-04-28 15:15:41.418 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007088504868864[0;39m <==        Row: 1
2022-04-28 15:15:41.418 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007088504868864[0;39m <==      Total: 1
2022-04-28 15:15:41.419 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007088504868864[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:15:41.419 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007088504868864[0;39m ==> Parameters: 201(Long), 1000(Integer)
2022-04-28 15:15:41.436 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007088504868864[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:15:41.437 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007088504868864[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:15:41.437 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007088504868864[0;39m <==      Total: 1
2022-04-28 15:15:41.438 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007088504868864[0;39m total rows：1
2022-04-28 15:15:41.438 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007088504868864[0;39m total pages：1
2022-04-28 15:15:41.438 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007088504868864[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20}],"total":1},"success":true}
2022-04-28 15:15:41.438 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007088504868864[0;39m ------------- 结束 耗时：64 ms -------------
2022-04-28 15:15:42.540 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007093395427328[0;39m ------------- 开始 -------------
2022-04-28 15:15:42.541 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007093395427328[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:15:42.541 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007093395427328[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:15:42.541 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007093395427328[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:42.541 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007093395427328[0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2022-04-28 15:15:42.568 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007093395427328[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2022-04-28 15:15:42.569 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007093395427328[0;39m ==> Parameters: 202(Long)
2022-04-28 15:15:42.592 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007093395427328[0;39m <==    Columns: count(0)
2022-04-28 15:15:42.593 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007093395427328[0;39m <==        Row: 1
2022-04-28 15:15:42.593 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007093395427328[0;39m <==      Total: 1
2022-04-28 15:15:42.594 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007093395427328[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2022-04-28 15:15:42.594 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007093395427328[0;39m ==> Parameters: 202(Long), 1000(Integer)
2022-04-28 15:15:42.610 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007093395427328[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:15:42.611 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007093395427328[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 75, 7
2022-04-28 15:15:42.612 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007093395427328[0;39m <==      Total: 1
2022-04-28 15:15:42.612 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007093395427328[0;39m total rows：1
2022-04-28 15:15:42.612 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007093395427328[0;39m total pages：1
2022-04-28 15:15:42.613 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007093395427328[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":75,"voteCount":7}],"total":1},"success":true}
2022-04-28 15:15:42.613 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007093395427328[0;39m ------------- 结束 耗时：73 ms -------------
2022-04-28 15:15:44.186 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007100299251712[0;39m ------------- 开始 -------------
2022-04-28 15:15:44.187 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007100299251712[0;39m 请求地址: http://127.0.0.1:8080/doc/all/1 GET
2022-04-28 15:15:44.187 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007100299251712[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.all
2022-04-28 15:15:44.187 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007100299251712[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:44.188 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007100299251712[0;39m 请求参数: [1]
2022-04-28 15:15:44.215 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175007100299251712[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-04-28 15:15:44.216 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175007100299251712[0;39m ==> Parameters: 1(Long)
2022-04-28 15:15:44.234 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007100299251712[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-04-28 15:15:44.234 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007100299251712[0;39m <==        Row: 1, 1, 0, Spring Boot, 1, 23, 3
2022-04-28 15:15:44.235 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007100299251712[0;39m <==        Row: 2, 1, 1, Introduction, 1, 18, 1
2022-04-28 15:15:44.235 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007100299251712[0;39m <==        Row: 4, 1, 3, Spring Cloud, 1, 15, 1
2022-04-28 15:15:44.236 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007100299251712[0;39m <==        Row: 6, 1, 5, video, 1, 12, 1
2022-04-28 15:15:44.237 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007100299251712[0;39m <==        Row: 3, 1, 0, Learn, 2, 3, 0
2022-04-28 15:15:44.237 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007100299251712[0;39m <==        Row: 5, 1, 3, Video, 2, 4, 1
2022-04-28 15:15:44.237 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175007100299251712[0;39m <==      Total: 6
2022-04-28 15:15:44.240 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007100299251712[0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Spring Boot","parent":0,"sort":1,"viewCount":23,"voteCount":3},{"ebookId":1,"id":2,"name":"Introduction","parent":1,"sort":1,"viewCount":18,"voteCount":1},{"ebookId":1,"id":4,"name":"Spring Cloud","parent":3,"sort":1,"viewCount":15,"voteCount":1},{"ebookId":1,"id":6,"name":"video","parent":5,"sort":1,"viewCount":12,"voteCount":1},{"ebookId":1,"id":3,"name":"Learn","parent":0,"sort":2,"viewCount":3,"voteCount":0},{"ebookId":1,"id":5,"name":"Video","parent":3,"sort":2,"viewCount":4,"voteCount":1}],"success":true}
2022-04-28 15:15:44.240 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007100299251712[0;39m ------------- 结束 耗时：54 ms -------------
2022-04-28 15:15:44.277 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007100680933376[0;39m ------------- 开始 -------------
2022-04-28 15:15:44.277 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007100680933376[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/1 GET
2022-04-28 15:15:44.277 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007100680933376[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:15:44.277 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007100680933376[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:44.277 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007100680933376[0;39m 请求参数: [1]
2022-04-28 15:15:44.295 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007100680933376[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:15:44.296 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007100680933376[0;39m ==> Parameters: 1(Long)
2022-04-28 15:15:44.317 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007100680933376[0;39m <==    Columns: id, content
2022-04-28 15:15:44.318 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007100680933376[0;39m <==        Row: 1, <<BLOB>>
2022-04-28 15:15:44.318 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007100680933376[0;39m <==      Total: 1
2022-04-28 15:15:44.319 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007100680933376[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:15:44.320 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007100680933376[0;39m ==> Parameters: 1(Long)
2022-04-28 15:15:44.361 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007100680933376[0;39m <==    Updates: 1
2022-04-28 15:15:44.361 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007100680933376[0;39m 返回结果: {"content":"","success":true}
2022-04-28 15:15:44.362 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007100680933376[0;39m ------------- 结束 耗时：85 ms -------------
2022-04-28 15:15:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007103730192384[0;39m 生成今日电子书快照开始
2022-04-28 15:15:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007103730192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007103730192384[0;39m ==> Parameters: 
2022-04-28 15:15:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007103730192384[0;39m <==    Updates: 0
2022-04-28 15:15:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007103730192384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:15:46.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007109413474304[0;39m ------------- 开始 -------------
2022-04-28 15:15:46.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007109413474304[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/4 GET
2022-04-28 15:15:46.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007109413474304[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:15:46.359 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007109413474304[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:46.360 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007109413474304[0;39m 请求参数: [4]
2022-04-28 15:15:46.383 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007109413474304[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:15:46.384 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007109413474304[0;39m ==> Parameters: 4(Long)
2022-04-28 15:15:46.403 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007109413474304[0;39m <==    Columns: id, content
2022-04-28 15:15:46.403 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007109413474304[0;39m <==        Row: 4, <<BLOB>>
2022-04-28 15:15:46.404 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007109413474304[0;39m <==      Total: 1
2022-04-28 15:15:46.404 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007109413474304[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:15:46.405 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007109413474304[0;39m ==> Parameters: 4(Long)
2022-04-28 15:15:46.441 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007109413474304[0;39m <==    Updates: 1
2022-04-28 15:15:46.441 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007109413474304[0;39m 返回结果: {"content":"<p>Spring Cloud provides tools for developers to quickly build some of the common patterns in distributed systems (e.g. configuration management, service discovery, circuit breakers, intelligent routing, micro-proxy, control bus, one-time tokens, global locks, leadership election, distributed sessions, cluster state). Coordination of distributed systems leads to boiler plate patterns, and using Spring Cloud developers can quickly stand up services and applications that implement those patterns. They will work well in any distributed environment, including the developer’s own laptop, bare metal data centres, and managed platforms such as Cloud Foundry.</p><h2>Features</h2><p>Spring Cloud focuses on providing good out of box experience for typical use cases and extensibility mechanism to cover others.</p><ul><li><p>Distributed/versioned configuration</p></li><li><p>Service registration and discovery</p></li><li><p>Routing</p></li><li><p>Service-to-service calls</p></li><li><p>Load balancing</p></li><li><p>Circuit Breakers</p></li><li><p>Global locks</p></li><li><p>Leadership election and cluster state</p></li><li><p>Distributed messaging</p></li></ul><h2>Getting Started</h2><h3>Generating A New Spring Cloud Project</h3><p>The easiest way to get started is visit&nbsp;<a href=\"https://start.spring.io/\">start.spring.io</a>, select your Spring Boot version and the Spring Cloud projects you want to use. This will add the corresponding Spring Cloud BOM version to your Maven/Gradle file when you generate the project.</p><h3>Adding Spring Cloud To An Existing Spring Boot Application</h3><p>If you an existing Spring Boot app you want to add Spring Cloud to that app, the first step is to determine the version of Spring Cloud you should use. The version you use in your app will depend on the version of Spring Boot you are using.</p><p></p><p>The table below outlines which version of Spring Cloud maps to which version of Spring Boot.</p>","success":true}
2022-04-28 15:15:46.442 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007109413474304[0;39m ------------- 结束 耗时：83 ms -------------
2022-04-28 15:15:47.002 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007112110411776[0;39m ------------- 开始 -------------
2022-04-28 15:15:47.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007112110411776[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/2 GET
2022-04-28 15:15:47.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007112110411776[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:15:47.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007112110411776[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:47.003 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007112110411776[0;39m 请求参数: [2]
2022-04-28 15:15:47.020 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007112110411776[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:15:47.020 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007112110411776[0;39m ==> Parameters: 2(Long)
2022-04-28 15:15:47.043 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007112110411776[0;39m <==    Columns: id, content
2022-04-28 15:15:47.044 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007112110411776[0;39m <==        Row: 2, <<BLOB>>
2022-04-28 15:15:47.044 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007112110411776[0;39m <==      Total: 1
2022-04-28 15:15:47.045 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007112110411776[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:15:47.045 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007112110411776[0;39m ==> Parameters: 2(Long)
2022-04-28 15:15:47.086 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007112110411776[0;39m <==    Updates: 1
2022-04-28 15:15:47.087 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007112110411776[0;39m 返回结果: {"content":"<p>Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can \"just run\".</p><p>We take an opinionated view of the Spring platform and third-party libraries so you can get started with minimum fuss. Most Spring Boot applications need minimal Spring configuration.</p><p>If you’re looking for information about a specific version, or instructions about how to upgrade from an earlier release, check out&nbsp;<a href=\"https://github.com/spring-projects/spring-boot/wiki#release-notes\">the project release notes section</a>&nbsp;on our wiki.</p><h2>Features</h2><ul><li><p>Create stand-alone Spring applications</p></li><li><p>Embed Tomcat, Jetty or Undertow directly (no need to deploy WAR files)</p></li><li><p>Provide opinionated 'starter' dependencies to simplify your build configuration</p></li><li><p>Automatically configure Spring and 3rd party libraries whenever possible</p></li><li><p>Provide production-ready features such as metrics, health checks, and externalized configuration</p></li><li><p>Absolutely no code generation and no requirement for XML configuration</p></li></ul><h2>Getting Started</h2><ul><li><p>Super quick — try the&nbsp;<a href=\"https://spring.io/quickstart\">Quickstart Guide</a>.</p></li><li><p>More general — try&nbsp;<a href=\"https://spring.io/guides/gs/spring-boot/\">Building an Application with Spring Boot</a></p></li><li><p>More specific — try&nbsp;<a href=\"https://spring.io/guides/gs/rest-service/\">Building a RESTful Web Service</a>.</p></li><li><p>Or search through all our guides on the&nbsp;<a href=\"https://spring.io/guides\">Guides</a>&nbsp;homepage.</p></li></ul><h2>Talks and videos</h2><ul><li><p><a href=\"https://content.pivotal.io/springone-platform-2017/its-a-kind-of-magic-under-the-covers-of-spring-boot-brian-clozel-st%C3%A9phane-nicoll\">It’s a Kind of Magic: Under the Covers of Spring Boot</a></p></li><li><p><a href=\"https://content.pivotal.io/springone-platform-2017/whats-new-in-spring-boot-2-0-phillip-webb-madhura-bhave\">What’s New in Spring Boot 2.0</a></p></li><li><p><a href=\"https://content.pivotal.io/webinars/mar-13-introducing-spring-boot-2-0-webinar\">Introducing Spring Boot 2.0 webinar</a></p></li><li><p><a href=\"https://content.pivotal.io/springone-platform-2017/test-driven-development-with-spring-boot-sannidhi-jalukar-madhura-bhave\">Test Driven Development with Spring Boot</a></p></li><li><p><a href=\"https://content.pivotal.io/springone-platform-2017/from-zero-to-hero-with-spring-boot-brian-clozel\">From Zero to Hero with Spring Boot 2.0</a></p></li></ul><p></p><p>You can also join the&nbsp;<a href=\"https://gitter.im/spring-projects/spring-boot\">Spring Boot community on Gitter</a>!</p>","success":true}
2022-04-28 15:15:47.087 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007112110411776[0;39m ------------- 结束 耗时：85 ms -------------
2022-04-28 15:15:48.176 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007117034524672[0;39m ------------- 开始 -------------
2022-04-28 15:15:48.177 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007117034524672[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/4 GET
2022-04-28 15:15:48.177 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007117034524672[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:15:48.177 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007117034524672[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:48.177 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007117034524672[0;39m 请求参数: [4]
2022-04-28 15:15:48.208 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007117034524672[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:15:48.209 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007117034524672[0;39m ==> Parameters: 4(Long)
2022-04-28 15:15:48.227 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007117034524672[0;39m <==    Columns: id, content
2022-04-28 15:15:48.227 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007117034524672[0;39m <==        Row: 4, <<BLOB>>
2022-04-28 15:15:48.228 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007117034524672[0;39m <==      Total: 1
2022-04-28 15:15:48.228 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007117034524672[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:15:48.228 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007117034524672[0;39m ==> Parameters: 4(Long)
2022-04-28 15:15:48.269 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007117034524672[0;39m <==    Updates: 1
2022-04-28 15:15:48.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007117034524672[0;39m 返回结果: {"content":"<p>Spring Cloud provides tools for developers to quickly build some of the common patterns in distributed systems (e.g. configuration management, service discovery, circuit breakers, intelligent routing, micro-proxy, control bus, one-time tokens, global locks, leadership election, distributed sessions, cluster state). Coordination of distributed systems leads to boiler plate patterns, and using Spring Cloud developers can quickly stand up services and applications that implement those patterns. They will work well in any distributed environment, including the developer’s own laptop, bare metal data centres, and managed platforms such as Cloud Foundry.</p><h2>Features</h2><p>Spring Cloud focuses on providing good out of box experience for typical use cases and extensibility mechanism to cover others.</p><ul><li><p>Distributed/versioned configuration</p></li><li><p>Service registration and discovery</p></li><li><p>Routing</p></li><li><p>Service-to-service calls</p></li><li><p>Load balancing</p></li><li><p>Circuit Breakers</p></li><li><p>Global locks</p></li><li><p>Leadership election and cluster state</p></li><li><p>Distributed messaging</p></li></ul><h2>Getting Started</h2><h3>Generating A New Spring Cloud Project</h3><p>The easiest way to get started is visit&nbsp;<a href=\"https://start.spring.io/\">start.spring.io</a>, select your Spring Boot version and the Spring Cloud projects you want to use. This will add the corresponding Spring Cloud BOM version to your Maven/Gradle file when you generate the project.</p><h3>Adding Spring Cloud To An Existing Spring Boot Application</h3><p>If you an existing Spring Boot app you want to add Spring Cloud to that app, the first step is to determine the version of Spring Cloud you should use. The version you use in your app will depend on the version of Spring Boot you are using.</p><p></p><p>The table below outlines which version of Spring Cloud maps to which version of Spring Boot.</p>","success":true}
2022-04-28 15:15:48.270 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007117034524672[0;39m ------------- 结束 耗时：94 ms -------------
2022-04-28 15:15:48.930 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007120197029888[0;39m ------------- 开始 -------------
2022-04-28 15:15:48.930 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007120197029888[0;39m 请求地址: http://127.0.0.1:8080/doc/find-content/6 GET
2022-04-28 15:15:48.930 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007120197029888[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.findContent
2022-04-28 15:15:48.931 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007120197029888[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:48.931 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007120197029888[0;39m 请求参数: [6]
2022-04-28 15:15:48.952 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007120197029888[0;39m ==>  Preparing: select id , content from content where id = ?
2022-04-28 15:15:48.953 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007120197029888[0;39m ==> Parameters: 6(Long)
2022-04-28 15:15:48.972 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007120197029888[0;39m <==    Columns: id, content
2022-04-28 15:15:48.972 TRACE c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :143  [32m175007120197029888[0;39m <==        Row: 6, <<BLOB>>
2022-04-28 15:15:48.972 DEBUG c.a.wiki.mapper.ContentMapper.selectByPrimaryKey  :137  [32m175007120197029888[0;39m <==      Total: 1
2022-04-28 15:15:48.973 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007120197029888[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2022-04-28 15:15:48.973 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007120197029888[0;39m ==> Parameters: 6(Long)
2022-04-28 15:15:49.011 DEBUG c.a.wiki.mapper.DocMapperCust.increaseViewCount   :137  [32m175007120197029888[0;39m <==    Updates: 1
2022-04-28 15:15:49.012 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007120197029888[0;39m 返回结果: {"content":"<p><iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/9SGDpanrc8U\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\"></iframe></p>","success":true}
2022-04-28 15:15:49.012 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007120197029888[0;39m ------------- 结束 耗时：82 ms -------------
2022-04-28 15:15:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007124697518080[0;39m 生成今日电子书快照开始
2022-04-28 15:15:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007124697518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007124697518080[0;39m ==> Parameters: 
2022-04-28 15:15:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007124697518080[0;39m <==    Updates: 0
2022-04-28 15:15:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007124697518080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-28 15:15:51.335 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007130284331008[0;39m ------------- 开始 -------------
2022-04-28 15:15:51.335 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007130284331008[0;39m 请求地址: http://127.0.0.1:8080/doc/vote/6 GET
2022-04-28 15:15:51.335 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007130284331008[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.vote
2022-04-28 15:15:51.335 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007130284331008[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:51.336 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007130284331008[0;39m 请求参数: [6]
2022-04-28 15:15:51.506 INFO  com.ameliawiki.wiki.util.RedisUtil                :30   [32m175007130284331008[0;39m key not exist，put：DOC_VOTE6_127.0.0.1，outdated 86400 secs
2022-04-28 15:15:51.701 DEBUG c.a.wiki.mapper.DocMapperCust.increaseVoteCount   :137  [32m175007130284331008[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2022-04-28 15:15:51.701 DEBUG c.a.wiki.mapper.DocMapperCust.increaseVoteCount   :137  [32m175007130284331008[0;39m ==> Parameters: 6(Long)
2022-04-28 15:15:51.742 DEBUG c.a.wiki.mapper.DocMapperCust.increaseVoteCount   :137  [32m175007130284331008[0;39m <==    Updates: 1
2022-04-28 15:15:51.743 DEBUG c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :137  [32m175007130284331008[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2022-04-28 15:15:51.743 DEBUG c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :137  [32m175007130284331008[0;39m ==> Parameters: 6(Long)
2022-04-28 15:15:51.762 TRACE c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :143  [32m175007130284331008[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-04-28 15:15:51.763 TRACE c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :143  [32m175007130284331008[0;39m <==        Row: 6, 1, 5, video, 1, 13, 2
2022-04-28 15:15:51.763 DEBUG c.a.wiki.mapper.DocMapper.selectByPrimaryKey      :137  [32m175007130284331008[0;39m <==      Total: 1
2022-04-28 15:15:51.764 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007130284331008[0;39m 返回结果: {"success":true}
2022-04-28 15:15:51.764 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :71   [32m175007130284331008[0;39m 推送消息：2GdcVGKMck，内容：video is liked!
2022-04-28 15:15:51.764 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007130284331008[0;39m ------------- 结束 耗时：429 ms -------------
2022-04-28 15:15:54.112 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007141931913216[0;39m ------------- 开始 -------------
2022-04-28 15:15:54.112 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007141931913218[0;39m ------------- 开始 -------------
2022-04-28 15:15:54.112 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007141931913217[0;39m ------------- 开始 -------------
2022-04-28 15:15:54.112 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007141931913216[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:15:54.112 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007141931913218[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007141931913217[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007141931913216[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007141931913218[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007141931913217[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007141931913216[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007141931913218[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007141931913217[0;39m 远程地址: 127.0.0.1
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007141931913216[0;39m 请求参数: []
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007141931913218[0;39m 请求参数: []
2022-04-28 15:15:54.113 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007141931913217[0;39m 请求参数: []
2022-04-28 15:15:54.131 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007141931913218[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:15:54.131 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007141931913218[0;39m ==> Parameters: 
2022-04-28 15:15:54.137 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007141931913217[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:15:54.137 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007141931913217[0;39m ==> Parameters: 
2022-04-28 15:15:54.139 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007141931913216[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:15:54.139 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007141931913216[0;39m ==> Parameters: 
2022-04-28 15:15:54.151 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:15:54.151 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:15:54.152 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:15:54.152 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:15:54.152 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:15:54.152 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:15:54.152 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:15:54.153 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:15:54.153 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:15:54.153 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:15:54.153 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:15:54.154 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:15:54.154 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007141931913218[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:15:54.154 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007141931913218[0;39m <==      Total: 12
2022-04-28 15:15:54.155 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007141931913218[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:15:54.155 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007141931913218[0;39m ------------- 结束 耗时：43 ms -------------
2022-04-28 15:15:54.155 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175007141931913217[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:15:54.155 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175007141931913217[0;39m <==        Row: 2022-04-28, 1730, 60, 1730, 60
2022-04-28 15:15:54.155 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007141931913217[0;39m <==      Total: 1
2022-04-28 15:15:54.156 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:15:54.156 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007141931913217[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1730,"viewIncrease":1730,"voteCount":60,"voteIncrease":60}],"success":true}
2022-04-28 15:15:54.156 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007141931913217[0;39m ------------- 结束 耗时：44 ms -------------
2022-04-28 15:15:54.156 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:15:54.156 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:15:54.156 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:15:54.156 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:15:54.157 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:15:54.157 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:15:54.157 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:15:54.157 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:15:54.158 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:15:54.158 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:15:54.158 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:15:54.158 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:15:54.158 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:15:54.159 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:15:54.159 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007141931913216[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:15:54.159 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007141931913216[0;39m <==      Total: 15
2022-04-28 15:15:54.160 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007141931913216[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:15:54.160 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007141931913216[0;39m ------------- 结束 耗时：48 ms -------------
2022-04-28 15:15:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007145664843776[0;39m 生成今日电子书快照开始
2022-04-28 15:15:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007145664843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:15:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007145664843776[0;39m ==> Parameters: 
2022-04-28 15:15:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007145664843776[0;39m <==    Updates: 0
2022-04-28 15:15:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007145664843776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:16:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007166627975168[0;39m 生成今日电子书快照开始
2022-04-28 15:16:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007166627975168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007166627975168[0;39m ==> Parameters: 
2022-04-28 15:16:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007166627975168[0;39m <==    Updates: 0
2022-04-28 15:16:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007166627975168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:16:05.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007187599495168[0;39m 生成今日电子书快照开始
2022-04-28 15:16:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007187599495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007187599495168[0;39m ==> Parameters: 
2022-04-28 15:16:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007187599495168[0;39m <==    Updates: 0
2022-04-28 15:16:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007187599495168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:16:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175007187846959104[0;39m start updating Ebook doc
2022-04-28 15:16:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007187846959104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:16:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007187846959104[0;39m ==> Parameters: 
2022-04-28 15:16:05.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007187846959104[0;39m <==    Updates: 1
2022-04-28 15:16:05.097 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175007187846959104[0;39m update ends, take 38 millisecs
2022-04-28 15:16:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007208587792384[0;39m 生成今日电子书快照开始
2022-04-28 15:16:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007208587792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007208587792384[0;39m ==> Parameters: 
2022-04-28 15:16:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007208587792384[0;39m <==    Updates: 0
2022-04-28 15:16:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007208587792384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-28 15:16:12.582 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007219400708096[0;39m ------------- 开始 -------------
2022-04-28 15:16:12.582 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007219400708096[0;39m 请求地址: http://127.0.0.1:8080/user/login POST
2022-04-28 15:16:12.583 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007219400708096[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.login
2022-04-28 15:16:12.583 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007219400708096[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:12.583 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007219400708096[0;39m 请求参数: [{"loginName":"test1"}]
2022-04-28 15:16:12.607 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175007219400708096[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2022-04-28 15:16:12.607 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175007219400708096[0;39m ==> Parameters: test1(String)
2022-04-28 15:16:12.629 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175007219400708096[0;39m <==    Columns: id, login_name, name, password
2022-04-28 15:16:12.629 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175007219400708096[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-28 15:16:12.630 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175007219400708096[0;39m <==      Total: 1
2022-04-28 15:16:12.630 INFO  com.ameliawiki.wiki.controller.UserController     :75   [32m175007219400708096[0;39m generate single sign-on token：175007219602034688，and put it into redis
2022-04-28 15:16:12.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007219400708096[0;39m 返回结果: {"content":{"id":1,"loginName":"test1","name":"test1","token":"175007219602034688"},"success":true}
2022-04-28 15:16:12.804 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007219400708096[0;39m ------------- 结束 耗时：222 ms -------------
2022-04-28 15:16:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007229559312384[0;39m 生成今日电子书快照开始
2022-04-28 15:16:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007229559312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007229559312384[0;39m ==> Parameters: 
2022-04-28 15:16:15.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007229559312384[0;39m <==    Updates: 0
2022-04-28 15:16:15.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007229559312384[0;39m 生成今日电子书快照结束，耗时：78毫秒
2022-04-28 15:16:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007250539220992[0;39m 生成今日电子书快照开始
2022-04-28 15:16:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007250539220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007250539220992[0;39m ==> Parameters: 
2022-04-28 15:16:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007250539220992[0;39m <==    Updates: 0
2022-04-28 15:16:20.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007250539220992[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-28 15:16:20.272 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :29   [32m175007100680933376[0;39m ------------- LoginInterceptor start -------------
2022-04-28 15:16:20.272 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :40   [32m175007100680933376[0;39m 接口登录拦截：，path：http://127.0.0.1:8080/user/list
2022-04-28 15:16:20.272 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :44   [32m175007100680933376[0;39m 登录校验开始，token：175007219602034688
2022-04-28 15:16:20.442 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :56   [32m175007100680933376[0;39m 已登录：{"id":1,"loginName":"test1","name":"test1","token":"175007219602034688"}
2022-04-28 15:16:20.444 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007252376326144[0;39m ------------- 开始 -------------
2022-04-28 15:16:20.444 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007252376326144[0;39m 请求地址: http://127.0.0.1:8080/user/list GET
2022-04-28 15:16:20.444 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007252376326144[0;39m 类名方法: com.ameliawiki.wiki.controller.UserController.list
2022-04-28 15:16:20.444 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007252376326144[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:20.445 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007252376326144[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-28 15:16:20.446 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175007252376326144[0;39m ==>  Preparing: SELECT count(0) FROM user
2022-04-28 15:16:20.446 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175007252376326144[0;39m ==> Parameters: 
2022-04-28 15:16:20.463 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175007252376326144[0;39m <==    Columns: count(0)
2022-04-28 15:16:20.464 TRACE c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :143  [32m175007252376326144[0;39m <==        Row: 1
2022-04-28 15:16:20.464 DEBUG c.a.wiki.mapper.UserMapper.selectByExample_COUNT  :137  [32m175007252376326144[0;39m <==      Total: 1
2022-04-28 15:16:20.465 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175007252376326144[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2022-04-28 15:16:20.465 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175007252376326144[0;39m ==> Parameters: 10(Integer)
2022-04-28 15:16:20.485 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175007252376326144[0;39m <==    Columns: id, login_name, name, password
2022-04-28 15:16:20.486 TRACE c.a.wiki.mapper.UserMapper.selectByExample        :143  [32m175007252376326144[0;39m <==        Row: 1, test1, test1, 7354a1d413535a6c0dc5c209e198d799
2022-04-28 15:16:20.486 DEBUG c.a.wiki.mapper.UserMapper.selectByExample        :137  [32m175007252376326144[0;39m <==      Total: 1
2022-04-28 15:16:20.486 INFO  com.ameliawiki.wiki.service.UserService           :49   [32m175007252376326144[0;39m 总行数：1
2022-04-28 15:16:20.487 INFO  com.ameliawiki.wiki.service.UserService           :50   [32m175007252376326144[0;39m 总页数：1
2022-04-28 15:16:20.487 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007252376326144[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test1","name":"test1"}],"total":1},"success":true}
2022-04-28 15:16:20.487 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007252376326144[0;39m ------------- 结束 耗时：43 ms -------------
2022-04-28 15:16:20.488 INFO  com.ameliawiki.wiki.interceptor.LoginInterceptor  :64   [32m175007252376326144[0;39m ------------- LoginInterceptor 结束 耗时：216 ms -------------
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007258357403650[0;39m ------------- 开始 -------------
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007258357403649[0;39m ------------- 开始 -------------
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007258357403648[0;39m ------------- 开始 -------------
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007258357403650[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007258357403649[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-30-statistic GET
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007258357403648[0;39m 请求地址: http://127.0.0.1:8080/ebook-snapshot/get-statistic GET
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007258357403650[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007258357403649[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.get30Statistic
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007258357403648[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookSnapshotController.getStatistic
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007258357403650[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007258357403649[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007258357403648[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007258357403650[0;39m 请求参数: []
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007258357403649[0;39m 请求参数: []
2022-04-28 15:16:21.870 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007258357403648[0;39m 请求参数: []
2022-04-28 15:16:21.894 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007258357403649[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:16:21.895 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007258357403649[0;39m ==> Parameters: 
2022-04-28 15:16:21.897 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007258357403648[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2022-04-28 15:16:21.897 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007258357403648[0;39m ==> Parameters: 
2022-04-28 15:16:21.901 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007258357403650[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:16:21.902 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007258357403650[0;39m ==> Parameters: 
2022-04-28 15:16:21.914 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175007258357403648[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2022-04-28 15:16:21.915 TRACE c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m175007258357403648[0;39m <==        Row: 2022-04-28, 1735, 61, 1735, 61
2022-04-28 15:16:21.915 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==    Columns: date, viewIncrease, voteIncrease
2022-04-28 15:16:21.915 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-15, 1430, 12
2022-04-28 15:16:21.915 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m175007258357403648[0;39m <==      Total: 1
2022-04-28 15:16:21.915 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-16, 10, 23
2022-04-28 15:16:21.916 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007258357403648[0;39m 返回结果: {"content":[{"date":1651129200000,"viewCount":1735,"viewIncrease":1735,"voteCount":61,"voteIncrease":61}],"success":true}
2022-04-28 15:16:21.916 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007258357403648[0;39m ------------- 结束 耗时：46 ms -------------
2022-04-28 15:16:21.916 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-17, 284, 28
2022-04-28 15:16:21.916 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-18, 0, 0
2022-04-28 15:16:21.917 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-19, 0, 0
2022-04-28 15:16:21.917 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-20, 0, 0
2022-04-28 15:16:21.918 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-21, 0, 0
2022-04-28 15:16:21.918 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-22, 2, 1
2022-04-28 15:16:21.919 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-23, 0, 0
2022-04-28 15:16:21.919 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-24, 0, 0
2022-04-28 15:16:21.919 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-25, 0, 0
2022-04-28 15:16:21.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:16:21.920 TRACE c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m175007258357403649[0;39m <==        Row: 2022-04-26, 0, 0
2022-04-28 15:16:21.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:16:21.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:16:21.920 DEBUG c.a.w.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m175007258357403649[0;39m <==      Total: 12
2022-04-28 15:16:21.920 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:16:21.921 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:16:21.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007258357403649[0;39m 返回结果: {"content":[{"date":1650006000000,"viewCount":0,"viewIncrease":1430,"voteCount":0,"voteIncrease":12},{"date":1650092400000,"viewCount":0,"viewIncrease":10,"voteCount":0,"voteIncrease":23},{"date":1650178800000,"viewCount":0,"viewIncrease":284,"voteCount":0,"voteIncrease":28},{"date":1650265200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650351600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650438000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650524400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650610800000,"viewCount":0,"viewIncrease":2,"voteCount":0,"voteIncrease":1},{"date":1650697200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650783600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650870000000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1650956400000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2022-04-28 15:16:21.921 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:16:21.921 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007258357403649[0;39m ------------- 结束 耗时：51 ms -------------
2022-04-28 15:16:21.921 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:16:21.921 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:16:21.921 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:16:21.922 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:16:21.922 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:16:21.922 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:16:21.922 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:16:21.923 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:16:21.923 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:16:21.923 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007258357403650[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:16:21.923 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007258357403650[0;39m <==      Total: 15
2022-04-28 15:16:21.924 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007258357403650[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:16:21.924 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007258357403650[0;39m ------------- 结束 耗时：54 ms -------------
2022-04-28 15:16:24.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007270504108032[0;39m ------------- 开始 -------------
2022-04-28 15:16:24.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007270504108032[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:16:24.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007270504108032[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:16:24.766 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007270504108032[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:24.767 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007270504108032[0;39m 请求参数: []
2022-04-28 15:16:24.783 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007270504108032[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:16:24.783 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007270504108032[0;39m ==> Parameters: 
2022-04-28 15:16:24.801 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:16:24.802 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:16:24.802 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:16:24.802 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:16:24.802 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:16:24.803 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:16:24.803 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:16:24.803 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:16:24.803 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:16:24.803 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:16:24.804 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:16:24.804 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:16:24.804 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:16:24.804 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:16:24.804 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:16:24.805 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007270504108032[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:16:24.805 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007270504108032[0;39m <==      Total: 15
2022-04-28 15:16:24.805 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007270504108032[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:16:24.806 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007270504108032[0;39m ------------- 结束 耗时：40 ms -------------
2022-04-28 15:16:24.826 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007270755766272[0;39m ------------- 开始 -------------
2022-04-28 15:16:24.826 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007270755766272[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:16:24.826 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007270755766272[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:16:24.827 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007270755766272[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:24.827 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007270755766272[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-28 15:16:24.843 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007270755766272[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-28 15:16:24.844 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007270755766272[0;39m ==> Parameters: 
2022-04-28 15:16:24.863 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007270755766272[0;39m <==    Columns: count(0)
2022-04-28 15:16:24.864 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007270755766272[0;39m <==        Row: 5
2022-04-28 15:16:24.864 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007270755766272[0;39m <==      Total: 1
2022-04-28 15:16:24.865 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007270755766272[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-28 15:16:24.865 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007270755766272[0;39m ==> Parameters: 10(Integer)
2022-04-28 15:16:24.885 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007270755766272[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:16:24.886 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007270755766272[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 80, 8
2022-04-28 15:16:24.886 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007270755766272[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:16:24.886 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007270755766272[0;39m <==        Row: 3, Python Tutorial, null, null, Introduction to programming with Python, null, 10, 75, 10
2022-04-28 15:16:24.887 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007270755766272[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-28 15:16:24.887 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007270755766272[0;39m <==        Row: 5, Oracle Tutorial, null, null, Introduction to Oracle, null, 11, 1123, 2
2022-04-28 15:16:24.887 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007270755766272[0;39m <==      Total: 5
2022-04-28 15:16:24.888 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007270755766272[0;39m total rows：5
2022-04-28 15:16:24.888 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007270755766272[0;39m total pages：1
2022-04-28 15:16:24.888 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007270755766272[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":80,"voteCount":8},{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-28 15:16:24.888 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007270755766272[0;39m ------------- 结束 耗时：62 ms -------------
2022-04-28 15:16:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007271493963776[0;39m 生成今日电子书快照开始
2022-04-28 15:16:25.002 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007271493963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:25.002 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007271493963776[0;39m ==> Parameters: 
2022-04-28 15:16:25.041 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007271493963776[0;39m <==    Updates: 0
2022-04-28 15:16:25.041 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007271493963776[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-28 15:16:27.134 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007280436219904[0;39m ------------- 开始 -------------
2022-04-28 15:16:27.134 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007280436219904[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:16:27.134 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007280436219904[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:16:27.135 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007280436219904[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:27.135 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007280436219904[0;39m 请求参数: []
2022-04-28 15:16:27.158 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007280436219904[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:16:27.159 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007280436219904[0;39m ==> Parameters: 
2022-04-28 15:16:27.182 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:16:27.182 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:16:27.182 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:16:27.182 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:16:27.182 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:16:27.183 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:16:27.183 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:16:27.183 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:16:27.183 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:16:27.183 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:16:27.184 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:16:27.184 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:16:27.185 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:16:27.185 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:16:27.185 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:16:27.185 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007280436219904[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:16:27.185 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007280436219904[0;39m <==      Total: 15
2022-04-28 15:16:27.186 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007280436219904[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:16:27.186 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007280436219904[0;39m ------------- 结束 耗时：52 ms -------------
2022-04-28 15:16:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007292461289472[0;39m 生成今日电子书快照开始
2022-04-28 15:16:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007292461289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007292461289472[0;39m ==> Parameters: 
2022-04-28 15:16:30.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007292461289472[0;39m <==    Updates: 0
2022-04-28 15:16:30.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007292461289472[0;39m 生成今日电子书快照结束，耗时：83毫秒
2022-04-28 15:16:30.615 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007295036592128[0;39m ------------- 开始 -------------
2022-04-28 15:16:30.615 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007295036592128[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:16:30.615 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007295036592128[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:16:30.615 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007295036592128[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:30.616 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007295036592128[0;39m 请求参数: []
2022-04-28 15:16:30.635 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007295036592128[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:16:30.636 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007295036592128[0;39m ==> Parameters: 
2022-04-28 15:16:30.659 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:16:30.660 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:16:30.660 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:16:30.661 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:16:30.661 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:16:30.661 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:16:30.661 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:16:30.662 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:16:30.662 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:16:30.662 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:16:30.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:16:30.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:16:30.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:16:30.663 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:16:30.664 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:16:30.664 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007295036592128[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:16:30.664 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007295036592128[0;39m <==      Total: 15
2022-04-28 15:16:30.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007295036592128[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:16:30.665 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007295036592128[0;39m ------------- 结束 耗时：50 ms -------------
2022-04-28 15:16:32.561 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007303198707712[0;39m ------------- 开始 -------------
2022-04-28 15:16:32.561 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007303198707712[0;39m 请求地址: http://127.0.0.1:8080/category/all GET
2022-04-28 15:16:32.561 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007303198707712[0;39m 类名方法: com.ameliawiki.wiki.controller.CategoryController.all
2022-04-28 15:16:32.561 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007303198707712[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:32.561 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007303198707712[0;39m 请求参数: []
2022-04-28 15:16:32.585 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007303198707712[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2022-04-28 15:16:32.586 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007303198707712[0;39m ==> Parameters: 
2022-04-28 15:16:32.604 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==    Columns: id, parent, name, sort
2022-04-28 15:16:32.604 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 100, 0, Front end development, 100
2022-04-28 15:16:32.605 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 101, 100, Vue, 101
2022-04-28 15:16:32.605 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 102, 100, HTML & CSS, 102
2022-04-28 15:16:32.605 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 200, 0, Java, 200
2022-04-28 15:16:32.606 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 201, 200, Basics, 201
2022-04-28 15:16:32.606 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 202, 200, Frameworks, 202
2022-04-28 15:16:32.606 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 300, 0, Python, 300
2022-04-28 15:16:32.607 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 301, 300, Basic application, 301
2022-04-28 15:16:32.607 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 302, 300, Advanced application, 302
2022-04-28 15:16:32.607 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 400, 0, Database, 400
2022-04-28 15:16:32.608 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 401, 400, MySQL, 401
2022-04-28 15:16:32.608 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 500, 0, Others, 500
2022-04-28 15:16:32.608 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 501, 500, Servers, 501
2022-04-28 15:16:32.608 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 502, 500, Tools, 502
2022-04-28 15:16:32.608 TRACE c.a.wiki.mapper.CategoryMapper.selectByExample    :143  [32m175007303198707712[0;39m <==        Row: 503, 500, Languages, 503
2022-04-28 15:16:32.609 DEBUG c.a.wiki.mapper.CategoryMapper.selectByExample    :137  [32m175007303198707712[0;39m <==      Total: 15
2022-04-28 15:16:32.610 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007303198707712[0;39m 返回结果: {"content":[{"id":100,"name":"Front end development","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"Basics","parent":200,"sort":201},{"id":202,"name":"Frameworks","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"Basic application","parent":300,"sort":301},{"id":302,"name":"Advanced application","parent":300,"sort":302},{"id":400,"name":"Database","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"Others","parent":0,"sort":500},{"id":501,"name":"Servers","parent":500,"sort":501},{"id":502,"name":"Tools","parent":500,"sort":502},{"id":503,"name":"Languages","parent":500,"sort":503}],"success":true}
2022-04-28 15:16:32.610 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007303198707712[0;39m ------------- 结束 耗时：49 ms -------------
2022-04-28 15:16:32.627 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007303475531776[0;39m ------------- 开始 -------------
2022-04-28 15:16:32.627 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007303475531776[0;39m 请求地址: http://127.0.0.1:8080/ebook/list GET
2022-04-28 15:16:32.628 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007303475531776[0;39m 类名方法: com.ameliawiki.wiki.controller.EbookController.list
2022-04-28 15:16:32.628 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007303475531776[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:32.628 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007303475531776[0;39m 请求参数: [{"page":1,"size":10}]
2022-04-28 15:16:32.629 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007303475531776[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2022-04-28 15:16:32.629 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007303475531776[0;39m ==> Parameters: 
2022-04-28 15:16:32.649 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007303475531776[0;39m <==    Columns: count(0)
2022-04-28 15:16:32.650 TRACE c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :143  [32m175007303475531776[0;39m <==        Row: 5
2022-04-28 15:16:32.651 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample_COUNT :137  [32m175007303475531776[0;39m <==      Total: 1
2022-04-28 15:16:32.651 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007303475531776[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2022-04-28 15:16:32.652 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007303475531776[0;39m ==> Parameters: 10(Integer)
2022-04-28 15:16:32.672 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007303475531776[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2022-04-28 15:16:32.672 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007303475531776[0;39m <==        Row: 1, SpringBoot Tutorial, 200, 202, Introduce how to create a SpringBoot project, null, 6, 80, 8
2022-04-28 15:16:32.673 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007303475531776[0;39m <==        Row: 2, Vue Tutorial, 200, 201, Introduce how to build front end with Vue, null, 8, 136, 20
2022-04-28 15:16:32.673 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007303475531776[0;39m <==        Row: 3, Python Tutorial, null, null, Introduction to programming with Python, null, 10, 75, 10
2022-04-28 15:16:32.674 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007303475531776[0;39m <==        Row: 4, MySQL Tutorial, null, null, Introduction to mySQL database, null, 12, 321, 21
2022-04-28 15:16:32.674 TRACE c.a.wiki.mapper.EbookMapper.selectByExample       :143  [32m175007303475531776[0;39m <==        Row: 5, Oracle Tutorial, null, null, Introduction to Oracle, null, 11, 1123, 2
2022-04-28 15:16:32.674 DEBUG c.a.wiki.mapper.EbookMapper.selectByExample       :137  [32m175007303475531776[0;39m <==      Total: 5
2022-04-28 15:16:32.675 INFO  com.ameliawiki.wiki.service.EbookService          :46   [32m175007303475531776[0;39m total rows：5
2022-04-28 15:16:32.675 INFO  com.ameliawiki.wiki.service.EbookService          :47   [32m175007303475531776[0;39m total pages：1
2022-04-28 15:16:32.675 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007303475531776[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"description":"Introduce how to create a SpringBoot project","docCount":6,"id":1,"name":"SpringBoot Tutorial","viewCount":80,"voteCount":8},{"category1Id":200,"category2Id":201,"description":"Introduce how to build front end with Vue","docCount":8,"id":2,"name":"Vue Tutorial","viewCount":136,"voteCount":20},{"description":"Introduction to programming with Python","docCount":10,"id":3,"name":"Python Tutorial","viewCount":75,"voteCount":10},{"description":"Introduction to mySQL database","docCount":12,"id":4,"name":"MySQL Tutorial","viewCount":321,"voteCount":21},{"description":"Introduction to Oracle","docCount":11,"id":5,"name":"Oracle Tutorial","viewCount":1123,"voteCount":2}],"total":5},"success":true}
2022-04-28 15:16:32.676 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007303475531776[0;39m ------------- 结束 耗时：49 ms -------------
2022-04-28 15:16:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175007313449586688[0;39m start updating Ebook doc
2022-04-28 15:16:35.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007313449586688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:16:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007313449586688[0;39m ==> Parameters: 
2022-04-28 15:16:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007313449586688[0;39m <==    Updates: 1
2022-04-28 15:16:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175007313449586688[0;39m update ends, take 56 millisecs
2022-04-28 15:16:35.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007313684467712[0;39m 生成今日电子书快照开始
2022-04-28 15:16:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007313684467712[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007313684467712[0;39m ==> Parameters: 
2022-04-28 15:16:35.101 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007313684467712[0;39m <==    Updates: 0
2022-04-28 15:16:35.101 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007313684467712[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-28 15:16:36.074 INFO  com.ameliawiki.wiki.aspect.LogAspect              :51   [32m175007317933297664[0;39m ------------- 开始 -------------
2022-04-28 15:16:36.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :52   [32m175007317933297664[0;39m 请求地址: http://127.0.0.1:8080/doc/all/1 GET
2022-04-28 15:16:36.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :53   [32m175007317933297664[0;39m 类名方法: com.ameliawiki.wiki.controller.DocController.all
2022-04-28 15:16:36.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :54   [32m175007317933297664[0;39m 远程地址: 127.0.0.1
2022-04-28 15:16:36.075 INFO  com.ameliawiki.wiki.aspect.LogAspect              :76   [32m175007317933297664[0;39m 请求参数: [1]
2022-04-28 15:16:36.089 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175007317933297664[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2022-04-28 15:16:36.090 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175007317933297664[0;39m ==> Parameters: 1(Long)
2022-04-28 15:16:36.109 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007317933297664[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2022-04-28 15:16:36.109 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007317933297664[0;39m <==        Row: 1, 1, 0, Spring Boot, 1, 24, 3
2022-04-28 15:16:36.109 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007317933297664[0;39m <==        Row: 2, 1, 1, Introduction, 1, 19, 1
2022-04-28 15:16:36.110 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007317933297664[0;39m <==        Row: 4, 1, 3, Spring Cloud, 1, 17, 1
2022-04-28 15:16:36.110 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007317933297664[0;39m <==        Row: 6, 1, 5, video, 1, 13, 2
2022-04-28 15:16:36.110 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007317933297664[0;39m <==        Row: 3, 1, 0, Learn, 2, 3, 0
2022-04-28 15:16:36.110 TRACE c.ameliawiki.wiki.mapper.DocMapper.selectByExample:143  [32m175007317933297664[0;39m <==        Row: 5, 1, 3, Video, 2, 4, 1
2022-04-28 15:16:36.110 DEBUG c.ameliawiki.wiki.mapper.DocMapper.selectByExample:137  [32m175007317933297664[0;39m <==      Total: 6
2022-04-28 15:16:36.111 INFO  com.ameliawiki.wiki.aspect.LogAspect              :89   [32m175007317933297664[0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Spring Boot","parent":0,"sort":1,"viewCount":24,"voteCount":3},{"ebookId":1,"id":2,"name":"Introduction","parent":1,"sort":1,"viewCount":19,"voteCount":1},{"ebookId":1,"id":4,"name":"Spring Cloud","parent":3,"sort":1,"viewCount":17,"voteCount":1},{"ebookId":1,"id":6,"name":"video","parent":5,"sort":1,"viewCount":13,"voteCount":2},{"ebookId":1,"id":3,"name":"Learn","parent":0,"sort":2,"viewCount":3,"voteCount":0},{"ebookId":1,"id":5,"name":"Video","parent":3,"sort":2,"viewCount":4,"voteCount":1}],"success":true}
2022-04-28 15:16:36.111 INFO  com.ameliawiki.wiki.aspect.LogAspect              :90   [32m175007317933297664[0;39m ------------- 结束 耗时：37 ms -------------
2022-04-28 15:16:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007334408523776[0;39m 生成今日电子书快照开始
2022-04-28 15:16:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007334408523776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007334408523776[0;39m ==> Parameters: 
2022-04-28 15:16:40.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007334408523776[0;39m <==    Updates: 0
2022-04-28 15:16:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007334408523776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-28 15:16:44.332 ERROR com.ameliawiki.wiki.websocket.WebSocketServer     :57   [32m175007258357403648[0;39m 发生错误
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1231)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1141)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:72)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:171)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:151)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:148)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:54)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
2022-04-28 15:16:44.333 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m175007258357403648[0;39m 连接关闭，token：2GdcVGKMck，session id：2！当前连接数：0
2022-04-28 15:16:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007355384238080[0;39m 生成今日电子书快照开始
2022-04-28 15:16:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007355384238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007355384238080[0;39m ==> Parameters: 
2022-04-28 15:16:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007355384238080[0;39m <==    Updates: 0
2022-04-28 15:16:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007355384238080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-28 15:16:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007376364146688[0;39m 生成今日电子书快照开始
2022-04-28 15:16:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007376364146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007376364146688[0;39m ==> Parameters: 
2022-04-28 15:16:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007376364146688[0;39m <==    Updates: 0
2022-04-28 15:16:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007376364146688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:16:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007397331472384[0;39m 生成今日电子书快照开始
2022-04-28 15:16:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007397331472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:16:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007397331472384[0;39m ==> Parameters: 
2022-04-28 15:16:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007397331472384[0;39m <==    Updates: 0
2022-04-28 15:16:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007397331472384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-28 15:17:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007418286215168[0;39m 生成今日电子书快照开始
2022-04-28 15:17:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007418286215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007418286215168[0;39m ==> Parameters: 
2022-04-28 15:17:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007418286215168[0;39m <==    Updates: 0
2022-04-28 15:17:00.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007418286215168[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-28 15:17:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007439261929472[0;39m 生成今日电子书快照开始
2022-04-28 15:17:05.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007439261929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007439261929472[0;39m ==> Parameters: 
2022-04-28 15:17:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007439261929472[0;39m <==    Updates: 0
2022-04-28 15:17:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007439261929472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-28 15:17:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175007439509393408[0;39m start updating Ebook doc
2022-04-28 15:17:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007439509393408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:17:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007439509393408[0;39m ==> Parameters: 
2022-04-28 15:17:05.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007439509393408[0;39m <==    Updates: 1
2022-04-28 15:17:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175007439509393408[0;39m update ends, take 46 millisecs
2022-04-28 15:17:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007460246032384[0;39m 生成今日电子书快照开始
2022-04-28 15:17:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007460246032384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007460246032384[0;39m ==> Parameters: 
2022-04-28 15:17:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007460246032384[0;39m <==    Updates: 0
2022-04-28 15:17:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007460246032384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-28 15:17:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007481209163776[0;39m 生成今日电子书快照开始
2022-04-28 15:17:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007481209163776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007481209163776[0;39m ==> Parameters: 
2022-04-28 15:17:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007481209163776[0;39m <==    Updates: 0
2022-04-28 15:17:15.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007481209163776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-28 15:17:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007502180683776[0;39m 生成今日电子书快照开始
2022-04-28 15:17:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007502180683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007502180683776[0;39m ==> Parameters: 
2022-04-28 15:17:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007502180683776[0;39m <==    Updates: 0
2022-04-28 15:17:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007502180683776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-28 15:17:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007523152203776[0;39m 生成今日电子书快照开始
2022-04-28 15:17:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007523152203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007523152203776[0;39m ==> Parameters: 
2022-04-28 15:17:25.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007523152203776[0;39m <==    Updates: 0
2022-04-28 15:17:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007523152203776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-28 15:17:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007544119529472[0;39m 生成今日电子书快照开始
2022-04-28 15:17:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007544119529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007544119529472[0;39m ==> Parameters: 
2022-04-28 15:17:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007544119529472[0;39m <==    Updates: 0
2022-04-28 15:17:30.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007544119529472[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-28 15:17:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m175007565091049472[0;39m 生成今日电子书快照开始
2022-04-28 15:17:35.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007565091049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-28 15:17:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007565091049472[0;39m ==> Parameters: 
2022-04-28 15:17:35.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m175007565091049472[0;39m <==    Updates: 0
2022-04-28 15:17:35.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m175007565091049472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-28 15:17:35.055 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m175007565317541888[0;39m start updating Ebook doc
2022-04-28 15:17:35.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007565317541888[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-28 15:17:35.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007565317541888[0;39m ==> Parameters: 
2022-04-28 15:17:35.093 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m175007565317541888[0;39m <==    Updates: 1
2022-04-28 15:17:35.093 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m175007565317541888[0;39m update ends, take 37 millisecs
