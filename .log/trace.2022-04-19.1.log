2022-04-19 08:57:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650444186226688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 08:57:35.062 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171650444425302016[0;39m start updating Ebook doc
2022-04-19 08:57:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650444425302016[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 08:57:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650444425302016[0;39m ==> Parameters: 
2022-04-19 08:57:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650444425302016[0;39m <==    Updates: 1
2022-04-19 08:57:35.101 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171650444425302016[0;39m update ends, take 39 millisecs
2022-04-19 08:57:40.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650465166135296[0;39m 生成今日电子书快照开始
2022-04-19 08:57:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650465166135296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:57:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650465166135296[0;39m ==> Parameters: 
2022-04-19 08:57:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650465166135296[0;39m <==    Updates: 0
2022-04-19 08:57:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650465166135296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 08:57:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650486125072384[0;39m 生成今日电子书快照开始
2022-04-19 08:57:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650486125072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:57:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650486125072384[0;39m ==> Parameters: 
2022-04-19 08:57:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650486125072384[0;39m <==    Updates: 0
2022-04-19 08:57:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650486125072384[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 08:57:50.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650507117563904[0;39m 生成今日电子书快照开始
2022-04-19 08:57:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650507117563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:57:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650507117563904[0;39m ==> Parameters: 
2022-04-19 08:57:50.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650507117563904[0;39m <==    Updates: 0
2022-04-19 08:57:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650507117563904[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 08:57:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650528076500992[0;39m 生成今日电子书快照开始
2022-04-19 08:57:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650528076500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:57:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650528076500992[0;39m ==> Parameters: 
2022-04-19 08:57:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650528076500992[0;39m <==    Updates: 0
2022-04-19 08:57:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650528076500992[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 08:58:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650549031243776[0;39m 生成今日电子书快照开始
2022-04-19 08:58:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650549031243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650549031243776[0;39m ==> Parameters: 
2022-04-19 08:58:00.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650549031243776[0;39m <==    Updates: 0
2022-04-19 08:58:00.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650549031243776[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-19 08:58:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650570011152384[0;39m 生成今日电子书快照开始
2022-04-19 08:58:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650570011152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650570011152384[0;39m ==> Parameters: 
2022-04-19 08:58:05.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650570011152384[0;39m <==    Updates: 0
2022-04-19 08:58:05.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650570011152384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 08:58:05.075 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171650570308947968[0;39m start updating Ebook doc
2022-04-19 08:58:05.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650570308947968[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 08:58:05.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650570308947968[0;39m ==> Parameters: 
2022-04-19 08:58:05.121 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650570308947968[0;39m <==    Updates: 1
2022-04-19 08:58:05.121 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171650570308947968[0;39m update ends, take 46 millisecs
2022-04-19 08:58:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650591003643904[0;39m 生成今日电子书快照开始
2022-04-19 08:58:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650591003643904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650591003643904[0;39m ==> Parameters: 
2022-04-19 08:58:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650591003643904[0;39m <==    Updates: 0
2022-04-19 08:58:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650591003643904[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 08:58:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650611962580992[0;39m 生成今日电子书快照开始
2022-04-19 08:58:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650611962580992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650611962580992[0;39m ==> Parameters: 
2022-04-19 08:58:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650611962580992[0;39m <==    Updates: 0
2022-04-19 08:58:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650611962580992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 08:58:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650632950878208[0;39m 生成今日电子书快照开始
2022-04-19 08:58:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650632950878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650632950878208[0;39m ==> Parameters: 
2022-04-19 08:58:20.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650632950878208[0;39m <==    Updates: 0
2022-04-19 08:58:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650632950878208[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 08:58:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650653897232384[0;39m 生成今日电子书快照开始
2022-04-19 08:58:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650653897232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650653897232384[0;39m ==> Parameters: 
2022-04-19 08:58:25.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650653897232384[0;39m <==    Updates: 0
2022-04-19 08:58:25.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650653897232384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 08:58:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650674877140992[0;39m 生成今日电子书快照开始
2022-04-19 08:58:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650674877140992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650674877140992[0;39m ==> Parameters: 
2022-04-19 08:58:30.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650674877140992[0;39m <==    Updates: 0
2022-04-19 08:58:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650674877140992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 08:58:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650695840272384[0;39m 生成今日电子书快照开始
2022-04-19 08:58:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650695840272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650695840272384[0;39m ==> Parameters: 
2022-04-19 08:58:35.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650695840272384[0;39m <==    Updates: 0
2022-04-19 08:58:35.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650695840272384[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 08:58:35.056 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171650696058376192[0;39m start updating Ebook doc
2022-04-19 08:58:35.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650696058376192[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 08:58:35.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650696058376192[0;39m ==> Parameters: 
2022-04-19 08:58:35.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650696058376192[0;39m <==    Updates: 1
2022-04-19 08:58:35.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171650696058376192[0;39m update ends, take 35 millisecs
2022-04-19 08:58:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650716836958208[0;39m 生成今日电子书快照开始
2022-04-19 08:58:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650716836958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650716836958208[0;39m ==> Parameters: 
2022-04-19 08:58:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650716836958208[0;39m <==    Updates: 0
2022-04-19 08:58:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650716836958208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 08:58:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650737770729472[0;39m 生成今日电子书快照开始
2022-04-19 08:58:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650737770729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650737770729472[0;39m ==> Parameters: 
2022-04-19 08:58:45.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650737770729472[0;39m <==    Updates: 0
2022-04-19 08:58:45.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650737770729472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 08:58:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650758759026688[0;39m 生成今日电子书快照开始
2022-04-19 08:58:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650758759026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650758759026688[0;39m ==> Parameters: 
2022-04-19 08:58:50.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650758759026688[0;39m <==    Updates: 0
2022-04-19 08:58:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650758759026688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 08:58:55.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650779738935296[0;39m 生成今日电子书快照开始
2022-04-19 08:58:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650779738935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:58:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650779738935296[0;39m ==> Parameters: 
2022-04-19 08:58:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650779738935296[0;39m <==    Updates: 0
2022-04-19 08:58:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650779738935296[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 08:59:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650800718843904[0;39m 生成今日电子书快照开始
2022-04-19 08:59:00.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650800718843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:00.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650800718843904[0;39m ==> Parameters: 
2022-04-19 08:59:00.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650800718843904[0;39m <==    Updates: 0
2022-04-19 08:59:00.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650800718843904[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 08:59:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171650821656809472[0;39m start updating Ebook doc
2022-04-19 08:59:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650821656809472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 08:59:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650821656809472[0;39m ==> Parameters: 
2022-04-19 08:59:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650821656809472[0;39m <==    Updates: 1
2022-04-19 08:59:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171650821656809472[0;39m update ends, take 65 millisecs
2022-04-19 08:59:05.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650821937827840[0;39m 生成今日电子书快照开始
2022-04-19 08:59:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650821937827840[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650821937827840[0;39m ==> Parameters: 
2022-04-19 08:59:05.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650821937827840[0;39m <==    Updates: 0
2022-04-19 08:59:05.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650821937827840[0;39m 生成今日电子书快照结束，耗时：36毫秒
2022-04-19 08:59:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650842653495296[0;39m 生成今日电子书快照开始
2022-04-19 08:59:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650842653495296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650842653495296[0;39m ==> Parameters: 
2022-04-19 08:59:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650842653495296[0;39m <==    Updates: 0
2022-04-19 08:59:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650842653495296[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 08:59:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650863637598208[0;39m 生成今日电子书快照开始
2022-04-19 08:59:15.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650863637598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:15.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650863637598208[0;39m ==> Parameters: 
2022-04-19 08:59:15.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650863637598208[0;39m <==    Updates: 0
2022-04-19 08:59:15.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650863637598208[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 08:59:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650884609118208[0;39m 生成今日电子书快照开始
2022-04-19 08:59:20.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650884609118208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:20.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650884609118208[0;39m ==> Parameters: 
2022-04-19 08:59:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650884609118208[0;39m <==    Updates: 0
2022-04-19 08:59:20.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650884609118208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 08:59:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650905576443904[0;39m 生成今日电子书快照开始
2022-04-19 08:59:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650905576443904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650905576443904[0;39m ==> Parameters: 
2022-04-19 08:59:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650905576443904[0;39m <==    Updates: 0
2022-04-19 08:59:25.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650905576443904[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 08:59:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650926518603776[0;39m 生成今日电子书快照开始
2022-04-19 08:59:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650926518603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650926518603776[0;39m ==> Parameters: 
2022-04-19 08:59:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650926518603776[0;39m <==    Updates: 0
2022-04-19 08:59:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650926518603776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-19 08:59:35.007 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171650947511095296[0;39m start updating Ebook doc
2022-04-19 08:59:35.030 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650947511095296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 08:59:35.031 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650947511095296[0;39m ==> Parameters: 
2022-04-19 08:59:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171650947511095296[0;39m <==    Updates: 1
2022-04-19 08:59:35.069 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171650947511095296[0;39m update ends, take 61 millisecs
2022-04-19 08:59:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650947775336448[0;39m 生成今日电子书快照开始
2022-04-19 08:59:35.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650947775336448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:35.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650947775336448[0;39m ==> Parameters: 
2022-04-19 08:59:35.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650947775336448[0;39m <==    Updates: 0
2022-04-19 08:59:35.112 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650947775336448[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-19 08:59:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650968461643776[0;39m 生成今日电子书快照开始
2022-04-19 08:59:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650968461643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650968461643776[0;39m ==> Parameters: 
2022-04-19 08:59:40.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650968461643776[0;39m <==    Updates: 0
2022-04-19 08:59:40.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650968461643776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 08:59:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171650989424775168[0;39m 生成今日电子书快照开始
2022-04-19 08:59:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650989424775168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650989424775168[0;39m ==> Parameters: 
2022-04-19 08:59:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171650989424775168[0;39m <==    Updates: 0
2022-04-19 08:59:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171650989424775168[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 08:59:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651010438238208[0;39m 生成今日电子书快照开始
2022-04-19 08:59:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651010438238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651010438238208[0;39m ==> Parameters: 
2022-04-19 08:59:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651010438238208[0;39m <==    Updates: 0
2022-04-19 08:59:50.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651010438238208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 08:59:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651031380398080[0;39m 生成今日电子书快照开始
2022-04-19 08:59:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651031380398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 08:59:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651031380398080[0;39m ==> Parameters: 
2022-04-19 08:59:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651031380398080[0;39m <==    Updates: 0
2022-04-19 08:59:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651031380398080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:00:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651052364500992[0;39m 生成今日电子书快照开始
2022-04-19 09:00:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651052364500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651052364500992[0;39m ==> Parameters: 
2022-04-19 09:00:00.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651052364500992[0;39m <==    Updates: 0
2022-04-19 09:00:00.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651052364500992[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:00:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651073315049472[0;39m start updating Ebook doc
2022-04-19 09:00:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651073315049472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:00:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651073315049472[0;39m ==> Parameters: 
2022-04-19 09:00:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651073315049472[0;39m <==    Updates: 1
2022-04-19 09:00:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651073315049472[0;39m update ends, take 67 millisecs
2022-04-19 09:00:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651073600262144[0;39m 生成今日电子书快照开始
2022-04-19 09:00:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651073600262144[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651073600262144[0;39m ==> Parameters: 
2022-04-19 09:00:05.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651073600262144[0;39m <==    Updates: 0
2022-04-19 09:00:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651073600262144[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-19 09:00:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651094290763776[0;39m 生成今日电子书快照开始
2022-04-19 09:00:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651094290763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651094290763776[0;39m ==> Parameters: 
2022-04-19 09:00:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651094290763776[0;39m <==    Updates: 0
2022-04-19 09:00:10.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651094290763776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:00:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651115253895168[0;39m 生成今日电子书快照开始
2022-04-19 09:00:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651115253895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651115253895168[0;39m ==> Parameters: 
2022-04-19 09:00:15.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651115253895168[0;39m <==    Updates: 0
2022-04-19 09:00:15.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651115253895168[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:00:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651136233803776[0;39m 生成今日电子书快照开始
2022-04-19 09:00:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651136233803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651136233803776[0;39m ==> Parameters: 
2022-04-19 09:00:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651136233803776[0;39m <==    Updates: 0
2022-04-19 09:00:20.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651136233803776[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:00:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651157213712384[0;39m 生成今日电子书快照开始
2022-04-19 09:00:25.152 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651157213712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:25.153 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651157213712384[0;39m ==> Parameters: 
2022-04-19 09:00:25.191 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651157213712384[0;39m <==    Updates: 0
2022-04-19 09:00:25.191 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651157213712384[0;39m 生成今日电子书快照结束，耗时：187毫秒
2022-04-19 09:00:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651178210398208[0;39m 生成今日电子书快照开始
2022-04-19 09:00:30.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651178210398208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:30.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651178210398208[0;39m ==> Parameters: 
2022-04-19 09:00:30.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651178210398208[0;39m <==    Updates: 0
2022-04-19 09:00:30.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651178210398208[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-19 09:00:35.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651199165140992[0;39m 生成今日电子书快照开始
2022-04-19 09:00:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651199165140992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651199165140992[0;39m ==> Parameters: 
2022-04-19 09:00:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651199165140992[0;39m <==    Updates: 0
2022-04-19 09:00:35.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651199165140992[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:00:35.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651199441965056[0;39m start updating Ebook doc
2022-04-19 09:00:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651199441965056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:00:35.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651199441965056[0;39m ==> Parameters: 
2022-04-19 09:00:35.113 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651199441965056[0;39m <==    Updates: 1
2022-04-19 09:00:35.113 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651199441965056[0;39m update ends, take 41 millisecs
2022-04-19 09:00:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651220119883776[0;39m 生成今日电子书快照开始
2022-04-19 09:00:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651220119883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651220119883776[0;39m ==> Parameters: 
2022-04-19 09:00:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651220119883776[0;39m <==    Updates: 0
2022-04-19 09:00:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651220119883776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:00:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651241124958208[0;39m 生成今日电子书快照开始
2022-04-19 09:00:45.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651241124958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:45.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651241124958208[0;39m ==> Parameters: 
2022-04-19 09:00:45.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651241124958208[0;39m <==    Updates: 0
2022-04-19 09:00:45.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651241124958208[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:00:50.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651262083895296[0;39m 生成今日电子书快照开始
2022-04-19 09:00:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651262083895296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651262083895296[0;39m ==> Parameters: 
2022-04-19 09:00:50.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651262083895296[0;39m <==    Updates: 0
2022-04-19 09:00:50.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651262083895296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:00:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651283051220992[0;39m 生成今日电子书快照开始
2022-04-19 09:00:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651283051220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:00:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651283051220992[0;39m ==> Parameters: 
2022-04-19 09:00:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651283051220992[0;39m <==    Updates: 0
2022-04-19 09:00:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651283051220992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:01:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651304001769472[0;39m 生成今日电子书快照开始
2022-04-19 09:01:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651304001769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651304001769472[0;39m ==> Parameters: 
2022-04-19 09:01:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651304001769472[0;39m <==    Updates: 0
2022-04-19 09:01:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651304001769472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:01:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651324973289472[0;39m 生成今日电子书快照开始
2022-04-19 09:01:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651324973289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651324973289472[0;39m ==> Parameters: 
2022-04-19 09:01:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651324973289472[0;39m <==    Updates: 0
2022-04-19 09:01:05.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651324973289472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:01:05.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651325254307840[0;39m start updating Ebook doc
2022-04-19 09:01:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651325254307840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:01:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651325254307840[0;39m ==> Parameters: 
2022-04-19 09:01:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651325254307840[0;39m <==    Updates: 1
2022-04-19 09:01:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651325254307840[0;39m update ends, take 37 millisecs
2022-04-19 09:01:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651345974169600[0;39m 生成今日电子书快照开始
2022-04-19 09:01:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651345974169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651345974169600[0;39m ==> Parameters: 
2022-04-19 09:01:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651345974169600[0;39m <==    Updates: 0
2022-04-19 09:01:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651345974169600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:01:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651366937300992[0;39m 生成今日电子书快照开始
2022-04-19 09:01:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651366937300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651366937300992[0;39m ==> Parameters: 
2022-04-19 09:01:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651366937300992[0;39m <==    Updates: 0
2022-04-19 09:01:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651366937300992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:01:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651387900432384[0;39m 生成今日电子书快照开始
2022-04-19 09:01:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651387900432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651387900432384[0;39m ==> Parameters: 
2022-04-19 09:01:20.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651387900432384[0;39m <==    Updates: 0
2022-04-19 09:01:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651387900432384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:01:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651408892923904[0;39m 生成今日电子书快照开始
2022-04-19 09:01:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651408892923904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651408892923904[0;39m ==> Parameters: 
2022-04-19 09:01:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651408892923904[0;39m <==    Updates: 0
2022-04-19 09:01:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651408892923904[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:01:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651429856055296[0;39m 生成今日电子书快照开始
2022-04-19 09:01:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651429856055296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651429856055296[0;39m ==> Parameters: 
2022-04-19 09:01:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651429856055296[0;39m <==    Updates: 0
2022-04-19 09:01:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651429856055296[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:01:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651450827575296[0;39m 生成今日电子书快照开始
2022-04-19 09:01:35.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651450827575296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:35.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651450827575296[0;39m ==> Parameters: 
2022-04-19 09:01:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651450827575296[0;39m <==    Updates: 0
2022-04-19 09:01:35.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651450827575296[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:01:35.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651451096010752[0;39m start updating Ebook doc
2022-04-19 09:01:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651451096010752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:01:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651451096010752[0;39m ==> Parameters: 
2022-04-19 09:01:35.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651451096010752[0;39m <==    Updates: 1
2022-04-19 09:01:35.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651451096010752[0;39m update ends, take 35 millisecs
2022-04-19 09:01:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651471803289600[0;39m 生成今日电子书快照开始
2022-04-19 09:01:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651471803289600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651471803289600[0;39m ==> Parameters: 
2022-04-19 09:01:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651471803289600[0;39m <==    Updates: 0
2022-04-19 09:01:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651471803289600[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:01:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651492783198208[0;39m 生成今日电子书快照开始
2022-04-19 09:01:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651492783198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651492783198208[0;39m ==> Parameters: 
2022-04-19 09:01:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651492783198208[0;39m <==    Updates: 0
2022-04-19 09:01:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651492783198208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:01:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651513754718208[0;39m 生成今日电子书快照开始
2022-04-19 09:01:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651513754718208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651513754718208[0;39m ==> Parameters: 
2022-04-19 09:01:50.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651513754718208[0;39m <==    Updates: 0
2022-04-19 09:01:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651513754718208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:01:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651534717849600[0;39m 生成今日电子书快照开始
2022-04-19 09:01:55.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651534717849600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:01:55.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651534717849600[0;39m ==> Parameters: 
2022-04-19 09:01:55.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651534717849600[0;39m <==    Updates: 0
2022-04-19 09:01:55.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651534717849600[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-19 09:02:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651555676786688[0;39m 生成今日电子书快照开始
2022-04-19 09:02:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651555676786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651555676786688[0;39m ==> Parameters: 
2022-04-19 09:02:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651555676786688[0;39m <==    Updates: 0
2022-04-19 09:02:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651555676786688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:02:05.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651576660889600[0;39m 生成今日电子书快照开始
2022-04-19 09:02:05.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651576660889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:05.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651576660889600[0;39m ==> Parameters: 
2022-04-19 09:02:05.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651576660889600[0;39m <==    Updates: 0
2022-04-19 09:02:05.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651576660889600[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 09:02:05.077 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651576950296576[0;39m start updating Ebook doc
2022-04-19 09:02:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651576950296576[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:02:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651576950296576[0;39m ==> Parameters: 
2022-04-19 09:02:05.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651576950296576[0;39m <==    Updates: 1
2022-04-19 09:02:05.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651576950296576[0;39m update ends, take 43 millisecs
2022-04-19 09:02:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651597598855168[0;39m 生成今日电子书快照开始
2022-04-19 09:02:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651597598855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651597598855168[0;39m ==> Parameters: 
2022-04-19 09:02:10.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651597598855168[0;39m <==    Updates: 0
2022-04-19 09:02:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651597598855168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:02:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651618599735296[0;39m 生成今日电子书快照开始
2022-04-19 09:02:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651618599735296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651618599735296[0;39m ==> Parameters: 
2022-04-19 09:02:15.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651618599735296[0;39m <==    Updates: 0
2022-04-19 09:02:15.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651618599735296[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:02:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651639546089472[0;39m 生成今日电子书快照开始
2022-04-19 09:02:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651639546089472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651639546089472[0;39m ==> Parameters: 
2022-04-19 09:02:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651639546089472[0;39m <==    Updates: 0
2022-04-19 09:02:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651639546089472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:02:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651660517609472[0;39m 生成今日电子书快照开始
2022-04-19 09:02:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651660517609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651660517609472[0;39m ==> Parameters: 
2022-04-19 09:02:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651660517609472[0;39m <==    Updates: 0
2022-04-19 09:02:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651660517609472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:02:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651681514295296[0;39m 生成今日电子书快照开始
2022-04-19 09:02:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651681514295296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651681514295296[0;39m ==> Parameters: 
2022-04-19 09:02:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651681514295296[0;39m <==    Updates: 0
2022-04-19 09:02:30.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651681514295296[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:02:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651702498398208[0;39m 生成今日电子书快照开始
2022-04-19 09:02:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651702498398208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651702498398208[0;39m ==> Parameters: 
2022-04-19 09:02:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651702498398208[0;39m <==    Updates: 0
2022-04-19 09:02:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651702498398208[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:02:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651702720696320[0;39m start updating Ebook doc
2022-04-19 09:02:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651702720696320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:02:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651702720696320[0;39m ==> Parameters: 
2022-04-19 09:02:35.101 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651702720696320[0;39m <==    Updates: 1
2022-04-19 09:02:35.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651702720696320[0;39m update ends, take 38 millisecs
2022-04-19 09:02:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651723436363776[0;39m 生成今日电子书快照开始
2022-04-19 09:02:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651723436363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651723436363776[0;39m ==> Parameters: 
2022-04-19 09:02:40.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651723436363776[0;39m <==    Updates: 0
2022-04-19 09:02:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651723436363776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:02:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651744441438208[0;39m 生成今日电子书快照开始
2022-04-19 09:02:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651744441438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651744441438208[0;39m ==> Parameters: 
2022-04-19 09:02:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651744441438208[0;39m <==    Updates: 0
2022-04-19 09:02:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651744441438208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:02:50.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651765400375296[0;39m 生成今日电子书快照开始
2022-04-19 09:02:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651765400375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651765400375296[0;39m ==> Parameters: 
2022-04-19 09:02:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651765400375296[0;39m <==    Updates: 0
2022-04-19 09:02:50.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651765400375296[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:02:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651786355118080[0;39m 生成今日电子书快照开始
2022-04-19 09:02:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651786355118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:02:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651786355118080[0;39m ==> Parameters: 
2022-04-19 09:02:55.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651786355118080[0;39m <==    Updates: 0
2022-04-19 09:02:55.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651786355118080[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:03:00.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651807355998208[0;39m 生成今日电子书快照开始
2022-04-19 09:03:00.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651807355998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:00.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651807355998208[0;39m ==> Parameters: 
2022-04-19 09:03:00.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651807355998208[0;39m <==    Updates: 0
2022-04-19 09:03:00.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651807355998208[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:03:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651828289769472[0;39m 生成今日电子书快照开始
2022-04-19 09:03:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651828289769472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651828289769472[0;39m ==> Parameters: 
2022-04-19 09:03:05.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651828289769472[0;39m <==    Updates: 0
2022-04-19 09:03:05.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651828289769472[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:03:05.055 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651828516261888[0;39m start updating Ebook doc
2022-04-19 09:03:05.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651828516261888[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:03:05.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651828516261888[0;39m ==> Parameters: 
2022-04-19 09:03:05.091 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651828516261888[0;39m <==    Updates: 1
2022-04-19 09:03:05.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651828516261888[0;39m update ends, take 37 millisecs
2022-04-19 09:03:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651849265483776[0;39m 生成今日电子书快照开始
2022-04-19 09:03:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651849265483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651849265483776[0;39m ==> Parameters: 
2022-04-19 09:03:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651849265483776[0;39m <==    Updates: 0
2022-04-19 09:03:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651849265483776[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 09:03:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651870257975296[0;39m 生成今日电子书快照开始
2022-04-19 09:03:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651870257975296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651870257975296[0;39m ==> Parameters: 
2022-04-19 09:03:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651870257975296[0;39m <==    Updates: 0
2022-04-19 09:03:15.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651870257975296[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:03:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651891212718080[0;39m 生成今日电子书快照开始
2022-04-19 09:03:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651891212718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651891212718080[0;39m ==> Parameters: 
2022-04-19 09:03:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651891212718080[0;39m <==    Updates: 0
2022-04-19 09:03:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651891212718080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:03:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651912188432384[0;39m 生成今日电子书快照开始
2022-04-19 09:03:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651912188432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651912188432384[0;39m ==> Parameters: 
2022-04-19 09:03:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651912188432384[0;39m <==    Updates: 0
2022-04-19 09:03:25.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651912188432384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:03:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651933172535296[0;39m 生成今日电子书快照开始
2022-04-19 09:03:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651933172535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651933172535296[0;39m ==> Parameters: 
2022-04-19 09:03:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651933172535296[0;39m <==    Updates: 0
2022-04-19 09:03:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651933172535296[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:03:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171651954135666688[0;39m start updating Ebook doc
2022-04-19 09:03:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651954135666688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:03:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651954135666688[0;39m ==> Parameters: 
2022-04-19 09:03:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171651954135666688[0;39m <==    Updates: 1
2022-04-19 09:03:35.062 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171651954135666688[0;39m update ends, take 57 millisecs
2022-04-19 09:03:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651954374742016[0;39m 生成今日电子书快照开始
2022-04-19 09:03:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651954374742016[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651954374742016[0;39m ==> Parameters: 
2022-04-19 09:03:35.101 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651954374742016[0;39m <==    Updates: 0
2022-04-19 09:03:35.101 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651954374742016[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-19 09:03:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651975102992384[0;39m 生成今日电子书快照开始
2022-04-19 09:03:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651975102992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651975102992384[0;39m ==> Parameters: 
2022-04-19 09:03:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651975102992384[0;39m <==    Updates: 0
2022-04-19 09:03:40.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651975102992384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:03:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171651996082900992[0;39m 生成今日电子书快照开始
2022-04-19 09:03:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651996082900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651996082900992[0;39m ==> Parameters: 
2022-04-19 09:03:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171651996082900992[0;39m <==    Updates: 0
2022-04-19 09:03:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171651996082900992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:03:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652017071198208[0;39m 生成今日电子书快照开始
2022-04-19 09:03:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652017071198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652017071198208[0;39m ==> Parameters: 
2022-04-19 09:03:50.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652017071198208[0;39m <==    Updates: 0
2022-04-19 09:03:50.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652017071198208[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:03:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652038038523904[0;39m 生成今日电子书快照开始
2022-04-19 09:03:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652038038523904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:03:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652038038523904[0;39m ==> Parameters: 
2022-04-19 09:03:55.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652038038523904[0;39m <==    Updates: 0
2022-04-19 09:03:55.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652038038523904[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:04:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652059005849600[0;39m 生成今日电子书快照开始
2022-04-19 09:04:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652059005849600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652059005849600[0;39m ==> Parameters: 
2022-04-19 09:04:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652059005849600[0;39m <==    Updates: 0
2022-04-19 09:04:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652059005849600[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:04:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652079960592384[0;39m start updating Ebook doc
2022-04-19 09:04:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652079960592384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:04:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652079960592384[0;39m ==> Parameters: 
2022-04-19 09:04:05.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652079960592384[0;39m <==    Updates: 1
2022-04-19 09:04:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652079960592384[0;39m update ends, take 60 millisecs
2022-04-19 09:04:05.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652080212250624[0;39m 生成今日电子书快照开始
2022-04-19 09:04:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652080212250624[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652080212250624[0;39m ==> Parameters: 
2022-04-19 09:04:05.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652080212250624[0;39m <==    Updates: 0
2022-04-19 09:04:05.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652080212250624[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-19 09:04:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652100940500992[0;39m 生成今日电子书快照开始
2022-04-19 09:04:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652100940500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652100940500992[0;39m ==> Parameters: 
2022-04-19 09:04:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652100940500992[0;39m <==    Updates: 0
2022-04-19 09:04:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652100940500992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:04:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652121928798208[0;39m 生成今日电子书快照开始
2022-04-19 09:04:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652121928798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652121928798208[0;39m ==> Parameters: 
2022-04-19 09:04:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652121928798208[0;39m <==    Updates: 0
2022-04-19 09:04:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652121928798208[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:04:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652142870958080[0;39m 生成今日电子书快照开始
2022-04-19 09:04:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652142870958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652142870958080[0;39m ==> Parameters: 
2022-04-19 09:04:20.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652142870958080[0;39m <==    Updates: 0
2022-04-19 09:04:20.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652142870958080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:04:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652163871838208[0;39m 生成今日电子书快照开始
2022-04-19 09:04:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652163871838208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652163871838208[0;39m ==> Parameters: 
2022-04-19 09:04:25.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652163871838208[0;39m <==    Updates: 0
2022-04-19 09:04:25.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652163871838208[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-19 09:04:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652184809803776[0;39m 生成今日电子书快照开始
2022-04-19 09:04:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652184809803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652184809803776[0;39m ==> Parameters: 
2022-04-19 09:04:30.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652184809803776[0;39m <==    Updates: 0
2022-04-19 09:04:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652184809803776[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-19 09:04:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652205772935168[0;39m 生成今日电子书快照开始
2022-04-19 09:04:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652205772935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:35.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652205772935168[0;39m ==> Parameters: 
2022-04-19 09:04:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652205772935168[0;39m <==    Updates: 0
2022-04-19 09:04:35.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652205772935168[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:04:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652206028787712[0;39m start updating Ebook doc
2022-04-19 09:04:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652206028787712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:04:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652206028787712[0;39m ==> Parameters: 
2022-04-19 09:04:35.097 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652206028787712[0;39m <==    Updates: 1
2022-04-19 09:04:35.097 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652206028787712[0;39m update ends, take 35 millisecs
2022-04-19 09:04:40.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652226790592512[0;39m 生成今日电子书快照开始
2022-04-19 09:04:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652226790592512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:40.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652226790592512[0;39m ==> Parameters: 
2022-04-19 09:04:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652226790592512[0;39m <==    Updates: 0
2022-04-19 09:04:40.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652226790592512[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:04:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652247757918208[0;39m 生成今日电子书快照开始
2022-04-19 09:04:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652247757918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652247757918208[0;39m ==> Parameters: 
2022-04-19 09:04:45.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652247757918208[0;39m <==    Updates: 0
2022-04-19 09:04:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652247757918208[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:04:50.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652268691689472[0;39m 生成今日电子书快照开始
2022-04-19 09:04:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652268691689472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652268691689472[0;39m ==> Parameters: 
2022-04-19 09:04:50.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652268691689472[0;39m <==    Updates: 0
2022-04-19 09:04:50.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652268691689472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:04:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652289663209472[0;39m 生成今日电子书快照开始
2022-04-19 09:04:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652289663209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:04:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652289663209472[0;39m ==> Parameters: 
2022-04-19 09:04:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652289663209472[0;39m <==    Updates: 0
2022-04-19 09:04:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652289663209472[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:05:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652310647312384[0;39m 生成今日电子书快照开始
2022-04-19 09:05:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652310647312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652310647312384[0;39m ==> Parameters: 
2022-04-19 09:05:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652310647312384[0;39m <==    Updates: 0
2022-04-19 09:05:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652310647312384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:05:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652331606249472[0;39m 生成今日电子书快照开始
2022-04-19 09:05:05.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652331606249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652331606249472[0;39m ==> Parameters: 
2022-04-19 09:05:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652331606249472[0;39m <==    Updates: 0
2022-04-19 09:05:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652331606249472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:05:05.059 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652331849519104[0;39m start updating Ebook doc
2022-04-19 09:05:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652331849519104[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:05:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652331849519104[0;39m ==> Parameters: 
2022-04-19 09:05:05.094 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652331849519104[0;39m <==    Updates: 1
2022-04-19 09:05:05.094 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652331849519104[0;39m update ends, take 35 millisecs
2022-04-19 09:05:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652352594546688[0;39m 生成今日电子书快照开始
2022-04-19 09:05:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652352594546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652352594546688[0;39m ==> Parameters: 
2022-04-19 09:05:10.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652352594546688[0;39m <==    Updates: 0
2022-04-19 09:05:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652352594546688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:05:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652373587038208[0;39m 生成今日电子书快照开始
2022-04-19 09:05:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652373587038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652373587038208[0;39m ==> Parameters: 
2022-04-19 09:05:15.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652373587038208[0;39m <==    Updates: 0
2022-04-19 09:05:15.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652373587038208[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:05:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652394533392384[0;39m 生成今日电子书快照开始
2022-04-19 09:05:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652394533392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652394533392384[0;39m ==> Parameters: 
2022-04-19 09:05:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652394533392384[0;39m <==    Updates: 0
2022-04-19 09:05:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652394533392384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:05:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652415517495296[0;39m 生成今日电子书快照开始
2022-04-19 09:05:25.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652415517495296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:25.116 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652415517495296[0;39m ==> Parameters: 
2022-04-19 09:05:25.284 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652415517495296[0;39m <==    Updates: 0
2022-04-19 09:05:25.285 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652415517495296[0;39m 生成今日电子书快照结束，耗时：277毫秒
2022-04-19 09:05:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652436489015296[0;39m 生成今日电子书快照开始
2022-04-19 09:05:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652436489015296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652436489015296[0;39m ==> Parameters: 
2022-04-19 09:05:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652436489015296[0;39m <==    Updates: 0
2022-04-19 09:05:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652436489015296[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:05:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652457473118208[0;39m start updating Ebook doc
2022-04-19 09:05:35.031 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652457473118208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:05:35.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652457473118208[0;39m ==> Parameters: 
2022-04-19 09:05:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652457473118208[0;39m <==    Updates: 1
2022-04-19 09:05:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652457473118208[0;39m update ends, take 60 millisecs
2022-04-19 09:05:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652457724776448[0;39m 生成今日电子书快照开始
2022-04-19 09:05:35.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652457724776448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652457724776448[0;39m ==> Parameters: 
2022-04-19 09:05:35.105 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652457724776448[0;39m <==    Updates: 0
2022-04-19 09:05:35.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652457724776448[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-19 09:05:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652478440443904[0;39m 生成今日电子书快照开始
2022-04-19 09:05:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652478440443904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652478440443904[0;39m ==> Parameters: 
2022-04-19 09:05:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652478440443904[0;39m <==    Updates: 0
2022-04-19 09:05:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652478440443904[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:05:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652499416158208[0;39m 生成今日电子书快照开始
2022-04-19 09:05:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652499416158208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652499416158208[0;39m ==> Parameters: 
2022-04-19 09:05:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652499416158208[0;39m <==    Updates: 0
2022-04-19 09:05:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652499416158208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:05:50.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652520383483904[0;39m 生成今日电子书快照开始
2022-04-19 09:05:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652520383483904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:50.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652520383483904[0;39m ==> Parameters: 
2022-04-19 09:05:50.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652520383483904[0;39m <==    Updates: 0
2022-04-19 09:05:50.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652520383483904[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-19 09:05:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652541325643776[0;39m 生成今日电子书快照开始
2022-04-19 09:05:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652541325643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:05:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652541325643776[0;39m ==> Parameters: 
2022-04-19 09:05:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652541325643776[0;39m <==    Updates: 0
2022-04-19 09:05:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652541325643776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:06:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652562292969472[0;39m 生成今日电子书快照开始
2022-04-19 09:06:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652562292969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652562292969472[0;39m ==> Parameters: 
2022-04-19 09:06:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652562292969472[0;39m <==    Updates: 0
2022-04-19 09:06:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652562292969472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:06:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652583281266688[0;39m start updating Ebook doc
2022-04-19 09:06:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652583281266688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:06:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652583281266688[0;39m ==> Parameters: 
2022-04-19 09:06:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652583281266688[0;39m <==    Updates: 1
2022-04-19 09:06:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652583281266688[0;39m update ends, take 61 millisecs
2022-04-19 09:06:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652583541313536[0;39m 生成今日电子书快照开始
2022-04-19 09:06:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652583541313536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652583541313536[0;39m ==> Parameters: 
2022-04-19 09:06:05.115 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652583541313536[0;39m <==    Updates: 0
2022-04-19 09:06:05.116 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652583541313536[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:06:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652604261175296[0;39m 生成今日电子书快照开始
2022-04-19 09:06:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652604261175296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652604261175296[0;39m ==> Parameters: 
2022-04-19 09:06:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652604261175296[0;39m <==    Updates: 0
2022-04-19 09:06:10.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652604261175296[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:06:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652625228500992[0;39m 生成今日电子书快照开始
2022-04-19 09:06:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652625228500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652625228500992[0;39m ==> Parameters: 
2022-04-19 09:06:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652625228500992[0;39m <==    Updates: 0
2022-04-19 09:06:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652625228500992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:06:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652646187438080[0;39m 生成今日电子书快照开始
2022-04-19 09:06:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652646187438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652646187438080[0;39m ==> Parameters: 
2022-04-19 09:06:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652646187438080[0;39m <==    Updates: 0
2022-04-19 09:06:20.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652646187438080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:06:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652667175735296[0;39m 生成今日电子书快照开始
2022-04-19 09:06:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652667175735296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652667175735296[0;39m ==> Parameters: 
2022-04-19 09:06:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652667175735296[0;39m <==    Updates: 0
2022-04-19 09:06:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652667175735296[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:06:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652688159838208[0;39m 生成今日电子书快照开始
2022-04-19 09:06:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652688159838208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652688159838208[0;39m ==> Parameters: 
2022-04-19 09:06:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652688159838208[0;39m <==    Updates: 0
2022-04-19 09:06:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652688159838208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:06:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652709093609472[0;39m start updating Ebook doc
2022-04-19 09:06:35.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652709093609472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:06:35.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652709093609472[0;39m ==> Parameters: 
2022-04-19 09:06:35.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652709093609472[0;39m <==    Updates: 1
2022-04-19 09:06:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652709093609472[0;39m update ends, take 63 millisecs
2022-04-19 09:06:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652709357850624[0;39m 生成今日电子书快照开始
2022-04-19 09:06:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652709357850624[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652709357850624[0;39m ==> Parameters: 
2022-04-19 09:06:35.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652709357850624[0;39m <==    Updates: 0
2022-04-19 09:06:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652709357850624[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-19 09:06:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652730102878208[0;39m 生成今日电子书快照开始
2022-04-19 09:06:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652730102878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652730102878208[0;39m ==> Parameters: 
2022-04-19 09:06:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652730102878208[0;39m <==    Updates: 0
2022-04-19 09:06:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652730102878208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:06:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652751074398208[0;39m 生成今日电子书快照开始
2022-04-19 09:06:45.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652751074398208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:45.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652751074398208[0;39m ==> Parameters: 
2022-04-19 09:06:45.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652751074398208[0;39m <==    Updates: 0
2022-04-19 09:06:45.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652751074398208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:06:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652772037529600[0;39m 生成今日电子书快照开始
2022-04-19 09:06:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652772037529600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652772037529600[0;39m ==> Parameters: 
2022-04-19 09:06:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652772037529600[0;39m <==    Updates: 0
2022-04-19 09:06:50.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652772037529600[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:06:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652793017438208[0;39m 生成今日电子书快照开始
2022-04-19 09:06:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652793017438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:06:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652793017438208[0;39m ==> Parameters: 
2022-04-19 09:06:55.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652793017438208[0;39m <==    Updates: 0
2022-04-19 09:06:55.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652793017438208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:07:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652813972180992[0;39m 生成今日电子书快照开始
2022-04-19 09:07:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652813972180992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652813972180992[0;39m ==> Parameters: 
2022-04-19 09:07:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652813972180992[0;39m <==    Updates: 0
2022-04-19 09:07:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652813972180992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:07:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652834943700992[0;39m start updating Ebook doc
2022-04-19 09:07:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652834943700992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:07:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652834943700992[0;39m ==> Parameters: 
2022-04-19 09:07:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652834943700992[0;39m <==    Updates: 1
2022-04-19 09:07:05.077 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652834943700992[0;39m update ends, take 71 millisecs
2022-04-19 09:07:05.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652835241496576[0;39m 生成今日电子书快照开始
2022-04-19 09:07:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652835241496576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:05.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652835241496576[0;39m ==> Parameters: 
2022-04-19 09:07:05.119 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652835241496576[0;39m <==    Updates: 0
2022-04-19 09:07:05.119 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652835241496576[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-19 09:07:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652855927803904[0;39m 生成今日电子书快照开始
2022-04-19 09:07:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652855927803904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652855927803904[0;39m ==> Parameters: 
2022-04-19 09:07:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652855927803904[0;39m <==    Updates: 0
2022-04-19 09:07:10.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652855927803904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:07:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652876869963776[0;39m 生成今日电子书快照开始
2022-04-19 09:07:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652876869963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652876869963776[0;39m ==> Parameters: 
2022-04-19 09:07:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652876869963776[0;39m <==    Updates: 0
2022-04-19 09:07:15.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652876869963776[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 09:07:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652897875038208[0;39m 生成今日电子书快照开始
2022-04-19 09:07:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652897875038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652897875038208[0;39m ==> Parameters: 
2022-04-19 09:07:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652897875038208[0;39m <==    Updates: 0
2022-04-19 09:07:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652897875038208[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:07:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652918838169600[0;39m 生成今日电子书快照开始
2022-04-19 09:07:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652918838169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652918838169600[0;39m ==> Parameters: 
2022-04-19 09:07:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652918838169600[0;39m <==    Updates: 0
2022-04-19 09:07:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652918838169600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:07:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652939813883904[0;39m 生成今日电子书快照开始
2022-04-19 09:07:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652939813883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652939813883904[0;39m ==> Parameters: 
2022-04-19 09:07:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652939813883904[0;39m <==    Updates: 0
2022-04-19 09:07:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652939813883904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:07:35.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652960781209600[0;39m 生成今日电子书快照开始
2022-04-19 09:07:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652960781209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652960781209600[0;39m ==> Parameters: 
2022-04-19 09:07:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652960781209600[0;39m <==    Updates: 0
2022-04-19 09:07:35.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652960781209600[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:07:35.064 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171652961016090624[0;39m start updating Ebook doc
2022-04-19 09:07:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652961016090624[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:07:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652961016090624[0;39m ==> Parameters: 
2022-04-19 09:07:35.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171652961016090624[0;39m <==    Updates: 1
2022-04-19 09:07:35.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171652961016090624[0;39m update ends, take 40 millisecs
2022-04-19 09:07:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171652981756923904[0;39m 生成今日电子书快照开始
2022-04-19 09:07:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652981756923904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652981756923904[0;39m ==> Parameters: 
2022-04-19 09:07:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171652981756923904[0;39m <==    Updates: 0
2022-04-19 09:07:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171652981756923904[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:07:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653002720055296[0;39m 生成今日电子书快照开始
2022-04-19 09:07:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653002720055296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653002720055296[0;39m ==> Parameters: 
2022-04-19 09:07:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653002720055296[0;39m <==    Updates: 0
2022-04-19 09:07:45.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653002720055296[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:07:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653023687380992[0;39m 生成今日电子书快照开始
2022-04-19 09:07:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653023687380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653023687380992[0;39m ==> Parameters: 
2022-04-19 09:07:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653023687380992[0;39m <==    Updates: 0
2022-04-19 09:07:50.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653023687380992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:07:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653044658900992[0;39m 生成今日电子书快照开始
2022-04-19 09:07:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653044658900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:07:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653044658900992[0;39m ==> Parameters: 
2022-04-19 09:07:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653044658900992[0;39m <==    Updates: 0
2022-04-19 09:07:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653044658900992[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:08:00.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653065647198208[0;39m 生成今日电子书快照开始
2022-04-19 09:08:00.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653065647198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:00.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653065647198208[0;39m ==> Parameters: 
2022-04-19 09:08:00.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653065647198208[0;39m <==    Updates: 0
2022-04-19 09:08:00.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653065647198208[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:08:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653086580969472[0;39m start updating Ebook doc
2022-04-19 09:08:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653086580969472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:08:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653086580969472[0;39m ==> Parameters: 
2022-04-19 09:08:05.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653086580969472[0;39m <==    Updates: 1
2022-04-19 09:08:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653086580969472[0;39m update ends, take 56 millisecs
2022-04-19 09:08:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653086820044800[0;39m 生成今日电子书快照开始
2022-04-19 09:08:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653086820044800[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653086820044800[0;39m ==> Parameters: 
2022-04-19 09:08:05.093 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653086820044800[0;39m <==    Updates: 0
2022-04-19 09:08:05.093 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653086820044800[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-19 09:08:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653107560878080[0;39m 生成今日电子书快照开始
2022-04-19 09:08:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653107560878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653107560878080[0;39m ==> Parameters: 
2022-04-19 09:08:10.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653107560878080[0;39m <==    Updates: 0
2022-04-19 09:08:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653107560878080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:08:15.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653128557563904[0;39m 生成今日电子书快照开始
2022-04-19 09:08:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653128557563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653128557563904[0;39m ==> Parameters: 
2022-04-19 09:08:15.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653128557563904[0;39m <==    Updates: 0
2022-04-19 09:08:15.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653128557563904[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:08:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653149508112384[0;39m 生成今日电子书快照开始
2022-04-19 09:08:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653149508112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653149508112384[0;39m ==> Parameters: 
2022-04-19 09:08:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653149508112384[0;39m <==    Updates: 0
2022-04-19 09:08:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653149508112384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:08:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653170504798208[0;39m 生成今日电子书快照开始
2022-04-19 09:08:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653170504798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653170504798208[0;39m ==> Parameters: 
2022-04-19 09:08:25.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653170504798208[0;39m <==    Updates: 0
2022-04-19 09:08:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653170504798208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:08:30.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653191480512512[0;39m 生成今日电子书快照开始
2022-04-19 09:08:30.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653191480512512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:30.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653191480512512[0;39m ==> Parameters: 
2022-04-19 09:08:30.086 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653191480512512[0;39m <==    Updates: 0
2022-04-19 09:08:30.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653191480512512[0;39m 生成今日电子书快照结束，耗时：75毫秒
2022-04-19 09:08:35.007 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653212435255296[0;39m start updating Ebook doc
2022-04-19 09:08:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653212435255296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:08:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653212435255296[0;39m ==> Parameters: 
2022-04-19 09:08:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653212435255296[0;39m <==    Updates: 1
2022-04-19 09:08:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653212435255296[0;39m update ends, take 58 millisecs
2022-04-19 09:08:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653212678524928[0;39m 生成今日电子书快照开始
2022-04-19 09:08:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653212678524928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653212678524928[0;39m ==> Parameters: 
2022-04-19 09:08:35.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653212678524928[0;39m <==    Updates: 0
2022-04-19 09:08:35.102 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653212678524928[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-19 09:08:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653233389998080[0;39m 生成今日电子书快照开始
2022-04-19 09:08:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653233389998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653233389998080[0;39m ==> Parameters: 
2022-04-19 09:08:40.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653233389998080[0;39m <==    Updates: 0
2022-04-19 09:08:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653233389998080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:08:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653254378295296[0;39m 生成今日电子书快照开始
2022-04-19 09:08:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653254378295296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653254378295296[0;39m ==> Parameters: 
2022-04-19 09:08:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653254378295296[0;39m <==    Updates: 0
2022-04-19 09:08:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653254378295296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:08:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653275354009600[0;39m 生成今日电子书快照开始
2022-04-19 09:08:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653275354009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653275354009600[0;39m ==> Parameters: 
2022-04-19 09:08:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653275354009600[0;39m <==    Updates: 0
2022-04-19 09:08:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653275354009600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:08:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653296312946688[0;39m 生成今日电子书快照开始
2022-04-19 09:08:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653296312946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:08:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653296312946688[0;39m ==> Parameters: 
2022-04-19 09:08:55.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653296312946688[0;39m <==    Updates: 0
2022-04-19 09:08:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653296312946688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:09:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653317288660992[0;39m 生成今日电子书快照开始
2022-04-19 09:09:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653317288660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653317288660992[0;39m ==> Parameters: 
2022-04-19 09:09:00.111 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653317288660992[0;39m <==    Updates: 0
2022-04-19 09:09:00.111 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653317288660992[0;39m 生成今日电子书快照结束，耗时：104毫秒
2022-04-19 09:09:05.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653338276958208[0;39m 生成今日电子书快照开始
2022-04-19 09:09:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653338276958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653338276958208[0;39m ==> Parameters: 
2022-04-19 09:09:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653338276958208[0;39m <==    Updates: 0
2022-04-19 09:09:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653338276958208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:09:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653338507644928[0;39m start updating Ebook doc
2022-04-19 09:09:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653338507644928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:09:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653338507644928[0;39m ==> Parameters: 
2022-04-19 09:09:05.106 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653338507644928[0;39m <==    Updates: 1
2022-04-19 09:09:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653338507644928[0;39m update ends, take 41 millisecs
2022-04-19 09:09:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653359235895296[0;39m 生成今日电子书快照开始
2022-04-19 09:09:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653359235895296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653359235895296[0;39m ==> Parameters: 
2022-04-19 09:09:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653359235895296[0;39m <==    Updates: 0
2022-04-19 09:09:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653359235895296[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:09:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653380203220992[0;39m 生成今日电子书快照开始
2022-04-19 09:09:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653380203220992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653380203220992[0;39m ==> Parameters: 
2022-04-19 09:09:15.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653380203220992[0;39m <==    Updates: 0
2022-04-19 09:09:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653380203220992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:09:20.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653401178935296[0;39m 生成今日电子书快照开始
2022-04-19 09:09:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653401178935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653401178935296[0;39m ==> Parameters: 
2022-04-19 09:09:20.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653401178935296[0;39m <==    Updates: 0
2022-04-19 09:09:20.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653401178935296[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:09:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653422146260992[0;39m 生成今日电子书快照开始
2022-04-19 09:09:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653422146260992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653422146260992[0;39m ==> Parameters: 
2022-04-19 09:09:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653422146260992[0;39m <==    Updates: 0
2022-04-19 09:09:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653422146260992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:09:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653443134558208[0;39m 生成今日电子书快照开始
2022-04-19 09:09:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653443134558208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653443134558208[0;39m ==> Parameters: 
2022-04-19 09:09:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653443134558208[0;39m <==    Updates: 0
2022-04-19 09:09:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653443134558208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:09:35.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653464097689600[0;39m 生成今日电子书快照开始
2022-04-19 09:09:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653464097689600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653464097689600[0;39m ==> Parameters: 
2022-04-19 09:09:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653464097689600[0;39m <==    Updates: 0
2022-04-19 09:09:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653464097689600[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:09:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653464340959232[0;39m start updating Ebook doc
2022-04-19 09:09:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653464340959232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:09:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653464340959232[0;39m ==> Parameters: 
2022-04-19 09:09:35.102 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653464340959232[0;39m <==    Updates: 1
2022-04-19 09:09:35.102 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653464340959232[0;39m update ends, take 36 millisecs
2022-04-19 09:09:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653485077598208[0;39m 生成今日电子书快照开始
2022-04-19 09:09:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653485077598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653485077598208[0;39m ==> Parameters: 
2022-04-19 09:09:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653485077598208[0;39m <==    Updates: 0
2022-04-19 09:09:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653485077598208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:09:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653506040729600[0;39m 生成今日电子书快照开始
2022-04-19 09:09:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653506040729600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653506040729600[0;39m ==> Parameters: 
2022-04-19 09:09:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653506040729600[0;39m <==    Updates: 0
2022-04-19 09:09:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653506040729600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:09:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653526987083776[0;39m 生成今日电子书快照开始
2022-04-19 09:09:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653526987083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653526987083776[0;39m ==> Parameters: 
2022-04-19 09:09:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653526987083776[0;39m <==    Updates: 0
2022-04-19 09:09:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653526987083776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:09:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653547971186688[0;39m 生成今日电子书快照开始
2022-04-19 09:09:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653547971186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:09:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653547971186688[0;39m ==> Parameters: 
2022-04-19 09:09:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653547971186688[0;39m <==    Updates: 0
2022-04-19 09:09:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653547971186688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:10:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653568925929472[0;39m 生成今日电子书快照开始
2022-04-19 09:10:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653568925929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653568925929472[0;39m ==> Parameters: 
2022-04-19 09:10:00.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653568925929472[0;39m <==    Updates: 0
2022-04-19 09:10:00.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653568925929472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:10:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653589918420992[0;39m start updating Ebook doc
2022-04-19 09:10:05.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653589918420992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:10:05.030 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653589918420992[0;39m ==> Parameters: 
2022-04-19 09:10:05.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653589918420992[0;39m <==    Updates: 1
2022-04-19 09:10:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653589918420992[0;39m update ends, take 58 millisecs
2022-04-19 09:10:05.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653590161690624[0;39m 生成今日电子书快照开始
2022-04-19 09:10:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653590161690624[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653590161690624[0;39m ==> Parameters: 
2022-04-19 09:10:05.105 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653590161690624[0;39m <==    Updates: 0
2022-04-19 09:10:05.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653590161690624[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-19 09:10:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653610885746688[0;39m 生成今日电子书快照开始
2022-04-19 09:10:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653610885746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653610885746688[0;39m ==> Parameters: 
2022-04-19 09:10:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653610885746688[0;39m <==    Updates: 0
2022-04-19 09:10:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653610885746688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:10:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653631865655296[0;39m 生成今日电子书快照开始
2022-04-19 09:10:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653631865655296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653631865655296[0;39m ==> Parameters: 
2022-04-19 09:10:15.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653631865655296[0;39m <==    Updates: 0
2022-04-19 09:10:15.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653631865655296[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:10:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653652820398080[0;39m 生成今日电子书快照开始
2022-04-19 09:10:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653652820398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653652820398080[0;39m ==> Parameters: 
2022-04-19 09:10:20.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653652820398080[0;39m <==    Updates: 0
2022-04-19 09:10:20.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653652820398080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:10:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653673783529472[0;39m 生成今日电子书快照开始
2022-04-19 09:10:25.133 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653673783529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:25.133 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653673783529472[0;39m ==> Parameters: 
2022-04-19 09:10:25.307 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653673783529472[0;39m <==    Updates: 0
2022-04-19 09:10:25.307 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653673783529472[0;39m 生成今日电子书快照结束，耗时：306毫秒
2022-04-19 09:10:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653694792798208[0;39m 生成今日电子书快照开始
2022-04-19 09:10:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653694792798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653694792798208[0;39m ==> Parameters: 
2022-04-19 09:10:30.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653694792798208[0;39m <==    Updates: 0
2022-04-19 09:10:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653694792798208[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:10:35.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653715739152384[0;39m start updating Ebook doc
2022-04-19 09:10:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653715739152384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:10:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653715739152384[0;39m ==> Parameters: 
2022-04-19 09:10:35.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653715739152384[0;39m <==    Updates: 1
2022-04-19 09:10:35.060 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653715739152384[0;39m update ends, take 56 millisecs
2022-04-19 09:10:35.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653715978227712[0;39m 生成今日电子书快照开始
2022-04-19 09:10:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653715978227712[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653715978227712[0;39m ==> Parameters: 
2022-04-19 09:10:35.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653715978227712[0;39m <==    Updates: 0
2022-04-19 09:10:35.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653715978227712[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-19 09:10:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653736714866688[0;39m 生成今日电子书快照开始
2022-04-19 09:10:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653736714866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653736714866688[0;39m ==> Parameters: 
2022-04-19 09:10:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653736714866688[0;39m <==    Updates: 0
2022-04-19 09:10:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653736714866688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:10:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653757698969600[0;39m 生成今日电子书快照开始
2022-04-19 09:10:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653757698969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653757698969600[0;39m ==> Parameters: 
2022-04-19 09:10:45.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653757698969600[0;39m <==    Updates: 0
2022-04-19 09:10:45.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653757698969600[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:10:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653778653712384[0;39m 生成今日电子书快照开始
2022-04-19 09:10:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653778653712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653778653712384[0;39m ==> Parameters: 
2022-04-19 09:10:50.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653778653712384[0;39m <==    Updates: 0
2022-04-19 09:10:50.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653778653712384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:10:55.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653799637815296[0;39m 生成今日电子书快照开始
2022-04-19 09:10:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653799637815296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:10:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653799637815296[0;39m ==> Parameters: 
2022-04-19 09:10:55.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653799637815296[0;39m <==    Updates: 0
2022-04-19 09:10:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653799637815296[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:11:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653820609335296[0;39m 生成今日电子书快照开始
2022-04-19 09:11:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653820609335296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653820609335296[0;39m ==> Parameters: 
2022-04-19 09:11:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653820609335296[0;39m <==    Updates: 0
2022-04-19 09:11:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653820609335296[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:11:05.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653841551495168[0;39m start updating Ebook doc
2022-04-19 09:11:05.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653841551495168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:11:05.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653841551495168[0;39m ==> Parameters: 
2022-04-19 09:11:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653841551495168[0;39m <==    Updates: 1
2022-04-19 09:11:05.064 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653841551495168[0;39m update ends, take 63 millisecs
2022-04-19 09:11:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653841824124928[0;39m 生成今日电子书快照开始
2022-04-19 09:11:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653841824124928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653841824124928[0;39m ==> Parameters: 
2022-04-19 09:11:05.105 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653841824124928[0;39m <==    Updates: 0
2022-04-19 09:11:05.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653841824124928[0;39m 生成今日电子书快照结束，耗时：41毫秒
2022-04-19 09:11:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653862560763904[0;39m 生成今日电子书快照开始
2022-04-19 09:11:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653862560763904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:10.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653862560763904[0;39m ==> Parameters: 
2022-04-19 09:11:10.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653862560763904[0;39m <==    Updates: 0
2022-04-19 09:11:10.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653862560763904[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:11:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653883511312384[0;39m 生成今日电子书快照开始
2022-04-19 09:11:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653883511312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653883511312384[0;39m ==> Parameters: 
2022-04-19 09:11:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653883511312384[0;39m <==    Updates: 0
2022-04-19 09:11:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653883511312384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:11:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653904507998208[0;39m 生成今日电子书快照开始
2022-04-19 09:11:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653904507998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653904507998208[0;39m ==> Parameters: 
2022-04-19 09:11:20.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653904507998208[0;39m <==    Updates: 0
2022-04-19 09:11:20.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653904507998208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:11:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653925479518208[0;39m 生成今日电子书快照开始
2022-04-19 09:11:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653925479518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653925479518208[0;39m ==> Parameters: 
2022-04-19 09:11:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653925479518208[0;39m <==    Updates: 0
2022-04-19 09:11:25.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653925479518208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:11:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653946430066688[0;39m 生成今日电子书快照开始
2022-04-19 09:11:30.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653946430066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653946430066688[0;39m ==> Parameters: 
2022-04-19 09:11:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653946430066688[0;39m <==    Updates: 0
2022-04-19 09:11:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653946430066688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:11:35.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171653967401586688[0;39m start updating Ebook doc
2022-04-19 09:11:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653967401586688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:11:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653967401586688[0;39m ==> Parameters: 
2022-04-19 09:11:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171653967401586688[0;39m <==    Updates: 1
2022-04-19 09:11:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171653967401586688[0;39m update ends, take 60 millisecs
2022-04-19 09:11:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653967653244928[0;39m 生成今日电子书快照开始
2022-04-19 09:11:35.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653967653244928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653967653244928[0;39m ==> Parameters: 
2022-04-19 09:11:35.109 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653967653244928[0;39m <==    Updates: 0
2022-04-19 09:11:35.109 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653967653244928[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-19 09:11:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171653988368912384[0;39m 生成今日电子书快照开始
2022-04-19 09:11:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653988368912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653988368912384[0;39m ==> Parameters: 
2022-04-19 09:11:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171653988368912384[0;39m <==    Updates: 0
2022-04-19 09:11:40.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171653988368912384[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:11:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654009348820992[0;39m 生成今日电子书快照开始
2022-04-19 09:11:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654009348820992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654009348820992[0;39m ==> Parameters: 
2022-04-19 09:11:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654009348820992[0;39m <==    Updates: 0
2022-04-19 09:11:45.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654009348820992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:11:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654030295175168[0;39m 生成今日电子书快照开始
2022-04-19 09:11:50.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654030295175168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654030295175168[0;39m ==> Parameters: 
2022-04-19 09:11:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654030295175168[0;39m <==    Updates: 0
2022-04-19 09:11:50.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654030295175168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:11:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654051270889472[0;39m 生成今日电子书快照开始
2022-04-19 09:11:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654051270889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:11:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654051270889472[0;39m ==> Parameters: 
2022-04-19 09:11:55.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654051270889472[0;39m <==    Updates: 0
2022-04-19 09:11:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654051270889472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-19 09:12:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654072242409472[0;39m 生成今日电子书快照开始
2022-04-19 09:12:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654072242409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654072242409472[0;39m ==> Parameters: 
2022-04-19 09:12:00.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654072242409472[0;39m <==    Updates: 0
2022-04-19 09:12:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654072242409472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:12:05.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654093247483904[0;39m 生成今日电子书快照开始
2022-04-19 09:12:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654093247483904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:05.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654093247483904[0;39m ==> Parameters: 
2022-04-19 09:12:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654093247483904[0;39m <==    Updates: 0
2022-04-19 09:12:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654093247483904[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:12:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654093499142144[0;39m start updating Ebook doc
2022-04-19 09:12:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654093499142144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:12:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654093499142144[0;39m ==> Parameters: 
2022-04-19 09:12:05.103 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654093499142144[0;39m <==    Updates: 1
2022-04-19 09:12:05.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654093499142144[0;39m update ends, take 35 millisecs
2022-04-19 09:12:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654114193838080[0;39m 生成今日电子书快照开始
2022-04-19 09:12:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654114193838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654114193838080[0;39m ==> Parameters: 
2022-04-19 09:12:10.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654114193838080[0;39m <==    Updates: 0
2022-04-19 09:12:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654114193838080[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:12:15.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654135186329600[0;39m 生成今日电子书快照开始
2022-04-19 09:12:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654135186329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654135186329600[0;39m ==> Parameters: 
2022-04-19 09:12:15.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654135186329600[0;39m <==    Updates: 0
2022-04-19 09:12:15.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654135186329600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:12:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654156132683776[0;39m 生成今日电子书快照开始
2022-04-19 09:12:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654156132683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654156132683776[0;39m ==> Parameters: 
2022-04-19 09:12:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654156132683776[0;39m <==    Updates: 0
2022-04-19 09:12:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654156132683776[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:12:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654177133563904[0;39m 生成今日电子书快照开始
2022-04-19 09:12:25.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654177133563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:25.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654177133563904[0;39m ==> Parameters: 
2022-04-19 09:12:25.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654177133563904[0;39m <==    Updates: 0
2022-04-19 09:12:25.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654177133563904[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:12:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654198092500992[0;39m 生成今日电子书快照开始
2022-04-19 09:12:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654198092500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654198092500992[0;39m ==> Parameters: 
2022-04-19 09:12:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654198092500992[0;39m <==    Updates: 0
2022-04-19 09:12:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654198092500992[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:12:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654219080798208[0;39m start updating Ebook doc
2022-04-19 09:12:35.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654219080798208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:12:35.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654219080798208[0;39m ==> Parameters: 
2022-04-19 09:12:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654219080798208[0;39m <==    Updates: 1
2022-04-19 09:12:35.068 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654219080798208[0;39m update ends, take 58 millisecs
2022-04-19 09:12:35.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654219324067840[0;39m 生成今日电子书快照开始
2022-04-19 09:12:35.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654219324067840[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654219324067840[0;39m ==> Parameters: 
2022-04-19 09:12:35.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654219324067840[0;39m <==    Updates: 0
2022-04-19 09:12:35.107 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654219324067840[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-19 09:12:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654240014569472[0;39m 生成今日电子书快照开始
2022-04-19 09:12:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654240014569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654240014569472[0;39m ==> Parameters: 
2022-04-19 09:12:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654240014569472[0;39m <==    Updates: 0
2022-04-19 09:12:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654240014569472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:12:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654261023838208[0;39m 生成今日电子书快照开始
2022-04-19 09:12:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654261023838208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654261023838208[0;39m ==> Parameters: 
2022-04-19 09:12:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654261023838208[0;39m <==    Updates: 0
2022-04-19 09:12:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654261023838208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:12:50.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654281991163904[0;39m 生成今日电子书快照开始
2022-04-19 09:12:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654281991163904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654281991163904[0;39m ==> Parameters: 
2022-04-19 09:12:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654281991163904[0;39m <==    Updates: 0
2022-04-19 09:12:50.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654281991163904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:12:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654302950100992[0;39m 生成今日电子书快照开始
2022-04-19 09:12:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654302950100992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:12:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654302950100992[0;39m ==> Parameters: 
2022-04-19 09:12:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654302950100992[0;39m <==    Updates: 0
2022-04-19 09:12:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654302950100992[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:13:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654323930009600[0;39m 生成今日电子书快照开始
2022-04-19 09:13:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654323930009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654323930009600[0;39m ==> Parameters: 
2022-04-19 09:13:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654323930009600[0;39m <==    Updates: 0
2022-04-19 09:13:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654323930009600[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:13:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654344893140992[0;39m start updating Ebook doc
2022-04-19 09:13:05.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654344893140992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:13:05.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654344893140992[0;39m ==> Parameters: 
2022-04-19 09:13:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654344893140992[0;39m <==    Updates: 1
2022-04-19 09:13:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654344893140992[0;39m update ends, take 58 millisecs
2022-04-19 09:13:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654345140604928[0;39m 生成今日电子书快照开始
2022-04-19 09:13:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654345140604928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654345140604928[0;39m ==> Parameters: 
2022-04-19 09:13:05.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654345140604928[0;39m <==    Updates: 0
2022-04-19 09:13:05.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654345140604928[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-19 09:13:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654365881438208[0;39m 生成今日电子书快照开始
2022-04-19 09:13:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654365881438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654365881438208[0;39m ==> Parameters: 
2022-04-19 09:13:10.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654365881438208[0;39m <==    Updates: 0
2022-04-19 09:13:10.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654365881438208[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:13:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654386819403776[0;39m 生成今日电子书快照开始
2022-04-19 09:13:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654386819403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654386819403776[0;39m ==> Parameters: 
2022-04-19 09:13:15.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654386819403776[0;39m <==    Updates: 0
2022-04-19 09:13:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654386819403776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:13:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654407790923776[0;39m 生成今日电子书快照开始
2022-04-19 09:13:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654407790923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654407790923776[0;39m ==> Parameters: 
2022-04-19 09:13:20.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654407790923776[0;39m <==    Updates: 0
2022-04-19 09:13:20.047 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654407790923776[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:13:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654428787609600[0;39m 生成今日电子书快照开始
2022-04-19 09:13:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654428787609600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654428787609600[0;39m ==> Parameters: 
2022-04-19 09:13:25.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654428787609600[0;39m <==    Updates: 0
2022-04-19 09:13:25.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654428787609600[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:13:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654449754935296[0;39m 生成今日电子书快照开始
2022-04-19 09:13:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654449754935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654449754935296[0;39m ==> Parameters: 
2022-04-19 09:13:30.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654449754935296[0;39m <==    Updates: 0
2022-04-19 09:13:30.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654449754935296[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-19 09:13:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654470739038208[0;39m 生成今日电子书快照开始
2022-04-19 09:13:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654470739038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654470739038208[0;39m ==> Parameters: 
2022-04-19 09:13:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654470739038208[0;39m <==    Updates: 0
2022-04-19 09:13:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654470739038208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:13:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654470969724928[0;39m start updating Ebook doc
2022-04-19 09:13:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654470969724928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:13:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654470969724928[0;39m ==> Parameters: 
2022-04-19 09:13:35.095 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654470969724928[0;39m <==    Updates: 1
2022-04-19 09:13:35.095 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654470969724928[0;39m update ends, take 30 millisecs
2022-04-19 09:13:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654491689586688[0;39m 生成今日电子书快照开始
2022-04-19 09:13:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654491689586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654491689586688[0;39m ==> Parameters: 
2022-04-19 09:13:40.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654491689586688[0;39m <==    Updates: 0
2022-04-19 09:13:40.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654491689586688[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:13:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654512677883904[0;39m 生成今日电子书快照开始
2022-04-19 09:13:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654512677883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654512677883904[0;39m ==> Parameters: 
2022-04-19 09:13:45.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654512677883904[0;39m <==    Updates: 0
2022-04-19 09:13:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654512677883904[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:13:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654533653598208[0;39m 生成今日电子书快照开始
2022-04-19 09:13:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654533653598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654533653598208[0;39m ==> Parameters: 
2022-04-19 09:13:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654533653598208[0;39m <==    Updates: 0
2022-04-19 09:13:50.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654533653598208[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:13:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654554608340992[0;39m 生成今日电子书快照开始
2022-04-19 09:13:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654554608340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:13:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654554608340992[0;39m ==> Parameters: 
2022-04-19 09:13:55.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654554608340992[0;39m <==    Updates: 0
2022-04-19 09:13:55.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654554608340992[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:14:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654575558889472[0;39m 生成今日电子书快照开始
2022-04-19 09:14:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654575558889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654575558889472[0;39m ==> Parameters: 
2022-04-19 09:14:00.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654575558889472[0;39m <==    Updates: 0
2022-04-19 09:14:00.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654575558889472[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:14:05.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654596551380992[0;39m 生成今日电子书快照开始
2022-04-19 09:14:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654596551380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654596551380992[0;39m ==> Parameters: 
2022-04-19 09:14:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654596551380992[0;39m <==    Updates: 0
2022-04-19 09:14:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654596551380992[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:14:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654596769484800[0;39m start updating Ebook doc
2022-04-19 09:14:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654596769484800[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:14:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654596769484800[0;39m ==> Parameters: 
2022-04-19 09:14:05.084 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654596769484800[0;39m <==    Updates: 1
2022-04-19 09:14:05.084 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654596769484800[0;39m update ends, take 26 millisecs
2022-04-19 09:14:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654617522900992[0;39m 生成今日电子书快照开始
2022-04-19 09:14:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654617522900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654617522900992[0;39m ==> Parameters: 
2022-04-19 09:14:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654617522900992[0;39m <==    Updates: 0
2022-04-19 09:14:10.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654617522900992[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:14:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654638473449472[0;39m 生成今日电子书快照开始
2022-04-19 09:14:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654638473449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654638473449472[0;39m ==> Parameters: 
2022-04-19 09:14:15.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654638473449472[0;39m <==    Updates: 0
2022-04-19 09:14:15.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654638473449472[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:14:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654659444969472[0;39m 生成今日电子书快照开始
2022-04-19 09:14:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654659444969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654659444969472[0;39m ==> Parameters: 
2022-04-19 09:14:20.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654659444969472[0;39m <==    Updates: 0
2022-04-19 09:14:20.048 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654659444969472[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:14:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654680416489472[0;39m 生成今日电子书快照开始
2022-04-19 09:14:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654680416489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654680416489472[0;39m ==> Parameters: 
2022-04-19 09:14:25.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654680416489472[0;39m <==    Updates: 0
2022-04-19 09:14:25.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654680416489472[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:14:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654701413175296[0;39m 生成今日电子书快照开始
2022-04-19 09:14:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654701413175296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654701413175296[0;39m ==> Parameters: 
2022-04-19 09:14:30.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654701413175296[0;39m <==    Updates: 0
2022-04-19 09:14:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654701413175296[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:14:35.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654722393083904[0;39m start updating Ebook doc
2022-04-19 09:14:35.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654722393083904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:14:35.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654722393083904[0;39m ==> Parameters: 
2022-04-19 09:14:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654722393083904[0;39m <==    Updates: 1
2022-04-19 09:14:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654722393083904[0;39m update ends, take 57 millisecs
2022-04-19 09:14:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654722632159232[0;39m 生成今日电子书快照开始
2022-04-19 09:14:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654722632159232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654722632159232[0;39m ==> Parameters: 
2022-04-19 09:14:35.114 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654722632159232[0;39m <==    Updates: 0
2022-04-19 09:14:35.114 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654722632159232[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:14:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654743368798208[0;39m 生成今日电子书快照开始
2022-04-19 09:14:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654743368798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654743368798208[0;39m ==> Parameters: 
2022-04-19 09:14:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654743368798208[0;39m <==    Updates: 0
2022-04-19 09:14:40.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654743368798208[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:14:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654764306763776[0;39m 生成今日电子书快照开始
2022-04-19 09:14:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654764306763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654764306763776[0;39m ==> Parameters: 
2022-04-19 09:14:45.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654764306763776[0;39m <==    Updates: 0
2022-04-19 09:14:45.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654764306763776[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:14:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654785311838208[0;39m 生成今日电子书快照开始
2022-04-19 09:14:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654785311838208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654785311838208[0;39m ==> Parameters: 
2022-04-19 09:14:50.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654785311838208[0;39m <==    Updates: 0
2022-04-19 09:14:50.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654785311838208[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-19 09:14:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654806249803776[0;39m 生成今日电子书快照开始
2022-04-19 09:14:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654806249803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:14:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654806249803776[0;39m ==> Parameters: 
2022-04-19 09:14:55.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654806249803776[0;39m <==    Updates: 0
2022-04-19 09:14:55.052 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654806249803776[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:15:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654827238100992[0;39m 生成今日电子书快照开始
2022-04-19 09:15:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654827238100992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654827238100992[0;39m ==> Parameters: 
2022-04-19 09:15:00.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654827238100992[0;39m <==    Updates: 0
2022-04-19 09:15:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654827238100992[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:15:05.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654848222203904[0;39m 生成今日电子书快照开始
2022-04-19 09:15:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654848222203904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654848222203904[0;39m ==> Parameters: 
2022-04-19 09:15:05.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654848222203904[0;39m <==    Updates: 0
2022-04-19 09:15:05.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654848222203904[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-19 09:15:05.052 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654848402558976[0;39m start updating Ebook doc
2022-04-19 09:15:05.052 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654848402558976[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:15:05.052 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654848402558976[0;39m ==> Parameters: 
2022-04-19 09:15:05.080 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654848402558976[0;39m <==    Updates: 1
2022-04-19 09:15:05.080 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654848402558976[0;39m update ends, take 28 millisecs
2022-04-19 09:15:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654869185335296[0;39m 生成今日电子书快照开始
2022-04-19 09:15:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654869185335296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654869185335296[0;39m ==> Parameters: 
2022-04-19 09:15:10.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654869185335296[0;39m <==    Updates: 0
2022-04-19 09:15:10.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654869185335296[0;39m 生成今日电子书快照结束，耗时：43毫秒
2022-04-19 09:15:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654890148466688[0;39m 生成今日电子书快照开始
2022-04-19 09:15:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654890148466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654890148466688[0;39m ==> Parameters: 
2022-04-19 09:15:15.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654890148466688[0;39m <==    Updates: 0
2022-04-19 09:15:15.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654890148466688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:15:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654911099015168[0;39m 生成今日电子书快照开始
2022-04-19 09:15:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654911099015168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654911099015168[0;39m ==> Parameters: 
2022-04-19 09:15:20.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654911099015168[0;39m <==    Updates: 0
2022-04-19 09:15:20.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654911099015168[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:15:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654932087312384[0;39m 生成今日电子书快照开始
2022-04-19 09:15:25.166 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654932087312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:25.167 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654932087312384[0;39m ==> Parameters: 
2022-04-19 09:15:25.196 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654932087312384[0;39m <==    Updates: 0
2022-04-19 09:15:25.196 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654932087312384[0;39m 生成今日电子书快照结束，耗时：192毫秒
2022-04-19 09:15:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654953083998208[0;39m 生成今日电子书快照开始
2022-04-19 09:15:30.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654953083998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:30.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654953083998208[0;39m ==> Parameters: 
2022-04-19 09:15:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654953083998208[0;39m <==    Updates: 0
2022-04-19 09:15:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654953083998208[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:15:35.002 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171654974021963776[0;39m start updating Ebook doc
2022-04-19 09:15:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654974021963776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:15:35.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654974021963776[0;39m ==> Parameters: 
2022-04-19 09:15:35.051 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171654974021963776[0;39m <==    Updates: 1
2022-04-19 09:15:35.052 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171654974021963776[0;39m update ends, take 49 millisecs
2022-04-19 09:15:35.052 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654974231678976[0;39m 生成今日电子书快照开始
2022-04-19 09:15:35.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654974231678976[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:35.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654974231678976[0;39m ==> Parameters: 
2022-04-19 09:15:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654974231678976[0;39m <==    Updates: 0
2022-04-19 09:15:35.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654974231678976[0;39m 生成今日电子书快照结束，耗时：26毫秒
2022-04-19 09:15:40.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171654995014455296[0;39m 生成今日电子书快照开始
2022-04-19 09:15:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654995014455296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654995014455296[0;39m ==> Parameters: 
2022-04-19 09:15:40.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171654995014455296[0;39m <==    Updates: 0
2022-04-19 09:15:40.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171654995014455296[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:15:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655015998558208[0;39m 生成今日电子书快照开始
2022-04-19 09:15:45.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655015998558208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:45.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655015998558208[0;39m ==> Parameters: 
2022-04-19 09:15:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655015998558208[0;39m <==    Updates: 0
2022-04-19 09:15:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655015998558208[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:15:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655036970078208[0;39m 生成今日电子书快照开始
2022-04-19 09:15:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655036970078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655036970078208[0;39m ==> Parameters: 
2022-04-19 09:15:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655036970078208[0;39m <==    Updates: 0
2022-04-19 09:15:50.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655036970078208[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:15:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655057941598208[0;39m 生成今日电子书快照开始
2022-04-19 09:15:55.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655057941598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:15:55.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655057941598208[0;39m ==> Parameters: 
2022-04-19 09:15:55.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655057941598208[0;39m <==    Updates: 0
2022-04-19 09:15:55.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655057941598208[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-19 09:16:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655078908923904[0;39m 生成今日电子书快照开始
2022-04-19 09:16:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655078908923904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655078908923904[0;39m ==> Parameters: 
2022-04-19 09:16:00.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655078908923904[0;39m <==    Updates: 0
2022-04-19 09:16:00.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655078908923904[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:16:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655099846889472[0;39m start updating Ebook doc
2022-04-19 09:16:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655099846889472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:16:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655099846889472[0;39m ==> Parameters: 
2022-04-19 09:16:05.049 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655099846889472[0;39m <==    Updates: 1
2022-04-19 09:16:05.049 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655099846889472[0;39m update ends, take 47 millisecs
2022-04-19 09:16:05.049 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655100048216064[0;39m 生成今日电子书快照开始
2022-04-19 09:16:05.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655100048216064[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:05.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655100048216064[0;39m ==> Parameters: 
2022-04-19 09:16:05.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655100048216064[0;39m <==    Updates: 0
2022-04-19 09:16:05.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655100048216064[0;39m 生成今日电子书快照结束，耗时：30毫秒
2022-04-19 09:16:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655120847769600[0;39m 生成今日电子书快照开始
2022-04-19 09:16:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655120847769600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655120847769600[0;39m ==> Parameters: 
2022-04-19 09:16:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655120847769600[0;39m <==    Updates: 0
2022-04-19 09:16:10.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655120847769600[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:16:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655141794123776[0;39m 生成今日电子书快照开始
2022-04-19 09:16:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655141794123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655141794123776[0;39m ==> Parameters: 
2022-04-19 09:16:15.049 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655141794123776[0;39m <==    Updates: 0
2022-04-19 09:16:15.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655141794123776[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:16:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655162757255168[0;39m 生成今日电子书快照开始
2022-04-19 09:16:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655162757255168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655162757255168[0;39m ==> Parameters: 
2022-04-19 09:16:20.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655162757255168[0;39m <==    Updates: 0
2022-04-19 09:16:20.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655162757255168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:16:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655183770718208[0;39m 生成今日电子书快照开始
2022-04-19 09:16:25.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655183770718208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:25.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655183770718208[0;39m ==> Parameters: 
2022-04-19 09:16:25.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655183770718208[0;39m <==    Updates: 0
2022-04-19 09:16:25.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655183770718208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:16:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655204742238208[0;39m 生成今日电子书快照开始
2022-04-19 09:16:30.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655204742238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:30.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655204742238208[0;39m ==> Parameters: 
2022-04-19 09:16:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655204742238208[0;39m <==    Updates: 0
2022-04-19 09:16:30.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655204742238208[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:16:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655225671815168[0;39m 生成今日电子书快照开始
2022-04-19 09:16:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655225671815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:35.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655225671815168[0;39m ==> Parameters: 
2022-04-19 09:16:35.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655225671815168[0;39m <==    Updates: 0
2022-04-19 09:16:35.052 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655225671815168[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:16:35.052 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655225889918976[0;39m start updating Ebook doc
2022-04-19 09:16:35.052 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655225889918976[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:16:35.053 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655225889918976[0;39m ==> Parameters: 
2022-04-19 09:16:35.080 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655225889918976[0;39m <==    Updates: 1
2022-04-19 09:16:35.081 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655225889918976[0;39m update ends, take 29 millisecs
2022-04-19 09:16:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655246647529472[0;39m 生成今日电子书快照开始
2022-04-19 09:16:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655246647529472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655246647529472[0;39m ==> Parameters: 
2022-04-19 09:16:40.049 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655246647529472[0;39m <==    Updates: 0
2022-04-19 09:16:40.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655246647529472[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:16:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655267640020992[0;39m 生成今日电子书快照开始
2022-04-19 09:16:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655267640020992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655267640020992[0;39m ==> Parameters: 
2022-04-19 09:16:45.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655267640020992[0;39m <==    Updates: 0
2022-04-19 09:16:45.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655267640020992[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:16:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655288586375168[0;39m 生成今日电子书快照开始
2022-04-19 09:16:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655288586375168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655288586375168[0;39m ==> Parameters: 
2022-04-19 09:16:50.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655288586375168[0;39m <==    Updates: 0
2022-04-19 09:16:50.045 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655288586375168[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-19 09:16:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655309595643904[0;39m 生成今日电子书快照开始
2022-04-19 09:16:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655309595643904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:16:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655309595643904[0;39m ==> Parameters: 
2022-04-19 09:16:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655309595643904[0;39m <==    Updates: 0
2022-04-19 09:16:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655309595643904[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:17:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655330546192384[0;39m 生成今日电子书快照开始
2022-04-19 09:17:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655330546192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655330546192384[0;39m ==> Parameters: 
2022-04-19 09:17:00.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655330546192384[0;39m <==    Updates: 0
2022-04-19 09:17:00.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655330546192384[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:17:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655351526100992[0;39m start updating Ebook doc
2022-04-19 09:17:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655351526100992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:17:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655351526100992[0;39m ==> Parameters: 
2022-04-19 09:17:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655351526100992[0;39m <==    Updates: 1
2022-04-19 09:17:05.057 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655351526100992[0;39m update ends, take 51 millisecs
2022-04-19 09:17:05.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655351740010496[0;39m 生成今日电子书快照开始
2022-04-19 09:17:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655351740010496[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655351740010496[0;39m ==> Parameters: 
2022-04-19 09:17:05.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655351740010496[0;39m <==    Updates: 0
2022-04-19 09:17:05.097 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655351740010496[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-19 09:17:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655372497620992[0;39m 生成今日电子书快照开始
2022-04-19 09:17:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655372497620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655372497620992[0;39m ==> Parameters: 
2022-04-19 09:17:10.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655372497620992[0;39m <==    Updates: 0
2022-04-19 09:17:10.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655372497620992[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:17:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655393485918208[0;39m 生成今日电子书快照开始
2022-04-19 09:17:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655393485918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655393485918208[0;39m ==> Parameters: 
2022-04-19 09:17:15.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655393485918208[0;39m <==    Updates: 0
2022-04-19 09:17:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655393485918208[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:17:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655414428078080[0;39m 生成今日电子书快照开始
2022-04-19 09:17:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655414428078080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655414428078080[0;39m ==> Parameters: 
2022-04-19 09:17:20.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655414428078080[0;39m <==    Updates: 0
2022-04-19 09:17:20.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655414428078080[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:17:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655435428958208[0;39m 生成今日电子书快照开始
2022-04-19 09:17:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655435428958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655435428958208[0;39m ==> Parameters: 
2022-04-19 09:17:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655435428958208[0;39m <==    Updates: 0
2022-04-19 09:17:25.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655435428958208[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:17:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655456383700992[0;39m 生成今日电子书快照开始
2022-04-19 09:17:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655456383700992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655456383700992[0;39m ==> Parameters: 
2022-04-19 09:17:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655456383700992[0;39m <==    Updates: 0
2022-04-19 09:17:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655456383700992[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:17:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655477334249472[0;39m start updating Ebook doc
2022-04-19 09:17:35.036 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655477334249472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:17:35.037 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655477334249472[0;39m ==> Parameters: 
2022-04-19 09:17:35.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655477334249472[0;39m <==    Updates: 1
2022-04-19 09:17:35.074 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655477334249472[0;39m update ends, take 73 millisecs
2022-04-19 09:17:35.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655477640433664[0;39m 生成今日电子书快照开始
2022-04-19 09:17:35.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655477640433664[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:35.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655477640433664[0;39m ==> Parameters: 
2022-04-19 09:17:35.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655477640433664[0;39m <==    Updates: 0
2022-04-19 09:17:35.102 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655477640433664[0;39m 生成今日电子书快照结束，耗时：28毫秒
2022-04-19 09:17:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655498335129600[0;39m 生成今日电子书快照开始
2022-04-19 09:17:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655498335129600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655498335129600[0;39m ==> Parameters: 
2022-04-19 09:17:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655498335129600[0;39m <==    Updates: 0
2022-04-19 09:17:40.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655498335129600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:17:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655519277289472[0;39m 生成今日电子书快照开始
2022-04-19 09:17:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655519277289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655519277289472[0;39m ==> Parameters: 
2022-04-19 09:17:45.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655519277289472[0;39m <==    Updates: 0
2022-04-19 09:17:45.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655519277289472[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:17:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655540244615168[0;39m 生成今日电子书快照开始
2022-04-19 09:17:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655540244615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655540244615168[0;39m ==> Parameters: 
2022-04-19 09:17:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655540244615168[0;39m <==    Updates: 0
2022-04-19 09:17:50.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655540244615168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:17:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655561220329472[0;39m 生成今日电子书快照开始
2022-04-19 09:17:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655561220329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:17:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655561220329472[0;39m ==> Parameters: 
2022-04-19 09:17:55.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655561220329472[0;39m <==    Updates: 0
2022-04-19 09:17:55.047 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655561220329472[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:18:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655582196043776[0;39m 生成今日电子书快照开始
2022-04-19 09:18:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655582196043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655582196043776[0;39m ==> Parameters: 
2022-04-19 09:18:00.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655582196043776[0;39m <==    Updates: 0
2022-04-19 09:18:00.052 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655582196043776[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:18:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655603184340992[0;39m start updating Ebook doc
2022-04-19 09:18:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655603184340992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:18:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655603184340992[0;39m ==> Parameters: 
2022-04-19 09:18:05.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655603184340992[0;39m <==    Updates: 1
2022-04-19 09:18:05.056 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655603184340992[0;39m update ends, take 50 millisecs
2022-04-19 09:18:05.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655603394056192[0;39m 生成今日电子书快照开始
2022-04-19 09:18:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655603394056192[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655603394056192[0;39m ==> Parameters: 
2022-04-19 09:18:05.089 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655603394056192[0;39m <==    Updates: 0
2022-04-19 09:18:05.090 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655603394056192[0;39m 生成今日电子书快照结束，耗时：34毫秒
2022-04-19 09:18:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655624143278080[0;39m 生成今日电子书快照开始
2022-04-19 09:18:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655624143278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:10.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655624143278080[0;39m ==> Parameters: 
2022-04-19 09:18:10.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655624143278080[0;39m <==    Updates: 0
2022-04-19 09:18:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655624143278080[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:18:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655645114798080[0;39m 生成今日电子书快照开始
2022-04-19 09:18:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655645114798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:15.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655645114798080[0;39m ==> Parameters: 
2022-04-19 09:18:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655645114798080[0;39m <==    Updates: 0
2022-04-19 09:18:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655645114798080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:18:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655666115678208[0;39m 生成今日电子书快照开始
2022-04-19 09:18:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655666115678208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655666115678208[0;39m ==> Parameters: 
2022-04-19 09:18:20.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655666115678208[0;39m <==    Updates: 0
2022-04-19 09:18:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655666115678208[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:18:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655687087198208[0;39m 生成今日电子书快照开始
2022-04-19 09:18:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655687087198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655687087198208[0;39m ==> Parameters: 
2022-04-19 09:18:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655687087198208[0;39m <==    Updates: 0
2022-04-19 09:18:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655687087198208[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:18:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655708025163776[0;39m 生成今日电子书快照开始
2022-04-19 09:18:30.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655708025163776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:30.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655708025163776[0;39m ==> Parameters: 
2022-04-19 09:18:30.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655708025163776[0;39m <==    Updates: 0
2022-04-19 09:18:30.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655708025163776[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:18:35.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655729009266688[0;39m 生成今日电子书快照开始
2022-04-19 09:18:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655729009266688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:35.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655729009266688[0;39m ==> Parameters: 
2022-04-19 09:18:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655729009266688[0;39m <==    Updates: 0
2022-04-19 09:18:35.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655729009266688[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-19 09:18:35.077 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655729311256576[0;39m start updating Ebook doc
2022-04-19 09:18:35.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655729311256576[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:18:35.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655729311256576[0;39m ==> Parameters: 
2022-04-19 09:18:35.118 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655729311256576[0;39m <==    Updates: 1
2022-04-19 09:18:35.119 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655729311256576[0;39m update ends, take 42 millisecs
2022-04-19 09:18:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655749980786688[0;39m 生成今日电子书快照开始
2022-04-19 09:18:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655749980786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655749980786688[0;39m ==> Parameters: 
2022-04-19 09:18:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655749980786688[0;39m <==    Updates: 0
2022-04-19 09:18:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655749980786688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:18:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655770969083904[0;39m 生成今日电子书快照开始
2022-04-19 09:18:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655770969083904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655770969083904[0;39m ==> Parameters: 
2022-04-19 09:18:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655770969083904[0;39m <==    Updates: 0
2022-04-19 09:18:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655770969083904[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:18:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655791919632384[0;39m 生成今日电子书快照开始
2022-04-19 09:18:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655791919632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655791919632384[0;39m ==> Parameters: 
2022-04-19 09:18:50.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655791919632384[0;39m <==    Updates: 0
2022-04-19 09:18:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655791919632384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:18:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655812916318208[0;39m 生成今日电子书快照开始
2022-04-19 09:18:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655812916318208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:18:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655812916318208[0;39m ==> Parameters: 
2022-04-19 09:18:55.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655812916318208[0;39m <==    Updates: 0
2022-04-19 09:18:55.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655812916318208[0;39m 生成今日电子书快照结束，耗时：74毫秒
2022-04-19 09:19:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655833875255296[0;39m 生成今日电子书快照开始
2022-04-19 09:19:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655833875255296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655833875255296[0;39m ==> Parameters: 
2022-04-19 09:19:00.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655833875255296[0;39m <==    Updates: 0
2022-04-19 09:19:00.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655833875255296[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-19 09:19:05.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655854855163904[0;39m 生成今日电子书快照开始
2022-04-19 09:19:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655854855163904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655854855163904[0;39m ==> Parameters: 
2022-04-19 09:19:05.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655854855163904[0;39m <==    Updates: 0
2022-04-19 09:19:05.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655854855163904[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-19 09:19:05.077 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655855140376576[0;39m start updating Ebook doc
2022-04-19 09:19:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655855140376576[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:19:05.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655855140376576[0;39m ==> Parameters: 
2022-04-19 09:19:05.115 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655855140376576[0;39m <==    Updates: 1
2022-04-19 09:19:05.115 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655855140376576[0;39m update ends, take 38 millisecs
2022-04-19 09:19:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655875822489600[0;39m 生成今日电子书快照开始
2022-04-19 09:19:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655875822489600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655875822489600[0;39m ==> Parameters: 
2022-04-19 09:19:10.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655875822489600[0;39m <==    Updates: 0
2022-04-19 09:19:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655875822489600[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:19:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655896802398208[0;39m 生成今日电子书快照开始
2022-04-19 09:19:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655896802398208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:15.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655896802398208[0;39m ==> Parameters: 
2022-04-19 09:19:15.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655896802398208[0;39m <==    Updates: 0
2022-04-19 09:19:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655896802398208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:19:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655917748752384[0;39m 生成今日电子书快照开始
2022-04-19 09:19:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655917748752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655917748752384[0;39m ==> Parameters: 
2022-04-19 09:19:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655917748752384[0;39m <==    Updates: 0
2022-04-19 09:19:20.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655917748752384[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:19:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655938728660992[0;39m 生成今日电子书快照开始
2022-04-19 09:19:25.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655938728660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655938728660992[0;39m ==> Parameters: 
2022-04-19 09:19:25.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655938728660992[0;39m <==    Updates: 0
2022-04-19 09:19:25.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655938728660992[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-19 09:19:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655959704375296[0;39m 生成今日电子书快照开始
2022-04-19 09:19:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655959704375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655959704375296[0;39m ==> Parameters: 
2022-04-19 09:19:30.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655959704375296[0;39m <==    Updates: 0
2022-04-19 09:19:30.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655959704375296[0;39m 生成今日电子书快照结束，耗时：72毫秒
2022-04-19 09:19:35.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171655980671700992[0;39m start updating Ebook doc
2022-04-19 09:19:35.038 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655980671700992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:19:35.038 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655980671700992[0;39m ==> Parameters: 
2022-04-19 09:19:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171655980671700992[0;39m <==    Updates: 1
2022-04-19 09:19:35.076 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171655980671700992[0;39m update ends, take 70 millisecs
2022-04-19 09:19:35.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171655980965302272[0;39m 生成今日电子书快照开始
2022-04-19 09:19:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655980965302272[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655980965302272[0;39m ==> Parameters: 
2022-04-19 09:19:35.117 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171655980965302272[0;39m <==    Updates: 0
2022-04-19 09:19:35.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171655980965302272[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-19 09:19:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656001655803904[0;39m 生成今日电子书快照开始
2022-04-19 09:19:40.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656001655803904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:40.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656001655803904[0;39m ==> Parameters: 
2022-04-19 09:19:40.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656001655803904[0;39m <==    Updates: 0
2022-04-19 09:19:40.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656001655803904[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 09:19:45.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656022635712512[0;39m 生成今日电子书快照开始
2022-04-19 09:19:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656022635712512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:45.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656022635712512[0;39m ==> Parameters: 
2022-04-19 09:19:45.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656022635712512[0;39m <==    Updates: 0
2022-04-19 09:19:45.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656022635712512[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:19:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656043603038208[0;39m 生成今日电子书快照开始
2022-04-19 09:19:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656043603038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:50.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656043603038208[0;39m ==> Parameters: 
2022-04-19 09:19:50.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656043603038208[0;39m <==    Updates: 0
2022-04-19 09:19:50.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656043603038208[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:19:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656064574558208[0;39m 生成今日电子书快照开始
2022-04-19 09:19:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656064574558208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:19:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656064574558208[0;39m ==> Parameters: 
2022-04-19 09:19:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656064574558208[0;39m <==    Updates: 0
2022-04-19 09:19:55.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656064574558208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:20:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656085508329472[0;39m 生成今日电子书快照开始
2022-04-19 09:20:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656085508329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656085508329472[0;39m ==> Parameters: 
2022-04-19 09:20:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656085508329472[0;39m <==    Updates: 0
2022-04-19 09:20:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656085508329472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:20:05.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656106484043776[0;39m 生成今日电子书快照开始
2022-04-19 09:20:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656106484043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:05.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656106484043776[0;39m ==> Parameters: 
2022-04-19 09:20:05.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656106484043776[0;39m <==    Updates: 0
2022-04-19 09:20:05.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656106484043776[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:20:05.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656106739896320[0;39m start updating Ebook doc
2022-04-19 09:20:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656106739896320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:20:05.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656106739896320[0;39m ==> Parameters: 
2022-04-19 09:20:05.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656106739896320[0;39m <==    Updates: 1
2022-04-19 09:20:05.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656106739896320[0;39m update ends, take 40 millisecs
2022-04-19 09:20:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656127459758080[0;39m 生成今日电子书快照开始
2022-04-19 09:20:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656127459758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656127459758080[0;39m ==> Parameters: 
2022-04-19 09:20:10.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656127459758080[0;39m <==    Updates: 0
2022-04-19 09:20:10.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656127459758080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:20:15.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656148435472384[0;39m 生成今日电子书快照开始
2022-04-19 09:20:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656148435472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656148435472384[0;39m ==> Parameters: 
2022-04-19 09:20:15.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656148435472384[0;39m <==    Updates: 0
2022-04-19 09:20:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656148435472384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:20:20.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656169423769600[0;39m 生成今日电子书快照开始
2022-04-19 09:20:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656169423769600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656169423769600[0;39m ==> Parameters: 
2022-04-19 09:20:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656169423769600[0;39m <==    Updates: 0
2022-04-19 09:20:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656169423769600[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:20:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656190378512384[0;39m 生成今日电子书快照开始
2022-04-19 09:20:25.171 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656190378512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:25.171 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656190378512384[0;39m ==> Parameters: 
2022-04-19 09:20:25.244 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656190378512384[0;39m <==    Updates: 0
2022-04-19 09:20:25.244 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656190378512384[0;39m 生成今日电子书快照结束，耗时：239毫秒
2022-04-19 09:20:30.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656211366809600[0;39m 生成今日电子书快照开始
2022-04-19 09:20:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656211366809600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656211366809600[0;39m ==> Parameters: 
2022-04-19 09:20:30.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656211366809600[0;39m <==    Updates: 0
2022-04-19 09:20:30.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656211366809600[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-19 09:20:35.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656232342523904[0;39m start updating Ebook doc
2022-04-19 09:20:35.039 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656232342523904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:20:35.040 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656232342523904[0;39m ==> Parameters: 
2022-04-19 09:20:35.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656232342523904[0;39m <==    Updates: 1
2022-04-19 09:20:35.077 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656232342523904[0;39m update ends, take 68 millisecs
2022-04-19 09:20:35.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656232631930880[0;39m 生成今日电子书快照开始
2022-04-19 09:20:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656232631930880[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656232631930880[0;39m ==> Parameters: 
2022-04-19 09:20:35.121 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656232631930880[0;39m <==    Updates: 0
2022-04-19 09:20:35.121 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656232631930880[0;39m 生成今日电子书快照结束，耗时：43毫秒
2022-04-19 09:20:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656253318238208[0;39m 生成今日电子书快照开始
2022-04-19 09:20:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656253318238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656253318238208[0;39m ==> Parameters: 
2022-04-19 09:20:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656253318238208[0;39m <==    Updates: 0
2022-04-19 09:20:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656253318238208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:20:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656274277175296[0;39m 生成今日电子书快照开始
2022-04-19 09:20:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656274277175296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656274277175296[0;39m ==> Parameters: 
2022-04-19 09:20:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656274277175296[0;39m <==    Updates: 0
2022-04-19 09:20:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656274277175296[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:20:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656295252889600[0;39m 生成今日电子书快照开始
2022-04-19 09:20:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656295252889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656295252889600[0;39m ==> Parameters: 
2022-04-19 09:20:50.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656295252889600[0;39m <==    Updates: 0
2022-04-19 09:20:50.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656295252889600[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:20:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656316224409600[0;39m 生成今日电子书快照开始
2022-04-19 09:20:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656316224409600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:20:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656316224409600[0;39m ==> Parameters: 
2022-04-19 09:20:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656316224409600[0;39m <==    Updates: 0
2022-04-19 09:20:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656316224409600[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:21:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656337195929600[0;39m 生成今日电子书快照开始
2022-04-19 09:21:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656337195929600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656337195929600[0;39m ==> Parameters: 
2022-04-19 09:21:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656337195929600[0;39m <==    Updates: 0
2022-04-19 09:21:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656337195929600[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:21:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656358138089472[0;39m start updating Ebook doc
2022-04-19 09:21:05.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656358138089472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:21:05.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656358138089472[0;39m ==> Parameters: 
2022-04-19 09:21:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656358138089472[0;39m <==    Updates: 1
2022-04-19 09:21:05.073 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656358138089472[0;39m update ends, take 71 millisecs
2022-04-19 09:21:05.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656358440079360[0;39m 生成今日电子书快照开始
2022-04-19 09:21:05.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656358440079360[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:05.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656358440079360[0;39m ==> Parameters: 
2022-04-19 09:21:05.114 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656358440079360[0;39m <==    Updates: 0
2022-04-19 09:21:05.115 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656358440079360[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-19 09:21:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656379147358208[0;39m 生成今日电子书快照开始
2022-04-19 09:21:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656379147358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656379147358208[0;39m ==> Parameters: 
2022-04-19 09:21:10.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656379147358208[0;39m <==    Updates: 0
2022-04-19 09:21:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656379147358208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:21:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656400085323776[0;39m 生成今日电子书快照开始
2022-04-19 09:21:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656400085323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656400085323776[0;39m ==> Parameters: 
2022-04-19 09:21:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656400085323776[0;39m <==    Updates: 0
2022-04-19 09:21:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656400085323776[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-19 09:21:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656421065232384[0;39m 生成今日电子书快照开始
2022-04-19 09:21:20.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656421065232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656421065232384[0;39m ==> Parameters: 
2022-04-19 09:21:20.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656421065232384[0;39m <==    Updates: 0
2022-04-19 09:21:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656421065232384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:21:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656442061918208[0;39m 生成今日电子书快照开始
2022-04-19 09:21:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656442061918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656442061918208[0;39m ==> Parameters: 
2022-04-19 09:21:25.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656442061918208[0;39m <==    Updates: 0
2022-04-19 09:21:25.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656442061918208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:21:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656463020855296[0;39m 生成今日电子书快照开始
2022-04-19 09:21:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656463020855296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656463020855296[0;39m ==> Parameters: 
2022-04-19 09:21:30.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656463020855296[0;39m <==    Updates: 0
2022-04-19 09:21:30.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656463020855296[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:21:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656484004958208[0;39m start updating Ebook doc
2022-04-19 09:21:35.043 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656484004958208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:21:35.043 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656484004958208[0;39m ==> Parameters: 
2022-04-19 09:21:35.081 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656484004958208[0;39m <==    Updates: 1
2022-04-19 09:21:35.082 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656484004958208[0;39m update ends, take 72 millisecs
2022-04-19 09:21:35.082 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656484306948096[0;39m 生成今日电子书快照开始
2022-04-19 09:21:35.082 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656484306948096[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:35.083 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656484306948096[0;39m ==> Parameters: 
2022-04-19 09:21:35.124 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656484306948096[0;39m <==    Updates: 0
2022-04-19 09:21:35.124 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656484306948096[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-19 09:21:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656504968089600[0;39m 生成今日电子书快照开始
2022-04-19 09:21:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656504968089600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656504968089600[0;39m ==> Parameters: 
2022-04-19 09:21:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656504968089600[0;39m <==    Updates: 0
2022-04-19 09:21:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656504968089600[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:21:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656525939609600[0;39m 生成今日电子书快照开始
2022-04-19 09:21:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656525939609600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656525939609600[0;39m ==> Parameters: 
2022-04-19 09:21:45.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656525939609600[0;39m <==    Updates: 0
2022-04-19 09:21:45.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656525939609600[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:21:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656546919518208[0;39m 生成今日电子书快照开始
2022-04-19 09:21:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656546919518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656546919518208[0;39m ==> Parameters: 
2022-04-19 09:21:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656546919518208[0;39m <==    Updates: 0
2022-04-19 09:21:50.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656546919518208[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:21:55.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656567895232512[0;39m 生成今日电子书快照开始
2022-04-19 09:21:55.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656567895232512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:21:55.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656567895232512[0;39m ==> Parameters: 
2022-04-19 09:21:55.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656567895232512[0;39m <==    Updates: 0
2022-04-19 09:21:55.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656567895232512[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 09:22:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656588854169600[0;39m 生成今日电子书快照开始
2022-04-19 09:22:00.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656588854169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:00.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656588854169600[0;39m ==> Parameters: 
2022-04-19 09:22:00.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656588854169600[0;39m <==    Updates: 0
2022-04-19 09:22:00.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656588854169600[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-19 09:22:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656609804718080[0;39m 生成今日电子书快照开始
2022-04-19 09:22:05.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656609804718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:05.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656609804718080[0;39m ==> Parameters: 
2022-04-19 09:22:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656609804718080[0;39m <==    Updates: 0
2022-04-19 09:22:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656609804718080[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:22:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656610035404800[0;39m start updating Ebook doc
2022-04-19 09:22:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656610035404800[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:22:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656610035404800[0;39m ==> Parameters: 
2022-04-19 09:22:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656610035404800[0;39m <==    Updates: 1
2022-04-19 09:22:05.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656610035404800[0;39m update ends, take 48 millisecs
2022-04-19 09:22:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656630797209600[0;39m 生成今日电子书快照开始
2022-04-19 09:22:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656630797209600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656630797209600[0;39m ==> Parameters: 
2022-04-19 09:22:10.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656630797209600[0;39m <==    Updates: 0
2022-04-19 09:22:10.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656630797209600[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:22:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656651777118208[0;39m 生成今日电子书快照开始
2022-04-19 09:22:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656651777118208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656651777118208[0;39m ==> Parameters: 
2022-04-19 09:22:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656651777118208[0;39m <==    Updates: 0
2022-04-19 09:22:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656651777118208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:22:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656672748638208[0;39m 生成今日电子书快照开始
2022-04-19 09:22:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656672748638208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656672748638208[0;39m ==> Parameters: 
2022-04-19 09:22:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656672748638208[0;39m <==    Updates: 0
2022-04-19 09:22:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656672748638208[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:22:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656693720158208[0;39m 生成今日电子书快照开始
2022-04-19 09:22:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656693720158208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656693720158208[0;39m ==> Parameters: 
2022-04-19 09:22:25.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656693720158208[0;39m <==    Updates: 0
2022-04-19 09:22:25.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656693720158208[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:22:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656714662318080[0;39m 生成今日电子书快照开始
2022-04-19 09:22:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656714662318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656714662318080[0;39m ==> Parameters: 
2022-04-19 09:22:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656714662318080[0;39m <==    Updates: 0
2022-04-19 09:22:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656714662318080[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:22:35.007 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656735650615296[0;39m start updating Ebook doc
2022-04-19 09:22:35.046 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656735650615296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:22:35.047 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656735650615296[0;39m ==> Parameters: 
2022-04-19 09:22:35.089 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656735650615296[0;39m <==    Updates: 1
2022-04-19 09:22:35.089 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656735650615296[0;39m update ends, take 82 millisecs
2022-04-19 09:22:35.090 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656735998742528[0;39m 生成今日电子书快照开始
2022-04-19 09:22:35.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656735998742528[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:35.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656735998742528[0;39m ==> Parameters: 
2022-04-19 09:22:35.146 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656735998742528[0;39m <==    Updates: 0
2022-04-19 09:22:35.147 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656735998742528[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:22:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656756634718208[0;39m 生成今日电子书快照开始
2022-04-19 09:22:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656756634718208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656756634718208[0;39m ==> Parameters: 
2022-04-19 09:22:40.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656756634718208[0;39m <==    Updates: 0
2022-04-19 09:22:40.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656756634718208[0;39m 生成今日电子书快照结束，耗时：69毫秒
2022-04-19 09:22:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656777568489472[0;39m 生成今日电子书快照开始
2022-04-19 09:22:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656777568489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656777568489472[0;39m ==> Parameters: 
2022-04-19 09:22:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656777568489472[0;39m <==    Updates: 0
2022-04-19 09:22:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656777568489472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:22:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656798577758208[0;39m 生成今日电子书快照开始
2022-04-19 09:22:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656798577758208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656798577758208[0;39m ==> Parameters: 
2022-04-19 09:22:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656798577758208[0;39m <==    Updates: 0
2022-04-19 09:22:50.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656798577758208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:22:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656819540889600[0;39m 生成今日电子书快照开始
2022-04-19 09:22:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656819540889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:22:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656819540889600[0;39m ==> Parameters: 
2022-04-19 09:22:55.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656819540889600[0;39m <==    Updates: 0
2022-04-19 09:22:55.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656819540889600[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:23:00.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656840520798208[0;39m 生成今日电子书快照开始
2022-04-19 09:23:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656840520798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656840520798208[0;39m ==> Parameters: 
2022-04-19 09:23:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656840520798208[0;39m <==    Updates: 0
2022-04-19 09:23:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656840520798208[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:23:05.005 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656861471346688[0;39m start updating Ebook doc
2022-04-19 09:23:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656861471346688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:23:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656861471346688[0;39m ==> Parameters: 
2022-04-19 09:23:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656861471346688[0;39m <==    Updates: 1
2022-04-19 09:23:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656861471346688[0;39m update ends, take 62 millisecs
2022-04-19 09:23:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656861731393536[0;39m 生成今日电子书快照开始
2022-04-19 09:23:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656861731393536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656861731393536[0;39m ==> Parameters: 
2022-04-19 09:23:05.113 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656861731393536[0;39m <==    Updates: 0
2022-04-19 09:23:05.113 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656861731393536[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:23:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656882442866688[0;39m 生成今日电子书快照开始
2022-04-19 09:23:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656882442866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656882442866688[0;39m ==> Parameters: 
2022-04-19 09:23:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656882442866688[0;39m <==    Updates: 0
2022-04-19 09:23:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656882442866688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:23:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656903435358208[0;39m 生成今日电子书快照开始
2022-04-19 09:23:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656903435358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656903435358208[0;39m ==> Parameters: 
2022-04-19 09:23:15.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656903435358208[0;39m <==    Updates: 0
2022-04-19 09:23:15.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656903435358208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:23:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656924381712384[0;39m 生成今日电子书快照开始
2022-04-19 09:23:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656924381712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656924381712384[0;39m ==> Parameters: 
2022-04-19 09:23:20.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656924381712384[0;39m <==    Updates: 0
2022-04-19 09:23:20.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656924381712384[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:23:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656945378398208[0;39m 生成今日电子书快照开始
2022-04-19 09:23:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656945378398208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656945378398208[0;39m ==> Parameters: 
2022-04-19 09:23:25.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656945378398208[0;39m <==    Updates: 0
2022-04-19 09:23:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656945378398208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:23:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656966324752384[0;39m 生成今日电子书快照开始
2022-04-19 09:23:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656966324752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656966324752384[0;39m ==> Parameters: 
2022-04-19 09:23:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656966324752384[0;39m <==    Updates: 0
2022-04-19 09:23:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656966324752384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:23:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171656987321438208[0;39m 生成今日电子书快照开始
2022-04-19 09:23:35.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656987321438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:35.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656987321438208[0;39m ==> Parameters: 
2022-04-19 09:23:35.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171656987321438208[0;39m <==    Updates: 0
2022-04-19 09:23:35.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171656987321438208[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-19 09:23:35.081 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171656987619233792[0;39m start updating Ebook doc
2022-04-19 09:23:35.081 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656987619233792[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:23:35.082 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656987619233792[0;39m ==> Parameters: 
2022-04-19 09:23:35.116 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171656987619233792[0;39m <==    Updates: 1
2022-04-19 09:23:35.116 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171656987619233792[0;39m update ends, take 35 millisecs
2022-04-19 09:23:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657008255209472[0;39m 生成今日电子书快照开始
2022-04-19 09:23:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657008255209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657008255209472[0;39m ==> Parameters: 
2022-04-19 09:23:40.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657008255209472[0;39m <==    Updates: 0
2022-04-19 09:23:40.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657008255209472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:23:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657029247700992[0;39m 生成今日电子书快照开始
2022-04-19 09:23:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657029247700992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657029247700992[0;39m ==> Parameters: 
2022-04-19 09:23:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657029247700992[0;39m <==    Updates: 0
2022-04-19 09:23:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657029247700992[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:23:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657050235998208[0;39m 生成今日电子书快照开始
2022-04-19 09:23:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657050235998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657050235998208[0;39m ==> Parameters: 
2022-04-19 09:23:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657050235998208[0;39m <==    Updates: 0
2022-04-19 09:23:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657050235998208[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:23:55.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657071190740992[0;39m 生成今日电子书快照开始
2022-04-19 09:23:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657071190740992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:23:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657071190740992[0;39m ==> Parameters: 
2022-04-19 09:23:55.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657071190740992[0;39m <==    Updates: 0
2022-04-19 09:23:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657071190740992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:24:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657092149678080[0;39m 生成今日电子书快照开始
2022-04-19 09:24:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657092149678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657092149678080[0;39m ==> Parameters: 
2022-04-19 09:24:00.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657092149678080[0;39m <==    Updates: 0
2022-04-19 09:24:00.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657092149678080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:24:05.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657113146363904[0;39m start updating Ebook doc
2022-04-19 09:24:05.030 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657113146363904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:24:05.031 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657113146363904[0;39m ==> Parameters: 
2022-04-19 09:24:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657113146363904[0;39m <==    Updates: 1
2022-04-19 09:24:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657113146363904[0;39m update ends, take 57 millisecs
2022-04-19 09:24:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657113385439232[0;39m 生成今日电子书快照开始
2022-04-19 09:24:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657113385439232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657113385439232[0;39m ==> Parameters: 
2022-04-19 09:24:05.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657113385439232[0;39m <==    Updates: 0
2022-04-19 09:24:05.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657113385439232[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-19 09:24:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657134101106688[0;39m 生成今日电子书快照开始
2022-04-19 09:24:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657134101106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657134101106688[0;39m ==> Parameters: 
2022-04-19 09:24:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657134101106688[0;39m <==    Updates: 0
2022-04-19 09:24:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657134101106688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:24:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657155051655168[0;39m 生成今日电子书快照开始
2022-04-19 09:24:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657155051655168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657155051655168[0;39m ==> Parameters: 
2022-04-19 09:24:15.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657155051655168[0;39m <==    Updates: 0
2022-04-19 09:24:15.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657155051655168[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:24:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657176044146688[0;39m 生成今日电子书快照开始
2022-04-19 09:24:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657176044146688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657176044146688[0;39m ==> Parameters: 
2022-04-19 09:24:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657176044146688[0;39m <==    Updates: 0
2022-04-19 09:24:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657176044146688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:24:25.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657197040832512[0;39m 生成今日电子书快照开始
2022-04-19 09:24:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657197040832512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657197040832512[0;39m ==> Parameters: 
2022-04-19 09:24:25.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657197040832512[0;39m <==    Updates: 0
2022-04-19 09:24:25.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657197040832512[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:24:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657217987186688[0;39m 生成今日电子书快照开始
2022-04-19 09:24:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657217987186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657217987186688[0;39m ==> Parameters: 
2022-04-19 09:24:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657217987186688[0;39m <==    Updates: 0
2022-04-19 09:24:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657217987186688[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:24:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657238979678208[0;39m start updating Ebook doc
2022-04-19 09:24:35.045 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657238979678208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:24:35.045 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657238979678208[0;39m ==> Parameters: 
2022-04-19 09:24:35.084 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657238979678208[0;39m <==    Updates: 1
2022-04-19 09:24:35.084 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657238979678208[0;39m update ends, take 74 millisecs
2022-04-19 09:24:35.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657239290056704[0;39m 生成今日电子书快照开始
2022-04-19 09:24:35.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657239290056704[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:35.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657239290056704[0;39m ==> Parameters: 
2022-04-19 09:24:35.129 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657239290056704[0;39m <==    Updates: 0
2022-04-19 09:24:35.129 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657239290056704[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:24:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657259951198208[0;39m 生成今日电子书快照开始
2022-04-19 09:24:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657259951198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657259951198208[0;39m ==> Parameters: 
2022-04-19 09:24:40.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657259951198208[0;39m <==    Updates: 0
2022-04-19 09:24:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657259951198208[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:24:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657280901746688[0;39m 生成今日电子书快照开始
2022-04-19 09:24:45.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657280901746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:45.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657280901746688[0;39m ==> Parameters: 
2022-04-19 09:24:45.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657280901746688[0;39m <==    Updates: 0
2022-04-19 09:24:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657280901746688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:24:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657301869072384[0;39m 生成今日电子书快照开始
2022-04-19 09:24:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657301869072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657301869072384[0;39m ==> Parameters: 
2022-04-19 09:24:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657301869072384[0;39m <==    Updates: 0
2022-04-19 09:24:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657301869072384[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:24:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657322865758208[0;39m 生成今日电子书快照开始
2022-04-19 09:24:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657322865758208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:24:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657322865758208[0;39m ==> Parameters: 
2022-04-19 09:24:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657322865758208[0;39m <==    Updates: 0
2022-04-19 09:24:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657322865758208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:25:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657343824695296[0;39m 生成今日电子书快照开始
2022-04-19 09:25:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657343824695296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657343824695296[0;39m ==> Parameters: 
2022-04-19 09:25:00.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657343824695296[0;39m <==    Updates: 0
2022-04-19 09:25:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657343824695296[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:25:05.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657364779438080[0;39m start updating Ebook doc
2022-04-19 09:25:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657364779438080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:25:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657364779438080[0;39m ==> Parameters: 
2022-04-19 09:25:05.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657364779438080[0;39m <==    Updates: 1
2022-04-19 09:25:05.062 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657364779438080[0;39m update ends, take 58 millisecs
2022-04-19 09:25:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657365026902016[0;39m 生成今日电子书快照开始
2022-04-19 09:25:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657365026902016[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657365026902016[0;39m ==> Parameters: 
2022-04-19 09:25:05.102 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657365026902016[0;39m <==    Updates: 0
2022-04-19 09:25:05.102 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657365026902016[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-19 09:25:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657385776123904[0;39m 生成今日电子书快照开始
2022-04-19 09:25:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657385776123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657385776123904[0;39m ==> Parameters: 
2022-04-19 09:25:10.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657385776123904[0;39m <==    Updates: 0
2022-04-19 09:25:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657385776123904[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:25:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657406722478080[0;39m 生成今日电子书快照开始
2022-04-19 09:25:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657406722478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657406722478080[0;39m ==> Parameters: 
2022-04-19 09:25:15.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657406722478080[0;39m <==    Updates: 0
2022-04-19 09:25:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657406722478080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:25:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657427723358208[0;39m 生成今日电子书快照开始
2022-04-19 09:25:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657427723358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657427723358208[0;39m ==> Parameters: 
2022-04-19 09:25:20.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657427723358208[0;39m <==    Updates: 0
2022-04-19 09:25:20.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657427723358208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:25:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657448669712384[0;39m 生成今日电子书快照开始
2022-04-19 09:25:25.190 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657448669712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:25.190 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657448669712384[0;39m ==> Parameters: 
2022-04-19 09:25:25.276 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657448669712384[0;39m <==    Updates: 0
2022-04-19 09:25:25.276 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657448669712384[0;39m 生成今日电子书快照结束，耗时：272毫秒
2022-04-19 09:25:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657469628649472[0;39m 生成今日电子书快照开始
2022-04-19 09:25:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657469628649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657469628649472[0;39m ==> Parameters: 
2022-04-19 09:25:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657469628649472[0;39m <==    Updates: 0
2022-04-19 09:25:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657469628649472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:25:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657490608558080[0;39m start updating Ebook doc
2022-04-19 09:25:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657490608558080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:25:35.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657490608558080[0;39m ==> Parameters: 
2022-04-19 09:25:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657490608558080[0;39m <==    Updates: 1
2022-04-19 09:25:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657490608558080[0;39m update ends, take 63 millisecs
2022-04-19 09:25:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657490876993536[0;39m 生成今日电子书快照开始
2022-04-19 09:25:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657490876993536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657490876993536[0;39m ==> Parameters: 
2022-04-19 09:25:35.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657490876993536[0;39m <==    Updates: 0
2022-04-19 09:25:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657490876993536[0;39m 生成今日电子书快照结束，耗时：36毫秒
2022-04-19 09:25:40.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657511596855296[0;39m 生成今日电子书快照开始
2022-04-19 09:25:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657511596855296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657511596855296[0;39m ==> Parameters: 
2022-04-19 09:25:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657511596855296[0;39m <==    Updates: 0
2022-04-19 09:25:40.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657511596855296[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:25:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657532559986688[0;39m 生成今日电子书快照开始
2022-04-19 09:25:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657532559986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657532559986688[0;39m ==> Parameters: 
2022-04-19 09:25:45.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657532559986688[0;39m <==    Updates: 0
2022-04-19 09:25:45.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657532559986688[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:25:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657553523118080[0;39m 生成今日电子书快照开始
2022-04-19 09:25:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657553523118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657553523118080[0;39m ==> Parameters: 
2022-04-19 09:25:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657553523118080[0;39m <==    Updates: 0
2022-04-19 09:25:50.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657553523118080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:25:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657574494638080[0;39m 生成今日电子书快照开始
2022-04-19 09:25:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657574494638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:25:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657574494638080[0;39m ==> Parameters: 
2022-04-19 09:25:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657574494638080[0;39m <==    Updates: 0
2022-04-19 09:25:55.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657574494638080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:26:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657595474546688[0;39m 生成今日电子书快照开始
2022-04-19 09:26:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657595474546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:00.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657595474546688[0;39m ==> Parameters: 
2022-04-19 09:26:00.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657595474546688[0;39m <==    Updates: 0
2022-04-19 09:26:00.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657595474546688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:26:05.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657616467038208[0;39m start updating Ebook doc
2022-04-19 09:26:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657616467038208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:26:05.034 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657616467038208[0;39m ==> Parameters: 
2022-04-19 09:26:05.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657616467038208[0;39m <==    Updates: 1
2022-04-19 09:26:05.070 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657616467038208[0;39m update ends, take 60 millisecs
2022-04-19 09:26:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657616718696448[0;39m 生成今日电子书快照开始
2022-04-19 09:26:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657616718696448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657616718696448[0;39m ==> Parameters: 
2022-04-19 09:26:05.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657616718696448[0;39m <==    Updates: 0
2022-04-19 09:26:05.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657616718696448[0;39m 生成今日电子书快照结束，耗时：35毫秒
2022-04-19 09:26:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657637425975296[0;39m 生成今日电子书快照开始
2022-04-19 09:26:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657637425975296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657637425975296[0;39m ==> Parameters: 
2022-04-19 09:26:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657637425975296[0;39m <==    Updates: 0
2022-04-19 09:26:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657637425975296[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:26:15.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657658414272512[0;39m 生成今日电子书快照开始
2022-04-19 09:26:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657658414272512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657658414272512[0;39m ==> Parameters: 
2022-04-19 09:26:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657658414272512[0;39m <==    Updates: 0
2022-04-19 09:26:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657658414272512[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:26:20.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657679377403904[0;39m 生成今日电子书快照开始
2022-04-19 09:26:20.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657679377403904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657679377403904[0;39m ==> Parameters: 
2022-04-19 09:26:20.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657679377403904[0;39m <==    Updates: 0
2022-04-19 09:26:20.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657679377403904[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:26:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657700336340992[0;39m 生成今日电子书快照开始
2022-04-19 09:26:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657700336340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:25.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657700336340992[0;39m ==> Parameters: 
2022-04-19 09:26:25.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657700336340992[0;39m <==    Updates: 0
2022-04-19 09:26:25.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657700336340992[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:26:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657721299472384[0;39m 生成今日电子书快照开始
2022-04-19 09:26:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657721299472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657721299472384[0;39m ==> Parameters: 
2022-04-19 09:26:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657721299472384[0;39m <==    Updates: 0
2022-04-19 09:26:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657721299472384[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:26:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657742266798080[0;39m start updating Ebook doc
2022-04-19 09:26:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657742266798080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:26:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657742266798080[0;39m ==> Parameters: 
2022-04-19 09:26:35.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657742266798080[0;39m <==    Updates: 1
2022-04-19 09:26:35.059 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657742266798080[0;39m update ends, take 55 millisecs
2022-04-19 09:26:35.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657742501679104[0;39m 生成今日电子书快照开始
2022-04-19 09:26:35.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657742501679104[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:35.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657742501679104[0;39m ==> Parameters: 
2022-04-19 09:26:35.097 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657742501679104[0;39m <==    Updates: 0
2022-04-19 09:26:35.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657742501679104[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-19 09:26:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657763238318080[0;39m 生成今日电子书快照开始
2022-04-19 09:26:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657763238318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:40.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657763238318080[0;39m ==> Parameters: 
2022-04-19 09:26:40.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657763238318080[0;39m <==    Updates: 0
2022-04-19 09:26:40.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657763238318080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:26:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657784226615296[0;39m 生成今日电子书快照开始
2022-04-19 09:26:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657784226615296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657784226615296[0;39m ==> Parameters: 
2022-04-19 09:26:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657784226615296[0;39m <==    Updates: 0
2022-04-19 09:26:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657784226615296[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:26:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657805210718208[0;39m 生成今日电子书快照开始
2022-04-19 09:26:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657805210718208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657805210718208[0;39m ==> Parameters: 
2022-04-19 09:26:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657805210718208[0;39m <==    Updates: 0
2022-04-19 09:26:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657805210718208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:26:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657826182238208[0;39m 生成今日电子书快照开始
2022-04-19 09:26:55.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657826182238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:26:55.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657826182238208[0;39m ==> Parameters: 
2022-04-19 09:26:55.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657826182238208[0;39m <==    Updates: 0
2022-04-19 09:26:55.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657826182238208[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:27:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657847111815168[0;39m 生成今日电子书快照开始
2022-04-19 09:27:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657847111815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:00.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657847111815168[0;39m ==> Parameters: 
2022-04-19 09:27:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657847111815168[0;39m <==    Updates: 0
2022-04-19 09:27:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657847111815168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:27:05.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657868125278208[0;39m start updating Ebook doc
2022-04-19 09:27:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657868125278208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:27:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657868125278208[0;39m ==> Parameters: 
2022-04-19 09:27:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657868125278208[0;39m <==    Updates: 1
2022-04-19 09:27:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657868125278208[0;39m update ends, take 55 millisecs
2022-04-19 09:27:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657868360159232[0;39m 生成今日电子书快照开始
2022-04-19 09:27:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657868360159232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657868360159232[0;39m ==> Parameters: 
2022-04-19 09:27:05.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657868360159232[0;39m <==    Updates: 0
2022-04-19 09:27:05.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657868360159232[0;39m 生成今日电子书快照结束，耗时：37毫秒
2022-04-19 09:27:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657889075826688[0;39m 生成今日电子书快照开始
2022-04-19 09:27:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657889075826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657889075826688[0;39m ==> Parameters: 
2022-04-19 09:27:10.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657889075826688[0;39m <==    Updates: 0
2022-04-19 09:27:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657889075826688[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:27:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657910068318208[0;39m 生成今日电子书快照开始
2022-04-19 09:27:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657910068318208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657910068318208[0;39m ==> Parameters: 
2022-04-19 09:27:15.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657910068318208[0;39m <==    Updates: 0
2022-04-19 09:27:15.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657910068318208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:27:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657931039838208[0;39m 生成今日电子书快照开始
2022-04-19 09:27:20.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657931039838208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:20.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657931039838208[0;39m ==> Parameters: 
2022-04-19 09:27:20.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657931039838208[0;39m <==    Updates: 0
2022-04-19 09:27:20.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657931039838208[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-19 09:27:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657952002969600[0;39m 生成今日电子书快照开始
2022-04-19 09:27:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657952002969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:25.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657952002969600[0;39m ==> Parameters: 
2022-04-19 09:27:25.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657952002969600[0;39m <==    Updates: 0
2022-04-19 09:27:25.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657952002969600[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:27:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657972945129472[0;39m 生成今日电子书快照开始
2022-04-19 09:27:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657972945129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657972945129472[0;39m ==> Parameters: 
2022-04-19 09:27:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657972945129472[0;39m <==    Updates: 0
2022-04-19 09:27:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657972945129472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:27:35.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171657993937620992[0;39m 生成今日电子书快照开始
2022-04-19 09:27:35.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657993937620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:35.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657993937620992[0;39m ==> Parameters: 
2022-04-19 09:27:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171657993937620992[0;39m <==    Updates: 0
2022-04-19 09:27:35.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171657993937620992[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-19 09:27:35.079 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171657994243805184[0;39m start updating Ebook doc
2022-04-19 09:27:35.079 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657994243805184[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:27:35.079 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657994243805184[0;39m ==> Parameters: 
2022-04-19 09:27:35.113 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171657994243805184[0;39m <==    Updates: 1
2022-04-19 09:27:35.114 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171657994243805184[0;39m update ends, take 35 millisecs
2022-04-19 09:27:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658014888169472[0;39m 生成今日电子书快照开始
2022-04-19 09:27:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658014888169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658014888169472[0;39m ==> Parameters: 
2022-04-19 09:27:40.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658014888169472[0;39m <==    Updates: 0
2022-04-19 09:27:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658014888169472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:27:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658035880660992[0;39m 生成今日电子书快照开始
2022-04-19 09:27:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658035880660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658035880660992[0;39m ==> Parameters: 
2022-04-19 09:27:45.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658035880660992[0;39m <==    Updates: 0
2022-04-19 09:27:45.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658035880660992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:27:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658056843792384[0;39m 生成今日电子书快照开始
2022-04-19 09:27:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658056843792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658056843792384[0;39m ==> Parameters: 
2022-04-19 09:27:50.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658056843792384[0;39m <==    Updates: 0
2022-04-19 09:27:50.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658056843792384[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:27:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658077840478208[0;39m 生成今日电子书快照开始
2022-04-19 09:27:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658077840478208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:27:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658077840478208[0;39m ==> Parameters: 
2022-04-19 09:27:55.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658077840478208[0;39m <==    Updates: 0
2022-04-19 09:27:55.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658077840478208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:28:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658098803609600[0;39m 生成今日电子书快照开始
2022-04-19 09:28:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658098803609600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658098803609600[0;39m ==> Parameters: 
2022-04-19 09:28:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658098803609600[0;39m <==    Updates: 0
2022-04-19 09:28:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658098803609600[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:28:05.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171658119754158080[0;39m start updating Ebook doc
2022-04-19 09:28:05.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658119754158080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:28:05.025 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658119754158080[0;39m ==> Parameters: 
2022-04-19 09:28:05.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658119754158080[0;39m <==    Updates: 1
2022-04-19 09:28:05.061 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171658119754158080[0;39m update ends, take 58 millisecs
2022-04-19 09:28:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658120001622016[0;39m 生成今日电子书快照开始
2022-04-19 09:28:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658120001622016[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:05.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658120001622016[0;39m ==> Parameters: 
2022-04-19 09:28:05.101 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658120001622016[0;39m <==    Updates: 0
2022-04-19 09:28:05.101 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658120001622016[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-19 09:28:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658140750843904[0;39m 生成今日电子书快照开始
2022-04-19 09:28:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658140750843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658140750843904[0;39m ==> Parameters: 
2022-04-19 09:28:10.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658140750843904[0;39m <==    Updates: 0
2022-04-19 09:28:10.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658140750843904[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:28:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658161726558208[0;39m 生成今日电子书快照开始
2022-04-19 09:28:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658161726558208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658161726558208[0;39m ==> Parameters: 
2022-04-19 09:28:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658161726558208[0;39m <==    Updates: 0
2022-04-19 09:28:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658161726558208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:28:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658182681300992[0;39m 生成今日电子书快照开始
2022-04-19 09:28:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658182681300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658182681300992[0;39m ==> Parameters: 
2022-04-19 09:28:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658182681300992[0;39m <==    Updates: 0
2022-04-19 09:28:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658182681300992[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:28:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658203657015296[0;39m 生成今日电子书快照开始
2022-04-19 09:28:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658203657015296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658203657015296[0;39m ==> Parameters: 
2022-04-19 09:28:25.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658203657015296[0;39m <==    Updates: 0
2022-04-19 09:28:25.084 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658203657015296[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-19 09:28:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658224636923904[0;39m 生成今日电子书快照开始
2022-04-19 09:28:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658224636923904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658224636923904[0;39m ==> Parameters: 
2022-04-19 09:28:30.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658224636923904[0;39m <==    Updates: 0
2022-04-19 09:28:30.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658224636923904[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:28:35.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171658245608443904[0;39m start updating Ebook doc
2022-04-19 09:28:35.038 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658245608443904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:28:35.039 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658245608443904[0;39m ==> Parameters: 
2022-04-19 09:28:35.083 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658245608443904[0;39m <==    Updates: 1
2022-04-19 09:28:35.083 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171658245608443904[0;39m update ends, take 74 millisecs
2022-04-19 09:28:35.083 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658245918822400[0;39m 生成今日电子书快照开始
2022-04-19 09:28:35.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658245918822400[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:35.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658245918822400[0;39m ==> Parameters: 
2022-04-19 09:28:35.127 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658245918822400[0;39m <==    Updates: 0
2022-04-19 09:28:35.128 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658245918822400[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:28:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658266584158208[0;39m 生成今日电子书快照开始
2022-04-19 09:28:40.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658266584158208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:40.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658266584158208[0;39m ==> Parameters: 
2022-04-19 09:28:40.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658266584158208[0;39m <==    Updates: 0
2022-04-19 09:28:40.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658266584158208[0;39m 生成今日电子书快照结束，耗时：68毫秒
2022-04-19 09:28:45.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658287547289600[0;39m 生成今日电子书快照开始
2022-04-19 09:28:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658287547289600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658287547289600[0;39m ==> Parameters: 
2022-04-19 09:28:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658287547289600[0;39m <==    Updates: 0
2022-04-19 09:28:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658287547289600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:28:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658308493643776[0;39m 生成今日电子书快照开始
2022-04-19 09:28:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658308493643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658308493643776[0;39m ==> Parameters: 
2022-04-19 09:28:50.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658308493643776[0;39m <==    Updates: 0
2022-04-19 09:28:50.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658308493643776[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:28:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658329498718208[0;39m 生成今日电子书快照开始
2022-04-19 09:28:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658329498718208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:28:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658329498718208[0;39m ==> Parameters: 
2022-04-19 09:28:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658329498718208[0;39m <==    Updates: 0
2022-04-19 09:28:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658329498718208[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:29:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658350432489472[0;39m 生成今日电子书快照开始
2022-04-19 09:29:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658350432489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658350432489472[0;39m ==> Parameters: 
2022-04-19 09:29:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658350432489472[0;39m <==    Updates: 0
2022-04-19 09:29:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658350432489472[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:29:05.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658371437563904[0;39m 生成今日电子书快照开始
2022-04-19 09:29:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658371437563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658371437563904[0;39m ==> Parameters: 
2022-04-19 09:29:05.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658371437563904[0;39m <==    Updates: 0
2022-04-19 09:29:05.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658371437563904[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:29:05.075 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171658371714387968[0;39m start updating Ebook doc
2022-04-19 09:29:05.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658371714387968[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:29:05.075 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658371714387968[0;39m ==> Parameters: 
2022-04-19 09:29:05.116 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658371714387968[0;39m <==    Updates: 1
2022-04-19 09:29:05.116 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171658371714387968[0;39m update ends, take 41 millisecs
2022-04-19 09:29:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658392409083904[0;39m 生成今日电子书快照开始
2022-04-19 09:29:10.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658392409083904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:10.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658392409083904[0;39m ==> Parameters: 
2022-04-19 09:29:10.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658392409083904[0;39m <==    Updates: 0
2022-04-19 09:29:10.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658392409083904[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:29:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658413384798208[0;39m 生成今日电子书快照开始
2022-04-19 09:29:15.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658413384798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658413384798208[0;39m ==> Parameters: 
2022-04-19 09:29:15.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658413384798208[0;39m <==    Updates: 0
2022-04-19 09:29:15.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658413384798208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:29:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658434322763776[0;39m 生成今日电子书快照开始
2022-04-19 09:29:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658434322763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658434322763776[0;39m ==> Parameters: 
2022-04-19 09:29:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658434322763776[0;39m <==    Updates: 0
2022-04-19 09:29:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658434322763776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:29:25.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658455311060992[0;39m 生成今日电子书快照开始
2022-04-19 09:29:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658455311060992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658455311060992[0;39m ==> Parameters: 
2022-04-19 09:29:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658455311060992[0;39m <==    Updates: 0
2022-04-19 09:29:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658455311060992[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:29:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658476286775296[0;39m 生成今日电子书快照开始
2022-04-19 09:29:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658476286775296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658476286775296[0;39m ==> Parameters: 
2022-04-19 09:29:30.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658476286775296[0;39m <==    Updates: 0
2022-04-19 09:29:30.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658476286775296[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:29:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171658497270878208[0;39m start updating Ebook doc
2022-04-19 09:29:35.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658497270878208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:29:35.034 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658497270878208[0;39m ==> Parameters: 
2022-04-19 09:29:35.077 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658497270878208[0;39m <==    Updates: 1
2022-04-19 09:29:35.077 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171658497270878208[0;39m update ends, take 67 millisecs
2022-04-19 09:29:35.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658497551896576[0;39m 生成今日电子书快照开始
2022-04-19 09:29:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658497551896576[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:35.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658497551896576[0;39m ==> Parameters: 
2022-04-19 09:29:35.127 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658497551896576[0;39m <==    Updates: 0
2022-04-19 09:29:35.128 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658497551896576[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:29:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658518238203904[0;39m 生成今日电子书快照开始
2022-04-19 09:29:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658518238203904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658518238203904[0;39m ==> Parameters: 
2022-04-19 09:29:40.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658518238203904[0;39m <==    Updates: 0
2022-04-19 09:29:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658518238203904[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:29:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658539192946688[0;39m 生成今日电子书快照开始
2022-04-19 09:29:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658539192946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658539192946688[0;39m ==> Parameters: 
2022-04-19 09:29:45.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658539192946688[0;39m <==    Updates: 0
2022-04-19 09:29:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658539192946688[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:29:50.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658560164466688[0;39m 生成今日电子书快照开始
2022-04-19 09:29:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658560164466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:50.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658560164466688[0;39m ==> Parameters: 
2022-04-19 09:29:50.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658560164466688[0;39m <==    Updates: 0
2022-04-19 09:29:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658560164466688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:29:55.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658581144375296[0;39m 生成今日电子书快照开始
2022-04-19 09:29:55.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658581144375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:29:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658581144375296[0;39m ==> Parameters: 
2022-04-19 09:29:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658581144375296[0;39m <==    Updates: 0
2022-04-19 09:29:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658581144375296[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:30:00.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658602099118080[0;39m 生成今日电子书快照开始
2022-04-19 09:30:00.188 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658602099118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:00.189 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658602099118080[0;39m ==> Parameters: 
2022-04-19 09:30:00.225 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658602099118080[0;39m <==    Updates: 0
2022-04-19 09:30:00.225 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658602099118080[0;39m 生成今日电子书快照结束，耗时：222毫秒
2022-04-19 09:30:05.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658623091609600[0;39m 生成今日电子书快照开始
2022-04-19 09:30:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658623091609600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658623091609600[0;39m ==> Parameters: 
2022-04-19 09:30:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658623091609600[0;39m <==    Updates: 0
2022-04-19 09:30:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658623091609600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:30:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171658623347462144[0;39m start updating Ebook doc
2022-04-19 09:30:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658623347462144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:30:05.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658623347462144[0;39m ==> Parameters: 
2022-04-19 09:30:05.108 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658623347462144[0;39m <==    Updates: 1
2022-04-19 09:30:05.108 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171658623347462144[0;39m update ends, take 39 millisecs
2022-04-19 09:30:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658644067323904[0;39m 生成今日电子书快照开始
2022-04-19 09:30:10.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658644067323904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:10.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658644067323904[0;39m ==> Parameters: 
2022-04-19 09:30:10.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658644067323904[0;39m <==    Updates: 0
2022-04-19 09:30:10.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658644067323904[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-19 09:30:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658665043038208[0;39m 生成今日电子书快照开始
2022-04-19 09:30:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658665043038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658665043038208[0;39m ==> Parameters: 
2022-04-19 09:30:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658665043038208[0;39m <==    Updates: 0
2022-04-19 09:30:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658665043038208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:30:20.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658685993586688[0;39m 生成今日电子书快照开始
2022-04-19 09:30:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658685993586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658685993586688[0;39m ==> Parameters: 
2022-04-19 09:30:20.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658685993586688[0;39m <==    Updates: 0
2022-04-19 09:30:20.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658685993586688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:30:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658706948329472[0;39m 生成今日电子书快照开始
2022-04-19 09:30:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658706948329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658706948329472[0;39m ==> Parameters: 
2022-04-19 09:30:25.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658706948329472[0;39m <==    Updates: 0
2022-04-19 09:30:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658706948329472[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:30:30.011 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658727957598208[0;39m 生成今日电子书快照开始
2022-04-19 09:30:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658727957598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658727957598208[0;39m ==> Parameters: 
2022-04-19 09:30:30.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658727957598208[0;39m <==    Updates: 0
2022-04-19 09:30:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658727957598208[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:30:35.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658748916535296[0;39m 生成今日电子书快照开始
2022-04-19 09:30:35.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658748916535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:35.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658748916535296[0;39m ==> Parameters: 
2022-04-19 09:30:35.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658748916535296[0;39m <==    Updates: 0
2022-04-19 09:30:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658748916535296[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:30:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171658749180776448[0;39m start updating Ebook doc
2022-04-19 09:30:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658749180776448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:30:35.070 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658749180776448[0;39m ==> Parameters: 
2022-04-19 09:30:35.121 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658749180776448[0;39m <==    Updates: 1
2022-04-19 09:30:35.121 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171658749180776448[0;39m update ends, take 51 millisecs
2022-04-19 09:30:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658769862889472[0;39m 生成今日电子书快照开始
2022-04-19 09:30:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658769862889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658769862889472[0;39m ==> Parameters: 
2022-04-19 09:30:40.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658769862889472[0;39m <==    Updates: 0
2022-04-19 09:30:40.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658769862889472[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:30:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658790838603776[0;39m 生成今日电子书快照开始
2022-04-19 09:30:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658790838603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658790838603776[0;39m ==> Parameters: 
2022-04-19 09:30:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658790838603776[0;39m <==    Updates: 0
2022-04-19 09:30:45.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658790838603776[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:30:50.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658811826900992[0;39m 生成今日电子书快照开始
2022-04-19 09:30:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658811826900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:50.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658811826900992[0;39m ==> Parameters: 
2022-04-19 09:30:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658811826900992[0;39m <==    Updates: 0
2022-04-19 09:30:50.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658811826900992[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:30:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658832815198208[0;39m 生成今日电子书快照开始
2022-04-19 09:30:55.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658832815198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:30:55.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658832815198208[0;39m ==> Parameters: 
2022-04-19 09:30:55.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658832815198208[0;39m <==    Updates: 0
2022-04-19 09:30:55.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658832815198208[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:31:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658853782523904[0;39m 生成今日电子书快照开始
2022-04-19 09:31:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658853782523904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658853782523904[0;39m ==> Parameters: 
2022-04-19 09:31:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658853782523904[0;39m <==    Updates: 0
2022-04-19 09:31:00.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658853782523904[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:31:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658874720489472[0;39m 生成今日电子书快照开始
2022-04-19 09:31:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658874720489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658874720489472[0;39m ==> Parameters: 
2022-04-19 09:31:05.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658874720489472[0;39m <==    Updates: 0
2022-04-19 09:31:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658874720489472[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:31:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171658874993119232[0;39m start updating Ebook doc
2022-04-19 09:31:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658874993119232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:31:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658874993119232[0;39m ==> Parameters: 
2022-04-19 09:31:05.104 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171658874993119232[0;39m <==    Updates: 1
2022-04-19 09:31:05.104 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171658874993119232[0;39m update ends, take 38 millisecs
2022-04-19 09:31:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658895712980992[0;39m 生成今日电子书快照开始
2022-04-19 09:31:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658895712980992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658895712980992[0;39m ==> Parameters: 
2022-04-19 09:31:10.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658895712980992[0;39m <==    Updates: 0
2022-04-19 09:31:10.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658895712980992[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:31:15.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658916684500992[0;39m 生成今日电子书快照开始
2022-04-19 09:31:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658916684500992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658916684500992[0;39m ==> Parameters: 
2022-04-19 09:31:15.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658916684500992[0;39m <==    Updates: 0
2022-04-19 09:31:15.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658916684500992[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:31:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658937656020992[0;39m 生成今日电子书快照开始
2022-04-19 09:31:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658937656020992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658937656020992[0;39m ==> Parameters: 
2022-04-19 09:31:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658937656020992[0;39m <==    Updates: 0
2022-04-19 09:31:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658937656020992[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:31:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658958623346688[0;39m 生成今日电子书快照开始
2022-04-19 09:31:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658958623346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658958623346688[0;39m ==> Parameters: 
2022-04-19 09:31:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658958623346688[0;39m <==    Updates: 0
2022-04-19 09:31:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658958623346688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:31:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171658979611643904[0;39m 生成今日电子书快照开始
2022-04-19 09:31:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658979611643904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658979611643904[0;39m ==> Parameters: 
2022-04-19 09:31:30.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171658979611643904[0;39m <==    Updates: 0
2022-04-19 09:31:30.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171658979611643904[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:31:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659000549609472[0;39m 生成今日电子书快照开始
2022-04-19 09:31:35.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659000549609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659000549609472[0;39m ==> Parameters: 
2022-04-19 09:31:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659000549609472[0;39m <==    Updates: 0
2022-04-19 09:31:35.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659000549609472[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:31:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659000818044928[0;39m start updating Ebook doc
2022-04-19 09:31:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659000818044928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:31:35.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659000818044928[0;39m ==> Parameters: 
2022-04-19 09:31:35.111 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659000818044928[0;39m <==    Updates: 1
2022-04-19 09:31:35.111 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659000818044928[0;39m update ends, take 46 millisecs
2022-04-19 09:31:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659021554683904[0;39m 生成今日电子书快照开始
2022-04-19 09:31:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659021554683904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659021554683904[0;39m ==> Parameters: 
2022-04-19 09:31:40.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659021554683904[0;39m <==    Updates: 0
2022-04-19 09:31:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659021554683904[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:31:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659042526203904[0;39m 生成今日电子书快照开始
2022-04-19 09:31:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659042526203904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:45.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659042526203904[0;39m ==> Parameters: 
2022-04-19 09:31:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659042526203904[0;39m <==    Updates: 0
2022-04-19 09:31:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659042526203904[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:31:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659063493529600[0;39m 生成今日电子书快照开始
2022-04-19 09:31:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659063493529600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659063493529600[0;39m ==> Parameters: 
2022-04-19 09:31:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659063493529600[0;39m <==    Updates: 0
2022-04-19 09:31:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659063493529600[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:31:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659084473438208[0;39m 生成今日电子书快照开始
2022-04-19 09:31:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659084473438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:31:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659084473438208[0;39m ==> Parameters: 
2022-04-19 09:31:55.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659084473438208[0;39m <==    Updates: 0
2022-04-19 09:31:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659084473438208[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:32:00.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659105440763904[0;39m 生成今日电子书快照开始
2022-04-19 09:32:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659105440763904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659105440763904[0;39m ==> Parameters: 
2022-04-19 09:32:00.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659105440763904[0;39m <==    Updates: 0
2022-04-19 09:32:00.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659105440763904[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:32:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659126378729472[0;39m 生成今日电子书快照开始
2022-04-19 09:32:05.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659126378729472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:05.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659126378729472[0;39m ==> Parameters: 
2022-04-19 09:32:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659126378729472[0;39m <==    Updates: 0
2022-04-19 09:32:05.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659126378729472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:32:05.058 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659126617804800[0;39m start updating Ebook doc
2022-04-19 09:32:05.058 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659126617804800[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:32:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659126617804800[0;39m ==> Parameters: 
2022-04-19 09:32:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659126617804800[0;39m <==    Updates: 1
2022-04-19 09:32:05.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659126617804800[0;39m update ends, take 34 millisecs
2022-04-19 09:32:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659147387998208[0;39m 生成今日电子书快照开始
2022-04-19 09:32:10.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659147387998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:10.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659147387998208[0;39m ==> Parameters: 
2022-04-19 09:32:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659147387998208[0;39m <==    Updates: 0
2022-04-19 09:32:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659147387998208[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:32:15.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659168346935296[0;39m 生成今日电子书快照开始
2022-04-19 09:32:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659168346935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659168346935296[0;39m ==> Parameters: 
2022-04-19 09:32:15.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659168346935296[0;39m <==    Updates: 0
2022-04-19 09:32:15.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659168346935296[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:32:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659189314260992[0;39m 生成今日电子书快照开始
2022-04-19 09:32:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659189314260992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:20.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659189314260992[0;39m ==> Parameters: 
2022-04-19 09:32:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659189314260992[0;39m <==    Updates: 0
2022-04-19 09:32:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659189314260992[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:32:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659210294169600[0;39m 生成今日电子书快照开始
2022-04-19 09:32:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659210294169600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659210294169600[0;39m ==> Parameters: 
2022-04-19 09:32:25.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659210294169600[0;39m <==    Updates: 0
2022-04-19 09:32:25.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659210294169600[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:32:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659231269883904[0;39m 生成今日电子书快照开始
2022-04-19 09:32:30.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659231269883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:30.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659231269883904[0;39m ==> Parameters: 
2022-04-19 09:32:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659231269883904[0;39m <==    Updates: 0
2022-04-19 09:32:30.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659231269883904[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:32:35.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659252241403904[0;39m 生成今日电子书快照开始
2022-04-19 09:32:35.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659252241403904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:35.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659252241403904[0;39m ==> Parameters: 
2022-04-19 09:32:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659252241403904[0;39m <==    Updates: 0
2022-04-19 09:32:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659252241403904[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:32:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659252467896320[0;39m start updating Ebook doc
2022-04-19 09:32:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659252467896320[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:32:35.064 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659252467896320[0;39m ==> Parameters: 
2022-04-19 09:32:35.094 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659252467896320[0;39m <==    Updates: 1
2022-04-19 09:32:35.094 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659252467896320[0;39m update ends, take 31 millisecs
2022-04-19 09:32:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659273191952384[0;39m 生成今日电子书快照开始
2022-04-19 09:32:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659273191952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659273191952384[0;39m ==> Parameters: 
2022-04-19 09:32:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659273191952384[0;39m <==    Updates: 0
2022-04-19 09:32:40.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659273191952384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:32:45.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659294176055296[0;39m 生成今日电子书快照开始
2022-04-19 09:32:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659294176055296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:45.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659294176055296[0;39m ==> Parameters: 
2022-04-19 09:32:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659294176055296[0;39m <==    Updates: 0
2022-04-19 09:32:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659294176055296[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:32:50.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659315155963904[0;39m 生成今日电子书快照开始
2022-04-19 09:32:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659315155963904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659315155963904[0;39m ==> Parameters: 
2022-04-19 09:32:50.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659315155963904[0;39m <==    Updates: 0
2022-04-19 09:32:50.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659315155963904[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:32:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659336098123776[0;39m 生成今日电子书快照开始
2022-04-19 09:32:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659336098123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:32:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659336098123776[0;39m ==> Parameters: 
2022-04-19 09:32:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659336098123776[0;39m <==    Updates: 0
2022-04-19 09:32:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659336098123776[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:33:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659357082226688[0;39m 生成今日电子书快照开始
2022-04-19 09:33:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659357082226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659357082226688[0;39m ==> Parameters: 
2022-04-19 09:33:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659357082226688[0;39m <==    Updates: 0
2022-04-19 09:33:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659357082226688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:33:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659378049552384[0;39m start updating Ebook doc
2022-04-19 09:33:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659378049552384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:33:05.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659378049552384[0;39m ==> Parameters: 
2022-04-19 09:33:05.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659378049552384[0;39m <==    Updates: 1
2022-04-19 09:33:05.054 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659378049552384[0;39m update ends, take 50 millisecs
2022-04-19 09:33:05.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659378259267584[0;39m 生成今日电子书快照开始
2022-04-19 09:33:05.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659378259267584[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:05.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659378259267584[0;39m ==> Parameters: 
2022-04-19 09:33:05.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659378259267584[0;39m <==    Updates: 0
2022-04-19 09:33:05.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659378259267584[0;39m 生成今日电子书快照结束，耗时：27毫秒
2022-04-19 09:33:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659399037849600[0;39m 生成今日电子书快照开始
2022-04-19 09:33:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659399037849600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659399037849600[0;39m ==> Parameters: 
2022-04-19 09:33:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659399037849600[0;39m <==    Updates: 0
2022-04-19 09:33:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659399037849600[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:33:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659419984203776[0;39m 生成今日电子书快照开始
2022-04-19 09:33:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659419984203776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659419984203776[0;39m ==> Parameters: 
2022-04-19 09:33:15.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659419984203776[0;39m <==    Updates: 0
2022-04-19 09:33:15.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659419984203776[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:33:20.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659440976695296[0;39m 生成今日电子书快照开始
2022-04-19 09:33:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659440976695296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:20.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659440976695296[0;39m ==> Parameters: 
2022-04-19 09:33:20.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659440976695296[0;39m <==    Updates: 0
2022-04-19 09:33:20.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659440976695296[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:33:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659461948215296[0;39m 生成今日电子书快照开始
2022-04-19 09:33:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659461948215296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659461948215296[0;39m ==> Parameters: 
2022-04-19 09:33:25.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659461948215296[0;39m <==    Updates: 0
2022-04-19 09:33:25.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659461948215296[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:33:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659482902958080[0;39m 生成今日电子书快照开始
2022-04-19 09:33:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659482902958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659482902958080[0;39m ==> Parameters: 
2022-04-19 09:33:30.049 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659482902958080[0;39m <==    Updates: 0
2022-04-19 09:33:30.049 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659482902958080[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:33:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659503903838208[0;39m start updating Ebook doc
2022-04-19 09:33:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659503903838208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:33:35.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659503903838208[0;39m ==> Parameters: 
2022-04-19 09:33:35.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659503903838208[0;39m <==    Updates: 1
2022-04-19 09:33:35.057 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659503903838208[0;39m update ends, take 46 millisecs
2022-04-19 09:33:35.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659504100970496[0;39m 生成今日电子书快照开始
2022-04-19 09:33:35.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659504100970496[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:35.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659504100970496[0;39m ==> Parameters: 
2022-04-19 09:33:35.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659504100970496[0;39m <==    Updates: 0
2022-04-19 09:33:35.088 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659504100970496[0;39m 生成今日电子书快照结束，耗时：31毫秒
2022-04-19 09:33:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659524871163904[0;39m 生成今日电子书快照开始
2022-04-19 09:33:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659524871163904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659524871163904[0;39m ==> Parameters: 
2022-04-19 09:33:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659524871163904[0;39m <==    Updates: 0
2022-04-19 09:33:40.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659524871163904[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:33:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659545846878208[0;39m 生成今日电子书快照开始
2022-04-19 09:33:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659545846878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659545846878208[0;39m ==> Parameters: 
2022-04-19 09:33:45.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659545846878208[0;39m <==    Updates: 0
2022-04-19 09:33:45.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659545846878208[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:33:50.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659566814203904[0;39m 生成今日电子书快照开始
2022-04-19 09:33:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659566814203904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659566814203904[0;39m ==> Parameters: 
2022-04-19 09:33:50.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659566814203904[0;39m <==    Updates: 0
2022-04-19 09:33:50.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659566814203904[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:33:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659587789918208[0;39m 生成今日电子书快照开始
2022-04-19 09:33:55.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659587789918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:33:55.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659587789918208[0;39m ==> Parameters: 
2022-04-19 09:33:55.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659587789918208[0;39m <==    Updates: 0
2022-04-19 09:33:55.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659587789918208[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:34:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659608753049600[0;39m 生成今日电子书快照开始
2022-04-19 09:34:00.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659608753049600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:00.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659608753049600[0;39m ==> Parameters: 
2022-04-19 09:34:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659608753049600[0;39m <==    Updates: 0
2022-04-19 09:34:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659608753049600[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:34:05.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659629720375296[0;39m 生成今日电子书快照开始
2022-04-19 09:34:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659629720375296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659629720375296[0;39m ==> Parameters: 
2022-04-19 09:34:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659629720375296[0;39m <==    Updates: 0
2022-04-19 09:34:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659629720375296[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:34:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659629967839232[0;39m start updating Ebook doc
2022-04-19 09:34:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659629967839232[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:34:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659629967839232[0;39m ==> Parameters: 
2022-04-19 09:34:05.098 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659629967839232[0;39m <==    Updates: 1
2022-04-19 09:34:05.099 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659629967839232[0;39m update ends, take 33 millisecs
2022-04-19 09:34:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659650696089600[0;39m 生成今日电子书快照开始
2022-04-19 09:34:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659650696089600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659650696089600[0;39m ==> Parameters: 
2022-04-19 09:34:10.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659650696089600[0;39m <==    Updates: 0
2022-04-19 09:34:10.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659650696089600[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:34:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659671642443776[0;39m 生成今日电子书快照开始
2022-04-19 09:34:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659671642443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:15.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659671642443776[0;39m ==> Parameters: 
2022-04-19 09:34:15.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659671642443776[0;39m <==    Updates: 0
2022-04-19 09:34:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659671642443776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:34:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659692613963776[0;39m 生成今日电子书快照开始
2022-04-19 09:34:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659692613963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659692613963776[0;39m ==> Parameters: 
2022-04-19 09:34:20.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659692613963776[0;39m <==    Updates: 0
2022-04-19 09:34:20.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659692613963776[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:34:25.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659713606455296[0;39m 生成今日电子书快照开始
2022-04-19 09:34:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659713606455296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:25.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659713606455296[0;39m ==> Parameters: 
2022-04-19 09:34:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659713606455296[0;39m <==    Updates: 0
2022-04-19 09:34:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659713606455296[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:34:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659734577975296[0;39m 生成今日电子书快照开始
2022-04-19 09:34:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659734577975296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659734577975296[0;39m ==> Parameters: 
2022-04-19 09:34:30.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659734577975296[0;39m <==    Updates: 0
2022-04-19 09:34:30.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659734577975296[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:34:35.007 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659755549495296[0;39m start updating Ebook doc
2022-04-19 09:34:35.036 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659755549495296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:34:35.036 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659755549495296[0;39m ==> Parameters: 
2022-04-19 09:34:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659755549495296[0;39m <==    Updates: 1
2022-04-19 09:34:35.065 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659755549495296[0;39m update ends, take 58 millisecs
2022-04-19 09:34:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659755796959232[0;39m 生成今日电子书快照开始
2022-04-19 09:34:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659755796959232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659755796959232[0;39m ==> Parameters: 
2022-04-19 09:34:35.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659755796959232[0;39m <==    Updates: 0
2022-04-19 09:34:35.097 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659755796959232[0;39m 生成今日电子书快照结束，耗时：31毫秒
2022-04-19 09:34:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659776533598208[0;39m 生成今日电子书快照开始
2022-04-19 09:34:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659776533598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659776533598208[0;39m ==> Parameters: 
2022-04-19 09:34:40.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659776533598208[0;39m <==    Updates: 0
2022-04-19 09:34:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659776533598208[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:34:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659797505118208[0;39m 生成今日电子书快照开始
2022-04-19 09:34:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659797505118208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659797505118208[0;39m ==> Parameters: 
2022-04-19 09:34:45.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659797505118208[0;39m <==    Updates: 0
2022-04-19 09:34:45.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659797505118208[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:34:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659818476638208[0;39m 生成今日电子书快照开始
2022-04-19 09:34:50.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659818476638208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:50.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659818476638208[0;39m ==> Parameters: 
2022-04-19 09:34:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659818476638208[0;39m <==    Updates: 0
2022-04-19 09:34:50.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659818476638208[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:34:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659839439769600[0;39m 生成今日电子书快照开始
2022-04-19 09:34:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659839439769600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:34:55.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659839439769600[0;39m ==> Parameters: 
2022-04-19 09:34:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659839439769600[0;39m <==    Updates: 0
2022-04-19 09:34:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659839439769600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:35:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659860411289600[0;39m 生成今日电子书快照开始
2022-04-19 09:35:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659860411289600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:00.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659860411289600[0;39m ==> Parameters: 
2022-04-19 09:35:00.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659860411289600[0;39m <==    Updates: 0
2022-04-19 09:35:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659860411289600[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:35:05.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171659881391198208[0;39m start updating Ebook doc
2022-04-19 09:35:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659881391198208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:35:05.034 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659881391198208[0;39m ==> Parameters: 
2022-04-19 09:35:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171659881391198208[0;39m <==    Updates: 1
2022-04-19 09:35:05.069 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171659881391198208[0;39m update ends, take 59 millisecs
2022-04-19 09:35:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659881638662144[0;39m 生成今日电子书快照开始
2022-04-19 09:35:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659881638662144[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659881638662144[0;39m ==> Parameters: 
2022-04-19 09:35:05.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659881638662144[0;39m <==    Updates: 0
2022-04-19 09:35:05.100 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659881638662144[0;39m 生成今日电子书快照结束，耗时：31毫秒
2022-04-19 09:35:10.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659902362718208[0;39m 生成今日电子书快照开始
2022-04-19 09:35:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659902362718208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659902362718208[0;39m ==> Parameters: 
2022-04-19 09:35:10.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659902362718208[0;39m <==    Updates: 0
2022-04-19 09:35:10.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659902362718208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:35:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659923304878080[0;39m 生成今日电子书快照开始
2022-04-19 09:35:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659923304878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659923304878080[0;39m ==> Parameters: 
2022-04-19 09:35:15.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659923304878080[0;39m <==    Updates: 0
2022-04-19 09:35:15.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659923304878080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:35:20.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659944297369600[0;39m 生成今日电子书快照开始
2022-04-19 09:35:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659944297369600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659944297369600[0;39m ==> Parameters: 
2022-04-19 09:35:20.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659944297369600[0;39m <==    Updates: 0
2022-04-19 09:35:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659944297369600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:35:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659965243723776[0;39m 生成今日电子书快照开始
2022-04-19 09:35:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659965243723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659965243723776[0;39m ==> Parameters: 
2022-04-19 09:35:25.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659965243723776[0;39m <==    Updates: 0
2022-04-19 09:35:25.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659965243723776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:35:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171659986248798208[0;39m 生成今日电子书快照开始
2022-04-19 09:35:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659986248798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:30.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659986248798208[0;39m ==> Parameters: 
2022-04-19 09:35:30.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171659986248798208[0;39m <==    Updates: 0
2022-04-19 09:35:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171659986248798208[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:35:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660007220318208[0;39m start updating Ebook doc
2022-04-19 09:35:35.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660007220318208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:35:35.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660007220318208[0;39m ==> Parameters: 
2022-04-19 09:35:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660007220318208[0;39m <==    Updates: 1
2022-04-19 09:35:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660007220318208[0;39m update ends, take 51 millisecs
2022-04-19 09:35:35.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660007434227712[0;39m 生成今日电子书快照开始
2022-04-19 09:35:35.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660007434227712[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660007434227712[0;39m ==> Parameters: 
2022-04-19 09:35:35.099 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660007434227712[0;39m <==    Updates: 0
2022-04-19 09:35:35.099 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660007434227712[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-19 09:35:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660028191838208[0;39m 生成今日电子书快照开始
2022-04-19 09:35:40.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660028191838208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:40.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660028191838208[0;39m ==> Parameters: 
2022-04-19 09:35:40.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660028191838208[0;39m <==    Updates: 0
2022-04-19 09:35:40.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660028191838208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:35:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660049138192384[0;39m 生成今日电子书快照开始
2022-04-19 09:35:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660049138192384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660049138192384[0;39m ==> Parameters: 
2022-04-19 09:35:45.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660049138192384[0;39m <==    Updates: 0
2022-04-19 09:35:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660049138192384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:35:50.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660070126489600[0;39m 生成今日电子书快照开始
2022-04-19 09:35:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660070126489600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660070126489600[0;39m ==> Parameters: 
2022-04-19 09:35:50.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660070126489600[0;39m <==    Updates: 0
2022-04-19 09:35:50.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660070126489600[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:35:55.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660091093815296[0;39m 生成今日电子书快照开始
2022-04-19 09:35:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660091093815296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:35:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660091093815296[0;39m ==> Parameters: 
2022-04-19 09:35:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660091093815296[0;39m <==    Updates: 0
2022-04-19 09:35:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660091093815296[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:36:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660112052752384[0;39m 生成今日电子书快照开始
2022-04-19 09:36:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660112052752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660112052752384[0;39m ==> Parameters: 
2022-04-19 09:36:00.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660112052752384[0;39m <==    Updates: 0
2022-04-19 09:36:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660112052752384[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:36:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660133032660992[0;39m start updating Ebook doc
2022-04-19 09:36:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660133032660992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:36:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660133032660992[0;39m ==> Parameters: 
2022-04-19 09:36:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660133032660992[0;39m <==    Updates: 1
2022-04-19 09:36:05.057 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660133032660992[0;39m update ends, take 51 millisecs
2022-04-19 09:36:05.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660133246570496[0;39m 生成今日电子书快照开始
2022-04-19 09:36:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660133246570496[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660133246570496[0;39m ==> Parameters: 
2022-04-19 09:36:05.087 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660133246570496[0;39m <==    Updates: 0
2022-04-19 09:36:05.087 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660133246570496[0;39m 生成今日电子书快照结束，耗时：30毫秒
2022-04-19 09:36:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660153995792384[0;39m 生成今日电子书快照开始
2022-04-19 09:36:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660153995792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660153995792384[0;39m ==> Parameters: 
2022-04-19 09:36:10.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660153995792384[0;39m <==    Updates: 0
2022-04-19 09:36:10.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660153995792384[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:36:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660174992478208[0;39m 生成今日电子书快照开始
2022-04-19 09:36:15.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660174992478208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660174992478208[0;39m ==> Parameters: 
2022-04-19 09:36:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660174992478208[0;39m <==    Updates: 0
2022-04-19 09:36:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660174992478208[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:36:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660195963998208[0;39m 生成今日电子书快照开始
2022-04-19 09:36:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660195963998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:20.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660195963998208[0;39m ==> Parameters: 
2022-04-19 09:36:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660195963998208[0;39m <==    Updates: 0
2022-04-19 09:36:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660195963998208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:36:25.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660216935518208[0;39m 生成今日电子书快照开始
2022-04-19 09:36:25.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660216935518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:25.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660216935518208[0;39m ==> Parameters: 
2022-04-19 09:36:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660216935518208[0;39m <==    Updates: 0
2022-04-19 09:36:25.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660216935518208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:36:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660237886066688[0;39m 生成今日电子书快照开始
2022-04-19 09:36:30.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660237886066688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660237886066688[0;39m ==> Parameters: 
2022-04-19 09:36:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660237886066688[0;39m <==    Updates: 0
2022-04-19 09:36:30.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660237886066688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:36:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660258878558208[0;39m 生成今日电子书快照开始
2022-04-19 09:36:35.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660258878558208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:35.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660258878558208[0;39m ==> Parameters: 
2022-04-19 09:36:35.085 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660258878558208[0;39m <==    Updates: 0
2022-04-19 09:36:35.086 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660258878558208[0;39m 生成今日电子书快照结束，耗时：76毫秒
2022-04-19 09:36:35.086 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660259197325312[0;39m start updating Ebook doc
2022-04-19 09:36:35.086 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660259197325312[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:36:35.087 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660259197325312[0;39m ==> Parameters: 
2022-04-19 09:36:35.116 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660259197325312[0;39m <==    Updates: 1
2022-04-19 09:36:35.116 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660259197325312[0;39m update ends, take 30 millisecs
2022-04-19 09:36:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660279812329472[0;39m 生成今日电子书快照开始
2022-04-19 09:36:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660279812329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660279812329472[0;39m ==> Parameters: 
2022-04-19 09:36:40.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660279812329472[0;39m <==    Updates: 0
2022-04-19 09:36:40.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660279812329472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:36:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660300788043776[0;39m 生成今日电子书快照开始
2022-04-19 09:36:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660300788043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660300788043776[0;39m ==> Parameters: 
2022-04-19 09:36:45.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660300788043776[0;39m <==    Updates: 0
2022-04-19 09:36:45.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660300788043776[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:36:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660321763758080[0;39m 生成今日电子书快照开始
2022-04-19 09:36:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660321763758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660321763758080[0;39m ==> Parameters: 
2022-04-19 09:36:50.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660321763758080[0;39m <==    Updates: 0
2022-04-19 09:36:50.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660321763758080[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:36:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660342764638208[0;39m 生成今日电子书快照开始
2022-04-19 09:36:55.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660342764638208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:36:55.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660342764638208[0;39m ==> Parameters: 
2022-04-19 09:36:55.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660342764638208[0;39m <==    Updates: 0
2022-04-19 09:36:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660342764638208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:37:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660363723575296[0;39m 生成今日电子书快照开始
2022-04-19 09:37:00.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660363723575296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:00.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660363723575296[0;39m ==> Parameters: 
2022-04-19 09:37:00.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660363723575296[0;39m <==    Updates: 0
2022-04-19 09:37:00.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660363723575296[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:37:05.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660384707678208[0;39m start updating Ebook doc
2022-04-19 09:37:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660384707678208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:37:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660384707678208[0;39m ==> Parameters: 
2022-04-19 09:37:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660384707678208[0;39m <==    Updates: 1
2022-04-19 09:37:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660384707678208[0;39m update ends, take 50 millisecs
2022-04-19 09:37:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660384917393408[0;39m 生成今日电子书快照开始
2022-04-19 09:37:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660384917393408[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660384917393408[0;39m ==> Parameters: 
2022-04-19 09:37:05.089 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660384917393408[0;39m <==    Updates: 0
2022-04-19 09:37:05.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660384917393408[0;39m 生成今日电子书快照结束，耗时：29毫秒
2022-04-19 09:37:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660405666615296[0;39m 生成今日电子书快照开始
2022-04-19 09:37:10.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660405666615296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:10.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660405666615296[0;39m ==> Parameters: 
2022-04-19 09:37:10.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660405666615296[0;39m <==    Updates: 0
2022-04-19 09:37:10.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660405666615296[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:37:15.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660426629746688[0;39m 生成今日电子书快照开始
2022-04-19 09:37:15.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660426629746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:15.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660426629746688[0;39m ==> Parameters: 
2022-04-19 09:37:15.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660426629746688[0;39m <==    Updates: 0
2022-04-19 09:37:15.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660426629746688[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:37:20.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660447618043904[0;39m 生成今日电子书快照开始
2022-04-19 09:37:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660447618043904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660447618043904[0;39m ==> Parameters: 
2022-04-19 09:37:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660447618043904[0;39m <==    Updates: 0
2022-04-19 09:37:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660447618043904[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:37:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660468589563904[0;39m 生成今日电子书快照开始
2022-04-19 09:37:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660468589563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:25.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660468589563904[0;39m ==> Parameters: 
2022-04-19 09:37:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660468589563904[0;39m <==    Updates: 0
2022-04-19 09:37:25.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660468589563904[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:37:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660489552695296[0;39m 生成今日电子书快照开始
2022-04-19 09:37:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660489552695296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660489552695296[0;39m ==> Parameters: 
2022-04-19 09:37:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660489552695296[0;39m <==    Updates: 0
2022-04-19 09:37:30.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660489552695296[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:37:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660510499049472[0;39m start updating Ebook doc
2022-04-19 09:37:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660510499049472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:37:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660510499049472[0;39m ==> Parameters: 
2022-04-19 09:37:35.051 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660510499049472[0;39m <==    Updates: 1
2022-04-19 09:37:35.052 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660510499049472[0;39m update ends, take 51 millisecs
2022-04-19 09:37:35.052 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660510712958976[0;39m 生成今日电子书快照开始
2022-04-19 09:37:35.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660510712958976[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:35.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660510712958976[0;39m ==> Parameters: 
2022-04-19 09:37:35.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660510712958976[0;39m <==    Updates: 0
2022-04-19 09:37:35.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660510712958976[0;39m 生成今日电子书快照结束，耗时：29毫秒
2022-04-19 09:37:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660531508318208[0;39m 生成今日电子书快照开始
2022-04-19 09:37:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660531508318208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660531508318208[0;39m ==> Parameters: 
2022-04-19 09:37:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660531508318208[0;39m <==    Updates: 0
2022-04-19 09:37:40.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660531508318208[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:37:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660552475643904[0;39m 生成今日电子书快照开始
2022-04-19 09:37:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660552475643904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660552475643904[0;39m ==> Parameters: 
2022-04-19 09:37:45.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660552475643904[0;39m <==    Updates: 0
2022-04-19 09:37:45.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660552475643904[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:37:50.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660573417803776[0;39m 生成今日电子书快照开始
2022-04-19 09:37:50.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660573417803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660573417803776[0;39m ==> Parameters: 
2022-04-19 09:37:50.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660573417803776[0;39m <==    Updates: 0
2022-04-19 09:37:50.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660573417803776[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:37:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660594418683904[0;39m 生成今日电子书快照开始
2022-04-19 09:37:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660594418683904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:37:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660594418683904[0;39m ==> Parameters: 
2022-04-19 09:37:55.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660594418683904[0;39m <==    Updates: 0
2022-04-19 09:37:55.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660594418683904[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:38:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660615386009600[0;39m 生成今日电子书快照开始
2022-04-19 09:38:00.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660615386009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:00.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660615386009600[0;39m ==> Parameters: 
2022-04-19 09:38:00.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660615386009600[0;39m <==    Updates: 0
2022-04-19 09:38:00.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660615386009600[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:38:05.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660636361723904[0;39m start updating Ebook doc
2022-04-19 09:38:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660636361723904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:38:05.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660636361723904[0;39m ==> Parameters: 
2022-04-19 09:38:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660636361723904[0;39m <==    Updates: 1
2022-04-19 09:38:05.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660636361723904[0;39m update ends, take 57 millisecs
2022-04-19 09:38:05.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660636600799232[0;39m 生成今日电子书快照开始
2022-04-19 09:38:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660636600799232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:05.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660636600799232[0;39m ==> Parameters: 
2022-04-19 09:38:05.095 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660636600799232[0;39m <==    Updates: 0
2022-04-19 09:38:05.095 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660636600799232[0;39m 生成今日电子书快照结束，耗时：29毫秒
2022-04-19 09:38:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660657324855296[0;39m 生成今日电子书快照开始
2022-04-19 09:38:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660657324855296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660657324855296[0;39m ==> Parameters: 
2022-04-19 09:38:10.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660657324855296[0;39m <==    Updates: 0
2022-04-19 09:38:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660657324855296[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:38:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660678308958208[0;39m 生成今日电子书快照开始
2022-04-19 09:38:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660678308958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660678308958208[0;39m ==> Parameters: 
2022-04-19 09:38:15.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660678308958208[0;39m <==    Updates: 0
2022-04-19 09:38:15.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660678308958208[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:38:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660699280478208[0;39m 生成今日电子书快照开始
2022-04-19 09:38:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660699280478208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660699280478208[0;39m ==> Parameters: 
2022-04-19 09:38:20.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660699280478208[0;39m <==    Updates: 0
2022-04-19 09:38:20.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660699280478208[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:38:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660720247803904[0;39m 生成今日电子书快照开始
2022-04-19 09:38:25.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660720247803904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:25.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660720247803904[0;39m ==> Parameters: 
2022-04-19 09:38:25.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660720247803904[0;39m <==    Updates: 0
2022-04-19 09:38:25.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660720247803904[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:38:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660741210935296[0;39m 生成今日电子书快照开始
2022-04-19 09:38:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660741210935296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:30.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660741210935296[0;39m ==> Parameters: 
2022-04-19 09:38:30.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660741210935296[0;39m <==    Updates: 0
2022-04-19 09:38:30.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660741210935296[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:38:35.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660762169872384[0;39m start updating Ebook doc
2022-04-19 09:38:35.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660762169872384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:38:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660762169872384[0;39m ==> Parameters: 
2022-04-19 09:38:35.050 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660762169872384[0;39m <==    Updates: 1
2022-04-19 09:38:35.050 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660762169872384[0;39m update ends, take 46 millisecs
2022-04-19 09:38:35.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660762367004672[0;39m 生成今日电子书快照开始
2022-04-19 09:38:35.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660762367004672[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:35.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660762367004672[0;39m ==> Parameters: 
2022-04-19 09:38:35.084 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660762367004672[0;39m <==    Updates: 0
2022-04-19 09:38:35.085 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660762367004672[0;39m 生成今日电子书快照结束，耗时：34毫秒
2022-04-19 09:38:40.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660783149780992[0;39m 生成今日电子书快照开始
2022-04-19 09:38:40.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660783149780992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:40.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660783149780992[0;39m ==> Parameters: 
2022-04-19 09:38:40.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660783149780992[0;39m <==    Updates: 0
2022-04-19 09:38:40.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660783149780992[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:38:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660804133883904[0;39m 生成今日电子书快照开始
2022-04-19 09:38:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660804133883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660804133883904[0;39m ==> Parameters: 
2022-04-19 09:38:45.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660804133883904[0;39m <==    Updates: 0
2022-04-19 09:38:45.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660804133883904[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:38:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660825080238080[0;39m 生成今日电子书快照开始
2022-04-19 09:38:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660825080238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660825080238080[0;39m ==> Parameters: 
2022-04-19 09:38:50.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660825080238080[0;39m <==    Updates: 0
2022-04-19 09:38:50.049 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660825080238080[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:38:55.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660846081118208[0;39m 生成今日电子书快照开始
2022-04-19 09:38:55.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660846081118208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:38:55.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660846081118208[0;39m ==> Parameters: 
2022-04-19 09:38:55.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660846081118208[0;39m <==    Updates: 0
2022-04-19 09:38:55.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660846081118208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:39:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660867010695168[0;39m 生成今日电子书快照开始
2022-04-19 09:39:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660867010695168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660867010695168[0;39m ==> Parameters: 
2022-04-19 09:39:00.049 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660867010695168[0;39m <==    Updates: 0
2022-04-19 09:39:00.049 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660867010695168[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:39:05.006 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171660888007380992[0;39m start updating Ebook doc
2022-04-19 09:39:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660888007380992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:39:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660888007380992[0;39m ==> Parameters: 
2022-04-19 09:39:05.063 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171660888007380992[0;39m <==    Updates: 1
2022-04-19 09:39:05.063 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171660888007380992[0;39m update ends, take 57 millisecs
2022-04-19 09:39:05.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660888250650624[0;39m 生成今日电子书快照开始
2022-04-19 09:39:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660888250650624[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660888250650624[0;39m ==> Parameters: 
2022-04-19 09:39:05.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660888250650624[0;39m <==    Updates: 0
2022-04-19 09:39:05.096 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660888250650624[0;39m 生成今日电子书快照结束，耗时：32毫秒
2022-04-19 09:39:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660908983095296[0;39m 生成今日电子书快照开始
2022-04-19 09:39:10.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660908983095296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660908983095296[0;39m ==> Parameters: 
2022-04-19 09:39:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660908983095296[0;39m <==    Updates: 0
2022-04-19 09:39:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660908983095296[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:39:15.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660929958809600[0;39m 生成今日电子书快照开始
2022-04-19 09:39:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660929958809600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660929958809600[0;39m ==> Parameters: 
2022-04-19 09:39:15.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660929958809600[0;39m <==    Updates: 0
2022-04-19 09:39:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660929958809600[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:39:20.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660950926135296[0;39m 生成今日电子书快照开始
2022-04-19 09:39:20.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660950926135296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660950926135296[0;39m ==> Parameters: 
2022-04-19 09:39:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660950926135296[0;39m <==    Updates: 0
2022-04-19 09:39:20.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660950926135296[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:39:25.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660971901849600[0;39m 生成今日电子书快照开始
2022-04-19 09:39:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660971901849600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:25.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660971901849600[0;39m ==> Parameters: 
2022-04-19 09:39:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660971901849600[0;39m <==    Updates: 0
2022-04-19 09:39:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660971901849600[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:39:30.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171660992877563904[0;39m 生成今日电子书快照开始
2022-04-19 09:39:30.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660992877563904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:30.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660992877563904[0;39m ==> Parameters: 
2022-04-19 09:39:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171660992877563904[0;39m <==    Updates: 0
2022-04-19 09:39:30.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171660992877563904[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:39:35.007 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661013840695296[0;39m start updating Ebook doc
2022-04-19 09:39:35.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661013840695296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:39:35.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661013840695296[0;39m ==> Parameters: 
2022-04-19 09:39:35.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661013840695296[0;39m <==    Updates: 1
2022-04-19 09:39:35.066 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661013840695296[0;39m update ends, take 58 millisecs
2022-04-19 09:39:35.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661014088159232[0;39m 生成今日电子书快照开始
2022-04-19 09:39:35.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661014088159232[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661014088159232[0;39m ==> Parameters: 
2022-04-19 09:39:35.096 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661014088159232[0;39m <==    Updates: 0
2022-04-19 09:39:35.096 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661014088159232[0;39m 生成今日电子书快照结束，耗时：30毫秒
2022-04-19 09:39:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661034816409600[0;39m 生成今日电子书快照开始
2022-04-19 09:39:40.041 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661034816409600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:40.041 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661034816409600[0;39m ==> Parameters: 
2022-04-19 09:39:40.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661034816409600[0;39m <==    Updates: 0
2022-04-19 09:39:40.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661034816409600[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:39:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661055796318208[0;39m 生成今日电子书快照开始
2022-04-19 09:39:45.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661055796318208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:45.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661055796318208[0;39m ==> Parameters: 
2022-04-19 09:39:45.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661055796318208[0;39m <==    Updates: 0
2022-04-19 09:39:45.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661055796318208[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:39:50.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661076755255296[0;39m 生成今日电子书快照开始
2022-04-19 09:39:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661076755255296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661076755255296[0;39m ==> Parameters: 
2022-04-19 09:39:50.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661076755255296[0;39m <==    Updates: 0
2022-04-19 09:39:50.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661076755255296[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:39:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661097709998080[0;39m 生成今日电子书快照开始
2022-04-19 09:39:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661097709998080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:39:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661097709998080[0;39m ==> Parameters: 
2022-04-19 09:39:55.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661097709998080[0;39m <==    Updates: 0
2022-04-19 09:39:55.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661097709998080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:40:00.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661118702489600[0;39m 生成今日电子书快照开始
2022-04-19 09:40:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661118702489600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:00.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661118702489600[0;39m ==> Parameters: 
2022-04-19 09:40:00.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661118702489600[0;39m <==    Updates: 0
2022-04-19 09:40:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661118702489600[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:40:05.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661139678203904[0;39m start updating Ebook doc
2022-04-19 09:40:05.034 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661139678203904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:40:05.035 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661139678203904[0;39m ==> Parameters: 
2022-04-19 09:40:05.066 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661139678203904[0;39m <==    Updates: 1
2022-04-19 09:40:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661139678203904[0;39m update ends, take 58 millisecs
2022-04-19 09:40:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661139921473536[0;39m 生成今日电子书快照开始
2022-04-19 09:40:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661139921473536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661139921473536[0;39m ==> Parameters: 
2022-04-19 09:40:05.098 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661139921473536[0;39m <==    Updates: 0
2022-04-19 09:40:05.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661139921473536[0;39m 生成今日电子书快照结束，耗时：31毫秒
2022-04-19 09:40:10.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661160649723904[0;39m 生成今日电子书快照开始
2022-04-19 09:40:10.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661160649723904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:10.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661160649723904[0;39m ==> Parameters: 
2022-04-19 09:40:10.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661160649723904[0;39m <==    Updates: 0
2022-04-19 09:40:10.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661160649723904[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:40:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661181625438208[0;39m 生成今日电子书快照开始
2022-04-19 09:40:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661181625438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:15.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661181625438208[0;39m ==> Parameters: 
2022-04-19 09:40:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661181625438208[0;39m <==    Updates: 0
2022-04-19 09:40:15.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661181625438208[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:40:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661202596958208[0;39m 生成今日电子书快照开始
2022-04-19 09:40:20.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661202596958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:20.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661202596958208[0;39m ==> Parameters: 
2022-04-19 09:40:20.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661202596958208[0;39m <==    Updates: 0
2022-04-19 09:40:20.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661202596958208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:40:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661223539118080[0;39m 生成今日电子书快照开始
2022-04-19 09:40:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661223539118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661223539118080[0;39m ==> Parameters: 
2022-04-19 09:40:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661223539118080[0;39m <==    Updates: 0
2022-04-19 09:40:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661223539118080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:40:30.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661244527415296[0;39m 生成今日电子书快照开始
2022-04-19 09:40:30.134 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661244527415296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:30.134 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661244527415296[0;39m ==> Parameters: 
2022-04-19 09:40:30.164 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661244527415296[0;39m <==    Updates: 0
2022-04-19 09:40:30.164 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661244527415296[0;39m 生成今日电子书快照结束，耗时：157毫秒
2022-04-19 09:40:35.008 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661265503129600[0;39m start updating Ebook doc
2022-04-19 09:40:35.042 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661265503129600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:40:35.043 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661265503129600[0;39m ==> Parameters: 
2022-04-19 09:40:35.078 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661265503129600[0;39m <==    Updates: 1
2022-04-19 09:40:35.079 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661265503129600[0;39m update ends, take 70 millisecs
2022-04-19 09:40:35.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661265800925184[0;39m 生成今日电子书快照开始
2022-04-19 09:40:35.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661265800925184[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:35.079 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661265800925184[0;39m ==> Parameters: 
2022-04-19 09:40:35.108 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661265800925184[0;39m <==    Updates: 0
2022-04-19 09:40:35.108 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661265800925184[0;39m 生成今日电子书快照结束，耗时：29毫秒
2022-04-19 09:40:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661286449483776[0;39m 生成今日电子书快照开始
2022-04-19 09:40:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661286449483776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661286449483776[0;39m ==> Parameters: 
2022-04-19 09:40:40.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661286449483776[0;39m <==    Updates: 0
2022-04-19 09:40:40.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661286449483776[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:40:45.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661307437780992[0;39m 生成今日电子书快照开始
2022-04-19 09:40:45.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661307437780992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:45.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661307437780992[0;39m ==> Parameters: 
2022-04-19 09:40:45.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661307437780992[0;39m <==    Updates: 0
2022-04-19 09:40:45.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661307437780992[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:40:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661328396718080[0;39m 生成今日电子书快照开始
2022-04-19 09:40:50.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661328396718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661328396718080[0;39m ==> Parameters: 
2022-04-19 09:40:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661328396718080[0;39m <==    Updates: 0
2022-04-19 09:40:50.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661328396718080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:40:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661349393403904[0;39m 生成今日电子书快照开始
2022-04-19 09:40:55.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661349393403904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:40:55.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661349393403904[0;39m ==> Parameters: 
2022-04-19 09:40:55.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661349393403904[0;39m <==    Updates: 0
2022-04-19 09:40:55.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661349393403904[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:41:00.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661370352340992[0;39m 生成今日电子书快照开始
2022-04-19 09:41:00.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661370352340992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:00.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661370352340992[0;39m ==> Parameters: 
2022-04-19 09:41:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661370352340992[0;39m <==    Updates: 0
2022-04-19 09:41:00.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661370352340992[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:41:05.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661391336443904[0;39m start updating Ebook doc
2022-04-19 09:41:05.037 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661391336443904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:41:05.038 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661391336443904[0;39m ==> Parameters: 
2022-04-19 09:41:05.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661391336443904[0;39m <==    Updates: 1
2022-04-19 09:41:05.067 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661391336443904[0;39m update ends, take 57 millisecs
2022-04-19 09:41:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661391579713536[0;39m 生成今日电子书快照开始
2022-04-19 09:41:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661391579713536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:05.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661391579713536[0;39m ==> Parameters: 
2022-04-19 09:41:05.100 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661391579713536[0;39m <==    Updates: 0
2022-04-19 09:41:05.100 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661391579713536[0;39m 生成今日电子书快照结束，耗时：32毫秒
2022-04-19 09:41:10.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661412299575296[0;39m 生成今日电子书快照开始
2022-04-19 09:41:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661412299575296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661412299575296[0;39m ==> Parameters: 
2022-04-19 09:41:10.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661412299575296[0;39m <==    Updates: 0
2022-04-19 09:41:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661412299575296[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:41:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661433283678208[0;39m 生成今日电子书快照开始
2022-04-19 09:41:15.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661433283678208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:15.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661433283678208[0;39m ==> Parameters: 
2022-04-19 09:41:15.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661433283678208[0;39m <==    Updates: 0
2022-04-19 09:41:15.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661433283678208[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:41:20.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661454251003904[0;39m 生成今日电子书快照开始
2022-04-19 09:41:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661454251003904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661454251003904[0;39m ==> Parameters: 
2022-04-19 09:41:20.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661454251003904[0;39m <==    Updates: 0
2022-04-19 09:41:20.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661454251003904[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:41:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661475197358080[0;39m 生成今日电子书快照开始
2022-04-19 09:41:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661475197358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661475197358080[0;39m ==> Parameters: 
2022-04-19 09:41:25.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661475197358080[0;39m <==    Updates: 0
2022-04-19 09:41:25.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661475197358080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:41:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661496160489472[0;39m 生成今日电子书快照开始
2022-04-19 09:41:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661496160489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661496160489472[0;39m ==> Parameters: 
2022-04-19 09:41:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661496160489472[0;39m <==    Updates: 0
2022-04-19 09:41:30.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661496160489472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:41:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661517169758208[0;39m 生成今日电子书快照开始
2022-04-19 09:41:35.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661517169758208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:35.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661517169758208[0;39m ==> Parameters: 
2022-04-19 09:41:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661517169758208[0;39m <==    Updates: 0
2022-04-19 09:41:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661517169758208[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:41:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661517408833536[0;39m start updating Ebook doc
2022-04-19 09:41:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661517408833536[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:41:35.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661517408833536[0;39m ==> Parameters: 
2022-04-19 09:41:35.094 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661517408833536[0;39m <==    Updates: 1
2022-04-19 09:41:35.094 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661517408833536[0;39m update ends, take 26 millisecs
2022-04-19 09:41:40.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661538132889600[0;39m 生成今日电子书快照开始
2022-04-19 09:41:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661538132889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:40.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661538132889600[0;39m ==> Parameters: 
2022-04-19 09:41:40.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661538132889600[0;39m <==    Updates: 0
2022-04-19 09:41:40.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661538132889600[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:41:45.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661559112798208[0;39m 生成今日电子书快照开始
2022-04-19 09:41:45.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661559112798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:45.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661559112798208[0;39m ==> Parameters: 
2022-04-19 09:41:45.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661559112798208[0;39m <==    Updates: 0
2022-04-19 09:41:45.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661559112798208[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:41:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661580054958080[0;39m 生成今日电子书快照开始
2022-04-19 09:41:50.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661580054958080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:50.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661580054958080[0;39m ==> Parameters: 
2022-04-19 09:41:50.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661580054958080[0;39m <==    Updates: 0
2022-04-19 09:41:50.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661580054958080[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:41:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661601026478080[0;39m 生成今日电子书快照开始
2022-04-19 09:41:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661601026478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:41:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661601026478080[0;39m ==> Parameters: 
2022-04-19 09:41:55.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661601026478080[0;39m <==    Updates: 0
2022-04-19 09:41:55.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661601026478080[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:42:00.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661622027358208[0;39m 生成今日电子书快照开始
2022-04-19 09:42:00.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661622027358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:00.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661622027358208[0;39m ==> Parameters: 
2022-04-19 09:42:00.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661622027358208[0;39m <==    Updates: 0
2022-04-19 09:42:00.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661622027358208[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:42:05.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661642973712384[0;39m 生成今日电子书快照开始
2022-04-19 09:42:05.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661642973712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:05.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661642973712384[0;39m ==> Parameters: 
2022-04-19 09:42:05.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661642973712384[0;39m <==    Updates: 0
2022-04-19 09:42:05.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661642973712384[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:42:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661643208593408[0;39m start updating Ebook doc
2022-04-19 09:42:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661643208593408[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:42:05.060 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661643208593408[0;39m ==> Parameters: 
2022-04-19 09:42:05.094 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661643208593408[0;39m <==    Updates: 1
2022-04-19 09:42:05.094 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661643208593408[0;39m update ends, take 34 millisecs
2022-04-19 09:42:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661663962009600[0;39m 生成今日电子书快照开始
2022-04-19 09:42:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661663962009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661663962009600[0;39m ==> Parameters: 
2022-04-19 09:42:10.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661663962009600[0;39m <==    Updates: 0
2022-04-19 09:42:10.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661663962009600[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:42:15.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661684941918208[0;39m 生成今日电子书快照开始
2022-04-19 09:42:15.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661684941918208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:15.036 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661684941918208[0;39m ==> Parameters: 
2022-04-19 09:42:15.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661684941918208[0;39m <==    Updates: 0
2022-04-19 09:42:15.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661684941918208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:42:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661705896660992[0;39m 生成今日电子书快照开始
2022-04-19 09:42:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661705896660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661705896660992[0;39m ==> Parameters: 
2022-04-19 09:42:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661705896660992[0;39m <==    Updates: 0
2022-04-19 09:42:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661705896660992[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:42:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661726855598080[0;39m 生成今日电子书快照开始
2022-04-19 09:42:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661726855598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661726855598080[0;39m ==> Parameters: 
2022-04-19 09:42:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661726855598080[0;39m <==    Updates: 0
2022-04-19 09:42:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661726855598080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:42:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661747856478208[0;39m 生成今日电子书快照开始
2022-04-19 09:42:30.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661747856478208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:30.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661747856478208[0;39m ==> Parameters: 
2022-04-19 09:42:30.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661747856478208[0;39m <==    Updates: 0
2022-04-19 09:42:30.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661747856478208[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:42:35.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661768827998208[0;39m 生成今日电子书快照开始
2022-04-19 09:42:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661768827998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:35.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661768827998208[0;39m ==> Parameters: 
2022-04-19 09:42:35.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661768827998208[0;39m <==    Updates: 0
2022-04-19 09:42:35.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661768827998208[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:42:35.056 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661769020936192[0;39m start updating Ebook doc
2022-04-19 09:42:35.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661769020936192[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:42:35.057 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661769020936192[0;39m ==> Parameters: 
2022-04-19 09:42:35.088 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661769020936192[0;39m <==    Updates: 1
2022-04-19 09:42:35.089 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661769020936192[0;39m update ends, take 33 millisecs
2022-04-19 09:42:40.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661789799518208[0;39m 生成今日电子书快照开始
2022-04-19 09:42:40.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661789799518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:40.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661789799518208[0;39m ==> Parameters: 
2022-04-19 09:42:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661789799518208[0;39m <==    Updates: 0
2022-04-19 09:42:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661789799518208[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:42:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661810733289472[0;39m 生成今日电子书快照开始
2022-04-19 09:42:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661810733289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661810733289472[0;39m ==> Parameters: 
2022-04-19 09:42:45.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661810733289472[0;39m <==    Updates: 0
2022-04-19 09:42:45.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661810733289472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:42:50.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661831738363904[0;39m 生成今日电子书快照开始
2022-04-19 09:42:50.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661831738363904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:50.040 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661831738363904[0;39m ==> Parameters: 
2022-04-19 09:42:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661831738363904[0;39m <==    Updates: 0
2022-04-19 09:42:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661831738363904[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:42:55.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661852709883904[0;39m 生成今日电子书快照开始
2022-04-19 09:42:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661852709883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:42:55.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661852709883904[0;39m ==> Parameters: 
2022-04-19 09:42:55.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661852709883904[0;39m <==    Updates: 0
2022-04-19 09:42:55.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661852709883904[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:43:00.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661873673015296[0;39m 生成今日电子书快照开始
2022-04-19 09:43:00.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661873673015296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:00.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661873673015296[0;39m ==> Parameters: 
2022-04-19 09:43:00.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661873673015296[0;39m <==    Updates: 0
2022-04-19 09:43:00.078 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661873673015296[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:43:05.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661894648729600[0;39m 生成今日电子书快照开始
2022-04-19 09:43:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661894648729600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661894648729600[0;39m ==> Parameters: 
2022-04-19 09:43:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661894648729600[0;39m <==    Updates: 0
2022-04-19 09:43:05.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661894648729600[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:43:05.072 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171661894917165056[0;39m start updating Ebook doc
2022-04-19 09:43:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661894917165056[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:43:05.073 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661894917165056[0;39m ==> Parameters: 
2022-04-19 09:43:05.120 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171661894917165056[0;39m <==    Updates: 1
2022-04-19 09:43:05.120 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171661894917165056[0;39m update ends, take 48 millisecs
2022-04-19 09:43:10.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661915611860992[0;39m 生成今日电子书快照开始
2022-04-19 09:43:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661915611860992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661915611860992[0;39m ==> Parameters: 
2022-04-19 09:43:10.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661915611860992[0;39m <==    Updates: 0
2022-04-19 09:43:10.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661915611860992[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:43:15.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661936591769600[0;39m 生成今日电子书快照开始
2022-04-19 09:43:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661936591769600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661936591769600[0;39m ==> Parameters: 
2022-04-19 09:43:15.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661936591769600[0;39m <==    Updates: 0
2022-04-19 09:43:15.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661936591769600[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:43:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661957571678208[0;39m 生成今日电子书快照开始
2022-04-19 09:43:20.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661957571678208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:20.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661957571678208[0;39m ==> Parameters: 
2022-04-19 09:43:20.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661957571678208[0;39m <==    Updates: 0
2022-04-19 09:43:20.077 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661957571678208[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:43:25.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661978539003904[0;39m 生成今日电子书快照开始
2022-04-19 09:43:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661978539003904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:25.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661978539003904[0;39m ==> Parameters: 
2022-04-19 09:43:25.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661978539003904[0;39m <==    Updates: 0
2022-04-19 09:43:25.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661978539003904[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:43:30.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171661999497940992[0;39m 生成今日电子书快照开始
2022-04-19 09:43:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661999497940992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:30.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661999497940992[0;39m ==> Parameters: 
2022-04-19 09:43:30.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171661999497940992[0;39m <==    Updates: 0
2022-04-19 09:43:30.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171661999497940992[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:43:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662020486238208[0;39m start updating Ebook doc
2022-04-19 09:43:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662020486238208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:43:35.026 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662020486238208[0;39m ==> Parameters: 
2022-04-19 09:43:35.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662020486238208[0;39m <==    Updates: 1
2022-04-19 09:43:35.071 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662020486238208[0;39m update ends, take 61 millisecs
2022-04-19 09:43:35.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662020742090752[0;39m 生成今日电子书快照开始
2022-04-19 09:43:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662020742090752[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:35.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662020742090752[0;39m ==> Parameters: 
2022-04-19 09:43:35.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662020742090752[0;39m <==    Updates: 0
2022-04-19 09:43:35.112 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662020742090752[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-19 09:43:40.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662041415815168[0;39m 生成今日电子书快照开始
2022-04-19 09:43:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662041415815168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:40.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662041415815168[0;39m ==> Parameters: 
2022-04-19 09:43:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662041415815168[0;39m <==    Updates: 0
2022-04-19 09:43:40.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662041415815168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:43:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662062395723776[0;39m 生成今日电子书快照开始
2022-04-19 09:43:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662062395723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662062395723776[0;39m ==> Parameters: 
2022-04-19 09:43:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662062395723776[0;39m <==    Updates: 0
2022-04-19 09:43:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662062395723776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:43:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662083375632384[0;39m 生成今日电子书快照开始
2022-04-19 09:43:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662083375632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:50.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662083375632384[0;39m ==> Parameters: 
2022-04-19 09:43:50.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662083375632384[0;39m <==    Updates: 0
2022-04-19 09:43:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662083375632384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:43:55.007 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662104359735296[0;39m 生成今日电子书快照开始
2022-04-19 09:43:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662104359735296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:43:55.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662104359735296[0;39m ==> Parameters: 
2022-04-19 09:43:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662104359735296[0;39m <==    Updates: 0
2022-04-19 09:43:55.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662104359735296[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:44:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662125301895168[0;39m 生成今日电子书快照开始
2022-04-19 09:44:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662125301895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:00.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662125301895168[0;39m ==> Parameters: 
2022-04-19 09:44:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662125301895168[0;39m <==    Updates: 0
2022-04-19 09:44:00.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662125301895168[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:44:05.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662146306969600[0;39m 生成今日电子书快照开始
2022-04-19 09:44:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662146306969600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:05.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662146306969600[0;39m ==> Parameters: 
2022-04-19 09:44:05.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662146306969600[0;39m <==    Updates: 0
2022-04-19 09:44:05.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662146306969600[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:44:05.070 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662146567016448[0;39m start updating Ebook doc
2022-04-19 09:44:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662146567016448[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:44:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662146567016448[0;39m ==> Parameters: 
2022-04-19 09:44:05.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662146567016448[0;39m <==    Updates: 1
2022-04-19 09:44:05.110 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662146567016448[0;39m update ends, take 39 millisecs
2022-04-19 09:44:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662167265906688[0;39m 生成今日电子书快照开始
2022-04-19 09:44:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662167265906688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662167265906688[0;39m ==> Parameters: 
2022-04-19 09:44:10.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662167265906688[0;39m <==    Updates: 0
2022-04-19 09:44:10.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662167265906688[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:44:15.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662188250009600[0;39m 生成今日电子书快照开始
2022-04-19 09:44:15.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662188250009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:15.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662188250009600[0;39m ==> Parameters: 
2022-04-19 09:44:15.081 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662188250009600[0;39m <==    Updates: 0
2022-04-19 09:44:15.081 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662188250009600[0;39m 生成今日电子书快照结束，耗时：73毫秒
2022-04-19 09:44:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662209192169472[0;39m 生成今日电子书快照开始
2022-04-19 09:44:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662209192169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662209192169472[0;39m ==> Parameters: 
2022-04-19 09:44:20.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662209192169472[0;39m <==    Updates: 0
2022-04-19 09:44:20.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662209192169472[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:44:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662230180466688[0;39m 生成今日电子书快照开始
2022-04-19 09:44:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662230180466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662230180466688[0;39m ==> Parameters: 
2022-04-19 09:44:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662230180466688[0;39m <==    Updates: 0
2022-04-19 09:44:25.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662230180466688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:44:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662251172958208[0;39m 生成今日电子书快照开始
2022-04-19 09:44:30.034 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662251172958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:30.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662251172958208[0;39m ==> Parameters: 
2022-04-19 09:44:30.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662251172958208[0;39m <==    Updates: 0
2022-04-19 09:44:30.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662251172958208[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:44:35.010 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662272144478208[0;39m start updating Ebook doc
2022-04-19 09:44:35.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662272144478208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:44:35.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662272144478208[0;39m ==> Parameters: 
2022-04-19 09:44:35.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662272144478208[0;39m <==    Updates: 1
2022-04-19 09:44:35.075 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662272144478208[0;39m update ends, take 64 millisecs
2022-04-19 09:44:35.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662272417107968[0;39m 生成今日电子书快照开始
2022-04-19 09:44:35.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662272417107968[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:35.076 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662272417107968[0;39m ==> Parameters: 
2022-04-19 09:44:35.115 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662272417107968[0;39m <==    Updates: 0
2022-04-19 09:44:35.115 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662272417107968[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-19 09:44:40.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662293111803904[0;39m 生成今日电子书快照开始
2022-04-19 09:44:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662293111803904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662293111803904[0;39m ==> Parameters: 
2022-04-19 09:44:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662293111803904[0;39m <==    Updates: 0
2022-04-19 09:44:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662293111803904[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:44:45.009 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662314083323904[0;39m 生成今日电子书快照开始
2022-04-19 09:44:45.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662314083323904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:45.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662314083323904[0;39m ==> Parameters: 
2022-04-19 09:44:45.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662314083323904[0;39m <==    Updates: 0
2022-04-19 09:44:45.073 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662314083323904[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:44:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662335059038208[0;39m 生成今日电子书快照开始
2022-04-19 09:44:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662335059038208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:50.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662335059038208[0;39m ==> Parameters: 
2022-04-19 09:44:50.074 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662335059038208[0;39m <==    Updates: 0
2022-04-19 09:44:50.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662335059038208[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:44:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662356005392384[0;39m 生成今日电子书快照开始
2022-04-19 09:44:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662356005392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:44:55.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662356005392384[0;39m ==> Parameters: 
2022-04-19 09:44:55.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662356005392384[0;39m <==    Updates: 0
2022-04-19 09:44:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662356005392384[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:45:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662376960135168[0;39m 生成今日电子书快照开始
2022-04-19 09:45:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662376960135168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662376960135168[0;39m ==> Parameters: 
2022-04-19 09:45:00.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662376960135168[0;39m <==    Updates: 0
2022-04-19 09:45:00.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662376960135168[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:45:05.009 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662397969403904[0;39m start updating Ebook doc
2022-04-19 09:45:05.032 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662397969403904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:45:05.033 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662397969403904[0;39m ==> Parameters: 
2022-04-19 09:45:05.071 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662397969403904[0;39m <==    Updates: 1
2022-04-19 09:45:05.072 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662397969403904[0;39m update ends, take 63 millisecs
2022-04-19 09:45:05.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662398233645056[0;39m 生成今日电子书快照开始
2022-04-19 09:45:05.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662398233645056[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:05.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662398233645056[0;39m ==> Parameters: 
2022-04-19 09:45:05.112 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662398233645056[0;39m <==    Updates: 0
2022-04-19 09:45:05.112 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662398233645056[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-19 09:45:10.008 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662418936729600[0;39m 生成今日电子书快照开始
2022-04-19 09:45:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662418936729600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662418936729600[0;39m ==> Parameters: 
2022-04-19 09:45:10.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662418936729600[0;39m <==    Updates: 0
2022-04-19 09:45:10.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662418936729600[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:45:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662439883083776[0;39m 生成今日电子书快照开始
2022-04-19 09:45:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662439883083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662439883083776[0;39m ==> Parameters: 
2022-04-19 09:45:15.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662439883083776[0;39m <==    Updates: 0
2022-04-19 09:45:15.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662439883083776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:45:20.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662460888158208[0;39m 生成今日电子书快照开始
2022-04-19 09:45:20.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662460888158208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:20.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662460888158208[0;39m ==> Parameters: 
2022-04-19 09:45:20.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662460888158208[0;39m <==    Updates: 0
2022-04-19 09:45:20.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662460888158208[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:45:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662481821929472[0;39m 生成今日电子书快照开始
2022-04-19 09:45:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662481821929472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662481821929472[0;39m ==> Parameters: 
2022-04-19 09:45:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662481821929472[0;39m <==    Updates: 0
2022-04-19 09:45:25.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662481821929472[0;39m 生成今日电子书快照结束，耗时：59毫秒
2022-04-19 09:45:30.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662502831198208[0;39m 生成今日电子书快照开始
2022-04-19 09:45:30.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662502831198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:30.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662502831198208[0;39m ==> Parameters: 
2022-04-19 09:45:30.216 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662502831198208[0;39m <==    Updates: 0
2022-04-19 09:45:30.217 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662502831198208[0;39m 生成今日电子书快照结束，耗时：207毫秒
2022-04-19 09:45:35.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662523773358080[0;39m 生成今日电子书快照开始
2022-04-19 09:45:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662523773358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662523773358080[0;39m ==> Parameters: 
2022-04-19 09:45:35.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662523773358080[0;39m <==    Updates: 0
2022-04-19 09:45:35.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662523773358080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:45:35.061 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662524016627712[0;39m start updating Ebook doc
2022-04-19 09:45:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662524016627712[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:45:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662524016627712[0;39m ==> Parameters: 
2022-04-19 09:45:35.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662524016627712[0;39m <==    Updates: 1
2022-04-19 09:45:35.106 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662524016627712[0;39m update ends, take 45 millisecs
2022-04-19 09:45:40.013 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662544786821120[0;39m 生成今日电子书快照开始
2022-04-19 09:45:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662544786821120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:40.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662544786821120[0;39m ==> Parameters: 
2022-04-19 09:45:40.072 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662544786821120[0;39m <==    Updates: 0
2022-04-19 09:45:40.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662544786821120[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:45:45.013 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662565758341120[0;39m 生成今日电子书快照开始
2022-04-19 09:45:45.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662565758341120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:45.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662565758341120[0;39m ==> Parameters: 
2022-04-19 09:45:45.078 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662565758341120[0;39m <==    Updates: 0
2022-04-19 09:45:45.079 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662565758341120[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:45:50.010 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662586717278208[0;39m 生成今日电子书快照开始
2022-04-19 09:45:50.037 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662586717278208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:50.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662586717278208[0;39m ==> Parameters: 
2022-04-19 09:45:50.146 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662586717278208[0;39m <==    Updates: 0
2022-04-19 09:45:50.147 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662586717278208[0;39m 生成今日电子书快照结束，耗时：136毫秒
2022-04-19 09:45:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662607667826688[0;39m 生成今日电子书快照开始
2022-04-19 09:45:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662607667826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:45:55.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662607667826688[0;39m ==> Parameters: 
2022-04-19 09:45:55.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662607667826688[0;39m <==    Updates: 0
2022-04-19 09:45:55.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662607667826688[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:46:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662628622569472[0;39m 生成今日电子书快照开始
2022-04-19 09:46:00.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662628622569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662628622569472[0;39m ==> Parameters: 
2022-04-19 09:46:00.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662628622569472[0;39m <==    Updates: 0
2022-04-19 09:46:00.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662628622569472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:46:05.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662649589895168[0;39m 生成今日电子书快照开始
2022-04-19 09:46:05.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662649589895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:05.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662649589895168[0;39m ==> Parameters: 
2022-04-19 09:46:05.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662649589895168[0;39m <==    Updates: 0
2022-04-19 09:46:05.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662649589895168[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:46:05.071 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662649887690752[0;39m start updating Ebook doc
2022-04-19 09:46:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662649887690752[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:46:05.072 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662649887690752[0;39m ==> Parameters: 
2022-04-19 09:46:05.110 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662649887690752[0;39m <==    Updates: 1
2022-04-19 09:46:05.111 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662649887690752[0;39m update ends, take 39 millisecs
2022-04-19 09:46:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662670582386688[0;39m 生成今日电子书快照开始
2022-04-19 09:46:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662670582386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662670582386688[0;39m ==> Parameters: 
2022-04-19 09:46:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662670582386688[0;39m <==    Updates: 0
2022-04-19 09:46:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662670582386688[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:46:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662691541323776[0;39m 生成今日电子书快照开始
2022-04-19 09:46:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662691541323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662691541323776[0;39m ==> Parameters: 
2022-04-19 09:46:15.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662691541323776[0;39m <==    Updates: 0
2022-04-19 09:46:15.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662691541323776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:46:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662712517038080[0;39m 生成今日电子书快照开始
2022-04-19 09:46:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662712517038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662712517038080[0;39m ==> Parameters: 
2022-04-19 09:46:20.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662712517038080[0;39m <==    Updates: 0
2022-04-19 09:46:20.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662712517038080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:46:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662733484363776[0;39m 生成今日电子书快照开始
2022-04-19 09:46:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662733484363776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662733484363776[0;39m ==> Parameters: 
2022-04-19 09:46:25.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662733484363776[0;39m <==    Updates: 0
2022-04-19 09:46:25.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662733484363776[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:46:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662754447495168[0;39m 生成今日电子书快照开始
2022-04-19 09:46:30.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662754447495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:30.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662754447495168[0;39m ==> Parameters: 
2022-04-19 09:46:30.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662754447495168[0;39m <==    Updates: 0
2022-04-19 09:46:30.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662754447495168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:46:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662775423209472[0;39m start updating Ebook doc
2022-04-19 09:46:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662775423209472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:46:35.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662775423209472[0;39m ==> Parameters: 
2022-04-19 09:46:35.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662775423209472[0;39m <==    Updates: 1
2022-04-19 09:46:35.063 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662775423209472[0;39m update ends, take 62 millisecs
2022-04-19 09:46:35.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662775683256320[0;39m 生成今日电子书快照开始
2022-04-19 09:46:35.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662775683256320[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:35.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662775683256320[0;39m ==> Parameters: 
2022-04-19 09:46:35.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662775683256320[0;39m <==    Updates: 0
2022-04-19 09:46:35.103 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662775683256320[0;39m 生成今日电子书快照结束，耗时：40毫秒
2022-04-19 09:46:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662796403118080[0;39m 生成今日电子书快照开始
2022-04-19 09:46:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662796403118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:40.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662796403118080[0;39m ==> Parameters: 
2022-04-19 09:46:40.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662796403118080[0;39m <==    Updates: 0
2022-04-19 09:46:40.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662796403118080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:46:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662817362055168[0;39m 生成今日电子书快照开始
2022-04-19 09:46:45.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662817362055168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662817362055168[0;39m ==> Parameters: 
2022-04-19 09:46:45.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662817362055168[0;39m <==    Updates: 0
2022-04-19 09:46:45.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662817362055168[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:46:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662838333575168[0;39m 生成今日电子书快照开始
2022-04-19 09:46:50.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662838333575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662838333575168[0;39m ==> Parameters: 
2022-04-19 09:46:50.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662838333575168[0;39m <==    Updates: 0
2022-04-19 09:46:50.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662838333575168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:46:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662859305095168[0;39m 生成今日电子书快照开始
2022-04-19 09:46:55.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662859305095168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:46:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662859305095168[0;39m ==> Parameters: 
2022-04-19 09:46:55.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662859305095168[0;39m <==    Updates: 0
2022-04-19 09:46:55.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662859305095168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:47:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662880276615168[0;39m 生成今日电子书快照开始
2022-04-19 09:47:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662880276615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:00.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662880276615168[0;39m ==> Parameters: 
2022-04-19 09:47:00.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662880276615168[0;39m <==    Updates: 0
2022-04-19 09:47:00.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662880276615168[0;39m 生成今日电子书快照结束，耗时：104毫秒
2022-04-19 09:47:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662901252329472[0;39m 生成今日电子书快照开始
2022-04-19 09:47:05.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662901252329472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662901252329472[0;39m ==> Parameters: 
2022-04-19 09:47:05.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662901252329472[0;39m <==    Updates: 0
2022-04-19 09:47:05.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662901252329472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:47:05.055 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171662901478821888[0;39m start updating Ebook doc
2022-04-19 09:47:05.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662901478821888[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:47:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662901478821888[0;39m ==> Parameters: 
2022-04-19 09:47:05.092 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171662901478821888[0;39m <==    Updates: 1
2022-04-19 09:47:05.092 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171662901478821888[0;39m update ends, take 37 millisecs
2022-04-19 09:47:10.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662922240626688[0;39m 生成今日电子书快照开始
2022-04-19 09:47:10.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662922240626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:10.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662922240626688[0;39m ==> Parameters: 
2022-04-19 09:47:10.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662922240626688[0;39m <==    Updates: 0
2022-04-19 09:47:10.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662922240626688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:47:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662943203758080[0;39m 生成今日电子书快照开始
2022-04-19 09:47:15.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662943203758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:15.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662943203758080[0;39m ==> Parameters: 
2022-04-19 09:47:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662943203758080[0;39m <==    Updates: 0
2022-04-19 09:47:15.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662943203758080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:47:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662964175278080[0;39m 生成今日电子书快照开始
2022-04-19 09:47:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662964175278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662964175278080[0;39m ==> Parameters: 
2022-04-19 09:47:20.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662964175278080[0;39m <==    Updates: 0
2022-04-19 09:47:20.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662964175278080[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:47:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171662985146798080[0;39m 生成今日电子书快照开始
2022-04-19 09:47:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662985146798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662985146798080[0;39m ==> Parameters: 
2022-04-19 09:47:25.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171662985146798080[0;39m <==    Updates: 0
2022-04-19 09:47:25.064 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171662985146798080[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:47:30.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663006122512384[0;39m 生成今日电子书快照开始
2022-04-19 09:47:30.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663006122512384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663006122512384[0;39m ==> Parameters: 
2022-04-19 09:47:30.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663006122512384[0;39m <==    Updates: 0
2022-04-19 09:47:30.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663006122512384[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:47:35.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663027094032384[0;39m start updating Ebook doc
2022-04-19 09:47:35.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663027094032384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:47:35.029 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663027094032384[0;39m ==> Parameters: 
2022-04-19 09:47:35.069 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663027094032384[0;39m <==    Updates: 1
2022-04-19 09:47:35.070 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663027094032384[0;39m update ends, take 65 millisecs
2022-04-19 09:47:35.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663027370856448[0;39m 生成今日电子书快照开始
2022-04-19 09:47:35.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663027370856448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663027370856448[0;39m ==> Parameters: 
2022-04-19 09:47:35.122 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663027370856448[0;39m <==    Updates: 0
2022-04-19 09:47:35.122 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663027370856448[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:47:40.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663048052969472[0;39m 生成今日电子书快照开始
2022-04-19 09:47:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663048052969472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:40.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663048052969472[0;39m ==> Parameters: 
2022-04-19 09:47:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663048052969472[0;39m <==    Updates: 0
2022-04-19 09:47:40.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663048052969472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:47:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663069028683776[0;39m 生成今日电子书快照开始
2022-04-19 09:47:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663069028683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663069028683776[0;39m ==> Parameters: 
2022-04-19 09:47:45.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663069028683776[0;39m <==    Updates: 0
2022-04-19 09:47:45.072 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663069028683776[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:47:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663090004398080[0;39m 生成今日电子书快照开始
2022-04-19 09:47:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663090004398080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663090004398080[0;39m ==> Parameters: 
2022-04-19 09:47:50.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663090004398080[0;39m <==    Updates: 0
2022-04-19 09:47:50.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663090004398080[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:47:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663110984306688[0;39m 生成今日电子书快照开始
2022-04-19 09:47:55.181 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663110984306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:47:55.183 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663110984306688[0;39m ==> Parameters: 
2022-04-19 09:47:55.254 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663110984306688[0;39m <==    Updates: 0
2022-04-19 09:47:55.254 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663110984306688[0;39m 生成今日电子书快照结束，耗时：247毫秒
2022-04-19 09:48:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663131934855168[0;39m 生成今日电子书快照开始
2022-04-19 09:48:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663131934855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663131934855168[0;39m ==> Parameters: 
2022-04-19 09:48:00.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663131934855168[0;39m <==    Updates: 0
2022-04-19 09:48:00.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663131934855168[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:48:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663152910569472[0;39m start updating Ebook doc
2022-04-19 09:48:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663152910569472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:48:05.024 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663152910569472[0;39m ==> Parameters: 
2022-04-19 09:48:05.059 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663152910569472[0;39m <==    Updates: 1
2022-04-19 09:48:05.060 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663152910569472[0;39m update ends, take 58 millisecs
2022-04-19 09:48:05.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663153158033408[0;39m 生成今日电子书快照开始
2022-04-19 09:48:05.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663153158033408[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:05.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663153158033408[0;39m ==> Parameters: 
2022-04-19 09:48:05.098 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663153158033408[0;39m <==    Updates: 0
2022-04-19 09:48:05.098 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663153158033408[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-19 09:48:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663173877895168[0;39m 生成今日电子书快照开始
2022-04-19 09:48:10.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663173877895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:10.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663173877895168[0;39m ==> Parameters: 
2022-04-19 09:48:10.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663173877895168[0;39m <==    Updates: 0
2022-04-19 09:48:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663173877895168[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:48:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663194853609472[0;39m 生成今日电子书快照开始
2022-04-19 09:48:15.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663194853609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:15.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663194853609472[0;39m ==> Parameters: 
2022-04-19 09:48:15.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663194853609472[0;39m <==    Updates: 0
2022-04-19 09:48:15.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663194853609472[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:48:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663215820935168[0;39m 生成今日电子书快照开始
2022-04-19 09:48:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663215820935168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663215820935168[0;39m ==> Parameters: 
2022-04-19 09:48:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663215820935168[0;39m <==    Updates: 0
2022-04-19 09:48:20.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663215820935168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:48:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663236796649472[0;39m 生成今日电子书快照开始
2022-04-19 09:48:25.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663236796649472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663236796649472[0;39m ==> Parameters: 
2022-04-19 09:48:25.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663236796649472[0;39m <==    Updates: 0
2022-04-19 09:48:25.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663236796649472[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:48:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663257763975168[0;39m 生成今日电子书快照开始
2022-04-19 09:48:30.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663257763975168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663257763975168[0;39m ==> Parameters: 
2022-04-19 09:48:30.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663257763975168[0;39m <==    Updates: 0
2022-04-19 09:48:30.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663257763975168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:48:35.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663278752272384[0;39m 生成今日电子书快照开始
2022-04-19 09:48:35.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663278752272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:35.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663278752272384[0;39m ==> Parameters: 
2022-04-19 09:48:35.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663278752272384[0;39m <==    Updates: 0
2022-04-19 09:48:35.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663278752272384[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:48:35.054 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663278961987584[0;39m start updating Ebook doc
2022-04-19 09:48:35.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663278961987584[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:48:35.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663278961987584[0;39m ==> Parameters: 
2022-04-19 09:48:35.089 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663278961987584[0;39m <==    Updates: 1
2022-04-19 09:48:35.089 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663278961987584[0;39m update ends, take 35 millisecs
2022-04-19 09:48:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663299719598080[0;39m 生成今日电子书快照开始
2022-04-19 09:48:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663299719598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663299719598080[0;39m ==> Parameters: 
2022-04-19 09:48:40.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663299719598080[0;39m <==    Updates: 0
2022-04-19 09:48:40.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663299719598080[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:48:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663320699506688[0;39m 生成今日电子书快照开始
2022-04-19 09:48:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663320699506688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663320699506688[0;39m ==> Parameters: 
2022-04-19 09:48:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663320699506688[0;39m <==    Updates: 0
2022-04-19 09:48:45.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663320699506688[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:48:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663341662638080[0;39m 生成今日电子书快照开始
2022-04-19 09:48:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663341662638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663341662638080[0;39m ==> Parameters: 
2022-04-19 09:48:50.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663341662638080[0;39m <==    Updates: 0
2022-04-19 09:48:50.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663341662638080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:48:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663362642546688[0;39m 生成今日电子书快照开始
2022-04-19 09:48:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663362642546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:48:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663362642546688[0;39m ==> Parameters: 
2022-04-19 09:48:55.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663362642546688[0;39m <==    Updates: 0
2022-04-19 09:48:55.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663362642546688[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:49:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663383597289472[0;39m 生成今日电子书快照开始
2022-04-19 09:49:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663383597289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663383597289472[0;39m ==> Parameters: 
2022-04-19 09:49:00.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663383597289472[0;39m <==    Updates: 0
2022-04-19 09:49:00.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663383597289472[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:49:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663404568809472[0;39m start updating Ebook doc
2022-04-19 09:49:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663404568809472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:49:05.020 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663404568809472[0;39m ==> Parameters: 
2022-04-19 09:49:05.062 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663404568809472[0;39m <==    Updates: 1
2022-04-19 09:49:05.062 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663404568809472[0;39m update ends, take 60 millisecs
2022-04-19 09:49:05.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663404824662016[0;39m 生成今日电子书快照开始
2022-04-19 09:49:05.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663404824662016[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:05.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663404824662016[0;39m ==> Parameters: 
2022-04-19 09:49:05.103 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663404824662016[0;39m <==    Updates: 0
2022-04-19 09:49:05.104 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663404824662016[0;39m 生成今日电子书快照结束，耗时：42毫秒
2022-04-19 09:49:10.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663425536135168[0;39m 生成今日电子书快照开始
2022-04-19 09:49:10.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663425536135168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:10.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663425536135168[0;39m ==> Parameters: 
2022-04-19 09:49:10.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663425536135168[0;39m <==    Updates: 0
2022-04-19 09:49:10.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663425536135168[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:49:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663446520238080[0;39m 生成今日电子书快照开始
2022-04-19 09:49:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663446520238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663446520238080[0;39m ==> Parameters: 
2022-04-19 09:49:15.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663446520238080[0;39m <==    Updates: 0
2022-04-19 09:49:15.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663446520238080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:49:20.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663467491758080[0;39m 生成今日电子书快照开始
2022-04-19 09:49:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663467491758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:20.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663467491758080[0;39m ==> Parameters: 
2022-04-19 09:49:20.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663467491758080[0;39m <==    Updates: 0
2022-04-19 09:49:20.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663467491758080[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-19 09:49:25.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663488463278080[0;39m 生成今日电子书快照开始
2022-04-19 09:49:25.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663488463278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:25.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663488463278080[0;39m ==> Parameters: 
2022-04-19 09:49:25.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663488463278080[0;39m <==    Updates: 0
2022-04-19 09:49:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663488463278080[0;39m 生成今日电子书快照结束，耗时：57毫秒
2022-04-19 09:49:30.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663509426409472[0;39m 生成今日电子书快照开始
2022-04-19 09:49:30.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663509426409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:30.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663509426409472[0;39m ==> Parameters: 
2022-04-19 09:49:30.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663509426409472[0;39m <==    Updates: 0
2022-04-19 09:49:30.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663509426409472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:49:35.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663530393735168[0;39m start updating Ebook doc
2022-04-19 09:49:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663530393735168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:49:35.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663530393735168[0;39m ==> Parameters: 
2022-04-19 09:49:35.061 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663530393735168[0;39m <==    Updates: 1
2022-04-19 09:49:35.062 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663530393735168[0;39m update ends, take 61 millisecs
2022-04-19 09:49:35.062 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663530653782016[0;39m 生成今日电子书快照开始
2022-04-19 09:49:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663530653782016[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:35.062 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663530653782016[0;39m ==> Parameters: 
2022-04-19 09:49:35.100 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663530653782016[0;39m <==    Updates: 0
2022-04-19 09:49:35.101 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663530653782016[0;39m 生成今日电子书快照结束，耗时：39毫秒
2022-04-19 09:49:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663551386226688[0;39m 生成今日电子书快照开始
2022-04-19 09:49:40.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663551386226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663551386226688[0;39m ==> Parameters: 
2022-04-19 09:49:40.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663551386226688[0;39m <==    Updates: 0
2022-04-19 09:49:40.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663551386226688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:49:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663572349358080[0;39m 生成今日电子书快照开始
2022-04-19 09:49:45.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663572349358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663572349358080[0;39m ==> Parameters: 
2022-04-19 09:49:45.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663572349358080[0;39m <==    Updates: 0
2022-04-19 09:49:45.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663572349358080[0;39m 生成今日电子书快照结束，耗时：71毫秒
2022-04-19 09:49:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663593320878080[0;39m 生成今日电子书快照开始
2022-04-19 09:49:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663593320878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:50.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663593320878080[0;39m ==> Parameters: 
2022-04-19 09:49:50.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663593320878080[0;39m <==    Updates: 0
2022-04-19 09:49:50.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663593320878080[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:49:55.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663614300786688[0;39m 生成今日电子书快照开始
2022-04-19 09:49:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663614300786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:49:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663614300786688[0;39m ==> Parameters: 
2022-04-19 09:49:55.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663614300786688[0;39m <==    Updates: 0
2022-04-19 09:49:55.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663614300786688[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:50:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663635259723776[0;39m 生成今日电子书快照开始
2022-04-19 09:50:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663635259723776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663635259723776[0;39m ==> Parameters: 
2022-04-19 09:50:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663635259723776[0;39m <==    Updates: 0
2022-04-19 09:50:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663635259723776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:50:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663656227049472[0;39m start updating Ebook doc
2022-04-19 09:50:05.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663656227049472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:50:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663656227049472[0;39m ==> Parameters: 
2022-04-19 09:50:05.052 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663656227049472[0;39m <==    Updates: 1
2022-04-19 09:50:05.053 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663656227049472[0;39m update ends, take 51 millisecs
2022-04-19 09:50:05.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663656445153280[0;39m 生成今日电子书快照开始
2022-04-19 09:50:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663656445153280[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663656445153280[0;39m ==> Parameters: 
2022-04-19 09:50:05.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663656445153280[0;39m <==    Updates: 0
2022-04-19 09:50:05.091 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663656445153280[0;39m 生成今日电子书快照结束，耗时：38毫秒
2022-04-19 09:50:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663677202763776[0;39m 生成今日电子书快照开始
2022-04-19 09:50:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663677202763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:10.029 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663677202763776[0;39m ==> Parameters: 
2022-04-19 09:50:10.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663677202763776[0;39m <==    Updates: 0
2022-04-19 09:50:10.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663677202763776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:50:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663698174283776[0;39m 生成今日电子书快照开始
2022-04-19 09:50:15.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663698174283776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:15.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663698174283776[0;39m ==> Parameters: 
2022-04-19 09:50:15.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663698174283776[0;39m <==    Updates: 0
2022-04-19 09:50:15.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663698174283776[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:50:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663719145803776[0;39m 生成今日电子书快照开始
2022-04-19 09:50:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663719145803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:20.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663719145803776[0;39m ==> Parameters: 
2022-04-19 09:50:20.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663719145803776[0;39m <==    Updates: 0
2022-04-19 09:50:20.058 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663719145803776[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:50:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663740113129472[0;39m 生成今日电子书快照开始
2022-04-19 09:50:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663740113129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:25.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663740113129472[0;39m ==> Parameters: 
2022-04-19 09:50:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663740113129472[0;39m <==    Updates: 0
2022-04-19 09:50:25.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663740113129472[0;39m 生成今日电子书快照结束，耗时：67毫秒
2022-04-19 09:50:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663761088843776[0;39m 生成今日电子书快照开始
2022-04-19 09:50:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663761088843776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:30.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663761088843776[0;39m ==> Parameters: 
2022-04-19 09:50:30.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663761088843776[0;39m <==    Updates: 0
2022-04-19 09:50:30.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663761088843776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:50:35.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663782051975168[0;39m 生成今日电子书快照开始
2022-04-19 09:50:35.033 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663782051975168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:35.035 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663782051975168[0;39m ==> Parameters: 
2022-04-19 09:50:35.239 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663782051975168[0;39m <==    Updates: 0
2022-04-19 09:50:35.239 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663782051975168[0;39m 生成今日电子书快照结束，耗时：238毫秒
2022-04-19 09:50:35.239 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663783054413824[0;39m start updating Ebook doc
2022-04-19 09:50:35.239 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663783054413824[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:50:35.239 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663783054413824[0;39m ==> Parameters: 
2022-04-19 09:50:35.280 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663783054413824[0;39m <==    Updates: 1
2022-04-19 09:50:35.280 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663783054413824[0;39m update ends, take 41 millisecs
2022-04-19 09:50:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663803031883776[0;39m 生成今日电子书快照开始
2022-04-19 09:50:40.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663803031883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663803031883776[0;39m ==> Parameters: 
2022-04-19 09:50:40.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663803031883776[0;39m <==    Updates: 0
2022-04-19 09:50:40.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663803031883776[0;39m 生成今日电子书快照结束，耗时：65毫秒
2022-04-19 09:50:45.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663824003403776[0;39m 生成今日电子书快照开始
2022-04-19 09:50:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663824003403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663824003403776[0;39m ==> Parameters: 
2022-04-19 09:50:45.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663824003403776[0;39m <==    Updates: 0
2022-04-19 09:50:45.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663824003403776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:50:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663844966535168[0;39m 生成今日电子书快照开始
2022-04-19 09:50:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663844966535168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:50.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663844966535168[0;39m ==> Parameters: 
2022-04-19 09:50:50.250 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663844966535168[0;39m <==    Updates: 0
2022-04-19 09:50:50.250 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663844966535168[0;39m 生成今日电子书快照结束，耗时：249毫秒
2022-04-19 09:50:55.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663865954832384[0;39m 生成今日电子书快照开始
2022-04-19 09:50:55.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663865954832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:50:55.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663865954832384[0;39m ==> Parameters: 
2022-04-19 09:50:55.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663865954832384[0;39m <==    Updates: 0
2022-04-19 09:50:55.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663865954832384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:51:00.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663886930546688[0;39m 生成今日电子书快照开始
2022-04-19 09:51:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663886930546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663886930546688[0;39m ==> Parameters: 
2022-04-19 09:51:00.061 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663886930546688[0;39m <==    Updates: 0
2022-04-19 09:51:00.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663886930546688[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:51:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663907893678080[0;39m 生成今日电子书快照开始
2022-04-19 09:51:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663907893678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:05.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663907893678080[0;39m ==> Parameters: 
2022-04-19 09:51:05.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663907893678080[0;39m <==    Updates: 0
2022-04-19 09:51:05.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663907893678080[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:51:05.068 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171663908166307840[0;39m start updating Ebook doc
2022-04-19 09:51:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663908166307840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:51:05.068 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663908166307840[0;39m ==> Parameters: 
2022-04-19 09:51:05.105 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171663908166307840[0;39m <==    Updates: 1
2022-04-19 09:51:05.105 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171663908166307840[0;39m update ends, take 37 millisecs
2022-04-19 09:51:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663928869392384[0;39m 生成今日电子书快照开始
2022-04-19 09:51:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663928869392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:10.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663928869392384[0;39m ==> Parameters: 
2022-04-19 09:51:10.065 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663928869392384[0;39m <==    Updates: 0
2022-04-19 09:51:10.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663928869392384[0;39m 生成今日电子书快照结束，耗时：61毫秒
2022-04-19 09:51:15.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663949836718080[0;39m 生成今日电子书快照开始
2022-04-19 09:51:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663949836718080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663949836718080[0;39m ==> Parameters: 
2022-04-19 09:51:15.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663949836718080[0;39m <==    Updates: 0
2022-04-19 09:51:15.070 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663949836718080[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:51:20.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663970799849472[0;39m 生成今日电子书快照开始
2022-04-19 09:51:20.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663970799849472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663970799849472[0;39m ==> Parameters: 
2022-04-19 09:51:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663970799849472[0;39m <==    Updates: 0
2022-04-19 09:51:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663970799849472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:51:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171663991783952384[0;39m 生成今日电子书快照开始
2022-04-19 09:51:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663991783952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663991783952384[0;39m ==> Parameters: 
2022-04-19 09:51:25.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171663991783952384[0;39m <==    Updates: 0
2022-04-19 09:51:25.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171663991783952384[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:51:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664012751278080[0;39m 生成今日电子书快照开始
2022-04-19 09:51:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664012751278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:30.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664012751278080[0;39m ==> Parameters: 
2022-04-19 09:51:30.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664012751278080[0;39m <==    Updates: 0
2022-04-19 09:51:30.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664012751278080[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:51:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664033714409472[0;39m start updating Ebook doc
2022-04-19 09:51:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664033714409472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:51:35.021 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664033714409472[0;39m ==> Parameters: 
2022-04-19 09:51:35.067 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664033714409472[0;39m <==    Updates: 1
2022-04-19 09:51:35.067 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664033714409472[0;39m update ends, take 65 millisecs
2022-04-19 09:51:35.067 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664033991233536[0;39m 生成今日电子书快照开始
2022-04-19 09:51:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664033991233536[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:35.067 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664033991233536[0;39m ==> Parameters: 
2022-04-19 09:51:35.117 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664033991233536[0;39m <==    Updates: 0
2022-04-19 09:51:35.117 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664033991233536[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:51:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664054690123776[0;39m 生成今日电子书快照开始
2022-04-19 09:51:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664054690123776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:40.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664054690123776[0;39m ==> Parameters: 
2022-04-19 09:51:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664054690123776[0;39m <==    Updates: 0
2022-04-19 09:51:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664054690123776[0;39m 生成今日电子书快照结束，耗时：63毫秒
2022-04-19 09:51:45.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664075665838080[0;39m 生成今日电子书快照开始
2022-04-19 09:51:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664075665838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:45.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664075665838080[0;39m ==> Parameters: 
2022-04-19 09:51:45.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664075665838080[0;39m <==    Updates: 0
2022-04-19 09:51:45.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664075665838080[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:51:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664096637358080[0;39m 生成今日电子书快照开始
2022-04-19 09:51:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664096637358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664096637358080[0;39m ==> Parameters: 
2022-04-19 09:51:50.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664096637358080[0;39m <==    Updates: 0
2022-04-19 09:51:50.059 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664096637358080[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:51:55.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664117600489472[0;39m 生成今日电子书快照开始
2022-04-19 09:51:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664117600489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:51:55.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664117600489472[0;39m ==> Parameters: 
2022-04-19 09:51:55.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664117600489472[0;39m <==    Updates: 0
2022-04-19 09:51:55.047 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664117600489472[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:52:00.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664138572009472[0;39m 生成今日电子书快照开始
2022-04-19 09:52:00.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664138572009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664138572009472[0;39m ==> Parameters: 
2022-04-19 09:52:00.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664138572009472[0;39m <==    Updates: 0
2022-04-19 09:52:00.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664138572009472[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:52:05.004 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664159556112384[0;39m start updating Ebook doc
2022-04-19 09:52:05.027 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664159556112384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:52:05.028 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664159556112384[0;39m ==> Parameters: 
2022-04-19 09:52:05.056 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664159556112384[0;39m <==    Updates: 1
2022-04-19 09:52:05.057 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664159556112384[0;39m update ends, take 53 millisecs
2022-04-19 09:52:05.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664159778410496[0;39m 生成今日电子书快照开始
2022-04-19 09:52:05.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664159778410496[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:05.058 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664159778410496[0;39m ==> Parameters: 
2022-04-19 09:52:05.090 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664159778410496[0;39m <==    Updates: 0
2022-04-19 09:52:05.090 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664159778410496[0;39m 生成今日电子书快照结束，耗时：33毫秒
2022-04-19 09:52:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664180519243776[0;39m 生成今日电子书快照开始
2022-04-19 09:52:10.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664180519243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:10.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664180519243776[0;39m ==> Parameters: 
2022-04-19 09:52:10.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664180519243776[0;39m <==    Updates: 0
2022-04-19 09:52:10.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664180519243776[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:52:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664201486569472[0;39m 生成今日电子书快照开始
2022-04-19 09:52:15.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664201486569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:15.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664201486569472[0;39m ==> Parameters: 
2022-04-19 09:52:15.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664201486569472[0;39m <==    Updates: 0
2022-04-19 09:52:15.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664201486569472[0;39m 生成今日电子书快照结束，耗时：55毫秒
2022-04-19 09:52:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664222470672384[0;39m 生成今日电子书快照开始
2022-04-19 09:52:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664222470672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:20.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664222470672384[0;39m ==> Parameters: 
2022-04-19 09:52:20.057 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664222470672384[0;39m <==    Updates: 0
2022-04-19 09:52:20.057 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664222470672384[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:52:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664243429609472[0;39m 生成今日电子书快照开始
2022-04-19 09:52:25.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664243429609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:25.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664243429609472[0;39m ==> Parameters: 
2022-04-19 09:52:25.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664243429609472[0;39m <==    Updates: 0
2022-04-19 09:52:25.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664243429609472[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:52:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664264409518080[0;39m 生成今日电子书快照开始
2022-04-19 09:52:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664264409518080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:30.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664264409518080[0;39m ==> Parameters: 
2022-04-19 09:52:30.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664264409518080[0;39m <==    Updates: 0
2022-04-19 09:52:30.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664264409518080[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:52:35.003 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664285381038080[0;39m start updating Ebook doc
2022-04-19 09:52:35.046 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664285381038080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:52:35.046 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664285381038080[0;39m ==> Parameters: 
2022-04-19 09:52:35.076 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664285381038080[0;39m <==    Updates: 1
2022-04-19 09:52:35.076 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664285381038080[0;39m update ends, take 72 millisecs
2022-04-19 09:52:35.076 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664285687222272[0;39m 生成今日电子书快照开始
2022-04-19 09:52:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664285687222272[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:35.077 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664285687222272[0;39m ==> Parameters: 
2022-04-19 09:52:35.104 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664285687222272[0;39m <==    Updates: 0
2022-04-19 09:52:35.105 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664285687222272[0;39m 生成今日电子书快照结束，耗时：29毫秒
2022-04-19 09:52:40.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664306356752384[0;39m 生成今日电子书快照开始
2022-04-19 09:52:40.038 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664306356752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:40.039 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664306356752384[0;39m ==> Parameters: 
2022-04-19 09:52:40.066 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664306356752384[0;39m <==    Updates: 0
2022-04-19 09:52:40.066 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664306356752384[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:52:45.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664327328272384[0;39m 生成今日电子书快照开始
2022-04-19 09:52:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664327328272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:45.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664327328272384[0;39m ==> Parameters: 
2022-04-19 09:52:45.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664327328272384[0;39m <==    Updates: 0
2022-04-19 09:52:45.060 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664327328272384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:52:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664348295598080[0;39m 生成今日电子书快照开始
2022-04-19 09:52:50.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664348295598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:50.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664348295598080[0;39m ==> Parameters: 
2022-04-19 09:52:50.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664348295598080[0;39m <==    Updates: 0
2022-04-19 09:52:50.048 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664348295598080[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:52:55.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664369262923776[0;39m 生成今日电子书快照开始
2022-04-19 09:52:55.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664369262923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:52:55.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664369262923776[0;39m ==> Parameters: 
2022-04-19 09:52:55.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664369262923776[0;39m <==    Updates: 0
2022-04-19 09:52:55.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664369262923776[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:53:00.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664390242832384[0;39m 生成今日电子书快照开始
2022-04-19 09:53:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664390242832384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664390242832384[0;39m ==> Parameters: 
2022-04-19 09:53:00.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664390242832384[0;39m <==    Updates: 0
2022-04-19 09:53:00.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664390242832384[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:53:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664411201769472[0;39m start updating Ebook doc
2022-04-19 09:53:05.022 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664411201769472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:53:05.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664411201769472[0;39m ==> Parameters: 
2022-04-19 09:53:05.053 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664411201769472[0;39m <==    Updates: 1
2022-04-19 09:53:05.053 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664411201769472[0;39m update ends, take 52 millisecs
2022-04-19 09:53:05.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664411424067584[0;39m 生成今日电子书快照开始
2022-04-19 09:53:05.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664411424067584[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:05.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664411424067584[0;39m ==> Parameters: 
2022-04-19 09:53:05.080 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664411424067584[0;39m <==    Updates: 0
2022-04-19 09:53:05.080 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664411424067584[0;39m 生成今日电子书快照结束，耗时：26毫秒
2022-04-19 09:53:10.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664432181678080[0;39m 生成今日电子书快照开始
2022-04-19 09:53:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664432181678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:10.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664432181678080[0;39m ==> Parameters: 
2022-04-19 09:53:10.063 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664432181678080[0;39m <==    Updates: 0
2022-04-19 09:53:10.063 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664432181678080[0;39m 生成今日电子书快照结束，耗时：60毫秒
2022-04-19 09:53:15.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664453149003776[0;39m 生成今日电子书快照开始
2022-04-19 09:53:15.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664453149003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:15.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664453149003776[0;39m ==> Parameters: 
2022-04-19 09:53:15.106 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664453149003776[0;39m <==    Updates: 0
2022-04-19 09:53:15.106 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664453149003776[0;39m 生成今日电子书快照结束，耗时：104毫秒
2022-04-19 09:53:20.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664474128912384[0;39m 生成今日电子书快照开始
2022-04-19 09:53:20.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664474128912384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664474128912384[0;39m ==> Parameters: 
2022-04-19 09:53:20.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664474128912384[0;39m <==    Updates: 0
2022-04-19 09:53:20.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664474128912384[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:53:25.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664495092043776[0;39m 生成今日电子书快照开始
2022-04-19 09:53:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664495092043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:25.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664495092043776[0;39m ==> Parameters: 
2022-04-19 09:53:25.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664495092043776[0;39m <==    Updates: 0
2022-04-19 09:53:25.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664495092043776[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:53:30.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664516067758080[0;39m 生成今日电子书快照开始
2022-04-19 09:53:30.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664516067758080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:30.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664516067758080[0;39m ==> Parameters: 
2022-04-19 09:53:30.049 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664516067758080[0;39m <==    Updates: 0
2022-04-19 09:53:30.049 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664516067758080[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:53:35.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664537026695168[0;39m start updating Ebook doc
2022-04-19 09:53:35.017 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664537026695168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:53:35.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664537026695168[0;39m ==> Parameters: 
2022-04-19 09:53:35.043 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664537026695168[0;39m <==    Updates: 1
2022-04-19 09:53:35.054 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664537026695168[0;39m update ends, take 54 millisecs
2022-04-19 09:53:35.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664537253187584[0;39m 生成今日电子书快照开始
2022-04-19 09:53:35.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664537253187584[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:35.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664537253187584[0;39m ==> Parameters: 
2022-04-19 09:53:35.088 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664537253187584[0;39m <==    Updates: 0
2022-04-19 09:53:35.089 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664537253187584[0;39m 生成今日电子书快照结束，耗时：34毫秒
2022-04-19 09:53:40.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664558006603776[0;39m 生成今日电子书快照开始
2022-04-19 09:53:40.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664558006603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:40.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664558006603776[0;39m ==> Parameters: 
2022-04-19 09:53:40.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664558006603776[0;39m <==    Updates: 0
2022-04-19 09:53:40.046 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664558006603776[0;39m 生成今日电子书快照结束，耗时：43毫秒
2022-04-19 09:53:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664578990706688[0;39m 生成今日电子书快照开始
2022-04-19 09:53:45.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664578990706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:45.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664578990706688[0;39m ==> Parameters: 
2022-04-19 09:53:45.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664578990706688[0;39m <==    Updates: 0
2022-04-19 09:53:45.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664578990706688[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:53:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664599953838080[0;39m 生成今日电子书快照开始
2022-04-19 09:53:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664599953838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:50.032 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664599953838080[0;39m ==> Parameters: 
2022-04-19 09:53:50.059 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664599953838080[0;39m <==    Updates: 0
2022-04-19 09:53:50.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664599953838080[0;39m 生成今日电子书快照结束，耗时：58毫秒
2022-04-19 09:53:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664620925358080[0;39m 生成今日电子书快照开始
2022-04-19 09:53:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664620925358080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:53:55.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664620925358080[0;39m ==> Parameters: 
2022-04-19 09:53:55.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664620925358080[0;39m <==    Updates: 0
2022-04-19 09:53:55.046 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664620925358080[0;39m 生成今日电子书快照结束，耗时：43毫秒
2022-04-19 09:54:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664641892683776[0;39m 生成今日电子书快照开始
2022-04-19 09:54:00.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664641892683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:00.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664641892683776[0;39m ==> Parameters: 
2022-04-19 09:54:00.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664641892683776[0;39m <==    Updates: 0
2022-04-19 09:54:00.047 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664641892683776[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:54:05.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664662860009472[0;39m start updating Ebook doc
2022-04-19 09:54:05.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664662860009472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:54:05.019 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664662860009472[0;39m ==> Parameters: 
2022-04-19 09:54:05.045 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664662860009472[0;39m <==    Updates: 1
2022-04-19 09:54:05.045 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664662860009472[0;39m update ends, take 43 millisecs
2022-04-19 09:54:05.045 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664663044558848[0;39m 生成今日电子书快照开始
2022-04-19 09:54:05.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664663044558848[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:05.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664663044558848[0;39m ==> Parameters: 
2022-04-19 09:54:05.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664663044558848[0;39m <==    Updates: 0
2022-04-19 09:54:05.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664663044558848[0;39m 生成今日电子书快照结束，耗时：23毫秒
2022-04-19 09:54:10.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664683844112384[0;39m 生成今日电子书快照开始
2022-04-19 09:54:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664683844112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:10.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664683844112384[0;39m ==> Parameters: 
2022-04-19 09:54:10.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664683844112384[0;39m <==    Updates: 0
2022-04-19 09:54:10.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664683844112384[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:54:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664704803049472[0;39m 生成今日电子书快照开始
2022-04-19 09:54:15.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664704803049472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664704803049472[0;39m ==> Parameters: 
2022-04-19 09:54:15.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664704803049472[0;39m <==    Updates: 0
2022-04-19 09:54:15.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664704803049472[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:54:20.006 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664725795540992[0;39m 生成今日电子书快照开始
2022-04-19 09:54:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664725795540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:20.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664725795540992[0;39m ==> Parameters: 
2022-04-19 09:54:20.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664725795540992[0;39m <==    Updates: 0
2022-04-19 09:54:20.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664725795540992[0;39m 生成今日电子书快照结束，耗时：49毫秒
2022-04-19 09:54:25.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664746758672384[0;39m 生成今日电子书快照开始
2022-04-19 09:54:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664746758672384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:25.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664746758672384[0;39m ==> Parameters: 
2022-04-19 09:54:25.060 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664746758672384[0;39m <==    Updates: 0
2022-04-19 09:54:25.061 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664746758672384[0;39m 生成今日电子书快照结束，耗时：56毫秒
2022-04-19 09:54:30.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664767721803776[0;39m 生成今日电子书快照开始
2022-04-19 09:54:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664767721803776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:30.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664767721803776[0;39m ==> Parameters: 
2022-04-19 09:54:30.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664767721803776[0;39m <==    Updates: 0
2022-04-19 09:54:30.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664767721803776[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:54:35.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664788689129472[0;39m 生成今日电子书快照开始
2022-04-19 09:54:35.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664788689129472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:35.026 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664788689129472[0;39m ==> Parameters: 
2022-04-19 09:54:35.054 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664788689129472[0;39m <==    Updates: 0
2022-04-19 09:54:35.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664788689129472[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:54:35.054 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664788911427584[0;39m start updating Ebook doc
2022-04-19 09:54:35.054 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664788911427584[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:54:35.055 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664788911427584[0;39m ==> Parameters: 
2022-04-19 09:54:35.083 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664788911427584[0;39m <==    Updates: 1
2022-04-19 09:54:35.083 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664788911427584[0;39m update ends, take 29 millisecs
2022-04-19 09:54:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664809677426688[0;39m 生成今日电子书快照开始
2022-04-19 09:54:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664809677426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:40.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664809677426688[0;39m ==> Parameters: 
2022-04-19 09:54:40.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664809677426688[0;39m <==    Updates: 0
2022-04-19 09:54:40.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664809677426688[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:54:45.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664830632169472[0;39m 生成今日电子书快照开始
2022-04-19 09:54:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664830632169472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664830632169472[0;39m ==> Parameters: 
2022-04-19 09:54:45.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664830632169472[0;39m <==    Updates: 0
2022-04-19 09:54:45.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664830632169472[0;39m 生成今日电子书快照结束，耗时：54毫秒
2022-04-19 09:54:50.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664851599495168[0;39m 生成今日电子书快照开始
2022-04-19 09:54:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664851599495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:50.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664851599495168[0;39m ==> Parameters: 
2022-04-19 09:54:50.070 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664851599495168[0;39m <==    Updates: 0
2022-04-19 09:54:50.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664851599495168[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:54:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664872583598080[0;39m 生成今日电子书快照开始
2022-04-19 09:54:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664872583598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:54:55.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664872583598080[0;39m ==> Parameters: 
2022-04-19 09:54:55.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664872583598080[0;39m <==    Updates: 0
2022-04-19 09:54:55.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664872583598080[0;39m 生成今日电子书快照结束，耗时：47毫秒
2022-04-19 09:55:00.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664893550923776[0;39m 生成今日电子书快照开始
2022-04-19 09:55:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664893550923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:00.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664893550923776[0;39m ==> Parameters: 
2022-04-19 09:55:00.068 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664893550923776[0;39m <==    Updates: 0
2022-04-19 09:55:00.068 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664893550923776[0;39m 生成今日电子书快照结束，耗时：66毫秒
2022-04-19 09:55:05.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664914518249472[0;39m 生成今日电子书快照开始
2022-04-19 09:55:05.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664914518249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:05.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664914518249472[0;39m ==> Parameters: 
2022-04-19 09:55:05.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664914518249472[0;39m <==    Updates: 0
2022-04-19 09:55:05.048 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664914518249472[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:55:05.048 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171664914715381760[0;39m start updating Ebook doc
2022-04-19 09:55:05.048 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664914715381760[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:55:05.048 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664914715381760[0;39m ==> Parameters: 
2022-04-19 09:55:05.074 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171664914715381760[0;39m <==    Updates: 1
2022-04-19 09:55:05.074 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171664914715381760[0;39m update ends, take 26 millisecs
2022-04-19 09:55:10.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664935493963776[0;39m 生成今日电子书快照开始
2022-04-19 09:55:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664935493963776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:10.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664935493963776[0;39m ==> Parameters: 
2022-04-19 09:55:10.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664935493963776[0;39m <==    Updates: 0
2022-04-19 09:55:10.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664935493963776[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:55:15.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664956461289472[0;39m 生成今日电子书快照开始
2022-04-19 09:55:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664956461289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664956461289472[0;39m ==> Parameters: 
2022-04-19 09:55:15.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664956461289472[0;39m <==    Updates: 0
2022-04-19 09:55:15.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664956461289472[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:55:20.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664977428615168[0;39m 生成今日电子书快照开始
2022-04-19 09:55:20.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664977428615168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:20.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664977428615168[0;39m ==> Parameters: 
2022-04-19 09:55:20.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664977428615168[0;39m <==    Updates: 0
2022-04-19 09:55:20.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664977428615168[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:55:25.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171664998421106688[0;39m 生成今日电子书快照开始
2022-04-19 09:55:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664998421106688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:25.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664998421106688[0;39m ==> Parameters: 
2022-04-19 09:55:25.055 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171664998421106688[0;39m <==    Updates: 0
2022-04-19 09:55:25.055 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171664998421106688[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:55:30.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665019392626688[0;39m 生成今日电子书快照开始
2022-04-19 09:55:30.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665019392626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:30.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665019392626688[0;39m ==> Parameters: 
2022-04-19 09:55:30.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665019392626688[0;39m <==    Updates: 0
2022-04-19 09:55:30.050 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665019392626688[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-19 09:55:35.001 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171665040347369472[0;39m start updating Ebook doc
2022-04-19 09:55:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665040347369472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:55:35.023 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665040347369472[0;39m ==> Parameters: 
2022-04-19 09:55:35.047 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665040347369472[0;39m <==    Updates: 1
2022-04-19 09:55:35.047 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171665040347369472[0;39m update ends, take 46 millisecs
2022-04-19 09:55:35.047 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665040540307456[0;39m 生成今日电子书快照开始
2022-04-19 09:55:35.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665040540307456[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:35.048 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665040540307456[0;39m ==> Parameters: 
2022-04-19 09:55:35.075 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665040540307456[0;39m <==    Updates: 0
2022-04-19 09:55:35.075 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665040540307456[0;39m 生成今日电子书快照结束，耗时：28毫秒
2022-04-19 09:55:40.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665061335666688[0;39m 生成今日电子书快照开始
2022-04-19 09:55:40.030 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665061335666688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:40.031 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665061335666688[0;39m ==> Parameters: 
2022-04-19 09:55:40.069 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665061335666688[0;39m <==    Updates: 0
2022-04-19 09:55:40.069 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665061335666688[0;39m 生成今日电子书快照结束，耗时：64毫秒
2022-04-19 09:55:45.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665082286215168[0;39m 生成今日电子书快照开始
2022-04-19 09:55:45.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665082286215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:45.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665082286215168[0;39m ==> Parameters: 
2022-04-19 09:55:45.050 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665082286215168[0;39m <==    Updates: 0
2022-04-19 09:55:45.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665082286215168[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:55:50.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665103270318080[0;39m 生成今日电子书快照开始
2022-04-19 09:55:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665103270318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:50.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665103270318080[0;39m ==> Parameters: 
2022-04-19 09:55:50.089 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665103270318080[0;39m <==    Updates: 0
2022-04-19 09:55:50.090 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665103270318080[0;39m 生成今日电子书快照结束，耗时：86毫秒
2022-04-19 09:55:55.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665124241838080[0;39m 生成今日电子书快照开始
2022-04-19 09:55:55.177 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665124241838080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:55:55.177 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665124241838080[0;39m ==> Parameters: 
2022-04-19 09:55:55.215 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665124241838080[0;39m <==    Updates: 0
2022-04-19 09:55:55.216 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665124241838080[0;39m 生成今日电子书快照结束，耗时：212毫秒
2022-04-19 09:56:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665145200775168[0;39m 生成今日电子书快照开始
2022-04-19 09:56:00.020 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665145200775168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:00.021 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665145200775168[0;39m ==> Parameters: 
2022-04-19 09:56:00.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665145200775168[0;39m <==    Updates: 0
2022-04-19 09:56:00.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665145200775168[0;39m 生成今日电子书快照结束，耗时：50毫秒
2022-04-19 09:56:05.003 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665166184878080[0;39m 生成今日电子书快照开始
2022-04-19 09:56:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665166184878080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:05.027 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665166184878080[0;39m ==> Parameters: 
2022-04-19 09:56:05.064 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665166184878080[0;39m <==    Updates: 0
2022-04-19 09:56:05.065 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665166184878080[0;39m 生成今日电子书快照结束，耗时：62毫秒
2022-04-19 09:56:05.065 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171665166444924928[0;39m start updating Ebook doc
2022-04-19 09:56:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665166444924928[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:56:05.065 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665166444924928[0;39m ==> Parameters: 
2022-04-19 09:56:05.095 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665166444924928[0;39m <==    Updates: 1
2022-04-19 09:56:05.096 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171665166444924928[0;39m update ends, take 31 millisecs
2022-04-19 09:56:10.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665187148009472[0;39m 生成今日电子书快照开始
2022-04-19 09:56:10.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665187148009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:10.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665187148009472[0;39m ==> Parameters: 
2022-04-19 09:56:10.046 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665187148009472[0;39m <==    Updates: 0
2022-04-19 09:56:10.046 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665187148009472[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:56:15.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665208115335168[0;39m 生成今日电子书快照开始
2022-04-19 09:56:15.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665208115335168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:15.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665208115335168[0;39m ==> Parameters: 
2022-04-19 09:56:15.052 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665208115335168[0;39m <==    Updates: 0
2022-04-19 09:56:15.053 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665208115335168[0;39m 生成今日电子书快照结束，耗时：52毫秒
2022-04-19 09:56:20.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665229095243776[0;39m 生成今日电子书快照开始
2022-04-19 09:56:20.018 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665229095243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:20.019 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665229095243776[0;39m ==> Parameters: 
2022-04-19 09:56:20.047 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665229095243776[0;39m <==    Updates: 0
2022-04-19 09:56:20.048 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665229095243776[0;39m 生成今日电子书快照结束，耗时：46毫秒
2022-04-19 09:56:25.001 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665250062569472[0;39m 生成今日电子书快照开始
2022-04-19 09:56:25.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665250062569472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:25.017 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665250062569472[0;39m ==> Parameters: 
2022-04-19 09:56:25.045 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665250062569472[0;39m <==    Updates: 0
2022-04-19 09:56:25.046 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665250062569472[0;39m 生成今日电子书快照结束，耗时：45毫秒
2022-04-19 09:56:30.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665271029895168[0;39m 生成今日电子书快照开始
2022-04-19 09:56:30.015 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665271029895168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:30.016 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665271029895168[0;39m ==> Parameters: 
2022-04-19 09:56:30.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665271029895168[0;39m <==    Updates: 0
2022-04-19 09:56:30.044 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665271029895168[0;39m 生成今日电子书快照结束，耗时：44毫秒
2022-04-19 09:56:35.000 INFO  com.ameliawiki.wiki.job.DocJob                    :33   [32m171665292001415168[0;39m start updating Ebook doc
2022-04-19 09:56:35.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665292001415168[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2022-04-19 09:56:35.018 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665292001415168[0;39m ==> Parameters: 
2022-04-19 09:56:35.043 DEBUG c.a.wiki.mapper.DocMapperCust.updateEbookInfo     :137  [32m171665292001415168[0;39m <==    Updates: 1
2022-04-19 09:56:35.043 INFO  com.ameliawiki.wiki.job.DocJob                    :36   [32m171665292001415168[0;39m update ends, take 42 millisecs
2022-04-19 09:56:35.044 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665292185964544[0;39m 生成今日电子书快照开始
2022-04-19 09:56:35.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665292185964544[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:35.044 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665292185964544[0;39m ==> Parameters: 
2022-04-19 09:56:35.071 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665292185964544[0;39m <==    Updates: 0
2022-04-19 09:56:35.071 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665292185964544[0;39m 生成今日电子书快照结束，耗时：27毫秒
2022-04-19 09:56:40.002 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665312981323776[0;39m 生成今日电子书快照开始
2022-04-19 09:56:40.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665312981323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:40.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665312981323776[0;39m ==> Parameters: 
2022-04-19 09:56:40.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665312981323776[0;39m <==    Updates: 0
2022-04-19 09:56:40.051 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665312981323776[0;39m 生成今日电子书快照结束，耗时：48毫秒
2022-04-19 09:56:45.005 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665333965426688[0;39m 生成今日电子书快照开始
2022-04-19 09:56:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665333965426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:45.028 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665333965426688[0;39m ==> Parameters: 
2022-04-19 09:56:45.056 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665333965426688[0;39m <==    Updates: 0
2022-04-19 09:56:45.056 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665333965426688[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:56:50.004 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665354932752384[0;39m 生成今日电子书快照开始
2022-04-19 09:56:50.042 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665354932752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:50.043 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665354932752384[0;39m ==> Parameters: 
2022-04-19 09:56:50.073 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665354932752384[0;39m <==    Updates: 0
2022-04-19 09:56:50.074 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665354932752384[0;39m 生成今日电子书快照结束，耗时：70毫秒
2022-04-19 09:56:55.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665375887495168[0;39m 生成今日电子书快照开始
2022-04-19 09:56:55.022 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665375887495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:56:55.023 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665375887495168[0;39m ==> Parameters: 
2022-04-19 09:56:55.051 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665375887495168[0;39m <==    Updates: 0
2022-04-19 09:56:55.052 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665375887495168[0;39m 生成今日电子书快照结束，耗时：51毫秒
2022-04-19 09:57:00.000 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :33   [32m171665396859015168[0;39m 生成今日电子书快照开始
2022-04-19 09:57:00.024 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665396859015168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2022-04-19 09:57:00.025 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665396859015168[0;39m ==> Parameters: 
2022-04-19 09:57:00.053 DEBUG c.a.w.mapper.EbookSnapshotMapperCust.getSnapshot  :137  [32m171665396859015168[0;39m <==    Updates: 0
2022-04-19 09:57:00.054 INFO  com.ameliawiki.wiki.job.EbookSnapshotJob          :36   [32m171665396859015168[0;39m 生成今日电子书快照结束，耗时：53毫秒
2022-04-19 09:57:01.142 INFO  com.ameliawiki.wiki.websocket.WebSocketServer     :41   [32m                  [0;39m 连接关闭，token：8fmo2PghhH，session id：4！当前连接数：0
2022-04-19 09:57:01.228 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :218  [32m                  [0;39m Shutting down ExecutorService 'taskScheduler'
2022-04-19 09:57:01.231 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :218  [32m                  [0;39m Shutting down ExecutorService 'applicationTaskExecutor'
2022-04-19 09:57:01.240 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2022-04-19 09:57:01.247 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
